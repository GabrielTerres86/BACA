BEGIN
  UPDATE craphis c
     SET c.idmonpld = 1
   WHERE c.cdcooper = 3
     AND c.cdhistor IN (43,2188,2944,7,8,13,101,550,997,1022,1399,1776,1777,1820,1827,1829,1848,1925,1989,2943);

  FOR r_hist IN (SELECT cdhistor
                   FROM craphis x
                  WHERE x.idmonpld = 1
                    AND x.cdcooper = 3) LOOP
    UPDATE craphis y
       SET y.idmonpld = 1
     WHERE y.cdcooper <> 3
       AND y.cdhistor = r_hist.cdhistor;
  END LOOP;
  
  UPDATE craphis c
   SET c.idmonpld = 0
 WHERE c.cdhistor IN (18,
20,
105,
106,
127,
1399,
451,
500,
621,
662,
788,
793,
803,
569,
573,
885,
956,
1099,
1536,
1900,
1908,
1580,
499,
2233,
1830,
1825,
2123,
1904,
1569,
1575,
2279,
2236,
2357,
2634,
2247,
1666,
9,
43,
73,
77,
78,
384,
472,
504,
767,
785,
845,
857,
832,
597,
76,
253,
297,
336,
350,
1118,
191,
205,
2102,
2104,
1851,
1567,
1576,
2246,
1022,
18,
1906,
1822,
1831,
1832,
1907,
1826,
1903,
2740,
2721,
2741,
49,
566,
608,
602,
867,
530,
359,
160,
214,
1899,
1911,
1909,
1570,
2001,
425,
2002,
1925,
1834,
1669,
2525,
2351,
2698,
2630,
1668,
387,
571,
774,
1229,
1404,
887,
469,
298,
338,
367,
423,
501,
1102,
2225,
2248,
1828,
1896,
1998,
1754,
1578,
2280,
1833,
2697,
1163,
2350,
2632,
1568,
1931,
13,
114,
461,
550,
567,
610,
766,
773,
782,
101,
1100,
1167,
1897,
1898,
2000,
2106,
1634,
1671,
1902,
2137,
1530,
2107,
1829,
2299,
1573,
2012,
2545,
2099,
2277,
16,
72,
74,
483,
570,
802,
568,
1146,
1419,
884,
920,
506,
512,
1101,
1672,
2100,
1581,
1910,
1989,
606,
2011,
1877,
2181,
1923,
2055,
2101,
1905,
1577,
1564,
1566,
2760,
2270,
2521,
2516,
2938,
107,
1405,
481,
498,
600,
843,
527,
8,
290,
156,
177,
1125,
1677,
1848,
2105,
2234,
2235,
1146,
1821,
1823,
1965,
1675,
1571,
1563,
1579,
1633,
1670,
2783,
2278,
2520,
2435,
2703,
2387,
2623,
1572,
1901,
7,
28,
388,
397,
399,
478,
480,
544,
604,
790,
784,
997,
317,
351,
360,
439,
497,
992,
998,
1095,
217,
218,
275,
1155,
1674,
2103,
2108,
2232,
1565,
1820,
1824,
1827,
1937,
1672,
1673,
1999,
1574,
1679,
2294,
2410,
2245,
2633,
2661,
2481,
2356,
2799);
  
  COMMIT;
END;
/
