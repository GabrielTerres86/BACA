BEGIN
  INSERT INTO
     PIX.TBPIX_BALDE_COOPERATIVA(CDCOOPER, CDBALDE, QTFICHA, QTINCREMENTO, QTFICHA_MAXIMO, DHULTIMA_ATUALIZACAO)
     SELECT COP.CDCOOPER,
         24 AS CDBALDE,
       CASE WHEN COP.CDCOOPER = 1 THEN 8000
           ELSE 3000
           END AS QTFICHA,
       CASE WHEN COP.CDCOOPER = 1 THEN 2000
           ELSE 50
           END AS QTINCREMENTO,
       CASE WHEN COP.CDCOOPER = 1 THEN 8000
           ELSE 3000
           END AS QTFICHA_MAXIMO,
       SYSDATE AS DHULTIMA_ATUALIZACAO
     FROM PIX.TBPIX_CRAPCOP COP WHERE COP.FLGATIVO = 1 ORDER BY COP.CDCOOPER;
   
  UPDATE
     PIX.TBPIX_BALDE_COOPERATIVA
  SET
     QTFICHA = 36000,
     QTFICHA_MAXIMO = 36000,
     QTINCREMENTO = 12000
  WHERE
     CDBALDE = 19;

  INSERT INTO
     PIX.TBPIX_BALDE_COOPERATIVA(CDCOOPER, CDBALDE, QTFICHA, QTINCREMENTO, QTFICHA_MAXIMO, DHULTIMA_ATUALIZACAO)
  SELECT COP.CDCOOPER,
       25 AS CDBALDE,
       36000 AS QTFICHA,
       1200 AS QTINCREMENTO,
       36000 AS QTFICHA_MAXIMO,
       SYSDATE AS DHULTIMA_ATUALIZACAO
  FROM PIX.TBPIX_CRAPCOP COP WHERE COP.FLGATIVO = 1 ORDER BY COP.CDCOOPER;
  
  COMMIT;
  
  EXCEPTION
  WHEN OTHERS THEN
    ROLLBACK;
  
END;
