<!-------------------------------------------------------------------------------

   Programa: sistema/internet/fontes/wcrm0007.html
   Sistema : Internet - Cooperativa de Credito
   Sigla   : CRED
   Autor   : Anderson Fossa
   Data    : 18/03/2016.                       Ultima atualizacao: 

   Dados referentes ao programa:
   Frequencia: Sempre que for chamado (On-Line)

   Objetivo  : Detalhar o Evento EAD

   Alteracoes:
--------------------------------------------------------------------------------->
<script language="SpeedScript">
DEF VAR aux_nmrescop LIKE crapcop.nmrescop NO-UNDO.
DEF VAR aux_cdcooper LIKE crapcop.cdcooper NO-UNDO.
		
/* Recebe os parametros  */
ASSIGN aux_cdcooper = INT(GET-VALUE("aux_cdcooper")).
       
/* Busca o nome da cooperativa para montagen da chamada inscLink dinamicamente */
FIND FIRST crapcop WHERE crapcop.cdcooper = aux_cdcooper NO-LOCK NO-ERROR. 
    
IF  NOT AVAILABLE crapcop  THEN
    DO:
        {&out} '~<script type=~"text/javascript~">alert(~"Nome da cooperativa nao encontrado~")~;~</script~>'.
        RETURN.
    END.
ELSE	
    aux_nmrescop = LC(REPLACE(crapcop.nmrescop, " ", "")).
</script>
<html>
<head>
<title>CECRED</title>
<script language="SpeedScript">
{&out} '~<link rel=~"stylesheet~" type=~"text/css~" href=~"/extrato-' + aux_nmrescop + '/crm/css/estilos_progrid.css~"~>\n'.
{&out} '~<script type=~"text/javascript~" src=~"/extrato-' + aux_nmrescop + '/crm/js/bloqueio.js~"~>~</script~>\n'.
{&out} '~<script type=~"text/javascript~" src=~"/extrato-' + aux_nmrescop + '/crm/js/ajax.js~"~>~</script~>\n'.
</script>
<script language="javascript">
function ajax_onResponse() {
	if(checkReadyState(request)) {  
		xmlDoc = request.responseXML;
		// conteudo = a tabela que sera exibida com os dados do evento
		
    conteudo = "<table width=550 border=0 cellpadding=0 cellspacing=0>";

		var erro   = xmlDoc.getElementsByTagName('ERRO');

		if (erro.length > 0) {
			erro = xmlDoc.getElementsByTagName('ERRO').item(0).firstChild.data;
			
			conteudo += '<tr class="fonte_geral">';
			conteudo += '  <td height="25">&nbsp;&nbsp;</td>';
			conteudo += '</tr>';
			conteudo += '<tr class="fonte_geral" align="center">';
			conteudo += '  <td height="25"><strong>' + erro + '</strong></td>';
			conteudo += '</tr>';
			conteudo += '<tr class="fonte_geral">';
			conteudo += '  <td height="25">&nbsp;&nbsp;</td>';
			conteudo += '</tr>';
		} else { 
			var node     = xmlDoc.getElementsByTagName('CURSOS_EAD');			
    
      
      idevento    = node[0].getElementsByTagName("IDEVENTO").item(0).firstChild.data;
      cdevento    = node[0].getElementsByTagName("CDEVENTO").item(0).firstChild.data;
      dtanoage    = node[0].getElementsByTagName("DTANOAGE").item(0).firstChild.data;
      nmevento    = node[0].getElementsByTagName("NMEVENTO").item(0).firstChild.data;
      if (node[0].getElementsByTagName("DSCARHOR").item(0).firstChild != null) {
          dscarhor    = node[0].getElementsByTagName("DSCARHOR").item(0).firstChild.data;
      } else {
          dscarhor = '00:00';
      }
      if (node[0].getElementsByTagName("DSCONTEU").item(0).firstChild != null) {
        dsconteu  = node[0].getElementsByTagName("DSCONTEU").item(0).firstChild.data;      
      } else {
        dsconteu  = '';
      }
      
      conteudo += '<tr>';
      conteudo += '  <td class="fonte_geral"><h2 style="margin-bottom: 10px;">'+ nmevento + '</h2></td>';
      conteudo += '</tr>';
      conteudo += '<tr>';
      conteudo += '  <td height="2" background="/extrato-viacredi/crm/images/geral/separador_laranja.gif"></td>'
      conteudo += '</tr>';      
      conteudo += '<tr>';
      conteudo += '  <td class="fonte_geral">&nbsp;</td>';
      conteudo += '</tr>';
      conteudo += '<tr>';
      conteudo += '  <td class="fonte_geral"><span class="fonte_geral_bold">Carga Hor&aacute;ria:&nbsp;</span>'+  dscarhor +'</td>';
      conteudo += '</tr>';
      conteudo += '<tr>';
      conteudo += '  <td class="fonte_geral">&nbsp;</td>';
      conteudo += '</tr>';
      conteudo += '<tr>';
      conteudo += '  <td class="fonte_geral"><span class="fonte_geral_bold">Descri&ccedil;&atilde;o do Curso:</span></td>';
      conteudo += '</tr>';
      conteudo += '<tr>';
      conteudo += '  <td class="fonte_geral">&nbsp;</td>';
      conteudo += '</tr>';
      conteudo += '<tr>';
      conteudo += '  <td class="fonte_geral"><span>'+ dsconteu +'</span></td>';
      conteudo += '</tr>';
      
    }
	
		conteudo = conteudo+"</table>";
		document.getElementById('copy').innerHTML = conteudo;
		
		return conteudo;
	}
}
</script>
<script language="SpeedScript">
	DEF VAR aux_cdevento LIKE crapedp.cdevento          NO-UNDO.
	DEF VAR aux_idevento LIKE crapedp.idevento          NO-UNDO.
	DEF VAR aux_dtanoage LIKE crapedp.dtanoage          NO-UNDO.
	
	ASSIGN aux_cdevento = INT(GET-VALUE("aux_cdevento"))
         aux_idevento = INT(GET-VALUE("aux_idevento"))
         aux_dtanoage = INT(GET-VALUE("aux_dtanoage")).
</script>	
	
<script language="JavaScript">
 // monta a URL do programa que gera o XML   
   var url = "wcrm0007_xml.p?aux_cdcooper=" + `aux_cdcooper` + 
                           "&aux_cdevento=" + `aux_cdevento` +
                           "&aux_idevento=" + `aux_idevento` +
                           "&aux_dtanoage=" + `aux_dtanoage`;
</script>

<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"><style type="text/css">
<!--
body {
	margin-left: 0px;
	margin-top: 0px;
	margin-right: 0px;
	margin-bottom: 0px;
}
-->
</style></head>
<body onLoad="ajax(url);">
<table width="550" border="0" cellpadding="0" cellspacing="0" class="bg_popup">
  <tr>
    <td width="550" height="60" background="/extrato-`aux_nmrescop`/crm/images/geral/topo_popup.gif"><table width="100%" height="64" border="0" cellpadding="0" cellspacing="0">
      <tr>
        <td width="15%">&nbsp;</td>
        <td width="68%" valign="top"><img src="/extrato-`aux_nmrescop`/crm/images/geral/titulo_eventos.gif"><br>
          <br></td>
        <td width="17%" align="center"><img src="/extrato-`aux_nmrescop`/crm/images/icones/imprimir.gif" width="67" height="18" onClick="javascript:self.print();" style="cursor:hand;"></td>
      </tr>
    </table></td>
  </tr>
  <tr>
    <td height="15"></td>
  </tr>
  <tr>
    <td height="30"><div id="copy"></div></td>
  </tr>
  <tr>
    <td height="2" class="bg_barra_bottom_claro"></td>
  </tr>
  <tr>
    <td height="5" class="bg_barra_bottom_escuro"></td>
  </tr>
  <tr>
    <td height="7" bgcolor="#FFFFFF"></td>
  </tr>
</table>
</body>
</html>
