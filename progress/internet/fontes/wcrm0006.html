<!-------------------------------------------------------------------------------

   Programa: sistema/internet/fontes/wcrm0006.p
   Sistema : Internet - Cooperativa de Credito
   Sigla   : CRED
   Autor   : Jean Michel
   Data    : Junho/2015.                       Ultima atualizacao: 18/06/2015
   
   Dados referentes ao programa:
   Frequencia: Sempre que for chamado (On-Line)
   
   Objetivo  : Envio de susgestões para cursos do Progrid.
      
   Alteracoes:
--------------------------------------------------------------------------------->
<script language="SpeedScript">
  DEF VAR aux_cdcooper AS INTE   NO-UNDO.
  DEF VAR aux_cdagenci AS INTE   NO-UNDO.
  DEF VAR aux_nrdconta AS INTE   NO-UNDO.
  DEF VAR aux_idseqttl AS INTE   NO-UNDO.
  DEF VAR aux_cdorisug AS INTE   NO-UNDO.
  DEF VAR aux_contador AS INTE   NO-UNDO.
  DEF VAR aux_nmrescop AS CHAR   NO-UNDO.
  DEF VAR aux_nrdddtel AS CHAR   NO-UNDO.
  DEF VAR aux_nrdddcel AS CHAR   NO-UNDO.
  DEF VAR aux_nrinitel AS CHAR   NO-UNDO.
  DEF VAR aux_nrfimtel AS CHAR   NO-UNDO.
  DEF VAR aux_nrinicel AS CHAR   NO-UNDO.
  DEF VAR aux_nrfimcel AS CHAR   NO-UNDO.	 
  DEF VAR aux_nmagenci AS CHAR   NO-UNDO.
  DEF VAR aux_nmextttl AS CHAR   NO-UNDO.
  DEF VAR aux_cdoperad AS CHAR   NO-UNDO.
  DEF VAR aux_dsdemail AS CHAR   NO-UNDO.
  DEF VAR aux_dstemeix AS CHAR   NO-UNDO.
  DEF VAR aux_dssugeve AS CHAR   NO-UNDO.
  DEF VAR aux_flgcolum AS LOGI   NO-UNDO INIT FALSE.
    
  DEF VAR b1wgen0011   AS HANDLE NO-UNDO.
  
  ASSIGN aux_cdcooper = INT(GET-VALUE("aux_cdcooper"))
         aux_cdagenci = INT(GET-VALUE("aux_cdagenci"))
         aux_nrdconta = INT(GET-VALUE("aux_nrdconta"))
	     aux_idseqttl = INT(GET-VALUE("aux_idseqttl"))
         aux_nmextttl =     GET-VALUE("aux_nmextttl")
         aux_cdoperad =     GET-VALUE("aux_cdoperad").

  FIND crapcop WHERE crapcop.cdcooper = aux_cdcooper NO-LOCK NO-ERROR NO-WAIT.
  
  IF AVAILABLE crapcop THEN
    DO:
      ASSIGN aux_nmrescop = crapcop.nmrescop.
    END. 
    
	IF aux_cdagenci <> 0 AND
     aux_cdagenci <> ? THEN
		DO:
			/* Consulta de PA do cooperado */
      FIND crapage WHERE crapage.cdcooper = aux_cdcooper
                     AND crapage.cdagenci = aux_cdagenci NO-LOCK NO-ERROR NO-WAIT.

      IF AVAIL crapage THEN
        ASSIGN aux_nmagenci = crapage.nmresage.
			
			ASSIGN aux_cdorisug = 4.	
		END.
  ELSE
    DO:
      ASSIGN aux_cdagenci = 0
             aux_cdorisug = 5.
    END.
        
	IF aux_cdoperad = "" OR
     aux_cdoperad = ?  THEN
    DO:
      ASSIGN aux_cdoperad = "999".
    END.

	/* Consulta de telefones de contato do cooperado */	
			
	/* Consulta de Telefone */
	FIND FIRST craptfc WHERE craptfc.cdcooper = aux_cdcooper
                       AND craptfc.nrdconta = aux_nrdconta
                       AND craptfc.idseqttl = aux_idseqttl
                       AND craptfc.tptelefo = 1 NO-LOCK NO-ERROR NO-WAIT.

	IF AVAIL craptfc THEN
		DO:
			/*STRING(craptfc.nrtelefo)*/
			ASSIGN aux_nrdddtel = STRING(craptfc.nrdddtfc)
             aux_nrinitel = IF LENGTH(STRING(craptfc.nrtelefo)) > 8 THEN SUBSTR(STRING(craptfc.nrtelefo),1,5) ELSE SUBSTR(STRING(craptfc.nrtelefo),1,4)
				     aux_nrfimtel = IF LENGTH(STRING(craptfc.nrtelefo)) > 8 THEN SUBSTR(STRING(craptfc.nrtelefo),6) ELSE SUBSTR(STRING(craptfc.nrtelefo),5).
		END.

	/* Consulta de Celular */
	FIND FIRST craptfc WHERE craptfc.cdcooper = aux_cdcooper
                       AND craptfc.nrdconta = aux_nrdconta
                       AND craptfc.idseqttl = aux_idseqttl
                       AND craptfc.tptelefo = 2 NO-LOCK NO-ERROR NO-WAIT.

	IF AVAIL craptfc THEN
		DO:
			ASSIGN aux_nrdddcel = STRING(craptfc.nrdddtfc)
				   aux_nrinicel = IF LENGTH(STRING(craptfc.nrtelefo)) > 8 THEN SUBSTR(STRING(craptfc.nrtelefo),1,5) ELSE SUBSTR(STRING(craptfc.nrtelefo),1,4)
				   aux_nrfimcel = IF LENGTH(STRING(craptfc.nrtelefo)) > 8 THEN SUBSTR(STRING(craptfc.nrtelefo),6) ELSE SUBSTR(STRING(craptfc.nrtelefo),5).
		END.
		
	/* Consulta de email do cooperado */	
	FIND FIRST crapcem WHERE crapcem.cdcooper = aux_cdcooper
						 AND crapcem.nrdconta = aux_nrdconta NO-LOCK NO-ERROR NO-WAIT.

	IF AVAIL crapcem THEN
		DO:
			ASSIGN aux_dsdemail = crapcem.dsdemail.
		END.
			
</script>

<html>
	<head>
		<style type="text/css">
			<!--
				body {
					margin-left: 0px;
					margin-top: 0px;
					margin-right: 0px;
					margin-bottom: 0px;
				}
				.fonte_nome {
					font-family: Verdana, Geneva, sans-serif;
					font-size: 12PX;
          text-align: left;
				}
			-->
		</style>
		<script language="JavaScript">

			function proximoCampo(intTamanho, strValor, strCampo){
						
				if(strValor.length == intTamanho){
					document.getElementById(strCampo).focus();
				}			
			}
			
			function somenteNum(Obj) {
				var data = new String(Obj.value);
				var dataok = '';
				var cont = 0;
					 
				for (i = 0; i < data.length; i++) {
                    if ((data.charAt(i) >= '0') && (data.charAt(i) <= '9')) {
                        dataok += data.charAt(i);
                    }else{
                        cont++;
					}
				}
					
				if (cont > 0) {  
					Obj.value = dataok;
				}
			}

            // Funcao para validacao do form    
            function validaForm(){
                
                var dsdemail = document.getElementById("dsdemail").value;
                var nmcooper = document.getElementById("nmcooper").value;
                var dssugeve = document.getElementById("dssugeve").value;
                var dssugeve = document.getElementById("dssugeve").value;

                // Flag auxiliar para validacao    
                var flgvalid = true;
                
                // Verificacao de nome    
                if(nmcooper == "" || nmcooper == null){
                    alert("Digite o seu nome!");    
                    flgvalid = false;
                }
                
                // Verifica se usuario informou email
                if(dsdemail != null && dsdemail != ""){
                    //Verificacao de email valido
                    if(!validaEmail(dsdemail)){
                        alert("Digite um email valido!");
                        flgvalid = false;
                    }
                }
                
                // Se form estiver com informacoes validas, faz o submit    
                if(flgvalid){
                    document.getElementById("formProgrid").submit();
                }
            }

            // Funcao para validacao de email    
            function validaEmail(dsdemail){
                
                var filter = /^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;
                
                // Verifica se o email digitado e valido
                if (filter.test(dsdemail)) {
                    return true;
                }else{
                    return false;
                }

            }
            </script>
            <script language="SpeedScript">

              DEF VAR aux_nrseqdig AS INTE NO-UNDO.
              DEF VAR aux_auxconta AS INTE NO-UNDO.
              DEF VAR aux_nrtelcto AS CHAR NO-UNDO.
              DEF VAR aux_nrcelcto AS CHAR NO-UNDO.
              DEF VAR aux_dsseqtem AS CHAR NO-UNDO.

              /* Codigo e enviado por parametro onde esta definido o iframe 
                 (Administracao do site da cooperativa)*/
              ASSIGN aux_cdcooper = INT(GET-VALUE("aux_cdcooper"))
                     aux_nrtelcto = GET-VALUE("nrinitel") + GET-VALUE("nrfimtel")
                     aux_nrcelcto = GET-VALUE("nrinicel") + GET-VALUE("nrfimcel").                

              /***********************************************************************************
                  So entra neste if caso ja tenha ocorrido o POST do form, no carregamento da tela
                  nao passa por aqui
              ***********************************************************************************/
              ASSIGN aux_dsseqtem = "".
              
              DO  aux_auxconta = 0 TO INT(GET-VALUE("contador")):
                IF GET-VALUE("chk[" + STRING(aux_auxconta) + "]") <> ? AND
                   GET-VALUE("chk[" + STRING(aux_auxconta) + "]") <> "" THEN
                  DO:
                    IF aux_auxconta = 0 THEN
                      DO:
                        ASSIGN aux_dsseqtem = GET-VALUE("chk[" + STRING(aux_auxconta) + "]").
                      END.
                    ELSE
                      DO:
                        ASSIGN aux_dsseqtem = aux_dsseqtem + "," + GET-VALUE("chk[" + STRING(aux_auxconta) + "]").
                      END.
                  END.                  
              END.
              
              IF TRIM(SUBSTR(aux_dsseqtem,1,1)) = "," THEN
                ASSIGN aux_dsseqtem = SUBSTR(aux_dsseqtem,2).    
              
              IF GET-VALUE("nmcooper") <> ? AND TRIM(GET-VALUE("nmcooper")) <> "" AND
                 ((TRIM(GET-VALUE("dssugeve")) <> ? AND TRIM(GET-VALUE("dssugeve")) <> "") OR
                 (aux_dsseqtem <> ? AND aux_dsseqtem <> ""))THEN
                  DO:
                            
                    IF NUM-ENTRIES(aux_dsseqtem,",") > 0 THEN        
                      DO:
                        
                        DO aux_auxconta = 1 TO NUM-ENTRIES(aux_dsseqtem,","):
                            
                          FIND LAST crapsdp NO-LOCK WHERE crapsdp.idevento = 1
                                                      AND crapsdp.cdcooper = INT(aux_cdcooper)
                                                      AND crapsdp.cdagenci = INT(aux_cdagenci) NO-ERROR NO-WAIT.

                          IF AVAIL crapsdp THEN
                            DO:
                              ASSIGN aux_nrseqdig = crapsdp.nrseqdig + 1.
                            END.
                          ELSE
                            DO:
                              ASSIGN aux_nrseqdig = 1.
                            END.

                          IF INT(GET-VALUE("nrdconta")) <> 0 THEN
                            ASSIGN aux_idseqttl = 1.
                          ELSE
                            ASSIGN aux_idseqttl = 0.
                          
                          IF INT(ENTRY(aux_auxconta,aux_dsseqtem,",")) <> ? AND 
                             INT(ENTRY(aux_auxconta,aux_dsseqtem,",")) <> 0 THEN
                            DO:
                              FIND craptem WHERE craptem.nrseqtem = INT(ENTRY(aux_auxconta,aux_dsseqtem,",")) NO-LOCK NO-ERROR NO-WAIT.
                          
                              IF AVAILABLE craptem THEN
                                DO:
                                  ASSIGN aux_dstemeix = craptem.dstemeix.
                                END.
                              ELSE
                                DO:
                                  ASSIGN aux_dstemeix = "Sugestao criada por tema a partir do site da cooperativa".
                                END.
                            END.
                          ELSE
                            DO:
                              ASSIGN aux_dstemeix = "Sugestao criada por tema a partir do site da cooperativa".
                            END.
                                                    
                          
                          IF aux_cdorisug = 5 THEN
                            DO:
                              ASSIGN aux_dstemeix = "SITE - " + aux_dstemeix.
                            END.
                          
                          IF craptem.nrseqtem <> 0 AND 
                             craptem.nrseqtem <> ? THEN
                            DO:
                              CREATE crapsdp.
                              ASSIGN crapsdp.idevento = 1
                                     crapsdp.qtsugeve = 1
                                     crapsdp.cdcooper = aux_cdcooper
                                     crapsdp.cdagenci = aux_cdagenci
                                     crapsdp.nrseqdig = aux_nrseqdig
                                     crapsdp.idseqttl = aux_idseqttl
                                     crapsdp.cdorisug = aux_cdorisug
                                     crapsdp.nrdconta = INT(GET-VALUE("nrdconta"))
                                     crapsdp.dssugeve = STRING(aux_dstemeix)
                                     crapsdp.dtmvtolt = TODAY
                                     crapsdp.cdoperad = aux_cdoperad
                                     crapsdp.nmpessug = GET-VALUE("nmcooper")
                                     crapsdp.dsemlcto = GET-VALUE("dsdemail")
                                     crapsdp.nrdddtel = INT(GET-VALUE("nrdddtel"))
                                     crapsdp.nrtelcto = INT(aux_nrtelcto)
                                     crapsdp.nrdddcel = INT(GET-VALUE("nrdddcel"))
                                     crapsdp.nrcelcto = INT(aux_nrcelcto)
                                     crapsdp.nrseqpri = ?
                                     crapsdp.dtanoage = ?
                                     crapsdp.cdevento = ?
                                     crapsdp.nrseqtem = INT(ENTRY(aux_auxconta,aux_dsseqtem,",")) NO-ERROR.
                              VALIDATE crapsdp.
                            END.
                          
                        END.
                        
                        IF TRIM(GET-VALUE("dssugeve")) <> ? AND
                           TRIM(GET-VALUE("dssugeve")) <> "" THEN
                          DO:
                            IF aux_cdorisug = 5 THEN
                              DO:
                                ASSIGN aux_dssugeve = "SITE - " + STRING(GET-VALUE("dssugeve")).
                              END.
                            ELSE
                              DO:
                                ASSIGN aux_dssugeve = STRING(GET-VALUE("dssugeve")).
                              END.  
                              
                            FIND LAST crapsdp NO-LOCK WHERE crapsdp.idevento = 1
                                                      AND crapsdp.cdcooper = INT(aux_cdcooper)
                                                      AND crapsdp.cdagenci = INT(aux_cdagenci) NO-ERROR NO-WAIT.

                            IF AVAIL crapsdp THEN
                              DO:
                                ASSIGN aux_nrseqdig = crapsdp.nrseqdig + 1.
                              END.
                            ELSE
                              DO:
                                ASSIGN aux_nrseqdig = 1.
                              END.  
                                  
                            CREATE crapsdp.
                            ASSIGN crapsdp.idevento = 1
                                   crapsdp.qtsugeve = 1
                                   crapsdp.cdcooper = aux_cdcooper
                                   crapsdp.cdagenci = aux_cdagenci
                                   crapsdp.nrseqdig = aux_nrseqdig
                                   crapsdp.idseqttl = aux_idseqttl
                                   crapsdp.cdorisug = aux_cdorisug
                                   crapsdp.nrdconta = INT(GET-VALUE("nrdconta"))
                                   crapsdp.dssugeve = STRING(aux_dssugeve)
                                   crapsdp.dtmvtolt = TODAY
                                   crapsdp.cdoperad = aux_cdoperad
                                   crapsdp.nmpessug = GET-VALUE("nmcooper")
                                   crapsdp.dsemlcto = GET-VALUE("dsdemail")
                                   crapsdp.nrdddtel = INT(GET-VALUE("nrdddtel"))
                                   crapsdp.nrtelcto = INT(aux_nrtelcto)
                                   crapsdp.nrdddcel = INT(GET-VALUE("nrdddcel"))
                                   crapsdp.nrcelcto = INT(aux_nrcelcto)
                                   crapsdp.nrseqpri = ?
                                   crapsdp.cdevento = ?
                                   crapsdp.dtanoage = ?
                                   crapsdp.nrseqtem = ? NO-ERROR.
                            VALIDATE crapsdp.
                          END.
                      END.
                    ELSE
                      DO:
                        FIND LAST crapsdp NO-LOCK WHERE crapsdp.idevento = 1
                                                    AND crapsdp.cdcooper = INT(aux_cdcooper)
                                                    AND crapsdp.cdagenci = INT(aux_cdagenci) NO-ERROR NO-WAIT.

                        IF AVAIL crapsdp THEN
                          DO:
                            ASSIGN aux_nrseqdig = crapsdp.nrseqdig + 1.
                          END.
                        ELSE
                          DO:
                            ASSIGN aux_nrseqdig = 1.
                          END.

                        IF INT(GET-VALUE("nrdconta")) <> 0 THEN
                          ASSIGN aux_idseqttl = 1.
                        ELSE
                          ASSIGN aux_idseqttl = 0.
                        
                        IF aux_cdorisug = 5 THEN
                          DO:
                            ASSIGN aux_dssugeve = "SITE - " + STRING(GET-VALUE("dssugeve")).
                          END.
                        ELSE
                          DO:
                            ASSIGN aux_dssugeve = STRING(GET-VALUE("dssugeve")).
                          END.
                        CREATE crapsdp.
                        ASSIGN crapsdp.idevento = 1
                               crapsdp.qtsugeve = 1
                               crapsdp.cdcooper = aux_cdcooper
                               crapsdp.cdagenci = aux_cdagenci
                               crapsdp.nrseqdig = aux_nrseqdig
                               crapsdp.idseqttl = aux_idseqttl
                               crapsdp.cdorisug = aux_cdorisug
                               crapsdp.nrdconta = INT(GET-VALUE("nrdconta"))
                               crapsdp.dssugeve = STRING(aux_dssugeve)
                               crapsdp.dtmvtolt = TODAY
                               crapsdp.cdoperad = aux_cdoperad
                               crapsdp.nmpessug = GET-VALUE("nmcooper")
                               crapsdp.dsemlcto = GET-VALUE("dsdemail")
                               crapsdp.nrdddtel = INT(GET-VALUE("nrdddtel"))
                               crapsdp.nrtelcto = INT(aux_nrtelcto)
                               crapsdp.nrdddcel = INT(GET-VALUE("nrdddcel"))
                               crapsdp.nrcelcto = INT(aux_nrcelcto)
                               crapsdp.nrseqpri = ?
                               crapsdp.cdevento = ?
                               crapsdp.dtanoage = ?
                               crapsdp.nrseqtem = ? NO-ERROR.
                        VALIDATE crapsdp.
                      END.                    
                  
                    IF GET-VALUE("dssugeve") <> ? AND
                       GET-VALUE("dssugeve") <> "" THEN
                      DO:
                        RUN sistema/generico/procedures/b1wgen0011.p PERSISTENT SET b1wgen0011.

                        IF VALID-HANDLE (b1wgen0011) THEN
                          DO:
                            IF aux_cdorisug = 5 THEN
                              DO:
                                ASSIGN aux_dssugeve = "SITE - " + STRING(GET-VALUE("dssugeve")).
                              END.
                            ELSE
                              DO:
                                ASSIGN aux_dssugeve = STRING(GET-VALUE("dssugeve")).
                              END.
                            RUN enviar_email_completo IN b1wgen0011(aux_cdcooper
                                                                   ,"wcrm0006"
                                                                   ,"sugestoes@cecred.coop.br" /*REMETENTE*/
                                                                   ,"sugestoes@cecred.coop.br" /*DESTINATARIO*/
                                                                   ,STRING(aux_nmrescop) + " - Sugestão de Tema - Progrid"
                                                                   ,""
                                                                   ,""
                                                                   ,"Nome: " + STRING(GET-VALUE("nmcooper")) + "<br>" +
                                                                    "E-mail: " + STRING(GET-VALUE("dsdemail")) + "<br>" +
                                                                    "Telefone: " + STRING("(" + GET-VALUE("nrdddtel") + ")" + " " + aux_nrtelcto) + "<br>" +
                                                                    "Conta: " + STRING(GET-VALUE("nrdconta")) + "<br>" +
                                                                    "Sugestão Número: " + STRING(aux_nrseqdig) + "<br>" +
                                                                    "Sugest&atilde;o de Tema: " + STRING(aux_dssugeve) + "<br>"
                                                                   ,FALSE).
                            DELETE PROCEDURE b1wgen0011.
                        END.                 
                      END.
                      
                    {&out} '~<script type=~"text/javascript~">alert(~"Sugestao enviada com sucesso!")~;~</script~>'.

                  END.
					
            </script>
    </head>
	<body>
		<form action="" method="POST" name="formProgrid" id="formProgrid">
			<table width="80%" border="0" cellspacing="15" cellpadding="0" style="text-align:left;">
                <script language="SpeedScript">
                    
                    IF aux_cdagenci <> ? AND aux_cdagenci <> 0 THEN
                        DO:
                           {&out} ' <tr>'.
            			   {&out} ' 	<td height="25" class="fonte_nome" style="text-align:right"sixe="40" >Posto de Atendimento:</td>'.
            			   {&out} ' 	<td class="fonte_nome">'.
            			   {&out} ' 		<span class="fonte_nome">'.
            			   {&out} ' 			<input name="nmagenci" id="nmagenci" type="text" class="formulario" style="width:300px" readonly="readonly" value="' + aux_nmagenci + '" >'.
            			   {&out} ' 		</span>'.
            			   {&out} ' 	</td>'.
            			   {&out} ' </tr>'.
                        END.
                </script>
                <tr>
					<td height="25" class="fonte_nome" style="text-align:left" >Conta:</td>
					<td class="fonte_nome">
						<span class="fonte_nome">
							<input name="nrdconta" id="nrdconta" type="text" class="formulario" style="width:100px" onKeyUp="somenteNum(this);" maxlength="10" 
                                <script language="SpeedScript">
                                    IF aux_nrdconta <> ? AND aux_nrdconta <> 0 THEN
                                        DO:
                                           {&out} ' value="' + STRING(aux_nrdconta) + '" readonly="readonly" '.
                            			END.
                                </script>
                            >
						</span>
					</td>
				</tr>
				<tr>
					<td height="25" class="fonte_nome" style="text-align:left" >Nome*:</td>
					<td width="259" height="25" class="fonte_nome">
						<span class="fonte_nome">
							<input name="nmcooper" id="nmcooper" type="text" class="formulario" style="width:320px" maxlength="50"
                            <script language="SpeedScript">
                                IF aux_nmextttl <> ? AND aux_nmextttl <> "" THEN
                                    DO:
                                       {&out} ' value="' + STRING(aux_nmextttl) + '" readonly="readonly" '.
                                    END.
                            </script>
                            >
						</span>
					</td>
				</tr>
				<tr>
					<td height="25" class="fonte_nome" style="text-align:left" >Telefone:</td>
					<td height="25" class="fonte_nome">
						<span class="fonte_nome">
							<input name="nrdddtel" id="nrdddtel" type="text" class="formulario" style="width:30px" maxlength="2" onKeyUp="somenteNum(this); proximoCampo(2, this.value, 'nrinitel');"
                            <script language="SpeedScript">
                                IF aux_nrdddtel <> ? AND aux_nrdddtel <> "" THEN
                                    DO:
                                       {&out} ' value="' + STRING(aux_nrdddtel) + '" '.
                                    END.
                            </script>
                            >
							<input name="nrinitel" id="nrinitel" type="text" class="formulario" style="width:50px" maxlength="5" onKeyUp="somenteNum(this); proximoCampo(5,this.value,'nrfimtel');"
                            <script language="SpeedScript">
                                IF aux_nrinitel <> ? AND aux_nrinitel <> "" THEN
                                    DO:
                                       {&out} ' value="' + STRING(aux_nrinitel) + '" '.
                                    END.
                            </script>
                            >
							<input name="nrfimtel" id="nrfimtel" type="text" class="formulario" style="width:40px" maxlength="4" onKeyUp="somenteNum(this); proximoCampo(4,this.value,'nrdddcel');"
                            <script language="SpeedScript">
                                IF aux_nrfimtel <> ? AND aux_nrfimtel <> "" THEN
                                    DO:
                                       {&out} ' value="' + STRING(aux_nrfimtel) + '" '.
                                    END.
                            </script>
                            >
						</span>
					</td>
				</tr>
				<tr>
					<td height="25" class="fonte_nome" style="text-align:left" >Celular:</td>
					<td height="25" class="fonte_nome">
						<span class="fonte_nome">
							<input name="nrdddcel" id="nrdddcel" type="text" class="formulario" style="width:30px" maxlength="2" onKeyUp="somenteNum(this); proximoCampo(2,this.value,'nrinicel');"
                            <script language="SpeedScript">
                                IF aux_nrdddcel <> ? AND aux_nrdddcel <> "" THEN
                                    DO:
                                       {&out} ' value="' + STRING(aux_nrdddcel) + '" '.
                                    END.
                            </script>
                            >
							<input name="nrinicel" id="nrinicel" type="text" class="formulario" style="width:50px" maxlength="5" onKeyUp="somenteNum(this); proximoCampo(5,this.value,'nrfimcel');"
                            <script language="SpeedScript">
                                IF aux_nrinicel <> ? AND aux_nrinicel <> "" THEN
                                    DO:
                                       {&out} ' value="' + STRING(aux_nrinicel) + '" '.
                                    END.
                            </script>
                            >
							<input name="nrfimcel" id="nrfimcel" type="text" class="formulario" style="width:40px" maxlength="4" onKeyUp="somenteNum(this); proximoCampo(4,this.value,'dsdemail');"
                            <script language="SpeedScript">
                                IF aux_nrfimcel <> ? AND aux_nrfimcel <> "" THEN
                                    DO:
                                       {&out} ' value="' + STRING(aux_nrfimcel) + '" '.
                                    END.
                            </script>
                            >
						</span>
					</td>
				</tr>
				<tr>
					<td colspan="2" height="25" class="fonte_nome" style="text-align:left"><b>Sugest&otilde;es</b> - Assinale abaixo o(s) tema(s) do seu interesse:</td>
				</tr>
        
        <!-- INCIO TEMAS-->
        
        <script language="SpeedScript">
          ASSIGN aux_contador = 0.
          FOR EACH craptem WHERE craptem.idsittem = "A" 
                             AND craptem.idrespub = "N" NO-LOCK BY craptem.dstemeix:
            IF aux_contador MOD 2 = 0 THEN
              DO:
                {&out} '<tr>'.
                {&out} '<td width="50%" ><p class="fonte_nome">'.
                {&out} '<input type="checkbox" name="chk[' + STRING(aux_contador) + ']" id="chk[' + STRING(aux_contador) + ']" value="' + STRING(craptem.nrseqtem) + '" >' + UPPER(craptem.dstemeix).
                {&out} '</p></td>'.
                ASSIGN aux_flgcolum = TRUE.
              END.
            ELSE
              DO:
                {&out} '<td width="50%"><p class="fonte_nome">'.
                {&out} '<input type="checkbox" name="chk[' + STRING(aux_contador) + ']" id="chk[' + STRING(aux_contador) + ']" value="' + STRING(craptem.nrseqtem) + '" >' + UPPER(craptem.dstemeix).
                {&out} '</p></td>'.
                {&out} '</tr>'.
                ASSIGN aux_flgcolum = FALSE.
              END.
            ASSIGN aux_contador = aux_contador + 1.				
          END.
          
          IF aux_flgcolum = TRUE THEN
            DO:
              {&out} '<td width="50%">'.
              {&out} '&nbsp;'.
              {&out} '</td>'.
              {&out} '</tr>'.
            END.
        </script>
        
        <!-- FIM TEMAS-->
        
        <tr>
					<td height="25" class="fonte_nome" style="text-align:left" >E-mail:</td>
					<td height="25" class="fonte_nome">
						<span class="fonte_nome">
							<input name="dsdemail" id="dsdemail" type="text" class="formulario" style="width:320px" maxlength="50"
                            <script language="SpeedScript">
                                IF aux_dsdemail <> ? AND aux_dsdemail <> "" THEN
                                    DO:
                                       {&out} ' value="' + STRING(aux_dsdemail) + '" readonly="readonly" '.
                                    END.
                            </script>
                            >
						</span>
					</td>
				</tr>
        <tr>
					<td height="25" class="fonte_nome" style="text-align:left" >Outras Sugest&otilde;es:</td>
					<td height="25" class="fonte_nome">
						<span class="fonte_nome">
							<textarea rows="6" cols="37" maxlength="200" id="dssugeve" name="dssugeve" ></textarea>
                            <h5 style="color:gray;">*Máximo 200 caracteres</h5>
						</span>
					</td>
				</tr>
				<tr>
					<td colspan="2">&nbsp;</td>
				</tr>
				<tr>
					<td colspan="2" style="text-align:center;">
						<input class="bt-hub-small button-hub-small" id="form_submit" name="form_submit" type="button" onclick="validaForm()" value="Enviar" >
					</td>
				</tr>
			</table>
			<input type="hidden" name="contador" id="contador" value="<script language="SpeedScript"> {&out} STRING(aux_contador). </script>" >
		</form>		
	</body>
</html>