<!--

Autor..........: Guilherme/SUPERO
Programa.......: crap087.htm
Data de criação: 09/09/2015

Objetivo.......: Tela de Pagamento de GPS - SICREDI

Alteracoes.....:
                12/09/2016 - Adicionado chamada da função "callBlass(event)" - (Evandro - RKAM).      
                29/09/2016 - Adicionado atributo onkeyDown para o form (Lucas Ranghetti #463572)
                02/12/2016 - Trocar a chamada callBLass(event); por callBlass(event); pq o js
                             é casesensitive e bugava a chamada dos BLs (Tiago/Elton SD563166).
				28/03/2017 - Função para que se for clicado mais que uma vez no confirmar, vamos 
							 desabilitar o botao para nao permitir a requisição dupla (Lucas Ranghetti #634500)
                03/01/2018 - M307 - Solicitaçao de senha do coordenador quando 
                             valor do pagamento for superior ao limite cadastrado 
                             na CADCOP / CADPAC
                            (Diogo - MoutS)

-->
<html>
    <head>
        <meta name="generator"
        content="HTML Tidy for HTML5 (experimental) for Windows https://github.com/w3c/tidy-html5/tree/c63cc39" />
        <meta http-equiv="Content-Language" content="pt-br" />
        <meta http-equiv="Content-Type" content="text/html; charset=windows-1252" />
        <meta name="GENERATOR" content="Microsoft FrontPage 4.0" />
        <meta name="ProgId" content="FrontPage.Editor.Document" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="Pragma" content="No-Cache" />
        <meta http-equiv="Expires" content="0" />
        <script language=JavaScript src="/script/formatadadosie.js"></script>
        <script language=JavaScript src="/script/jquery.js"></script>
        <script language=JavaScript src="/script/jquery.mask.mv.js"></script>
        <link rel="StyleSheet" type="text/css" href="/script/viacredi.css" />
        <title>PAGAMENTO GPS SICREDI</title>
    </head>
    <body background="/images/moeda.jpg" bgproperties="fixed" class="fundo" onLoad="JavaScript:controlaCampos(); mudaFoco(); click();" onKeyUp="callBlass(event); callBLini(event); callBLsal(event); ">
        <form  onKeyDown="change_page(event)" method=post>
        <input type="hidden" name="vh_foco"     id="vh_foco"     value="" >
        <input type="hidden" name="vh_nome"     id="vh_nome"     value="" >
        <input type="hidden" name="v_msg"       id="v_msg"       value="" >
        <input type="hidden" name="proximo"     id="proximo"     value="" >
        <input type="hidden" name="v_cntanter"  id="v_cntanter"  value="" >
        <input type="hidden" name="h_inpesgps"  id="h_inpesgps"  value="0">
        <input type="hidden" name="h_tpdpagto"  id="h_tpdpagto"  value="0">
        <input type="hidden" name="h_idleitor"  id="h_idleitor"  value="0">
        <p style="word-spacing: 0; line-height: 100%; margin-top: 0; margin-bottom: 0">&nbsp;</p>
        <div align="center">
            <center>
                <table width="100%" class="cabtab">
                    <tr>
                        <td width="15%" align="center">
                            <input type="text" name="v_coop" id="v_coop" size="11" class="transp" readonly="readonly" />
                        </td>
                        <td width="20%" align="center">PA
                        <input type="text" name="v_pac" size="1" class="transp" readonly="readonly" /></td>
                        <td width="20%" align="center">CAIXA
                        <input type="text" name="v_caixa" size="1" class="transp" readonly="readonly" /></td>
                        <td width="30%" align="center">OPERADOR
                        <input type="text" name="v_operador" size="7" class="transp" readonly="readonly" /></td>
                        <td width="15%" align="center">
                            <input type="text" name="v_data" id="v_data" size="10" class="transp" readonly="readonly" />
                        </td>
                    </tr>
                </table>
            </center>
        </div>
        <div align="center">
            <center>
                <table width="100%" class="cabtab">
                    <tr>
                        <td class="titulo">SICREDI - PAGAMENTO GPS(GUIAS PREVIDENCIA)</td>
                        <td width="21%" class="programa" align="right">P.087 V.1.00</td>
                    </tr>
                </table>
            </center>
        </div>
        <div align="center">
            <table cellspacing="0" cellpadding="0" width="100%">
                <tr>
                    <td width="100%" valign="middle" align="center">
                        <div align="center">
                            <table width="100%" align="center" cellspacing="0" cellpadding="1" class="tcampo">
                                <tr>
                                    <td align="center" class="linhaform" colspan="4"></td>
                                </tr>
                                <tr align="center">
                                    <td align="center" class="linhaform" colspan="4">
                                        <table align="center" cellspacing="0" cellpadding="1" class="tcampo">
                                            <tr>
                                                <td align="right" class="linhaform"><div style="display:none" > Conta/DV: </div></td>
                                                <td align="left" class="linhaform">
                                                    <div style="display:none" >
                                                        <input type="text" name="v_conta" id="v_conta"
                                                               onchange="document.forms[0].submit();"
                                                               onkeydown="JavaScript:if(event.keyCode == 13) {document.forms[0].elements[12].focus();} validaInteiro(event); FormataConta(this,8,event);"
                                                               maxlength="10" size="10" class="input" style="text-align: right" />
                                                        <input type="text" name="v_nome" id="v_nome" size="60" class="input"
                                                               style="font-weight: bold; background: #DFDFDF;" readonly />
                                                    </div>
                                                </td>
                                            </tr>
                                        </table>
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="4" class="linhaform">
                                        <div style="display:none" ><hr class="input" /></div>
                                    </td>
                                    <td width="61%"></td>
                                </tr>
                                <tr>
                                    <td colspan="2" class="linhaform" align="center">
                                       <input type="radio" id="tpdpagto1" name="tpdpagto" value="1" onClick="habilitaCodBarras();JavaScript:setValorCampo('tpdpagto','h_tpdpagto');" >
                                       <label for="tpdPagtp" accesskey="b">Com Código de Barras</label>
                                       <input type="radio" id="tpdpagto2" name="tpdpagto" value="2" onClick="habilitaManual();JavaScript:setValorCampo('tpdpagto','h_tpdpagto');" style="margin-left:20px">
                                       <label for="TpEntLin" accesskey="d">Sem Código de Barras</label>
                                    </td>
                                    <td  align="right" style="display:none;">
                                        <input type="radio" id="tpdpagto0" name="tpdpagto" checked value="0">
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="4" class="linhaform">
                                        <hr class="input" />
                                    </td>
                                    <td width="61%"></td>
                                </tr>
                                <tr>
                                    <td colspan="4" class="linhaform">
                                        &nbsp;
                                    </td>
                                    <td width="61%"></td>
                                </tr>
                                <tr>
                                    <td width="39%" align="right" class="linhaform">Código de Barras:</td>
                                    <td width="61%">
                                        <input type="text" name="v_codbarras" id="v_codbarras" size="60" class="input" maxlength="44"
                                               onBlur="JavaScript:submeterForm();"
                                               style="text-align: right" />
                                    </td>
                                </tr>
                                <tr>
                                    <td width="39%" align="right" class="linhaform" nowrap="nowrap"></td>
                                    <td width="61%">
                                        &nbsp;
                                    </td>
                                </tr>
                                <tr>
                                    <td width="39%" align="right" class="linhaform">Vencimento:</td>
                                    <td width="61%">
                                        <input type="text" name="v_vencimento" id="v_vencimento" size="17" class="input" maxlength="10"
                                        onkeydown="JavaScript:validaInteiro(event);"
                                        onKeyUp="FormataData(this,this.value);"
                                        onBlur="if ( validarData(this.value,'v_vencimento') ){alert('Data Invalida!'); } if ( this.value.length<10) { verificaTamanhoData('v_vencimento'); }"
                                        style="text-align: right" />
                                    </td>
                                </tr>
                                <tr>
                                    <td width="39%" align="right" class="linhaform" nowrap="nowrap">Código de Pagamento:</td>
                                    <td width="61%">
                                        <input type="text" name="v_codigo" id="v_codigo" size="4" maxlength="4" class="input"
                                            onkeydown="JavaScript:validaInteiro(event);" style="text-align: right" />
                                    </td>
                                </tr>
                                <tr>
                                    <td width="39%" align="right" class="linhaform" nowrap="nowrap">Competência (Mês/Ano):</td>
                                    <td width="61%">
                                        <input type="text" name="v_competencia" id="v_competencia" size="6" maxlength="6" class="input"
                                         onblur="JavaScript:mascaraData(this,1);"
                                         onkeydown="JavaScript:validaInteiro(event);" style="text-align: right" />
                                    </td>
                                </tr>
                                <tr>
                                    <td width="39%" align="right" class="linhaform">Identificador:</td>
                                    <td width="61%">
                                        <input type="text" name="v_identificador" id="v_identificador" size="17" maxlength="14" class="input"
                                               onkeydown="JavaScript:validaInteiro(event);" style="text-align: right" />
                                    </td>
                                </tr>
                                <tr>
                                    <td width="39%" align="right" class="linhaform">Valor INSS:</td>
                                    <td width="61%">
                                        <input type="text" name="v_valorins" id="v_valorins" size="17" class="input" maxlength="14"
                                        onKeyDown="JavaScript:FormataValor(this,14,event)"
                                        onChange="JavaScript: formataDecimal(this,true,event);"
                                        onBlur="JavaScript:calcValorTotal();"
                                        style="text-align: right" />
                                    </td>
                                </tr>
                                <tr>
                                    <td width="39%" align="right" class="linhaform">Valor Outras Entidades:</td>
                                    <td width="61%">
                                        <input type="text" name="v_valorout" id="v_valorout" size="17" class="input" maxlength="14"
                                        onKeyDown="JavaScript:FormataValor(this,14,event)"
                                        onChange="JavaScript: formataDecimal(this,true,event);"
                                        onBlur="JavaScript:calcValorTotal();"
                                        style="text-align: right" />
                                    </td>
                                </tr>
                                <tr>
                                    <td width="39%" align="right" class="linhaform">ATM / Multa e Juros:</td>
                                    <td width="61%">
                                        <input type="text" name="v_valorjur" id="v_valorjur" size="17" class="input" maxlength="14"
                                        onKeyDown="JavaScript:FormataValor(this,14,event)"
                                        onChange="JavaScript: formataDecimal(this,true,event);"
                                        onBlur="JavaScript:calcValorTotal();"
                                        style="text-align: right" />
                                    </td>
                                </tr>
                                <tr>
                                    <td width="39%" align="right" class="linhaform">Valor Total:</td>
                                    <td width="61%">
                                        <input type="text" name="v_valortot" id="v_valortot" size="17" class="input" maxlength="14"
                                        style="text-align: right; background-color: #DFDFDF" readOnly />
                                    </td>
                                </tr>
                                <tr>
                                    <td width="39%" align="right" class="linhaform">Tipo Pessoa</td>
                                    <td width="61%">
                                       <input type="radio" id="inpesgps1" name="inpesgps" value="1" onclick="JavaScript:setValorCampo('inpesgps','h_inpesgps');" >
                                       <label for="inpesgps1" accesskey="b">Física</label>
                                       <input type="radio" id="inpesgps2" name="inpesgps" value="2" style="margin-left:20px" onclick="JavaScript:setValorCampo('inpesgps','h_inpesgps');">
                                       <label for="inpesgps2" accesskey="d">Jurídica</label>
                                    </td>
                                    <td  align="right" style="display:none;">
                                        <input type="radio" id="inpesgps0" name="inpesgps" checked value="0">
                                    </td>
                                </tr>
                                <tr>
                                    <td width="39%" align="right" class="linhaform">Código:</td>
                                    <td width="61%"><input class="input" type="text" id="v_cod" name="v_cod" size="12" maxlength="10"></td>
                                </tr>
                                <tr>
                                    <td width="39%" align="right" class="linhaform">Senha:</td>
                                    <td width="61%"><input class="input" type="password" id="v_senha" name="v_senha" size="12" maxlength="10"></td>
                                </tr>
                                <tr>
                                    <td width="39%" align="right" class="linhaform"></td>
                                    <td width="61%"></td>
                                </tr>
                                <tr>
                                    <td width="101%" align="center" class="linhaform" colspan="2">
                                        <input type="submit" id="b_confirmar" value="Confirmar" name="b_confirmar" class="button" />
                                        <input type="submit" id="b_cancelar"  value="Cancelar"  name="b_cancelar"  class="button" />
                                    </td>
                                </tr>
                                <tr>
                                    <td width="101%" align="center" class="linhaform" colspan="2"></td>
                                </tr>
                            </table>
                        </div>
                    </td>
                </tr>
            </table>
        </div>
        <div align="center">
            <table width="100%">
                <tr>
                    <td align="right" class="linhaform">
                        &nbsp;
                    </td>
                </tr>
            </table>
        </div>
        </form>
        <script language="JavaScript">

            var cCodBarras = "#v_codbarras";
            var cDatVvenct = "#v_vencimento";
            var running = false;
            var	count   = 0;
            var	run_for = 300;
            var	fim     = false;
            var flmask  = false;
            var leitora = false;
			var b_confirmar = "#b_confirmar";	
			var clicks = 0;

            if (document.getElementById('v_conta').value=="") {
                 document.getElementById("b_confirmar").disabled = true;
                 document.getElementById("b_cancelar").disabled  = true;
            }else {
                document.getElementById("b_confirmar").disabled = false;
                document.getElementById("b_cancelar").disabled  = false;
            }

            $( document ).ready(function() {

				// Função para que se for clicado mais que uma vez no confirmar, vamos desabilitar o botao para nao permitir a requisição dupla
				$(b_confirmar).click( 
					function(){
						clicks++;
						if(clicks > 1 ){							
							$(b_confirmar).prop('disabled', true);
						}else{ 
							document.forms[0].submit();							
						}
					});
				
                $(cCodBarras).attr("maxlength","57");

                var end_counter = function() {
        			if (running) {
        				running = false;
        				fim     = true;
        				started_at = 0;

                        /*Identifica se eh leitora*/
        				if(count >= 4){
        					leitora = true;
        				}else{
        					leitora = false;
        				}
        			}
        		};

                $(cCodBarras).keypress(function(e) {

                    if (!fim) {

        				if (running) {
        					count++;
        				} else {
        					running = true;
        					count = 0;
        					setTimeout(end_counter, run_for);
        				}

        			} else {

        				/*Verificar leitora ou digitacao manual*/
        				if(leitora){

                            $(cCodBarras).unmask();
                            $(cCodBarras).mask('00000000000000000000000000000000000000000000');

        				}else{

        					if( $(cCodBarras).val().length > 4 && !flmask){

                                $(cCodBarras).unmask();
        						$(cCodBarras).mask('00000000000-0 00000000000-0 00000000000-0 00000000000-0');
        						$(cCodBarras).attr("maxlength","57");
        						flmask = true;
        					}

        				}
        			}

        		});


        		$(cCodBarras).keyup(function(event) {

        			if( $(cCodBarras).val().length == 0 ){
        				/*zera variaveis de controle*/
        				running = false;
        				count   = 0;
        				run_for = 300;
        				fim     = false;
                        flmask  = false;
                        leitora = true;

                       $(cCodBarras).unmask();
                       $(cCodBarras).mask('00000000000000000000000000000000000000000000');
        			}

                    // Atribuir caracteres numericos
                    var keyCodesPermitidos = new Array();

                    // Numeros e 0 a 9 do teclado alfanumerico
                    for(x=48;x<=57;x++){
                        keyCodesPermitidos.push(x);
                    }

                    // Numeros e 0 a 9 do teclado numerico
                    for(x=96;x<=105;x++){
                        keyCodesPermitidos.push(x);
                    }

                    // Verificar se ja esta completo a quantidade de caracteres,
                    // para assim pular para o proximo campo
                    // somente testar se for um numerico
                    event = event || window.event;
                    var keyCode = event.keyCode;
                    /**********************************************************/

        		});


                $(cCodBarras).bind('paste', function(event) {
                    //aumentar campo antes de copiar para que nao seja perdido nenhuma informação
                    $(cCodBarras).attr("maxlength","57");
                    $(cCodBarras).unmask();
                    $(cCodBarras).mask('000000000000000000000000000000000000000000000000000000000');

                    leitora = false;

                    setTimeout(function () {
                        $(cCodBarras).attr("maxlength","57");
                        $(cCodBarras).unmask();
                        $(cCodBarras).mask('00000000000-0 00000000000-0 00000000000-0 00000000000-0');
                        flmask  = true;
                    });
        		});

            });


            function controlaCampos(){

                var proximo = document.getElementById("proximo").value;
                var lstBlq  = "";
                var lstLib  = "";
                var vcampos;

                for (var i=0;i<document.forms[0].length;i++){
                     vcampos+= i + ' - ' + document.forms[0].elements[i].name + '\n\r';
                }

                if ((proximo == 0) || (proximo == 99)) {// Inicio - Bloqueia tudo

                    //0 - Entrou na tela  / 99 - Conta nao encontrada

                    lstLib = "v_conta,vh_foco";
                    habilitaDesabilita(1,lstLib,'13');  // 1 - Habilita

                    lstBlq = "tpdpagto1,tpdpagto2,v_codbarras,v_codigo,v_competencia," +
                             "v_identificador,v_valorins,v_valorout,v_valorjur,v_vencimento,v_valortot,inpesgps1," +
                             "inpesgps2,v_vencimento";

                    habilitaDesabilita(0,lstBlq,'13');  // 0 - Desabilita

                    document.getElementById('vh_foco').value       = "13";
                    document.getElementById('v_conta').value       = "0";

                    document.forms[0].submit();

                }else if ((proximo == 1) || (proximo == 2)) {

                    // 1 - Achou conta (Debito em Conta) / 2 - Conta Zero (Pagto A vista)
                    // Digitou a conta ou conta 0
                    
                    if (verificaValorDosCampos('tpdpagto')==0) {

                        lstBlq = "v_codbarras,v_codigo,v_competencia," +
                                 "v_identificador,v_valorins,v_valorout,v_valorjur,v_vencimento,v_valortot,inpesgps1," +
                                 "inpesgps2,v_vencimento,b_confirmar";
                        habilitaDesabilita(0,lstBlq,'15');  // 0 - Desabilita

                        lstLib = "v_conta,vh_foco,tpdpagto1,tpdpagto2";
                        habilitaDesabilita(1,lstLib,"15");  // 1 - Habilita
                        return true;
                    }

                    lstLib = "v_conta,vh_foco,tpdpagto1,tpdpagto2,v_vencimento";
                    habilitaDesabilita(1,lstLib,"18");  // 1 - Habilita

                    document.getElementById('proximo').value = proximo;
                    document.getElementById('vh_foco').value = "18";

                    if (verificaValorDosCampos('tpdpagto')==1) {
                        habilitaCodBarras();
                    }else {
                        habilitaManual();
                    }

                }else if (proximo == 997) {

                    if (document.getElementById('h_tpdpagto').value==1) {
                        document.getElementById('tpdpagto1').checked = true;
                    }else
                    if (document.getElementById('h_tpdpagto').value==2) {
                        document.getElementById('tpdpagto2').checked = true;
                    }

                    if (document.getElementById('h_inpesgps').value==1) {
                        document.getElementById('inpesgps1').checked = true;
                    }else
                    if (document.getElementById('h_inpesgps').value==2) {
                        document.getElementById('inpesgps2').checked = true;
                    }

                    // proximo = 9979 - Sucesso das Validacoes - C/ COD.BARRAS

                    // Ajusta a cor do campo
                    document.getElementById('v_codigo').style.background = "#DFDFDF";
                    document.getElementById('v_competencia').style.background = "#DFDFDF";
                    document.getElementById('v_identificador').style.background = "#DFDFDF";
                    document.getElementById('v_valorins').style.background = "#DFDFDF";
                    document.getElementById('v_valorout').style.background = "#DFDFDF";
                    document.getElementById('v_valorjur').style.background = "#DFDFDF";
                    document.getElementById('v_valortot').style.background = "#DFDFDF";
                    document.getElementById('v_vencimento').style.background = "#DFDFDF";
                    // Transforma os campos em READ-ONLY
                    document.getElementById('v_codigo').readOnly = true;
                    document.getElementById('v_competencia').readOnly = true;
                    document.getElementById('v_identificador').readOnly = true;
                    document.getElementById('v_valorins').readOnly = true;
                    document.getElementById('v_valorout').readOnly = true;
                    document.getElementById('v_valorjur').readOnly = true;
                    document.getElementById('v_valortot').readOnly = true;
                    document.getElementById('v_vencimento').readOnly = true;

                    document.getElementById('vh_foco').value = "27";

                    setValorCampo('tpdpagto','h_tpdpagto');
                    setValorCampo('inpesgps','h_inpesgps');

                }else if ((proximo == 999) || (proximo == 998)) {

                    if (document.getElementById('h_tpdpagto').value==1) {
                        document.getElementById('tpdpagto1').checked = true;
                    }else
                    if (document.getElementById('h_tpdpagto').value==2) {
                        document.getElementById('tpdpagto2').checked = true;
                    }

                    if (document.getElementById('h_inpesgps').value==1) {
                        document.getElementById('inpesgps1').checked = true;
                    }else
                    if (document.getElementById('h_inpesgps').value==2) {
                        document.getElementById('inpesgps2').checked = true;
                    }
                    
                    // proximo = 999 - Retorno de Erro das Validacoes - S/ COD.BARRAS
                    // proximo = 998 - Retorno de Erro das Validacoes - C/ COD.BARRAS
                    if (proximo==998) {
                        // Ajusta a cor do campo
                        document.getElementById('v_codigo').style.background = "#DFDFDF";
                        document.getElementById('v_competencia').style.background = "#DFDFDF";
                        document.getElementById('v_identificador').style.background = "#DFDFDF";
                        document.getElementById('v_valorins').style.background = "#DFDFDF";
                        document.getElementById('v_valorout').style.background = "#DFDFDF";
                        document.getElementById('v_valorjur').style.background = "#DFDFDF";
                        document.getElementById('v_valortot').style.background = "#DFDFDF";
                        document.getElementById('v_vencimento').style.background = "#DFDFDF";
                        // Transforma os campos em READ-ONLY
                        document.getElementById('v_codigo').readOnly = true;
                        document.getElementById('v_competencia').readOnly = true;
                        document.getElementById('v_identificador').readOnly = true;
                        document.getElementById('v_valorins').readOnly = true;
                        document.getElementById('v_valorout').readOnly = true;
                        document.getElementById('v_valorjur').readOnly = true;
                        document.getElementById('v_valortot').readOnly = true;
                        document.getElementById('v_vencimento').readOnly = true;
                    }

                    if (proximo==999) {
                        lstBlq = "v_codbarras";
                        habilitaDesabilita(0,lstBlq,document.getElementById('vh_foco').value);  // 0 - Desabilita
                    }

                    setValorCampo('tpdpagto','h_tpdpagto');
                    setValorCampo('inpesgps','h_inpesgps');

                } else if (proximo == 9999) {

                    /* Quando o horario estiver esgotado, bloquear todos os campos */
                    document.getElementById('v_conta').style.background = "#DFDFDF";
                    document.getElementById('v_nome').style.background = "#DFDFDF";
                    document.getElementById('tpdpagto1').style.background = "#DFDFDF";
                    document.getElementById('tpdpagto2').style.background = "#DFDFDF";
                    document.getElementById('v_codbarras').style.background = "#DFDFDF";
                    document.getElementById('v_codigo').style.background = "#DFDFDF";
                    document.getElementById('v_competencia').style.background = "#DFDFDF";
                    document.getElementById('v_identificador').style.background = "#DFDFDF";
                    document.getElementById('v_valorins').style.background = "#DFDFDF";
                    document.getElementById('v_valorout').style.background = "#DFDFDF";
                    document.getElementById('v_valorjur').style.background = "#DFDFDF";
                    document.getElementById('v_valortot').style.background = "#DFDFDF";
                    document.getElementById('v_vencimento').style.background = "#DFDFDF";
                    document.getElementById('inpesgps1').style.background = "#DFDFDF";
                    document.getElementById('inpesgps1').style.background = "#DFDFDF";
                    document.getElementById('b_confirmar').style.background = "#DFDFDF";
                    document.getElementById('b_cancelar').style.background = "#DFDFDF";

                    document.getElementById('v_conta').disabled = true;
                    document.getElementById('v_nome').disabled = true;
                    document.getElementById('tpdpagto1').disabled = true;
                    document.getElementById('tpdpagto2').disabled = true;
                    document.getElementById('v_codbarras').disabled = true;
                    document.getElementById('v_codigo').disabled = true;
                    document.getElementById('v_competencia').disabled = true;
                    document.getElementById('v_identificador').disabled = true;
                    document.getElementById('v_valorins').disabled = true;
                    document.getElementById('v_valorout').disabled = true;
                    document.getElementById('v_valorjur').disabled = true;
                    document.getElementById('v_valortot').disabled = true;
                    document.getElementById('v_vencimento').disabled = true;
                    document.getElementById('inpesgps1').disabled = true;
                    document.getElementById('inpesgps1').disabled = true;
                    document.getElementById('b_confirmar').disabled = true;
                    document.getElementById('b_cancelar').disabled = true;

                }

                return true;
            }


            function habilitaCodBarras() {

                document.getElementById('inpesgps0').checked  = true;
                document.getElementById('h_inpesgps').value   = 0;

                // Habilitar Cod Barras
                lstLib = "v_conta,vh_foco,v_codbarras,inpesgps1,inpesgps2,b_confirmar";
                habilitaDesabilita(1,lstLib,"18");  // 1 - Habilita

                lstBlq = "v_codigo,v_competencia,v_identificador,v_valorins,v_valorout,v_valorjur,v_vencimento";
                habilitaDesabilita(0,lstBlq,"18");  // 0 - Desabilita

                if (document.getElementById('v_valorins').value!="") {
                    document.getElementById('v_valorins').value= "";
                }
                if (document.getElementById('v_valorout').value!="") {
                    document.getElementById('v_valorout').value= "";
                }
                if (document.getElementById('v_valorjur').value!="") {
                    document.getElementById('v_valorjur').value= "";
                }
                if (document.getElementById('v_valortot').value!="") {
                    document.getElementById('v_valortot').value= "";
                }

                document.getElementById('v_valortot').disabled = true;
            }


            function habilitaManual() {

                // Transforma os campos em READ-ONLY
                document.getElementById('v_valortot').disabled = false;
                document.getElementById('v_codigo').readOnly = false;
                document.getElementById('v_competencia').readOnly = false;
                document.getElementById('v_identificador').readOnly = false;
                document.getElementById('v_valorins').readOnly = false;
                document.getElementById('v_valorout').readOnly = false;
                document.getElementById('v_valorjur').readOnly = false;
                document.getElementById('v_vencimento').readOnly = false;
                document.getElementById('v_valortot').readOnly = true;
                // Inicializa os Campos
                document.getElementById('v_vencimento').value = "";
                document.getElementById('inpesgps0').checked  = true;
                document.getElementById('h_inpesgps').value   = 0;

                // Habilitar Cod Barras
                lstLib = "v_conta,vh_foco,v_codigo,v_competencia,v_identificador,v_valorins,v_valorout," +
                         "v_valorjur,inpesgps1,inpesgps2,v_vencimento,b_confirmar";
                habilitaDesabilita(1,lstLib,"18");  // 1 - Habilita

                lstBlq = "v_codbarras";
                habilitaDesabilita(0,lstBlq,"18");  // 0 - Desabilita

                if (document.getElementById('v_valorins').value!="") {
                    document.getElementById('v_valorins').value= "";
                }
                if (document.getElementById('v_valorout').value!="") {
                    document.getElementById('v_valorout').value= "";
                }
                if (document.getElementById('v_valorjur').value!="") {
                    document.getElementById('v_valorjur').value= "";
                }
                if (document.getElementById('v_valortot').value!="") {
                    document.getElementById('v_valortot').value= "";
                }

            }


            function habilitaDesabilita(funcao,campos,foco){

                var lista = campos.split(",");
                var obj;

                for	(cont = 0; cont < lista.length; cont++) {
                    obj = document.getElementById(lista[cont]);

                    if (funcao == 0) { // Desabilitar
                        obj.disabled = true;
                        if ((obj.type != 'radio')  &&
                            (obj.type != 'submit') &&
                            (obj.type != 'button') ) {
                            obj.style.background = "#DFDFDF";
                        }
                    } else { // Habilitar
                        obj.disabled = false;
                        if ((obj.type != 'radio')  &&
                            (obj.type != 'submit') &&
                            (obj.type != 'button') ) {
                            obj.style.background = "#FFF";
                        }
                    }

                    if (obj.name != "v_conta"  &&
                        obj.name != "inpesgps" &&
                        obj.name != "tpdpagto" &&
                        obj.name != "b_confirmar" ) {
                        obj.value = '';
                    }

                }

                document.getElementById('vh_foco').value = foco;
                mudaFoco();
            }


            function mascaraData(campoData,controlFormat) {

            	var mes = 0;
            	var ano = 0;
            	var exibeMes = "";
            	var exibeAno = "";
            	var data = document.getElementById('v_competencia').value.replace("/","");

            	// Se string nao conter 6 caracteres
            	if (data.length != 6 && data.length != 4) {
                    document.getElementById('v_competencia').value = "";
            		return true;
            	}

            	if (controlFormat==0){
            		// O Formato da data veio como AAAAMM
            		mes = parseInt(data.substr(4,2),10);
            		ano = parseInt(data.substr(0,4));
            		exibeMes = data.substr(4,2);
            		exibeAno = data.substr(0,4);
            	}else{
            		// O Formato da data veio como MMAAAA
            		mes = parseInt(data.substr(0,2),10);
            		ano = parseInt(data.substr(2));
            		exibeMes = data.substr(0,2);
            		exibeAno = data.substr(2);
            	}

                if (isNaN(mes) || isNaN(ano) || (String(ano).length != 4 && String(ano).length != 2)) {
            		document.getElementById('v_competencia').value = "";
                    document.getElementById('v_competencia').focus();
            		alert("Competência Inválida. Por favor, digite novamente!");
            		return false;
            	}

            	// Valida numero do mes. Tratando para receber o 13º mes
            	if (mes < 1 || mes > 13) {
            		document.getElementById('v_competencia').value = "";
                    document.getElementById('v_competencia').focus();
            		alert("Competência Inválida. Por favor, digite novamente");
            		return false;
            	}

                // Exibe campo formatado
                if (String(ano).length != 2) {
                    document.getElementById('v_competencia').value = exibeMes+"/"+exibeAno;
                } else {
                    document.getElementById('v_competencia').value = exibeMes+"/20"+exibeAno;
                }
            	return true;
            }


            function calcValorTotal() {

                var vlinss;
            	var vloutr;
            	var vlmult;
                var vlsoma;

                if (document.getElementById('v_valorins').value=="") {
                    vlinss = 0.00;
                }else{
                    vlinss = parseFloat(document.getElementById('v_valorins').value.split(".").join("").replace(",", "."));
                }

                if (document.getElementById('v_valorout').value=="") {
                    vloutr = 0.00;
                }else{
                    vloutr = parseFloat(document.getElementById('v_valorout').value.split(".").join("").replace(",", "."));
                }

                if (document.getElementById('v_valorjur').value=="") {
                    vlmult = 0.00;
                }else{
                    vlmult = parseFloat(document.getElementById('v_valorjur').value.split(".").join("").replace(",", "."));
                }

            	vlsoma = vlinss + vloutr + vlmult;

            	// Valor total calculados
            	document.getElementById('v_valortot').value = number_format(vlsoma, 2, ",", ".");
            }


            function number_format(number, decimals, dec_point, thousands_sep) {
            	var n = !isFinite(+number) ? 0 : +number,
            		prec = !isFinite(+decimals) ? 0 : Math.abs(decimals),
            		sep = (typeof thousands_sep === 'undefined') ? ',' : thousands_sep,        dec = (typeof dec_point === 'undefined') ? '.' : dec_point,
            		s = '',
            		toFixedFix = function (n, prec) {
            			var k = Math.pow(10, prec);
            			return '' + Math.round(n * k) / k;        };
            	// Fix for IE parseFloat(0.55).toFixed(0) = 0;
            	s = (prec ? toFixedFix(n, prec) : '' + Math.round(n)).split('.');
            	if (s[0].length > 3) {
            		s[0] = s[0].replace(/\B(?=(?:\d{3})+(?!\d))/g, sep); }
            	if ((s[1] || '').length < prec) {
            		s[1] = s[1] || '';
            		s[1] += new Array(prec - s[1].length + 1).join('0');
            	}    return s.join(dec);
            }


            function validarData( data ) {

                if (data=="") {
                    return false;
                }

                data = data.replace(/[^0-9\/]/g, "");

                var partes = data.split("/");

                if( partes.length != 3 ) {
                    document.getElementById('v_vencimento').focus();
                    document.getElementById('v_vencimento').value = '';
                    return true;
                }

                var dia = partes[0];
                var mes = partes[1];
                var ano = partes[2];

                if( isNaN(dia) || isNaN(mes) || isNaN(ano) ) {
                    document.getElementById('v_vencimento').focus();
                    document.getElementById('v_vencimento').value = '';
                    return true;
                }

                if( mes > 12 || mes < 1 || ano < 1 || dia < 1) {
                    document.getElementById('v_vencimento').focus();
                    document.getElementById('v_vencimento').value = '';
                    return true;
                }

                if( mes == 2 ) {

                        maiorDia = ( ( (!(ano % 4)) && (ano % 100) ) || (!(ano % 400)) )? 29: 28;

                        if( dia > maiorDia ) {
                            document.getElementById('v_vencimento').focus();
                            document.getElementById('v_vencimento').value = '';
                            return true;
                        }

                }else {

                        if( mes == 4 || mes == 6 || mes == 9 || mes == 11 ) {

                                if( dia > 30 ) {
                                    document.getElementById('v_vencimento').focus();
                                    document.getElementById('v_vencimento').value = '';
                                    return true;
                                }
                        }else {

                                if( dia > 31 ) {
                                    document.getElementById('v_vencimento').focus();
                                    document.getElementById('v_vencimento').value = '';
                                    return true;
                                }
                        }
                }

                return false;
            }


            function verificaValorDosCampos(campo){
                var rads = document.getElementsByName(campo);
                var valor;
                for(var i = 0; i < rads.length; i++){
                    if(rads[i].checked){
                        valor = rads[i].value;
                    }
                }
                return valor;
            }


            function setValorCampo(nameDe,namePara){
                var rads = document.getElementsByName(nameDe);
                var valor;

                for(var i = 0; i < rads.length; i++){
                    if(rads[i].checked){
                        valor = rads[i].value;
                    }
                }
                document.getElementById(namePara).value = valor;
            }


            function proximo(campo){
                campo.focus();
            }


            function submeterForm(){

                var cdBarra;
                try {
                    cdBarra = $(cCodBarras).cleanVal();
                } catch (e) {
                    // Em caso de erro lê apenas o value, sem importar-se com a mascara
                    cdBarra = $(cCodBarras).val();
                }

                if (leitora) {
                    $('#h_idleitor').val("1");
                } else {
                    $('#h_idleitor').val("0");
                }

                if (cdBarra=="") {
                    document.getElementById('v_codigo').value = "";
                    document.getElementById('v_competencia').value = "";
                    document.getElementById('v_identificador').value = "";
                    document.getElementById('v_valorins').value = "";
                    document.getElementById('v_valorout').value = "";
                    document.getElementById('v_valorjur').value = "";
                    document.getElementById('v_valortot').value = "";
                    document.getElementById('v_vencimento').value = "";
                    document.getElementById('inpesgps0').checked  = true;
                    document.getElementById('h_inpesgps').value   = 0;
                    return false;
                }

                // Se ocódigo tiver mais de 44 caracteres, caracterizando linha digitavelm deve
                // tratar o código pois nesta situação temos as informações de digito verificador
                // na string
            	if (cdBarra.length > 44) {
            		// Remover digitos verificadores
            		cdBarra = cdBarra.substr(0,11).concat(cdBarra.substr(12,11)
            											 ,cdBarra.substr(24,11)
            											 ,cdBarra.substr(36,11));
            	}

                if( cdBarra.length != 44 && cdBarra.length != 48 ) {
                    document.getElementById('vh_foco').value = "18";
                    $(cCodBarras).val("");
                    alert("Codigo de Barras e/ou Linha Digitavel invalida ou incompleta!");
                    return false;
                }

                document.forms[0].submit();
            }

            function verificaTamanhoData(campo) {
                var campoDeData;
                var formataData;
                if (document.getElementById(campo).value == "") { return false; }

                campoDeData = document.getElementById(campo).value;
                campoDeData = campoDeData.replace( ".", "" );
                campoDeData = campoDeData.replace( "/", "" );
                campoDeData = campoDeData.replace( "/", "" );

                if (campoDeData.length == 8) { return false; }
                if (campoDeData.length < 6 || campoDeData.length == 7)  { document.getElementById(campo).value = ""; $(campo).focus(); return false; }

                formataData = document.getElementById(campo).value.split("/");
                document.getElementById(campo).value = formataData[0]+"/"+formataData[1]+"/20"+formataData[2];
                $(campo).focus();
            }


            function formataDecimal(objField,flgBlur,e) {

                if (flgBlur) { // Utilizar no evento onBlur
                        if (objField.value != "") { // Se campo possui algum conteúdo

                                var flgVirgula  = false;
                                var contDecimos = 0;
                                var value       = "";
                                var temp        = "";
                                var comeco                = false;

                                for (var i = 0; i < objField.value.length; i++) {
                                        temp = objField.value.substr(i,1);

                                        if(temp != "0"){
                                                comeco = true;
                                        }

                                        if(comeco)
                                                value += temp;
                                        else
                                                continue;

                                        if (flgVirgula) {
                                                contDecimos++;
                                        }

                                        if (!flgVirgula && temp == ",") {
                                                if(value == ",")
                                                        value = "0" + value;
                                                flgVirgula = true;
                                        }

                                        if (contDecimos == 2) {
                                                break;
                                        }
                                }

                                value += !flgVirgula ? ",00" : contDecimos == 0 ? "00" : contDecimos == 1 ? "0" : "";

                                if (value.length > objField.maxLengt) {
                                        objField.maxLengt = value.length;
                                }

                                objField.value = value;

                        }
                } else {
                        if (retornaTecla(e) == 44) {
                                if (objField.value == "" || objField.value.indexOf(",") != "-1") {
                                        return false;
                                }

                                return true;
                        }

                        // Permitir a utilização das teclas de setas, tab, home e end.
                        if ((retornaTecla(e) >= 35 && retornaTecla(e) <= 40) || (retornaTecla(e) == 9) ){
                                return true;
                        }

                        if (!validaNumero(e)) {
                                return false;
                        }

                        return true;
                }
            }

    </script>
    </body>
</html>
