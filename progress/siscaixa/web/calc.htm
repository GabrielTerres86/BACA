<!--------------------------------------------------------------------------
Ultima alteracao: 13/03/2009

13/03/2009 - Incluido script "formatadadosie.js" para nao dar erro na funcao
             "click" ao carregar a tela (Evandro).
--------------------------------------------------------------------------->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<meta name="GENERATOR" content="Microsoft FrontPage 4.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<meta http-equiv="cache-control" content="no-cache">
<meta http-equiv="Pragma"        content="No-Cache">
<meta http-equiv="Expires"       content="0">
<script language=JavaScript src="/script/formatadadosie.js"></script>
<link rel=StyleSheet type="text/css" href="/script/viacredi.css">
<title>Calculadora</title>
<SCRIPT LANGUAGE="JavaScript">
<!-- Begin
var Memory = 0;
var Number1 = "";
var Number2 = "";
var NewNumber = "blank";
var opvalue = "";

function Display(displaynumber) {
document.calculator.answer.value = displaynumber;
}

function MemoryClear() {
Memory = 0;
document.calculator.mem.value = "";
}

function MemoryRecall(answer) {
if(NewNumber != "blank") {
Number2 += answer;
} else {
Number1 = answer;
}
NewNumber = "blank";
Display(answer);
}

function MemorySubtract(answer) {
Memory = Memory - eval(answer);
}

function MemoryAdd(answer) {
Memory = Memory + eval(answer);
document.calculator.mem.value = " M ";
NewNumber = "blank";
}

function ClearCalc() {
Number1 = "";
Number2 = "";
NewNumber = "blank";
Display("");
}

function Backspace(answer) {
answerlength = answer.length;
answer = answer.substring(0, answerlength - 1);
if (Number2 != "") {
Number2 = answer.toString();
Display(Number2);
} else {
Number1 = answer.toString();
Display(Number1);
   }
}

function CECalc() {
Number2 = "";
NewNumber = "yes";
Display("");
}

function CheckNumber(answer) {
if(answer == ".") {
Number = document.calculator.answer.value;
if(Number.indexOf(".") != -1) {
answer = "";
   }
}

if(NewNumber == "yes") {
Number2 += answer;
Display(Number2);
}
else {
if(NewNumber == "blank") {
Number1 = answer;
Number2 = "";
NewNumber = "no";
}
else {
Number1 += answer;
}
Display(Number1);
   }
}
function AddButton(x) {
if(x == 1) EqualButton();
if(Number2 != "") {
Number1 = parseFloat(Number1) + parseFloat(Number2);
}
NewNumber = "yes";
opvalue = '+';
Display(Number1);
}
function SubButton(x) {
if(x == 1) EqualButton();
if(Number2 != "") {
Number1 = parseFloat(Number1) - parseFloat(Number2);
}
NewNumber = "yes";
opvalue = '-';
Display(Number1);
}
function MultButton(x) {
if(x == 1) EqualButton();
if(Number2 != "") {
Number1 = parseFloat(Number1) * parseFloat(Number2);
}
NewNumber = "yes";
opvalue = '*';
Display(Number1);
}
function DivButton(x) {
if(x == 1) EqualButton();
if(Number2 != "") {
Number1 = parseFloat(Number1) / parseFloat(Number2);
}
NewNumber = "yes";
opvalue = '/';
Display(Number1);
}
function SqrtButton() {
Number1 = Math.sqrt(Number1);
NewNumber = "blank";
Display(Number1);
}
function PercentButton() {
if(NewNumber != "blank") {
Number2 *= .01;
NewNumber = "blank";
Display(Number2);
   }
}
function RecipButton() {
Number1 = 1/Number1;
NewNumber = "blank";
Display(Number1);
}
function NegateButton() {
Number1 = parseFloat(-Number1);
NewNumber = "no";
Display(Number1);
}
function EqualButton() {
if(opvalue == '+') AddButton(0);
if(opvalue == '-') SubButton(0);
if(opvalue == '*') MultButton(0);
if(opvalue == '/') DivButton(0);
Number2 = "";
opvalue = "";
}

function CheckKey(e) {
	switch(e.keyCode) {
	    case 120: window.close();
	    break;
		case 27: ClearCalc();
		break;
		case 46: CECalc();
		break;
        case 50: if (e.shiftKey) SqrtButton();
        break; 
        case 67: CopyValue();
        break;
		case 82: 
        RecipButton();
		break;
   		case 96: CheckNumber('0');
   		break;
   		case 97: CheckNumber('1');
   		break;
   		case 98: CheckNumber('2');
   		break;
   		case 99: CheckNumber('3');
   		break;
   		case 100: CheckNumber('4');
   		break;
   		case 101: CheckNumber('5');
   		break;
   		case 102: CheckNumber('6');
   		break;
   		case 103: CheckNumber('7');
   		break;
   		case 104: CheckNumber('8');
   		break;
   		case 105: CheckNumber('9');
   		break;
   		case 110: case 108: CheckNumber('.');
   		break;
   		case 111: DivButton(1);
   		break;
   		case 106: MultButton(1);
   		break;
   		case 109: SubButton(1); 
   		break;
   		case 107: AddButton(1);
   		break;
   		case 120: NegateButton();
   		break;
   		case 13: EqualButton();
   		return true;
	}
} 

function CopyValue() {
    loc = window.location.href;
    if ((pos = loc.lastIndexOf("?elem")) != -1) {
        val = document.calculator.answer.value;
        if (val.lastIndexOf(".") != -1) {
            decimals = val.substr(val.lastIndexOf(".") + 1);
            val = val.substr(0, val.lastIndexOf("."));
            if (decimals > 99) {
                if (decimals.charAt(2) >= 5) {
                    decimals = decimals.substr(0,2);
                    decimals++;
                }
                else decimals = decimals.substr(0,2);
            }
            if (decimals > 99) {
                val++;
                decimals = "00";
            }
        }
        else decimals = "00"; 
        result = "";
        j = 0;
        for (i = val.length - 1; i >= 0 ; i--) {
            j++; 
            result = val.charAt(i) + result;
            if (i && (j % 3) == 0) {
                result = "." + result;
                j = 0;
            }
        }
        if (result == "") result = val != "" ? val : "0";
        result = result + "," + decimals;
		eval("window.opener.document.forms[0]." + loc.substring(pos + 6) + ".value = result");
        window.close();
    }
}
    
//  End -->
</script>
</head>

<body bgcolor="#FFFFCE" topmargin="0" leftmargin="0" onKeyDown="CheckKey(event)" onLoad="javascript:window.focus(); click();">
<form name="calculator">
<table border="0">
  <tr>
    <td align="right" height="31" colspan="6"><input type="text" size="32" style="position: relative; width: 244; height: 25; font-size: 8 pt; text-align: right; line-height: 200%" name="answer" readonly onChange="CheckNumber(this.value)" class="input"></td>
  </tr>
  <tr>
    <td align="center" width="48" height="27" align="center"><input type="text" size="20" style="position: relative; width: 32; height: 25; background-color: #FFFFCE; font-size: 8 pt; text-align: center; line-height: 200%" name="mem" readonly class="input"></td>
    <td align="center" colspan="2" height="27"><input type="button" value="Copiar" style="position: relative; width: 70; height: 25; font-size: 8 pt" onClick="CopyValue(); return false;" class="button4"></td>
    <td align="center" height="27"><input type="button" value="RET" style="position: relative; width: 32; height: 25; font-size: 8 pt" onClick="Backspace(document.calculator.answer.value); return false;" class="button4"></td>
    <td align="center" height="27"><input type="button" value="CE" style="position: relative; width: 32; height: 25; font-size: 8 pt" onClick="CECalc(); return false;" class="button4"></td>
    <td align="center" height="27"><input type="button" value="C" style="position: relative; width: 32; height: 25; font-size: 8 pt" onClick="ClearCalc(); return false;" class="button4"></td>
  </tr>
  <tr>
    <td align="center" width="48"><input type="button" value="MC" style="position: relative; width: 32; height: 25; font-size: 8 pt" onClick="MemoryClear(); return false;" class="button4"></td>
    <td align="center"><input type="button" value="7" style="position: relative; width: 32; height: 25; font-size: 8 pt" onClick="CheckNumber('7'); return false;" class="button4"></td>
    <td align="center"><input type="button" value="8" style="position: relative; width: 32; height: 25; font-size: 8 pt" onClick="CheckNumber('8'); return false;" class="button4"></td>
    <td align="center"><input type="button" value="9" style="position: relative; width: 32; height: 25; font-size: 8 pt" onClick="CheckNumber('9'); return false;" class="button4"></td>
    <td align="center"><input type="button" value="/" style="position: relative; width: 32; height: 25; font-size: 8 pt" onClick="DivButton(1); return false;" class="button4"></td>
    <td align="center"><input type="button" value="sqrt" style="position: relative; width: 32; height: 25; font-size: 8 pt" onClick="SqrtButton(); return false;" class="button4"></td>
  </tr>
  <tr>
    <td align="center" width="48"><input type="button" value="MR" style="position: relative; width: 32; height: 25; font-size: 8 pt" onClick="MemoryRecall(Memory); return false;" class="button4"></td>
    <td align="center"><input type="button" value="4" style="position: relative; width: 32; height: 25; font-size: 8 pt" onClick="CheckNumber('4'); return false;" class="button4"></td>
    <td align="center"><input type="button" value="5" style="position: relative; width: 32; height: 25; font-size: 8 pt" onClick="CheckNumber('5'); return false;" class="button4"></td>
    <td align="center"><input type="button" value="6" style="position: relative; width: 32; height: 25; font-size: 8 pt" onClick="CheckNumber('6'); return false;" class="button4"></td>
    <td align="center"><input type="button" value="*" style="position: relative; width: 32; height: 25; font-size: 8 pt" onClick="MultButton(1); return false;" class="button4"></td>
    <td align="center"><input type="button" value="%" style="position: relative; width: 32; height: 25; font-size: 8 pt" onClick="PercentButton(); return false;" class="button4"></td>
  </tr>
  <tr>
    <td align="center" width="48"><input type="button" value="MS" style="position: relative; width: 32; height: 25; font-size: 8 pt" onClick="MemorySubtract(document.calculator.answer.value); return false;" class="button4"></td>
    <td align="center"><input type="button" value="1" style="position: relative; width: 32; height: 25; font-size: 8 pt" onClick="CheckNumber('1'); return false;" class="button4"></td>
    <td align="center"><input type="button" value="2" style="position: relative; width: 32; height: 25; font-size: 8 pt" onClick="CheckNumber('2'); return false;" class="button4"></td>
    <td align="center"><input type="button" value="3" style="position: relative; width: 32; height: 25; font-size: 8 pt" onClick="CheckNumber('3'); return false;" class="button4"></td>
    <td align="center"><input type="button" value="-" style="position: relative; width: 32; height: 25; font-size: 8 pt" onClick="SubButton(1); return false;" class="button4"></td>
    <td align="center"><input type="button" value="1/x" style="position: relative; width: 32; height: 25; font-size: 8 pt" onClick="RecipButton(); return false;" class="button4"></td>
  </tr>
  <tr>
    <td align="center" width="48"><input type="button" value="M+" style="position: relative; width: 32; height: 25; font-size: 8 pt" onClick="MemoryAdd(document.calculator.answer.value); return false;" class="button4"></td>
    <td align="center"><input type="button" value="0" style="position: relative; width: 32; height: 25; font-size: 8 pt" onClick="CheckNumber('0'); return false;" class="button4"></td>
    <td align="center"><input type="button" value="+/-" style="position: relative; width: 32; height: 25; font-size: 8 pt" onClick="NegateButton(); return false;" class="button4"></td>
    <td align="center"><input type="button" value="," style="position: relative; width: 32; height: 25; font-size: 8 pt" onClick="CheckNumber('.'); return false;" class="button4"></td>
    <td align="center"><input type="button" value="+" style="position: relative; width: 32; height: 25; font-size: 8 pt" onClick="AddButton(1); return false;" class="button4"></td>
    <td align="center"><input type="button" value="=" style="position: relative; width: 32; height: 25; font-size: 8 pt" onClick="EqualButton(); return false;" class="button4"></td>
  </tr>
</table>
</form>
</body>

</html>
