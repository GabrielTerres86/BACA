<!--
   Programa: crap022.htm                  
   Autora  : Elton
   Data    : 30/11/2011                      Ultima atualizacao: 04/06/2014

   Dados referentes ao programa:

   Objetivo  : Transferencia e Deposito entre Cooperativas
   
   Alteracoes: 11/09/2013 - Nova forma de chamar as agências, de PAC agora 
                            a escrita será PA (André Euzébio - Supero).
                            
               04/06/2014 - Incluido opcao de deposito de cheques entre
                            cooperativas. (Andre Santos - SUPERO)                            
                            
  
-->


<html>

<head>
<meta http-equiv="Content-Language" content="pt-br">
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<meta name="GENERATOR" content="Microsoft FrontPage 4.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<meta http-equiv="cache-control" content="no-cache">
<meta http-equiv="Pragma"        content="No-Cache">
<meta http-equiv="Expires"       content="0">
<script language=JavaScript src="/script/formatadadosie.js"></script>
<link rel=StyleSheet type="text/css" href="/script/viacredi.css">
<title>DEPOSITO E TRANSFERENCIA ENTRE COOPERATIVAS</title>

<script language="JavaScript">
var lChangePara = false;


function callconta(e) {
   if (e.keyCode == 121){ 
      if (document.forms[0].vh_doc.value == "V2")
         window.open('condoc.p','wcta','width=300,height=,310,scrollbars=auto,resizable=no,alwaysRaised=true,left=0,top=0');
      else if (document.forms[0].vh_doc.value == "V3")           
         window.open('conted.p','wcta','width=300,height=,120,scrollbars=auto,resizable=no,alwaysRaised=true,left=0,top=0');
   }
}

function callfin(e) {
   if (e.keyCode == 123){ 
      if (document.forms[0].vh_doc.value == "V1" || document.forms[0].vh_doc.value == "V2")
         window.open('findoc.p','wcta','width=300,height=,330,scrollbars=auto,resizable=no,alwaysRaised=true,left=0,top=0');
      else if (document.forms[0].vh_doc.value == "V3")           
         window.open('finted.p','wcta','width=300,height=,400,scrollbars=auto,resizable=no,alwaysRaised=true,left=0,top=0');
   }
}


function selectDocto(UsrEvent, TipoDocto) {
  
   switch (TipoDocto) {
   case "Deposito":        
      document.form1.v_nrocontade.disabled = true;
      document.form1.v_nomede.disabled     = true;
      document.form1.v_cpfcgcde.disabled   = true;
      document.form1.v_identifica.disabled = false;               
      document.getElementById('divLinha').style.display   = "block";
      document.getElementById('divValor').style.display   = "block";
      document.getElementById('divIdentifica').style.display = "block";
      document.getElementById('divExibeCaptura').style.display = "none";
      document.getElementById('divTransf').style.display  = "none";
      document.getElementById('divCampos').style.display  = "none"; 
      document.getElementById('divCodigo').style.display  = "none";
      document.getElementById('divEstorno').style.display = "none";
      break;

   case "Cheque":        
      document.form1.v_nrocontade.disabled = true;
      document.form1.v_nomede.disabled     = true;
      document.form1.v_cpfcgcde.disabled   = true;
      document.form1.v_identifica.disabled = false;
      document.getElementById('divLinha').style.display   = "block";
      document.getElementById('divValor').style.display   = "none";
      document.getElementById('divExibeCaptura').style.display = "block";
      document.getElementById('divIdentifica').style.display = "block";
      document.getElementById('divEstorno').style.display = "block";
      document.getElementById('divTransf').style.display  = "none";
      document.getElementById('divCampos').style.display  = "none";
      document.getElementById('divCodigo').style.display  = "none";
      break;

   
   case "Transferencia":
      document.form1.v_nrocontade.disabled = false;
      document.form1.v_nomede.disabled     = true;
      document.form1.v_cpfcgcde.disabled   = true;
      document.form1.v_identifica.disabled = true;
      document.getElementById('divLinha').style.display   = "none";
      document.getElementById('divEstorno').style.display = "none";
      document.getElementById('divIdentifica').style.display = "none";
      document.getElementById('divValor').style.display   = "block";
      document.getElementById('divExibeCaptura').style.display = "none";
      document.getElementById('divTransf').style.display  = "block";
      document.getElementById('divCampos').style.display  = "block";
      document.getElementById('divCodigo').style.display  = "block";
      break;
   } 
   
   // Fernando - desabilitar senha, pois quando troca de tela (DOC para TED) aparece a senha do coordenador
   if(document.form1.v_senha != null && document.form1.v_cod != null && (TipoDocto != "transferencia" )){
       document.form1.v_senha.value = "";
       document.form1.v_cod.value = "";
   }

   if (UsrEvent) {
       document.form1.v_codcoop.value = "";
       doIt();
   }
}                  

function changeContaDe() {
   if (document.form1.v_nrocontade.value != "") {
       document.form1.vh_foco.value = 16;         
       doIt();
   }
}

function changeContaPara() {
   if (document.form1.v_nrocontapara.value != "" || document.form1.TpDocto[1].checked ) {
      document.form1.vh_foco.value = 32;
      doIt();
   }
}

function doIt() {

   document.form1.submit(); 
   for (i=0;i<document.form1.elements.length;i++) {
      document.form1.elements[i].disabled = true;
   }                          
}

function initPage() {
    
   document.form1.v_nomepara1.disabled   = true;
   document.form1.v_cpfcgcpara1.disabled = true;
   document.form1.v_nomepara2.disabled   = true;
   document.form1.v_cpfcgcpara2.disabled = true;
    
   for (var i=0;i<document.form1.TpDocto.length;i++) {
      if (document.form1.TpDocto[i].checked) {
         selectDocto(false,document.form1.TpDocto[i].value);
      }
   }  
   
   document.form1.v_codcoop.value = document.form1.v_cooppara.value;
  
   mudaFoco();
   
   
}
</script>


</head>


<body background="/images/moeda.jpg" bgproperties="fixed" class="fundo" onLoad="JavaScript:initPage();" onKeyUp="callBLini(event); callBLsal(event); callconta(event); callfin(event);"> 

<form name="form1" onKeyDown="change_page(event)" method=post>

<input type="hidden" name="vh_tpDoctoSel" value="Deposito">
<input type="hidden" name="vh_TpDoctoAnt" value="Deposito">
<input type="hidden" name="vh_foco" value="8">
<input type="hidden" name="vh_fl_coop_mig" value="" >
<input type="hidden" name="vh_fl_coop_host" value="">
<input type="hidden" name="vh_coop_mig" value="">
<input type="hidden" name="v_msg">
<input type="hidden" name="vh_doc">
<!--campos para guardar os valores dos selection-lists pois estes sao dinamicos-->
<input type="hidden" name="v_codcoop">
<input type="hidden" name="v_btn_ok" value="false">
<input type="hidden" name="v_captura" value="false">
<input type="hidden" name="v_msgsaldo" value="false">

<p style="word-spacing: 0; line-height: 100%; margin-top: 0; margin-bottom: 0">&nbsp;</p>
<div align="center">
  <center>
  <table width="100%" class=cabtab>
    <tr>
      <td width="15%" align="center"> <input type="text" name="v_coop" size="11" class="transp" readOnly></td>
      <td width="20%" align="center"> PA&nbsp; <input type="text" name="v_pac" size="1" class="transp"  readOnly></td>
      <td width="20%" align="center"> CAIXA&nbsp; <input type="text" name="v_caixa" size="1" class="transp" readOnly></td>
      <td width="30%" align="center"> OPERADOR&nbsp; <input type="text" name="v_operador" size="7" class="transp" readOnly></td>
      <td width="15%" align="center"> <input type="text" name="v_data" size="10" class="transp" readOnly></td>
    </tr>
  </table>
  </center>
</div>

<div align="center">
  <center>
  <table width="100%" class=cabtab height="23">
    <tr>
      <td class=titulo height="19">DEPOSITO E TRANSFERENCIA ENTRE COOPERATIVAS</td>
      <td width="21%" class=programa align="right" height="19">P.022&nbsp; V.1.00</td>
    </tr>
  </table>
  </center>
</div>

<div align="center">
  <center>
    <table cellspacing = 0 cellpadding= 0 width=100%>
      <tr>
        <td width="100%" valign="middle" align="center">
          <div align="center">
            <center>
              <table width="100%" cellspacing = 0 cellpadding = 1 class=tcampo>
                <tr>
                  <td colspan="2">&nbsp;</td>
                </tr>
                <tr>                
                  <td class="linhaform" align="right"></td>
                  <td>
                    <table cellspacing="0" cellpadding="0" width="100%">
                      <tr>
                        <td class="linhaform">
                          <input type="radio" name="TpDocto" value="Deposito"    onClick="JavaScript:selectDocto(true,this.value);" checked>Deposito em dinheiro
                          <input type="radio" name="TpDocto" value="Cheque"      onClick="JavaScript:selectDocto(true,this.value);">Deposito em cheque
                          <input type="radio" name="TpDocto" value="Transferencia"    onClick="JavaScript:selectDocto(true,this.value);">Transferencia
                        </td>                                      
                      </tr>
                    </table>
                  </td>               
                </tr>
                <tr>
                  <td colspan="2">
                    <div id="divTransf" style="display:none">
                      <table width="100%">
                        <tr>
                          <td class="linhaform" width="5%">De:</td>
                          <td class="linhaform" nowrap><hr></td>
                        </tr>
                      </table>
                    </div>
                  </td>
                </tr>
              </table>
            </center>
          </div>
        </td>
      </tr>
    </table>      
  </center>
</div>
<!-- -->
<div id="divCampos" align="center">
  <center>
    <table width="100%">
        <tr>
          <td align="right" class="linhaform">Conta:</td>
          <td><input type="text" name="v_nrocontade" size="10" class="input" maxlength="10" onKeyDown="JavaScript:validaInteiro(event);  FormataConta(this,8,event);" onChange="JavaScript:changeContaDe();"  style="text-align: right"></td>
        </tr>
        <tr>
          <td align="right" class="linhaform">Nome:&nbsp;</td>
          <td class="linhaform"><input type="text" name="v_nomede"  size="42" maxlength="40" class="input" style="font-weight: bold"></td>
        </tr>
        <tr>
          <td align="right" class="linhaform">CPF/CNPJ:&nbsp;</td>
          <td class="linhaform"><input type="text" name="v_cpfcgcde"  maxlength="14" onKeyDown="JavaScript:validaInteiro(event)" size="18" class="input"></td>
        </tr>
        <tr>
          <td colspan="2">
            <table width="100%">
              <tr>
                <td class="linhaform" width="5%">Para:</td>
                <td class="linhaform" nowrap><hr></td>
              </tr>
            </table>
          </td>
        </tr>
    </table>
  </center>
</div>
<!-- -->
<div id="divLinha" style="display:none">
  <table width="100%">
    <tr>
        <td class="linhaform" nowrap><hr></td>
    </tr>
  </table>
</div>
<!-- -->
<div align="center" style="float:justify;overflow:auto;clear:both;">
  <center>
    <table cellspacing = 0 cellpadding= 0 width=100%>
      <tr>
        <td width="100%" valign="middle" align="center">
          <div align="center" style="float:justify;">
            <center>
              <table width="100%" cellspacing = 0 cellpadding = 1>
                <tr>
                  <td align="right" class="linhaform">Cooperativa:</td>
                  <td nowrap class="linhaform">
                    <select name="v_cooppara" size="1" onChange="JavaScript:document.form1.v_codcoop.value=this.value;">
                    </select>
                  </td>
                </tr>
                <tr>
                  <td align="right" class="linhaform">Conta:</td>
                  <td><input type="text" name="v_nrocontapara" size="10" class="input" maxlength="10" onKeyDown="JavaScript:validaInteiro(event); FormataConta(this,8,event);" onChange="JavaScript:changeContaPara();"style="text-align: right"></td>
                </tr>
                <tr>
                  <td align="right" class="linhaform">Tit1:&nbsp;</td>
                  <td><input type="text" name="v_nomepara1"  size="42" class="input" maxlength="40" style="font-weight: bold"></td>
                </tr>
                <tr>
                  <td align="right" class="linhaform">CPF/CNPJ:&nbsp;</td>
                  <td><input type="text" name="v_cpfcgcpara1" size="18" class="input" maxlength="14" class="input"></td>
                </tr>
                <tr>
                  <td align="right" class="linhaform">Tit2:&nbsp;</td>
                  <td><input type="text" name="v_nomepara2" size="42" class="input" maxlength="40" style="font-weight: bold"></td>
                </tr>
                <tr>
                  <td align="right" class="linhaform">CPF/CNPJ:&nbsp;</td>
                  <td><input type="text" name="v_cpfcgcpara2" maxlength="14" onKeyDown="JavaScript:validaInteiro(event)" size="18" class="input"></td>
                </tr>
              </table>
            </center>
          </div>
        </td>
      </tr>
    </table>      
  </center>
</div

<!-- -->
<div id="divIdentifica" style="display:none">
<table width="55%">
    <tr>
      <td align="right" class="linhaform">Identificador:</td>
      <td><input type="text" name="v_identifica" size="20" class="input" maxlength="20"  style="text-align: right"></td>
    </tr>
  </table>
</div>

<!-- -->
<div id="divExibeCaptura" style="display:none;">
  <table width="154%" cellspacing = 1 cellpadding = 1>
    <tr>
      <td align="right" class="linhaform">Valor:</td>
      <td width="85%" >
        <input type="text" name="v_vlrdocumento" size="20" class="input" maxlength="18" style="text-align: right" onKeyUp="callCalc(event, this)" onKeyDown="JavaScript:FormataValor(this,14,event)">
        <input type="submit" value="Captura" name="v_captura" class="button">
      </td>
    </tr>
  </table>
</div>
<!-- -->
<div id="divValor" style="display:none">
  <center>
    <table cellspacing = 0 cellpadding= 0 width=100%>
      <tr>
        <td width="100%" valign="middle" align="center">
          <table width="145%" cellspacing = 0 cellpadding = 1>
            <tr>
              <td align="right" class="linhaform">Valor:&nbsp;</td>
              <td >
                <input type="text" name="v_valordocumento" size="20" class="input" maxlength="18" style="text-align: right" onKeyUp="callCalc(event, this)" onKeyDown="JavaScript:FormataValor(this,14,event)" >
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
              </td>
            </tr>
          </table>
        </td>
      </tr>
    </table>      
  </center>
</div>
<!-- -->
<div id="divCodigo" style="display:none">
  <table width="22%">
    <tr>  
      <td> &nbsp; </td>
    </tr>
    <tr>
      <td class="linhaform" align="right">Código:</td>
      <td ><input class="input" type="text" name="v_cod" size="12" maxlength="10"></td>
    </tr>
    <tr>
      <td class="linhaform" align="right">Senha:</td>
      <td ><input class="input" type="password" name="v_senha" size="12" maxlength="10"></td>
    </tr>
  </table>
</div>
<!-- -->
<div id="divBotao" style="display:block">
  <table width="100%">
    <tr>
      <td class="linhaform" colspan="2"><hr></td>
    </tr>
    <tr>
      <td width="100%" align="middle" class="linhaform" colspan="2">
        <input type="submit" value="Ok" name="ok" class="button" onclick="document.form1.ok.disabled='true';document.form1.v_btn_ok.value='true'; submit();">
        <input type="submit" value="Cancelar" name="cancela" class="button">
        <div id="divEstorno" style="text-align: right">
            <input type="button" value="Estorno" name="estorno" class="button" onClick="JavaScript:redir_login('crap088.w')">
        </div>
      </td>
    </tr>
  </table>
</div>
<!-- -->
</form>
</body>

</html>
