<html>
<head>
<title>Facilitadores (wpgd0016)</title>
</head>
<body>
<link href="/cecred/estilos/progrid.css" rel="stylesheet" type="text/css">
<script SRC="/cecred/jsbiblio/biblio.js"></script>
<script SRC="/cecred/jsbiblio/frcod.js"></script>
<form action="#." method="POST" name="form">
  <input name="aux_cddopcao" type="hidden" value="">    
  <input name="aux_lspermis" type="hidden" value="">    
  <input name="aux_nrdrowid" type="hidden" value="">
  <input name="aux_dsretorn" type="hidden" value="">    
  <input name="aux_stdopcao" type="hidden" value="">
  <input name="aux_dsendurl" type="hidden" value="">    
  <input name="aux_idevento" type="hidden" value="">  
  <input name="aux_cdfacili" type="hidden" value="">

  <!-- Início do modelo geral -->
  <table width="450" border="0" align="left" cellpadding="0" cellspacing="0">
    <tr valign="botton">
      <td>
	    <table border="0" cellpadding="0" cellspacing="0" background="/cecred/images/geral/guia_fundo.gif">
		  <tr>
            <td width="11"><img src="/cecred/images/geral/guia_esquerda.gif" width="11" height="21"></td>
            <td align="center" nowrap width="150" class="linkGuia">Adicionar Facilitador</td>
            <td width="11" align="right"><img src="/cecred/images/geral/guia_direita.gif" width="8" height="21"></td>
          </tr>
        </table>
      </td>
    </tr>
    <tr valign="top" bgcolor="#FFFFFF">
      <td colspan="4">
        <table width="100%" height="100%"  border="0" align="left" cellpadding="0" cellspacing="1" bgcolor="#999999">
          <tr>
            <td valign="top" bgcolor="#FFFFFF">
              <table width="100%" height="100%"  border="0" cellpadding="0" cellspacing="0">
                <tr bgcolor="#FFFFFF">
                  <td>&nbsp;
                    
                  </td>
                </tr>
                <tr>
                  <td height="15" align="left">&nbsp;</td>
                  <td height="15" align="left">
                    <!-- Interrupção do modelo geral, início dos dados específicos da tela -->
                    <table border="0" align="center" cellspacing="0">
                      <tr>
                        <td align="right" class="NomeCampo">Fornecedor:</td>
                        <td align="left">
                          <input name="aux_nrcpfcgc" type="text" class="Campo" onFocus="window.status = 'Fornecedor'" size="60" maxlength="65" readOnly="true" value="">
                        </td>
                      </tr>
                      <tr>
                        <td align="right" class="NomeCampo">Facilitador:</td>
                        <td align="left">
                          <input name="nmfacili" type="text" class="Campo" onFocus="window.status = 'Nome do Facilitador.'" size="61" maxlength="61" value="">
                        </td>
                      </tr>
					  <tr>
					  	<td align="right" class="NomeCampo">DDD/Fone(s):</td>
                        <td align="left" height="20">
						  <input name="nrdddfon1" type="text" class="Campo" size="1" maxlength="3" onkeyup="verifica_ddd(this);">
						  <input name="nrtelefo1" type="text" class="Campo" size="6" maxlength="9" onkeyup="verifica_telefone(this);">
						  &nbsp;&nbsp;&nbsp;&nbsp;
						  <input name="nrdddfon2" type="text" class="Campo" size="1" maxlength="3" onkeyup="verifica_ddd(this);">
						  <input name="nrtelefo2" type="text" class="Campo" size="6" maxlength="9" onkeyup="verifica_telefone(this);">
						  &nbsp;&nbsp;&nbsp;&nbsp;
						  <input name="nrdddfon3" type="text" class="Campo" size="1" maxlength="3" onkeyup="verifica_ddd(this);">
						  <input name="nrtelefo3" type="text" class="Campo" size="6" maxlength="9" onkeyup="verifica_telefone(this);">
						</td>    					    
					  </tr>
                      <tr>
                        <td align="right" class="NomeCampo">Curriculum:
                        </td>
                        <td align="left" height="20">
                          <textarea name="dscurric" cols="62" rows="5" class="CampoTextArea" id="dscurric"></textarea>
						</td>    
                      </tr>
                      <tr>
                        <td align="right" class="NomeCampo">Avaliação:
                        </td>
                        <td align="left">
                          <textarea name="dsavalia" cols="62" rows="5" class="CampoTextArea" id="dsavalia"></textarea>
                        </td>    
                      </tr>
                    </table>
					<br>
                    <table width="200" align="center">
                      <tr>
                        <td><img style="cursor:hand;" src="/cecred/images/botoes/btn_cadastrar.gif" width="58" height="20" onClick="return Incluir()"></td>
                        <td><img style="cursor:hand;" src="/cecred/images/botoes/btn_salvar.gif" width="60" height="20" onClick="return Salvar()"></td>
                        <td><img style="cursor:hand;" src="/cecred/images/botoes/btn_excluir_botao.gif" width="53" height="20" onClick="return Excluir()"></td>
                        <td><img style="cursor:hand;" src="/cecred/images/botoes/btn_procurar.gif" width="61" height="20" onClick="return AbreZoom(NomeDoProgramaDeZoom,NomeDoProgramaPrincipal,'','P',document.form.aux_idevento.value)"></td>
                      </tr>
                    </table>					
                    <!-- Fim dos dados específicos da tela, reinício do modelo geral -->
                  </td>
                </tr>
              </table>
            </td>
          </tr>
        </table>
      </td>
    </tr>
  </table>
  <!-- Fim do modelo geral -->
</form>
<script language="JavaScript">
   NomeDoProgramaPrincipal  = '/wpgd0016.w';
   NomeDoProgramaDeListagem = '/wpgd0016ls.w';
   NomeDoProgramaDeAjuda    = '/wpgd0016aj.w';
   NomeDoProgramaDeZoom     = '/zoom/zwpgd0016.w';
   
   NomeDoProgramaPrincipal = document.form.aux_dsendurl.value + NomeDoProgramaPrincipal;
   document.form.action = NomeDoProgramaPrincipal;
   
function Incluir(){
  ZeraModoExclusao()
  var vaux = document.form.aux_lspermis.value; 
  if(vaux.substring(0,1) == 'I'){ 
    if(document.form.aux_stdopcao.value == 'i'){ 
      MostraResultado('1','Você já esta no modo de inclusão.'); 
      return false
    } 
    else{ 
      document.form.aux_cddopcao.value='in'; 
      document.form.aux_stdopcao.value='i'
      LimparCampos(); 
      return true
    } 
  } 
  else{ 
    MostraResultado('1','Desculpe, mas você não tem permissão para executar esta função.'); 
    return false
  }
}

function Salvar(){
  ZeraModoExclusao();
  
  var vaux = document.form.aux_lspermis.value; 
  if((vaux.substring(1,2) == 'A') || (document.form.aux_stdopcao.value == 'i')) 
  {
     if(ValidaDados(document.forms[0]))
     {
        document.form.aux_cddopcao.value='sa'; 
        status = 'Salvando. Por favor, aguarde ...';  
        document.form.aux_nrcpfcgc.value =  TiraFormato(document.form.aux_nrcpfcgc.value);
        document.form.submit(); 
        return true;
     } 
     else
     { 
        return false;
     }  
  }
  else
  {
     MostraResultado('1','Desculpe, mas você não tem permissão para executar esta função.'); 
     return false;
  }
}

function Excluir(){
  ZeraModoExclusao();  
  var vaux = document.form.aux_lspermis.value;
   
  if(vaux.substring(2,3) == 'E') { 
    if(document.form.aux_stdopcao.value=='i') { 
      MostraResultado('1','Você esta no modo de inclusão.Selecione o registro apropriado e então selecione a opção exclusão.'); 
      return false
    } 
    else {
      if (!confirm('Confirma Exclusão do Facilitador?')){
         return false;
      }
	  else{
         document.form.aux_cddopcao.value = "ex";
         document.form.submit();
	  }
    } 
  } 
  else { 
    MostraResultado('1','Desculpe, mas você não tem permissão para executar esta função.'); 
    return false
  }	
}

function AbreZoom(ProgramaDeZoom,ProgramaPrincipal,NomeDoCampo,TipoDeZoom,ValorCampo,ValorCampo2,ValorCampo3,ValorCampo4,ValorCampo5,ValorCampo6)
   {
      ZeraModoExclusao()   
      status = 'Processando pesquisa. Por favor, aguarde ...'; 
      if (ValorCampo == null)  ValorCampo = "";
      if (ValorCampo2 == null) ValorCampo2 = "";
      if (ValorCampo3 == null) ValorCampo3 = "";
      if (ValorCampo4 == null) ValorCampo4 = "";
      if (ValorCampo5 == null) ValorCampo5 = "";
      if (ValorCampo6 == null) ValorCampo6 = "";
      if (ValorCampo != "" )  ValorCampo = Substituir(ValorCampo);  
      if (ValorCampo2 != "" ) ValorCampo2 = Substituir(ValorCampo2);  
      if (ValorCampo3 != "" ) ValorCampo3 = Substituir(ValorCampo3);  
      if (ValorCampo4 != "" ) ValorCampo4 = Substituir(ValorCampo4);  
      if (ValorCampo5 != "" ) ValorCampo5 = Substituir(ValorCampo5);  
      if (ValorCampo6 != "" ) ValorCampo6 = Substituir(ValorCampo6);  
      ProgramaPrincipal = Substituir(ProgramaPrincipal);   
      ProgramaDeZoom = document.form.aux_dsendurl.value + ProgramaDeZoom;   
      varurl = ProgramaDeZoom + '?Pesquisa='    + TipoDeZoom  + 
                                '&vprograma='   + ProgramaPrincipal + 
                                '&NomeDoCampo=' + NomeDoCampo + 
                                '&ValorCampo='  + ValorCampo  + 
                                '&ValorCampo2=' + ValorCampo2 + 
                                '&ValorCampo3=' + ValorCampo3 + 
                                '&ValorCampo4=' + ValorCampo4 + 
                                '&ValorCampo5=' + ValorCampo5 + 
                                '&ValorCampo6=' + ValorCampo6;
      WZoom = window.open(varurl,'WZoom','toolbar=no,location=no,diretories=no,status=no,menubar=no,scrollbars=no,resizable=yes,width=580,height=350,screenX=0,screenY=0,top=10,left=10');
      WZoom.focus();	  
   }
   
function FechaZoom(campo,valor,valor2,valor3,valor4,valor5,valor6,valor7,valor8)
{
   ZeraModoExclusao()   
   if (window.WZoom != null)
         {	
            if (WZoom.closed != true)
                  {
                     if (valor != null)
                           top.mainFrame.RetornoDoZoom(campo,valor,valor2,valor3,valor4,valor5,valor6,valor7,valor8);
                     WZoom.close();
                  }
         }
}    
   
function ValidaDados(form){ 
   var msg="";
         
   msg = msg + VE("ca",form.nmfacili,"O Nome do facilitador","nao");
         
   if (msg == "")
      return true
   else{
      MostraResultado('1',msg);
      return false
   }
}

function LimparCampos(){
    document.form.aux_cdfacili.value = "";
	document.form.nmfacili.value = "";
    document.form.dscurric.value = "";
	document.form.dsavalia.value = "";
    focus();
    document.form.nmfacili.focus();
    document.form.nmfacili.select();
}

function ExaminaCampo(Campo){
   if (document.form.aux_stdopcao.value != 'i' & Campo == 'aux_cdfacili' )  {
       document.form.nmfacili.focus();
       document.form.nmfacili.select();
   }      
}
 
function CarregaPrincipal()
{
}

// Tirar os formatos de CPF e CNPJ, deixando somente os numeros
function TiraFormato(campo)
{
   //Retirar a formatação de CPF e CNPJ
   campo = campo.replace(".",""); 
   campo = campo.replace(".","");
   campo = campo.replace(".","");
   campo = campo.replace("/","");
   campo = campo.replace("-","");

   return campo;
}

function verifica_ddd(campo){

   // backspace
   if(event.keyCode==8)
      return true;
   
   // varre o campo em busca de caracteres inválidos e remove-os
   for(var i=0;i<campo.value.length;i++){   
	  if((campo.value.substring(i,i+1)!='0')&&
         (campo.value.substring(i,i+1)!='1')&&
         (campo.value.substring(i,i+1)!='2')&&
         (campo.value.substring(i,i+1)!='3')&&
         (campo.value.substring(i,i+1)!='4')&&
         (campo.value.substring(i,i+1)!='5')&&
         (campo.value.substring(i,i+1)!='6')&&
         (campo.value.substring(i,i+1)!='7')&&
         (campo.value.substring(i,i+1)!='8')&&
         (campo.value.substring(i,i+1)!='9'))	  
    	  campo.value = campo.value.substring(0,i);   
   }
}

function verifica_telefone(campo){

   // backspace
   if(event.keyCode==8)
      return true;
   
   // tira o ponto
   campo.value = campo.value.replace('.','');
   
   // varre o campo em busca de caracteres inválidos e remove-os
   for(var i=0;i<campo.value.length;i++){
   
	  if((campo.value.substring(i,i+1)!='0')&&
         (campo.value.substring(i,i+1)!='1')&&
         (campo.value.substring(i,i+1)!='2')&&
         (campo.value.substring(i,i+1)!='3')&&
         (campo.value.substring(i,i+1)!='4')&&
         (campo.value.substring(i,i+1)!='5')&&
         (campo.value.substring(i,i+1)!='6')&&
         (campo.value.substring(i,i+1)!='7')&&
         (campo.value.substring(i,i+1)!='8')&&
         (campo.value.substring(i,i+1)!='9'))	  
    	  campo.value = campo.value.substring(0,i);   
   }

   if (campo.value.length >= 4)
       campo.value = campo.value.substring(0,4) + '.' + campo.value.substring(4,campo.value.length);
}
	
// não deixa digitar no CPF/CNPJ
document.form.aux_nrcpfcgc.style.border='none';

// se o dds ou o telefone estão zerados coloca como brancos
if(document.form.nrdddfon1.value==0)
   document.form.nrdddfon1.value='';
if(document.form.nrtelefo1.value==0)
   document.form.nrtelefo1.value='';   
if(document.form.nrdddfon2.value==0)
   document.form.nrdddfon2.value='';
if(document.form.nrtelefo2.value==0)
   document.form.nrtelefo2.value='';
if(document.form.nrdddfon3.value==0)
   document.form.nrdddfon3.value='';
if(document.form.nrtelefo3.value==0)
   document.form.nrtelefo3.value='';

</SCRIPT>
</body>
</html>
