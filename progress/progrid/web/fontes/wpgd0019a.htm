<!-- saved from url=(0022)http://internet.e-mail 

Alteracoes: 17/10/2012 - Limitar campos dsdiaeve e dshroeve (Gabriel).
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta name="wsoptions" content="no-output">
<title>Evento</title>
<link href="/cecred/estilos/progrid.css" rel="stylesheet" type="text/css">
</head>
<body>
<form action="#." method="POST" name="form">
<input name="aux_cddopcao" type="hidden"  VALUE="">
<input name="aux_lspermis" type="hidden"  VALUE="">
<input name="aux_nrdrowid" type="hidden"  VALUE="">
<input name="aux_dsretorn" type="hidden"  VALUE="">
<input name="aux_stdopcao" type="hidden"  VALUE="?">
<input name="aux_dsendurl" type="hidden"  VALUE="">
<input name="aux_idevento" type="hidden"  VALUE="">
<input name="aux_idexclui" type="hidden"  VALUE="">
<input name="aux_nmpagina" type="hidden"  VALUE="">
<input name="aux_idinseve" type="hidden"  VALUE="">
<input name="cdagenci" type="hidden"  VALUE="">
<input name="cdcooper" type="hidden"  VALUE="">
<input name="cdlocali" type="hidden"  VALUE="">
<input name="cdabrido" type="hidden"  VALUE="">
<input name="idstaeve" type="hidden"  VALUE="">
<table width="462" border="0" cellpadding="0" cellspacing="0">
    <tr valign="botton">
      <td>
            <table border="0" cellpadding="0" cellspacing="0">
                  <tr>
            <td width="102" align="left" height="15">
                          <table width="100" id="AbaEvento" border="0" cellpadding="0" cellspacing="0">
                            <tr style="cursor:hand;">
                              <td background="/cecred/images/menu/mnu_nle.gif" width="4" height="21"></td>
                              <td width="92" align="center" class="txtTituloHid" onclick="mostraDiv('divEvento')">Evento</td>
                              <td background="/cecred/images/menu/mnu_nld.gif" width="4" height="21"></td>
                            </tr>
                          </table>
                        </td>
                        <td width="102" align="left" height="15">
                          <table width="100" id="AbaHistorico" border="0" cellpadding="0" cellspacing="0">
                            <tr style="cursor:hand;">
                              <td background="/cecred/images/menu/mnu_nle.gif" width="4" height="21"></td>
                              <td width="92" align="center" class="txtTituloHid" onclick="mostraDiv('divHistorico')">Histórico</td>
                              <td background="/cecred/images/menu/mnu_nld.gif" width="4" height="21"></td>
                            </tr>
                          </table>
                        </td>
          </tr>
        </table>
      <td>
    </tr>
  </table>
    <div id="divEvento">
    <table width="460" border="0" cellpadding="0" cellspacing="1" bgColor="#999999">
    <tr valign="top">
      <td>
        <table width="100%" cellpadding="0" cellspacing="00" bgColor="#999999">
          <tr bgColor="#FFFFFF">
           <td>                                 
              <table width="100%" border="0" align="center" cellpadding="0" cellspacing="1">
                <tr>                                    
                  <td height="24" colspan="2" align="right" class="NomeCampo">Evento:</td>
                  <td height="24" colspan="3"><input name="aux_nmevento" type="text" class="Campo" size="40" maxlength="40" readOnly VALUE="NOME DO EVENTO VAI AQUI"></td>
                </tr>                                    
                <tr>                                      
                <tr>                                    
          <td height="24" colspan="2" align="right" class="NomeCampo">PA:</td>
                  <td height="24" colspan="3"><input name="aux_nmresage" type="text" class="Campo" size="40" maxlength="40" readOnly VALUE="NOME DO PA"></td>
                </tr>                                    
                <tr>                                      
                  <td height="24" colspan="2" align="right" class="NomeCampo">Mês:</td>
                  <td height="24" colspan="3"><input name="aux_nrmeseve" type="text" class="Campo" size="40" maxlength="40" readOnly VALUE="OUTUBRO"></td>
                </tr>  
                <tr>
                <tr>                                      
                  <td height="24" colspan="2" align="right" class="NomeCampo">Fornecedor:</td>
                  <td height="24" colspan="2"><input name="aux_nmfornec" type="text" class="Campo" size="40" maxlength="40" readOnly VALUE="OUTUBRO"></td>
                </tr>  
                <tr>
                  <td height="24" colspan=2 class="NomeCampo" align="right">Data início:</td>
                  <td height="24" class="NomeCampo"><input name="dtinieve" type="text" class="Campo" size="8" onkeyup="validaData(this.name,this.value)" ></td>
                                </tr>  
                <tr>
                  <td height="24" colspan=2 class="NomeCampo" align="right">Data término:</td>
                  <td height="24" ><input name="dtfineve" type="text" class="Campo" size="8" onkeyup="validaData(this.name,this.value)"></td>
                </tr>
                <tr>
                  <td height="24" colspan=2 class="NomeCampo" align="right">Dias do Evento:</td>
                  <td height="24" colspan=2 class="NomeCampo"><input name="dsdiaeve" type="text" class="Campo" maxlength="40" VALUE="Quarta-feira"></td>
                 </tr>  
                 <tr>
                 <tr>
                  <td height="24" colspan=2 class="NomeCampo" align="right">Número de Dias do Evento:</td>
                  <td height="24" colspan=2 class="NomeCampo"><input name="qtdiaeve" type="text" class="Campo" size="10" VALUE="0"></td>
                 </tr>  
                 <tr>
                  <td height="24" colspan=2 class="NomeCampo" align="right">Horário:</td>
                  <td height="24" colspan=2><input name="dshroeve" type="text" class="Campo" maxlength="20" VALUE="19:00 as 20:30 horas"></td>
                 </tr>
                 <tr>
                  <td height="24" colspan=2 class="NomeCampo" align="right">Local:</td>
                  <td height="24" colspan=2>
                  <select name="aux_cdlocali" class="Campo"></select></td>
                                 </tr>
                                 <tr>
                  <td height="24" colspan=2 class="NomeCampo" align="right">Abertura:</td>
                  <td height="24" colspan=2>
                  <select name="aux_cdabrido" class="Campo"></select></td>
                 </tr>
              </table>
           </td>   
          </tr>  
        </table>
        </td>
    </tr>
  </table>  
  </div>
<div id="divHistorico">
<table cellpadding="0" cellspacing="1" border="0" bgcolor="#999999" width="460" height="230">
<tr>
  <td height="26" align="left" valign="top">
        <table cellpadding="0" cellspacing="0" border="0" bgcolor="#FFFFFF" width="460" height="230">
        <tr>
          <td height="26" align="left" valign="top">
                <table cellpadding="0" background="/cecred/images/menu/fnd_title.jpg" cellspacing="0" border="0" width="100%" height="26">
                  <tr>
                        <td width="5" height="26" id="separador1" background="/cecred/images/menu/fnd_title.jpg">&nbsp;</td>
                        <td width="80" id="tbhistorico_col1" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos">Data</td>
                        <td width="5" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                        <td id="tbhistorico_col2" align="left" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos">Descrição</td>
                        <td width="15" id="tbhistorico_col3" align="left" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                  </tr>
                </table>
          </td>
        </tr>
        <tr>
          <td align="left" valign="top"> 
                <div style="overflow: auto; height:'229px';">
                        <table id="tbhistorico" cellpadding="0" cellspacing="0" border="0" width="100%">
                                  <!-- INCLUI DADOS -->
                        </table>
                </div>
          </td>
        </tr>
        </table>
 </td>
</tr>
</table>
</div>

<div id="divMotivo">
<table cellpadding="0" cellspacing="1" border="0" bgcolor="#999999" width="460" height="230">
<tr>
  <td height="26" align="left" valign="top">
    <table cellpadding="0" border="0" cellspacing="0" bgColor="#FFFFFF" width="100%" height="100%">
          <tr>
                  <td width="5" height="26" align="left" background="/cecred/images/menu/fnd_title.jpg">&nbsp;</td>
            <td height="26" align="left" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos">Motivo</td>
          </tr>
      <tr>
                  <td width="5" height="26" align="left">&nbsp;</td>
                <td align="left" valign="top"><textarea name="aux_motivo" class="CampoTextArea" cols="75" rows="10"></textarea></td>
          </tr>
    </table>
        </td>
  </tr>
</table>
</div>
  
  
  <table align=center>
  <tr>
    <td align="center" valign="bottom" colspan="4" height="8"></td>
  </tr>
  <tr>
    <td align="center" valign="bottom">
       <div><img style="cursor:hand" src="/cecred/images/botoes/btn_salvar.gif" onClick="Salvar()"></div>
    </td>
    <td align="center" valign="bottom">
       <div id="btncancela"><img style="cursor:hand" src="/cecred/images/botoes/btn_cancelar_evento.gif" onClick="Cancelar()"></div>
    </td>
    <td align="center" valign="bottom">
       <div id="btnreativa"><img style="cursor:hand" src="/cecred/images/botoes/btn_reativar_evento.gif" onClick="Reativa()" alt="Reativa Evento"></div>
    </td>
        <td align="center" valign="bottom">
       <div><img style="cursor:hand" src="/cecred/images/botoes/btn_excluir_botao.gif" onClick="Excluir()"></div>
    </td>
    <td align="center" valign="bottom">
       <div><img style="cursor:hand" src="/cecred/images/botoes/btn_fechar.gif" onClick="window.close();"></div>
    </td>              
  </tr>
  </table>
</form>
</body>
</html>
<SCRIPT LANGUAGE="JAVASCRIPT">
   NomeDoProgramaPrincipal  = '/wpgd0019a.w';
   NomeDoProgramaDeListagem = '/wpgd0019als.w';
   NomeDoProgramaDeAjuda    = '/wpgd0019aaj.w';
   
   NomeDoProgramaPrincipal = document.form.aux_dsendurl.value + NomeDoProgramaPrincipal;
   document.form.action = NomeDoProgramaPrincipal;
   
   if (parseInt(document.form.idstaeve.value)==2) {
      document.all.btncancela.style.display='none';
      document.all.btnreativa.style.display='inline';
   }
   else
    {
      document.all.btncancela.style.display='inline';
      document.all.btnreativa.style.display='none';
   }
   

function ValidaDados(form){ 
    
        var msg="";
         
        //msg = msg + top.frcod.VE("ca",form.dseixtem,"A descrição do eixo temático","nao");
      
        if (msg == "")
       return true
    else
         {
           alert(msg);
           return false
         }
}

function LimparCampos()
{
   document.form.cdevento.value = '';
   document.form.cdeixtem.value = '';
}

function Recarrega(){
  document.form.cdeixtem.value = document.form.aux_cdeixtem.value;
  document.form.cdevento.value = document.form.aux_cdevento.value;
  document.form.submit();  
}

function CarregaPrincipal()
{  
} 

function Incluir()
{
   var vaux = document.form.aux_lspermis.value; 
   if (vaux.substring(0,1) == 'I'){ 
          if (document.form.aux_stdopcao.value == 'i'){ 
                   alert('Você já esta no modo de inclusão'); 
                   return false
                } 
             else{ 
                   document.form.aux_cddopcao.value ='in'; 
                   document.form.aux_stdopcao.value ='i';
                   LimparCampos(); 
                   return true
                } 
       } 
    else{ 
          alert('Desculpe, mas você não tem permissão para executar esta função.'); 
          return false
       }
}

function Salvar(){
   //ZeraModoExclusao();
   var vaux = document.form.aux_lspermis.value; 
   if ((vaux.substring(1,2) == 'A') || (document.form.aux_stdopcao.value == 'i')) { 
      if (ValidaDados(document.forms[0])) {
         document.form.aux_cddopcao.value='sa';
         status = 'Salvando. Por favor, aguarde ...';
         document.form.submit(); 
         return true;
      } 
      else { 
            return false;
      }  
   }
   else { 
         alert('Desculpe, mas você não tem permissão para executar esta função.'); 
         return false;
   }
}
function Reativa(){
   var vaux = document.form.aux_lspermis.value; 
   if ((vaux.substring(1,2) == 'A') || (document.form.aux_stdopcao.value == 'i')) { 
      if (ValidaDados(document.forms[0])) {
         document.form.aux_cddopcao.value='sa';
         if (confirm("Deseja realmente reativar esse evento ?")){if (document.form.aux_idexclui.value=prompt('Motivo da Reativação do Evento','')){document.form.idstaeve.value="01";document.form.submit();}}
           
         return true;
      } 
      else { 
            return false;
      }  
   }
   else { 
         alert('Desculpe, mas você não tem permissão para executar esta função.'); 
         return false;
   }
}
function Cancelar(){
   
   var vaux = document.form.aux_lspermis.value; 
   if ((vaux.substring(1,2) == 'A') || (document.form.aux_stdopcao.value == 'i')) { 
      if (ValidaDados(document.forms[0])) {
         document.form.aux_cddopcao.value='sa';
                 
                 // exestem pré-inscritos
                 if((document.form.aux_idinseve.value=="yes")&&
            (!confirm("Existem pré-inscritos neste evento, deseja continuar?")))
                        return false;         
                                  
         if (confirm("Deseja realmente cancelar esse evento ?")){
                         if (document.form.aux_idexclui.value=prompt('Motivo do Cancelamento do Evento','')){
                            document.form.idstaeve.value="02";
                                document.form.submit();
                        }
                 }           
         return true;
      } 
      else { 
            return false;
      }  
   }
   else { 
         alert('Desculpe, mas você não tem permissão para executar esta função.'); 
         return false;
   }
}

function Excluir(){
   var vaux = document.form.aux_lspermis.value; 
   if (vaux.substring(2,3) == 'E') { 
         document.form.aux_cddopcao.value='ex';
                 
                 // exestem pré-inscritos
                 if((document.form.aux_idinseve.value=="yes")&&
            (!confirm("Existem pré-inscritos neste evento, deseja continuar?")))
                        return false;
                        
                if (confirm("Deseja realmente excluir este evento?"))
                    document.form.submit();
                else
                        return false;
   }
   else { 
         alert('Desculpe, mas você não tem permissão para executar esta função.'); 
         return false;
   }
}

function mostraDiv(nomediv)
{
  var nomeaba = '';

  if (nomediv == '') {
     nomediv = 'divEvento';
  }

  if (nomediv=='divEvento')  {nomeaba='AbaEvento';}
  if (nomediv=='divHistorico') {nomeaba='AbaHistorico';}
  
  // guarda a página atual
  document.form.aux_nmpagina.value = nomediv;

  // Define todas as abas como não selecionadas
  document.all.AbaEvento.rows[0].cells[0].background="/cecred/images/menu/mnu_nle.gif";
  document.all.AbaEvento.rows[0].cells[1].background="/cecred/images/menu/mnu_nlc.gif";
  document.all.AbaEvento.rows[0].cells[2].background="/cecred/images/menu/mnu_nld.gif";
  document.all.AbaEvento.rows[0].cells[1].className="txtTituloHid";

  document.all.AbaHistorico.rows[0].cells[0].background="/cecred/images/menu/mnu_nle.gif";
  document.all.AbaHistorico.rows[0].cells[1].background="/cecred/images/menu/mnu_nlc.gif";
  document.all.AbaHistorico.rows[0].cells[2].background="/cecred/images/menu/mnu_nld.gif";
  document.all.AbaHistorico.rows[0].cells[1].className="txtTituloHid";

  // Altera a imagem da aba selecionada
  document.all[nomeaba].rows[0].cells[0].background="/cecred/images/menu/mnu_sle.gif";
  document.all[nomeaba].rows[0].cells[1].background="/cecred/images/menu/mnu_slc.gif";
  document.all[nomeaba].rows[0].cells[2].background="/cecred/images/menu/mnu_sld.gif";
  document.all[nomeaba].rows[0].cells[1].className="txtTituloVis";

  
  // apaga todas as DIV
  document.all.divEvento.style.display = 'none';
  document.all.divHistorico.style.display = 'none';
  document.all.divMotivo.style.display = 'none';
  

  

  // ativa a DIV escolhida
  document.all[nomediv].style.display = 'block';
}
function mostraHistorico(){

  var row; var cell;

  var cor = '#F7F7F7';
  
  // limpa a tabela de historicos, menos a 1ª linha - linha do cabecalho
  for (var i=document.all.tbhistorico.rows.length; i>1; i--)
      document.all.tbhistorico.deleteRow(i-1);
  for(i=0;i<mhistorico.length;i++){      // insere linhas na tabela de historicos
     row=tbhistorico.insertRow();  // nova linha 
     if (cor == '#FFFFFF')
        cor = '#F7F7F7';
     else
        cor = '#FFFFFF';
     row.bgColor = cor;
         
         //separador
     cell=row.insertCell();
     cell.className = 'txtNormal';
     cell.width = document.all.separador1.width;
     cell.height = 26;
     cell.innerText='';

     cell=row.insertCell();      // primeira celula da linha (data do historico)
     cell.className = 'txtNormal';
     cell.width = document.all.tbhistorico_col1.width;
     cell.height = 26;
     cell.align = 'left';
     cell.innerText=mhistorico[i].dthist; // fim primeira celula (data do historico)
         
         //separador
     cell=row.insertCell();
     cell.className = 'txtNormal';
     cell.width = document.all.separador1.width;
     cell.height = 26;
     cell.innerText='';
         
     cell=row.insertCell();      // segunda celula da linha (descricao do historico)
     cell.className = 'txtNormal';
     cell.width = document.all.tbhistorico_col2.width;
     cell.height = 26;
     cell.align = 'left';
     cell.innerText=mhistorico[i].dshist; // fim segunda celula (descricao do historico)

         //separador
     cell=row.insertCell();
     cell.className = 'txtNormal';
     cell.width = document.all.tbhistorico_col3.width;
     cell.height = 26;
     cell.innerText='';
  }  
}

// valida a digitação da data nos campos
function validaData(campo,valor){

   if((event.keyCode==9)||    // TAB
      (event.keyCode==16)){   // BACK-TAB
          return true;
   } 

   // tira as barras
   document.form[campo].value = document.form[campo].value.replace("/","");
   document.form[campo].value = document.form[campo].value.replace("/","");
   
   // data são 8 caracteres
   document.form[campo].value = document.form[campo].value.substring(0,8);

   // varre o campo em busca de caracteres inválidos e remove-os
   for(var i=0;i< document.form[campo].value.length;i++){
      
          if((document.form[campo].value.substring(i,i+1)!='0')&&
         (document.form[campo].value.substring(i,i+1)!='1')&&
         (document.form[campo].value.substring(i,i+1)!='2')&&
         (document.form[campo].value.substring(i,i+1)!='3')&&
         (document.form[campo].value.substring(i,i+1)!='4')&&
         (document.form[campo].value.substring(i,i+1)!='5')&&
         (document.form[campo].value.substring(i,i+1)!='6')&&
         (document.form[campo].value.substring(i,i+1)!='7')&&
         (document.form[campo].value.substring(i,i+1)!='8')&&
         (document.form[campo].value.substring(i,i+1)!='9'))          
              document.form[campo].value = document.form[campo].value.substring(0,i);   
   }   
      
   // valida o dia e formata a data - DD/MM
   if(document.form[campo].value.length > 2){
      if((document.form[campo].value.substring(0,2) > "31")||
         (document.form[campo].value.substring(0,2) == "00")){
             alert("Dia inválido! Deve ser entre 01 e 31!");
                 document.form[campo].value="";
                 return false;
          }
   
      document.form[campo].value = document.form[campo].value.substring(0,2) + "/" +
                                       document.form[campo].value.substring(2,document.form[campo].value.length);
   }                                                           

   // valida o mes e formata a data - MM/AAAA
   if(document.form[campo].value.length > 5){
      if((document.form[campo].value.substring(3,5) > "12")||
         (document.form[campo].value.substring(3,5) == "00")){
             alert("Mês inválido! Deve ser entre 01 e 12!");
                 document.form[campo].value="";
                 return false;
          }
             
      document.form[campo].value = document.form[campo].value.substring(0,5) + "/" +
                                       document.form[campo].value.substring(5,document.form[campo].value.length);                                                                    
   }
}

mostraDiv(document.form.aux_nmpagina.value);
mostraHistorico();
</SCRIPT>
