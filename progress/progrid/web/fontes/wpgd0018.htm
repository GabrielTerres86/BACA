<html>
<head>
<meta name="AUTHOR" content="Rosangela">
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta name="wsoptions" content="no-output">
<meta name="GENERATOR" content="Microsoft FrontPage 4.0">
<meta http-equiv="Cache-Control" content="No-Cache">
<meta http-equiv="Pragma"        content="No-Cache">
<meta http-equiv="Expires"       content="0">
<title>Custos Orçados</title>
<link href="/cecred/estilos/progrid.css" rel="stylesheet" type="text/css">
<script SRC="/cecred/jsbiblio/sorttable.js"></script>
<script SRC="/cecred/jsbiblio/biblio.js"></script>
<script SRC="/cecred/jsbiblio/frcod.js"></script>
<script SRC="/modelo/js/funcoes.js"></script>
</head>
<body style="margin-left: 3px; ">
<script language="JavaScript">
   NomeDoProgramaPrincipal  = '/wpgd0018.w';
   NomeDoProgramaDeListagem = '/wpgd0018ls.w';
   NomeDoProgramaDeAjuda    = '/wpgd0018aj.w';
   NomeDoProgramaDeZoom     = '/zoom/zwpgd0018.w';
</script>
<form action="#." method="POST" name="form"> 
  <input type="hidden" name="aux_dsendurl" value="">
  <input type="hidden" name="aux_idevento" value="">
  <input type="hidden" name="aux_cddopcao" value="">
  <input type="hidden" name="aux_nrdrowid" value="">
  <input type="hidden" name="aux_lspermis" value="">
  <input type="hidden" name="aux_dsretorn" value="">
  <input type="hidden" name="aux_stdopcao" value="">
  <input type="hidden" name="aux_idexclui" value="">
  <input type="hidden" name="aux_cdevento" value="">
  <input type="hidden" name="aux_vlcusind" value="">
  <input type="hidden" name="aux_lstcusto" value="">
  <input type="hidden" name="aux_lstnovos" value="">
  <input type="hidden" name="aux_lsqtdkit" value="">
  <input type="hidden" name="aux_lsvlrkit" value="">
  <input type="hidden" name="aux_lsqtdbri" value="">
  <input type="hidden" name="aux_lsvlrbri" value="">
  <input type="hidden" name="aux_idecusto" value="">
  <input type="hidden" name="aux_contarow" value="">
  <input type="hidden" name="aux_maxrows"  value="">

  <!-- Para o carregamento dos registros em partes -->
  <input type="hidden" name="aux_carregar" value="">
  <input type="hidden" name="aux_reginils" value="">
  <input type="hidden" name="aux_regfimls" value="">

  <input type="hidden" name="pagina" value="">

  <!-- Inicio do modelo -->
  <div id="Layer1" style="position:absolute; border:0px; width:35px; height:35; z-index:1; left: 18px; top: 2px; visibility: ;"><img src="/cecred/images/icones/ico_fornecedor.gif" width="28" height="32" align="bottom"></div>
  <table width="575" height="360"  border="0" align="left" cellpadding="0" cellspacing="0" background="/cecred/images/geral/guia_fundo.gif">
    <tr>
      <td height="20" colspan="5">
        <table width="100%" border="0" cellpadding="0" cellspacing="0">
          <tr>
            <td width="11"><img src="/cecred/images/geral/guia_esquerda.gif" width="11" height="21"></td>
            <td width="56"><img src="/cecred/images/geral/spacer.gif" width="48" height="10"></td>
            <td width="395" height="20" class="linkGuia" align="left">Custos Orçados</td>
            <td width="103" class="linkGuia" align="right">wpgd0018</td>
            <td width="13" align="right" valign="middle" class="linkGuia"><img src="/cecred/images/geral/guia_direita.gif" width="11" height="21"></td>
          </tr>
        </table>
      </td>
    </tr>
    <tr valign="top" bgcolor="#FFFFFF">
      <td colspan="5">
        <table width="100%" height="100%"  border="0" align="left" cellpadding="0" cellspacing="1" bgcolor="#999999">
          <tr>
            <td height="50" valign="top" bgcolor="#FFFFFF">
              <table width="65%" border="0" align="center" cellspacing="1">
                <tr>                                
                  <td width="1%" height="15" align="left">&nbsp;</td>
                  <td align="left">&nbsp;</td>
                  <td width="1%" align="left">&nbsp;</td>
                </tr>
                <tr>
                  <td class="NomeCampo"><div align="right" class="NomeCampo">Agenda:</div></td>
                  <td class="NomeCampo"><input type="text" name="aux_dtanoage" size="4" class="Campo" onChange="document.form.submit();"></td>
                  <td class="NomeCampo"><div align="right" class="NomeCampo">Cooperativa: </div></td>
                  <td class="NomeCampo" ><select name="aux_cdcooper" class="Campo" id="cdcooper" onChange="document.form.submit();">
                  </select></td>
                </tr>
               </table>
             </td>
           </tr>
            <tr>
            <td height="285" valign="top" bgcolor="#FFFFFF">
              <table width="100%" height="100%"   border="0" cellpadding="0" cellspacing="0">
                <tr>
                                  <td height="5" align="left"></td>
                                </tr>  
                <tr>
                  <td height="5" align="left" valign="top">
                    <!-- Interrupcao do modelo - início das abas -->
                    <table height="15" border="0" align="left" cellpadding="0" cellspacing="0" bgcolor="#FFFFFF">
                      <tr align="center">
                                          <td width="2" height="15">&nbsp;</td>
                        <td width="100" height="15">
                          <table width="100" id="AbaEventos" border="0" cellpadding="0" cellspacing="0">
                            <tr style="cursor:hand">
                              <td background="/cecred/images/menu/mnu_nle.gif" width="4" height="21"></td>
                              <td width="92" align="center" class="txtTituloHid" onclick="mostraDiv('divEventos');" onChange="document.form.aux_carregar.value='';">Eventos</td>
                              <td background="/cecred/images/menu/mnu_nld.gif" width="4" height="21"></td>
                            </tr>
                          </table>
                        </td>
                        <td width="107" height="15">
                          <table width="100" id="AbaIndiretos" border="0" cellpadding="0" cellspacing="0">
                            <tr style="cursor:hand">
                               <td background="/cecred/images/menu/mnu_nle.gif" width="4" height="21"></td>
                              <td width="92" align="center" class="txtTituloHid" onclick="mostraDiv('divIndiretos'); document.form.aux_carregar.value='';"> Diversos </td>
                              <td background="/cecred/images/menu/mnu_nld.gif" width="4" height="21"></td>
                            </tr>
                          </table>
                        </td>
                                                <td width="100" height="15">
                          <table width="100" id="AbaSocios" border="0" cellpadding="0" cellspacing="0">
                            <tr style="cursor:hand">
                              <td background="/cecred/images/menu/mnu_nle.gif" width="4" height="21"></td>
                              <td width="92" align="center" class="txtTituloHid" onclick="mostraDiv('divSocios')">Novos S&oacute;cios </td>
                              <td background="/cecred/images/menu/mnu_nld.gif" width="4" height="21"></td>
                            </tr>
                          </table>
                        </td>
                        <!-- Links de Adicionar -->
                        <td width="361" align="right" class="txtTituloHid">
                                                  <div id="adicionar">
                                                         <a href="#." onclick="mudaAdicionar(); document.form.aux_carregar.value='';">Adicionar</a>
                                                  </div>
                                                </td>                         
                      </tr>
                                          <tr>
                                                <td colspan="5" height="2" align="left" background="/cecred/images/menu/mnu_slc.gif"></td>
                                          </tr>
                                        </table>                                   
                                        </td>   
                                 </tr>
                 <tr>
                  <td height="5" align="left" valign="top">
                    <div id="divEventos">
                      <table width="100%" border="0" align="center" cellpadding="0" cellspacing="0">
                        <tr>
                          <td align="left" valign="top">
                              <table width="100%" border="0" cellpadding="0" cellspacing="0" class="dataTable">
                                <tr>
                                  <td id="separador1" width="5" background="/cecred/images/menu/fnd_title.jpg">&nbsp;</td>
                                  <td width="200" height="25" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos" id="tbevento_col1">Evento</td>
                                  <td width="5" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                                  <td width="20" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos" id="tbevento_col11" >&nbsp;</td>
                                </tr>
                              </table>
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <div style="overflow: auto; height:'185';">
                              <table id="tbevento" width="100%" border="0" cellpadding="0" cellspacing="0" class="dataTable">
                                                                        <!-- INCLUI DADOS -->
                              </table>
                            </div>
                          </td>
                        </tr>
                        <tr>
                          <td align="right" valign="bottom" scope="col">
                            <img id="anteriores" style="cursor:hand" src="/cecred/images/botoes/btn_anterior.gif" onClick="carrega_registros(this.id);" title="Anterior">
                            <img id="proximos" style="cursor:hand" src="/cecred/images/botoes/btn_posterior.gif"  onClick="carrega_registros(this.id);" title="Próximo">
                          </td>                                                                
                        </tr> 
                      </table>
                    </div>
                    <div id="divSocios">
                      <table width="100%" height="100%" border="0" align="center" cellspacing="0">
                        <tr>
                          <td class="NomeCampo">
                            &nbsp; Valor Unit&aacute;rio do kit:
                              <input type="text" class="Campo" name="aux_vlunikit" style="text-align:right" size="5" onChange="Totaliza('')">
                            &nbsp; &nbsp;Valor Unit&aacute;rio do brinde:
                            <input type="text" class="Campo" name="aux_vlunibri" style="text-align:right" size="5" onChange="Totaliza('')">
                          </td>
                        </tr>
                        <tr>
                          <td>
                              <table width="560" border="0" cellpadding="0" cellspacing="0" class="dataTable">
                                <tr>
                                  <td width="5" background="/cecred/images/menu/fnd_title.jpg">&nbsp;</td>
                                  <td width="140" height="25" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos" id="tbpac_col1">PA</td>
                                  <td width="5" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                                  <td width="105" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos" id="tbpac_col2" title="Qtd prevista de kits"> Qtd Kits </td>
                                  <td width="5" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                                  <td width="92" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos" id="tbpac_col3" title="Valor total previsto com  custo dos kits"> $ Kits</td>
                                  <td width="5" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                                  <td width="131" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos" id="tbpac_col4" title="Qtde prevista de brindes"> Qtd brindes</td>
                                  <td width="5" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                                  <td width="131" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos" id="tbpac_col5" title="Valor total previsto com custo dos brindes">$ Brindes</td>
                                  <td width="5" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                                  <td width="90" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos" id="tbpac_col6" title="Valor previsto com custo de novos sócios">$ Total</td>
                                </tr>
                              </table>
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <div style="overflow: auto; height:'185';">
                              <table id="tbpac" width="560" border="0" cellpadding="0" cellspacing="0" class="dataTable">
                              </table>
                            </div>
                          </td>
                        </tr>
                        <tr>
                          <td height="15" align="center" valign="bottom">
                              <input name="imageField" type="image" onClick="SalvarNovos();" style="cursor:hand " src="/cecred/images/botoes/btn_salvar.gif" width="60" height="20">
                          </td>
                        </tr>
                      </table>
                    </div>
                    <div id="divIndiretos">
                      <table width="100%" height="100%" border="0" align="center" cellpadding="0">
                        <tr>
                          <td align="left" valign="top">
                              <table width="100%" border="0" cellpadding="0" cellspacing="0" class="dataTable">
                                <tr>
                                  <td width="5" background="/cecred/images/menu/fnd_title.jpg">&nbsp;</td>
                                  <td width="330" height="25" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos" id="tbcusto_col1">Despesa</td>
                                  <td width="5" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                                  <td width="210" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos" id="tbcusto_col2" title="Honorários">Valor</td>
                                  <td width="5" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                                  <td width="20" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos" id="tbcusto_col3" >&nbsp;</td>
                                </tr>
                              </table>
                          </td>
                        </tr>
                                                <tr>
                          <td align="left" valign="top">
                            <div style="overflow: auto; height:'180';">
                              <table id="tbcusto" width="100%" border="0" cellpadding="0" cellspacing="0" class="dataTable">
                              </table>
                            </div>
                          </td>
                        </tr>
                        <tr>
                          <td height="15" align="center" valign="bottom">
                              <input name="imageField" type="image" onClick="SalvarIndiretos();" style="cursor:hand " src="/cecred/images/botoes/btn_salvar.gif" width="60" height="20">
                          </td>
                        </tr>
                      </table>
                    </div>
                  </td>
                </tr>
              </table>
            </td>
          </tr>
        </table>
      </td>
    </tr>
  </table>
</div>
</form>
   <script language="JavaScript">

NomeDoProgramaPrincipal = document.form.aux_dsendurl.value + NomeDoProgramaPrincipal +' ?aux_idevento=' + document.form.aux_idevento.value;
document.form.action = NomeDoProgramaPrincipal;

function ValidaDados(form)
{
   var msg="";

   /*if(document.form.aux_vlcusind.length > 1) 
   {
      for(i=0;i<document.form.aux_vlcusind.length; i++)
         msg = msg + top.frcod.VE("de",form.aux_vlcusind[i],"Valor","nao",0,9999);

   }
   else
      msg = msg + top.frcod.VE("de",form.aux_vlcusind,"Valor","nao",0,9999);*/

   if (msg == "")
     return true;
   else
   {
     top.frcod.MostraResultado('1',msg);
     return false;
   }
   
}

function LimparCampos()
{

}

function CarregaPrincipal () 
{
   //top.topFrame.document.all.titulo.innerHTML = 'Custo dos Eventos - ' + document.form.aux_idevento.value;
}

// Traz as informações atualizadas do banco de dados
function Recarrega(){
  document.form.submit();  
}

function Incluir()
{
   ZeraModoExclusao();
   var vaux =document.form.aux_lspermis.value; 
   if (vaux.substring(0,1) == 'I') 
       { 
          if (document.form.aux_stdopcao.value == 'i') 
                { 
                   MostraResultado('1','Você já esta no modo de inclusão'); 
                   return false
                } 
             else 
                { 
                   document.form.aux_cddopcao.value='in';
                   document.form.aux_stdopcao.value='i'
                   LimparCampos(); 
                   return true
                } 
       } 
    else 
       { 
          MostraResultado('1','Desculpe, mas você não tem permissão para executar esta função.'); 
          return false
       }
}

function Salvar()
{
   ZeraModoExclusao();
   var vaux = document.form.aux_lspermis.value; 
   if ((vaux.substring(1,2) == 'A') || (document.form.aux_stdopcao.value == 'i')) { 
        if ( document.form.aux_cddopcao.value!='sa')  {
           if (ValidaDados(document.forms[0])) {
               document.form.aux_cddopcao.value='sa'; 
               status = 'Salvando. Por favor, aguarde ...'; 
               document.form.submit(); 
               return true;
            } 
            else { 
              return false;
            }  
        } 
   }
   else { 
         MostraResultado('1','Desculpe, mas você não tem permissão para executar esta função.'); 
         return false;
   }
}


// Funcoes declaradas para manter compatilibidade com as funcoes da biblioteca padrão
function Habilita(){}
// Funcoes declaradas para manter compatilibidade com as funcoes da biblioteca padrão
function HabilitaSalvar(){}

function FechaZoom(campo,valor,valor2,valor3,valor4,valor5,valor6,valor7,valor8)
   {
      ZeraModoExclusao();   
      if (window.WZoom != null)
            {  
               alert('1');
               if (WZoom.closed != true)
                     {
                        alert('2');
                        WZoom.close();
                     }
            }
   }
   
// Preenche a tabela de Eventos com seus custos
function mostraEventos(){

  var row; var cell;

  var cor='#F7F7F7';
  
  // limpa a tabela de Eventos, menos a 1ª linha - linha do cabecalho
  for (var i=document.all.tbevento.rows.length; i>0; i--)
      document.all.tbevento.deleteRow(i-1);                

  for(i=0;i<mevento.length;i++) // insere linhas na tabela de eventos
  { 
     // verifica se os dados são da cooperativa selecionada na tela
     if (document.form.aux_cdcooper.value == mevento[i].cdcooper) 
     {

        row=tbevento.insertRow();  
        //row.id=mevento[i].cdevento;
        //row.ondblclick=InsereCusto;

        if (cor == '#FFFFFF')
           cor = '#F7F7F7';
        else
           cor = '#FFFFFF';
      
        row.bgColor = cor;
        //row.title = 'Duplo-clique para lançar os custos por PA';
        //row.style.cursor = 'hand';
                   
        cell=row.insertCell();   // Separador
        cell.className = 'txtNormal';
        cell.height = 26;
        cell.align = 'left';
                cell.width= document.all.separador1.width;
        cell.innerText='';
        
        cell=row.insertCell();         // primeira celula da linha (descricao do evento)
        cell.className = 'txtNormal';
        cell.height = 26;
        cell.align = 'left';
        cell.title = mevento[i].nmevento;
        cell.id=mevento[i].cdevento;
        cell.onclick=InsereCusto;
        cell.width = document.all.tbevento_col1.width;
        linky='<a href="#.">' + mevento[i].nmevento + '</a>';
        cell.innerHTML= linky;

        /*cell=row.insertCell();   // Separador
        cell.className = 'txtNormal';
        cell.width= 1;
        cell.height = 26;
                cell.width= document.all.separador1.width;
        cell.align = 'left';
        cell.innerText='';
   
        // 1 - Honorários
        cell=row.insertCell();         
        cell.className = 'txtNormal';
        cell.height = 26;
        cell.align = 'right';
        cell.style.textAlign='right';
                cell.width = document.all.tbevento_col2.width;
        cell.innerText=mevento[i].vlhonora;

        cell=row.insertCell();   // Separador
        cell.className = 'txtNormal';
        cell.height = 26;
        cell.width= document.all.separador1.width;
        cell.align = 'left';
        cell.innerText='';
   
        // 2 - Local
        cell=row.insertCell();         
        cell.className = 'txtNormal';
        cell.height = 26;
        cell.align = 'right';
        cell.style.textAlign='right';
        cell.width = document.all.tbevento_col3.width;
        cell.innerText=mevento[i].vlrlocal;

        cell=row.insertCell();   // Separador
        cell.className = 'txtNormal';
        cell.height = 26;
        cell.width= document.all.separador1.width;
        cell.align = 'left';
        cell.innerText='';
   
        // 3 - Alimentação
        cell=row.insertCell();         
        cell.className = 'txtNormal';
        cell.height = 26;
        cell.align = 'right';
        cell.style.textAlign='right';
        cell.width = document.all.tbevento_col4.width;
        cell.innerText=mevento[i].vlalimen;

        cell=row.insertCell();   // Separador
        cell.className = 'txtNormal';
        cell.height = 26;
                cell.width= document.all.separador1.width;
        cell.align = 'left';
        cell.innerText='';
   
        // 4 - Material
        cell=row.insertCell();         
        cell.className = 'txtNormal';
        cell.height = 26;
        cell.align = 'right';
        cell.style.textAlign='right';
        cell.width = document.all.tbevento_col5.width;
        cell.innerText=mevento[i].vlmateri;

        cell=row.insertCell();   // Separador
        cell.className = 'txtNormal';
        cell.height = 26;
                cell.width= document.all.separador1.width;
        cell.align = 'left';
        cell.innerText='';
   
        // 5 - Transportes
        cell=row.insertCell();         
        cell.className = 'txtNormal';
        cell.height = 26;
        cell.align = 'right';
        cell.style.textAlign='right';
                cell.width = document.all.tbevento_col6.width;
        cell.innerText=mevento[i].vltransp;

        cell=row.insertCell();   // Separador
        cell.className = 'txtNormal';
        cell.height = 26;
                cell.width= document.all.separador1.width;
        cell.align = 'left';
        cell.innerText='';
   
        // 6 - Brindes
        cell=row.insertCell();         
        cell.className = 'txtNormal';
        cell.height = 26;
        cell.align = 'right';
        cell.style.textAlign='right';
                cell.width = document.all.tbevento_col7.width;
        cell.innerText=mevento[i].vlbrinde;

        cell=row.insertCell();   // Separador
        cell.className = 'txtNormal';
        cell.height = 26;
                cell.width= document.all.separador1.width;
        cell.align = 'left';
                
        cell.innerText='';
   
        // 7 - Divulgação
        cell=row.insertCell();         
        cell.className = 'txtNormal';
        cell.height = 26;
        cell.align = 'right';
        cell.style.textAlign='right';
                cell.width = document.all.tbevento_col8.width;
        cell.innerText=mevento[i].vldivulg;
                
        cell=row.insertCell();   // Separador
        cell.className = 'txtNormal';
        cell.height = 26;
                cell.width= document.all.separador1.width;
        cell.align = 'left';
        cell.innerText='';
   
        // 8 - Outros
        cell=row.insertCell();         
        cell.className = 'txtNormal';
        cell.height = 26;
        cell.align = 'right';
        cell.style.textAlign='right';
                cell.width = document.all.tbevento_col9.width;
        cell.innerText=mevento[i].vloutros;

        cell=row.insertCell();   // Separador
        cell.className = 'txtNormal';
        cell.height = 26;
                cell.width= document.all.separador1.width;
        cell.align = 'left';
        cell.innerText='';

        // Total
        cell=row.insertCell();         
        cell.className = 'txtNormal';
        cell.height = 26;
        cell.align = 'right';
        cell.style.textAlign='right';
                cell.width = document.all.tbevento_col10.width;
        cell.innerText=mevento[i].ttevento;*/

        cell=row.insertCell();   // Separador
        cell.className = 'txtNormal';
        cell.height = 26;
                cell.width= document.all.separador1.width;
        cell.align = 'left';
        cell.innerText='';
            
        // Botão de Excluir
        cell=row.insertCell();   
        cell.className = 'txtNormal';
        cell.align = 'left';
        cell.height = 26;         
                cell.width = document.all.tbevento_col11.width;
        linky='<a href="#." onClick=ExEvento(' + mevento[i].cdevento + '); class="linkGuia"><img src="/cecred/images/botoes/btn_excluir.gif" border="0" title="Excluir"></a>';
        cell.innerHTML=linky; 

       // guarda o ROWID do 1º da lista
       if(i==0)
          document.form.aux_reginils.value = mevento[i].nrdrowid;
              
       // guarda o ROWID do último da lista
       if(i==mevento.length -1)
          document.form.aux_regfimls.value = mevento[i].nrdrowid;        

     } // if (document.form.aux_cdcooper.value == mevento[i].cdcooper)
  } // for(i=0;i<mevento.length;i++)
  
  //completa a tabela, caso necessário
  //PreencheBrancos(tbevento, 0, (7 - tbevento.rows.length), 11);
  
}

// Abre a janela para a seleção de eventos para lançar custos
function AdEvento(){

   VarURL = document.form.aux_dsendurl.value  + '/wpgd0018a.htm' 
      + '?aux_idevento=' + document.form.aux_idevento.value
      + '&aux_dtanoage=' + document.form.aux_dtanoage.value
      + '&aux_cdcooper=' + document.form.aux_cdcooper.value;
   window.open(VarURL,'','toolbar=no,location=no,diretories=no,status=no,menubar=no,scrollbars=yes,resizable=no,width=640,height=380,top=10,left=10');   
}

// Exclui os custos do evento selecionado
function ExEvento(evento){

   // Verifica se o usuário tem permissão de exclusão
   if (document.form.aux_lspermis.value.substring(2,3) != 'E'){ 
      alert('Desculpe, mas você não tem permissão para executar esta função.'); 
      return false;
   }

   if(evento != "")   {
      if (!confirm('Confirma Exclusão do Evento?')){
         return false;
      }

      document.form.aux_cdevento.value = evento;
      document.form.aux_cddopcao.value = "exe";
      document.form.submit();
   }
}

// função que preenche tabelas com linhas em branco
function PreencheBrancos(tabela,limpa,numlinhas,numcolunas)
{
   if (limpa == 1) {
      for (var i=tabela.rows.length; i>1; i--)
         tabela.deleteRow(i-1); 
   }

   for(i=0;i<numlinhas;i++){
      row=tabela.insertRow();
      for(j=0;j<numcolunas;j++)
      {
                 cell=row.insertCell();
         cell.height = 26;
         cell.width = 20;
      }
   }
}

// Abre a tela de distribuição de custos entre os PAs
function InsereCusto()
{
   VarURL = document.form.aux_dsendurl.value  + '/wpgd0018b.htm' 
      + '?aux_cdevento=' + this.id
      + '&aux_cdcooper=' + document.form.aux_cdcooper.value 
      + '&aux_idevento=' + document.form.aux_idevento.value
      + '&aux_dtanoage=' + document.form.aux_dtanoage.value;
   window.open(VarURL,'','toolbar=no,location=no,diretories=no,status=no,menubar=no,scrollbars=yes,resizable=no,width=800,height=450,top=10,left=10');          
}

// Exclui custo indireto
function ExCusto(idcusto){

   // Verifica se o usuário tem permissão de exclusão
   if (document.form.aux_lspermis.value.substring(2,3) != 'E'){ 
      alert('Desculpe, mas você não tem permissão para executar esta função.'); 
      return false;
   }

   if(idcusto != "")   {
      if (!confirm('Confirma Exclusão do Custo?')){
         return false;
      }

      document.form.aux_idecusto.value = idcusto;
      document.form.aux_cddopcao.value = "exc";
      document.form.submit();
   }
}

function mostraDiv(nomediv)
{   
   var nomeaba = '';

   if (nomediv=='') {nomediv='divEventos';}

   if (nomediv=='divEventos')    {nomeaba='AbaEventos';}
   if (nomediv=='divIndiretos')  {nomeaba='AbaIndiretos';}
   if (nomediv=='divSocios')     {nomeaba='AbaSocios';}


   document.form.pagina.value=nomediv;
   document.all.divEventos.style.display = 'none';
   document.all.divIndiretos.style.display = 'none';
   document.all.divSocios.style.display = 'none';
   document.all.adicionar.style.visibility = 'hidden';

   document.all.AbaEventos.rows[0].cells[0].background="/cecred/images/menu/mnu_nle.gif";
   document.all.AbaEventos.rows[0].cells[1].background="/cecred/images/menu/mnu_nlc.gif";
   document.all.AbaEventos.rows[0].cells[2].background="/cecred/images/menu/mnu_nld.gif";
   document.all.AbaEventos.rows[0].cells[1].className="txtTituloHid";
   
   document.all.AbaIndiretos.rows[0].cells[0].background="/cecred/images/menu/mnu_nle.gif";
   document.all.AbaIndiretos.rows[0].cells[1].background="/cecred/images/menu/mnu_nlc.gif";
   document.all.AbaIndiretos.rows[0].cells[2].background="/cecred/images/menu/mnu_nld.gif";
   document.all.AbaIndiretos.rows[0].cells[1].className="txtTituloHid";

   document.all.AbaSocios.rows[0].cells[0].background="/cecred/images/menu/mnu_nle.gif";
   document.all.AbaSocios.rows[0].cells[1].background="/cecred/images/menu/mnu_nlc.gif";
   document.all.AbaSocios.rows[0].cells[2].background="/cecred/images/menu/mnu_nld.gif";
   document.all.AbaSocios.rows[0].cells[1].className="txtTituloHid";

   document.all[nomeaba].rows[0].cells[0].background="/cecred/images/menu/mnu_sle.gif";
   document.all[nomeaba].rows[0].cells[1].background="/cecred/images/menu/mnu_slc.gif";
   document.all[nomeaba].rows[0].cells[2].background="/cecred/images/menu/mnu_sld.gif";
   document.all[nomeaba].rows[0].cells[1].className="txtTituloVis";

   if (nomediv != 'divSocios')
      document.all.adicionar.style.visibility = 'visible';

   document.all[nomediv].style.display = 'block';

   if (document.form.aux_idevento.value != "1")
      document.all.AbaSocios.style.display = 'none';
}

// Altera o link da função de adicionar
function mudaAdicionar(){

   // Verifica se o usuário tem permissão de inclusão
   if (document.form.aux_lspermis.value.substring(0,1) != 'I'){ 
      alert('Desculpe, mas você não tem permissão para executar esta função.'); 
      return false;
   }

   if(document.all.divEventos.style.display == 'block')
      AdEvento();

   if(document.all.divIndiretos.style.display == 'block')
     AdCusto();
}

// Abre a janela para a seleção de custos indiretos
function AdCusto()
{
   VarURL = document.form.aux_dsendurl.value  + '/wpgd0018e.htm?' +
      'aux_idevento=' + document.form.aux_idevento.value +
     '&aux_cdcooper=' + document.form.aux_cdcooper.value + 
     '&aux_dtanoage=' + document.form.aux_dtanoage.value;
   window.open(VarURL,'','toolbar=no,location=no,diretories=no,status=no,menubar=no,scrollbars=yes,resizable=no,width=360,height=400,TOP=10,LEFT=10');   
}

function mostraCusto(){
  var row;var cell;

  var cor='#F7F7F7';

  for(var i=document.all.tbcusto.rows.length; i>0; i--)
     document.all.tbcusto.deleteRow(i-1); 

  for(i=0;i<mcusto.length;i++){
     // verifica se os dados são da cooperativa selecionada na tela
     if (document.form.aux_cdcooper.value == mcusto[i].cdcooper) 
     {

        row=tbcusto.insertRow();         
        row.checked = false;
        row.value=mcusto[i].nmcusto;
        
        if (cor == '#FFFFFF')
           cor = '#F7F7F7';
        else
           cor = '#FFFFFF';
      
        row.bgColor = cor;
                
           cell=row.insertCell();   // Separador
        cell.className = 'txtNormal';
        cell.height = 26;
        cell.width =  document.all.separador1.width;
        cell.align = 'left';
        cell.innerText='';
                
        cell=row.insertCell();   
        cell.className = 'txtNormal';
        cell.height = 26;
        cell.align = 'left';
        cell.width =  document.all.tbcusto_col1.width;
        linky=mcusto[i].nmcusto + '<in' + 'put type="hidden" name="custo" value="' + mcusto[i].idcusto + '">';
        cell.innerHTML=linky;

        cell=row.insertCell();   // Separador
        cell.className = 'txtNormal';
        cell.height = 26;
        cell.width =  document.all.separador1.width;
        cell.align = 'left';
        cell.innerText='';

        cell=row.insertCell();   
        cell.className = 'txtNormal';
        cell.height = 26;
        cell.align = 'left';
        cell.width =  document.all.tbcusto_col2.width;
        linky= '<in' + 'put type="text" name="vlcusind" size="10" class="Campo" style="text-align:right;" value="' + mcusto[i].vlcusto + '">';
        cell.innerHTML=linky;

        cell=row.insertCell();   // Separador
        cell.className = 'txtNormal';
        cell.height = 26;
        cell.width= document.all.separador1.width;
        cell.align = 'left';
        cell.innerText='';
            
        // Botão de Excluir
        cell=row.insertCell();   
        cell.className = 'txtNormal';
        cell.align = 'left';
        cell.height = 26;         
        cell.width = document.all.tbcusto_col3.width;
        linky='<a href="#." onClick=ExCusto(' + mcusto[i].idcusto + '); class="linkGuia"><img src="/cecred/images/botoes/btn_excluir.gif" border="0" title="Excluir"></a>';
        cell.innerHTML=linky; 


     }
  }
}

// Preenche a tabela de PAs e Kits
function mostraPAC()
{
  var row;var cell;

  var cor='#F7F7F7';

  for(var i=document.all.tbpac.rows.length; i>0; i--)
     document.all.tbpac.deleteRow(i-1); 

  for(i=0;i<mpac.length;i++){
     // verifica se os dados são da cooperativa selecionada na tela
     if (document.form.aux_cdcooper.value == mpac[i].cdcooper) 
     {

        row=tbpac.insertRow();         
        row.checked = false;
        row.value=mpac[i].nmcusto;
        
        if (cor == '#FFFFFF')
           cor = '#F7F7F7';
        else
           cor = '#FFFFFF';
      
        row.bgColor = cor;
                
           cell=row.insertCell();   // Separador
        cell.className = 'txtNormal';
        cell.height = 26;
        cell.width =  document.all.separador1.width;
        cell.align = 'left';
        cell.innerText='';
                
        // PAC
        cell=row.insertCell();   
        cell.className = 'txtNormal';
        cell.height = 26;
        cell.align = 'left';
        cell.width =  document.all.tbpac_col1.width;
        linky=mpac[i].nmresage + '<in' + 'put type="hidden" name="aux_cdagencn" value="' + mpac[i].cdagenci + '">';
        cell.innerHTML=linky;

        cell=row.insertCell();   // Separador
        cell.className = 'txtNormal';
        cell.height = 26;
        cell.width =  document.all.separador1.width;
        cell.align = 'left';
        cell.innerText='';

        // Qtd Kits
        cell=row.insertCell();   
        cell.className = 'txtNormal';
        cell.height = 26;
        cell.align = 'left';
        cell.width =  document.all.tbpac_col2.width;
        linky='<in' + 'put type="text" name="aux_qtcuskit" size="5" class="Campo" onChange="Totaliza(' + "'" + (document.all.tbpac.rows.length - 1) + "'" + ')" style="text-align:right;"  value="' + mpac[i].qtcuskit + '">';
        cell.innerHTML=linky;

        cell=row.insertCell();   // Separador
        cell.className = 'txtNormal';
        cell.height = 26;
        cell.width =  document.all.separador1.width;
        cell.align = 'left';
        cell.innerText='';

        // $ Kits
        cell=row.insertCell();   
        cell.className = 'txtNormal';
        cell.height = 26;
        cell.align = 'left';
        cell.width =  document.all.tbpac_col3.width;
        linky='<in' + 'put type="text" name="aux_vlcuskit" size="5" readOnly TABINDEX="-1" class="Campo" style="text-align:right; border:none; background-color:' + cor + '" value="' + mpac[i].vlcuskit + '">';
        cell.innerHTML=linky;

        cell=row.insertCell();   // Separador
        cell.className = 'txtNormal';
        cell.height = 26;
        cell.width =  document.all.separador1.width;
        cell.align = 'left';
        cell.innerText='';

        // Qtd brindes
        cell=row.insertCell();   
        cell.className = 'txtNormal';
        cell.height = 26;
        cell.align = 'left';
        cell.width =  document.all.tbpac_col4.width;
        linky='<in' + 'put type="text" name="aux_qtcusbri" size="5" class="Campo" onChange="Totaliza(' + "'" + (document.all.tbpac.rows.length - 1) + "'" + ')" style="text-align:right;" value="' + mpac[i].qtcusbri + '">';
        cell.innerHTML=linky;

        cell=row.insertCell();   // Separador
        cell.className = 'txtNormal';
        cell.height = 26;
        cell.width =  document.all.separador1.width;
        cell.align = 'left';
        cell.innerText='';

        // $ Brindes
        cell=row.insertCell();   
        cell.className = 'txtNormal';
        cell.height = 26;
        cell.align = 'left';
        cell.width =  document.all.tbpac_col5.width;
        linky='<in' + 'put type="text" name="aux_vlcusbri" size="5" readOnly TABINDEX="-1" class="Campo" style="text-align:right; border:none; background-color:' + cor + '" value="' + mpac[i].vlcusbri + '">';
        cell.innerHTML=linky;

        cell=row.insertCell();   // Separador
        cell.className = 'txtNormal';
        cell.height = 26;
        cell.width =  document.all.separador1.width;
        cell.align = 'left';
        cell.innerText='';

        // $ Total
        cell=row.insertCell();   
        cell.className = 'txtNormal';
        cell.height = 26;
        cell.align = 'right';
            cell.width =  document.all.tbpac_col6.width;
        linky='<in' + 'put type="text" name="aux_vlcustot" size="5" class="Campo" TABINDEX="-1" readonly style="text-align:right;border:none;background-color:' + cor + ';" value="' + mpac[i].vlcustot + '">';
        cell.innerHTML=linky;
                
     }
  }
}

function SalvarIndiretos()
{
   var vaux = document.form.aux_lspermis.value;
   if ((vaux.substring(1,2) == 'A') || (document.form.aux_stdopcao.value == 'i')) { 
        if ( document.form.aux_cddopcao.value!='sa')  {
           if (ValidaDados(document.forms[0])) 
           {
              document.form.aux_cddopcao.value='si'; 
              armazenaIndiretos();
              status = 'Salvando. Por favor, aguarde ...'; 
              document.form.submit(); 
              return true;
            } 
            else { 
              return false;
            }  
        } 
   }
   else { 
         alert('Desculpe, mas você não tem permissão para executar esta função.'); 
         return false;
   }
}

function armazenaIndiretos()
{
   var i;

   // se for mais de um registro de custo
   if (mcusto.length > 1)
   {
      for(i=0;i<document.form.custo.length;i++)
      {
         // grava os códigos dos custos indiretos
         if(document.form.aux_lstcusto.value=='')
            document.form.aux_lstcusto.value = document.form.custo[i].value;
         else
            document.form.aux_lstcusto.value = document.form.aux_lstcusto.value + ';' + document.form.custo[i].value;

         // Grava os valores digitados
         if(document.form.aux_vlcusind.value=='')
            document.form.aux_vlcusind.value = document.form.vlcusind[i].value;
         else
            document.form.aux_vlcusind.value = document.form.aux_vlcusind.value + ';' + document.form.vlcusind[i].value;
      }
          
   }
   // se for somente um registro de custos
   else
   {
      document.form.aux_lstcusto.value = document.form.custo.value;
      document.form.aux_vlcusind.value = document.form.vlcusind.value;
   }
}

function SalvarNovos()
{
   var vaux = document.form.aux_lspermis.value;
   if ((vaux.substring(1,2) == 'A') || (document.form.aux_stdopcao.value == 'i')) { 
        if ( document.form.aux_cddopcao.value!='sa')  {
           if (ValidaDados(document.forms[0])) 
           {
              document.form.aux_cddopcao.value='sn'; 
              armazenaNovos();
              status = 'Salvando. Por favor, aguarde ...'; 
              document.form.submit(); 
              return true;
            } 
            else { 
              return false;
            }  
        } 
   }
   else { 
         alert('Desculpe, mas você não tem permissão para executar esta função.'); 
         return false;
   }
}

function armazenaNovos()
{
   var i;

   document.form.aux_lstnovos.value='';
   document.form.aux_lsqtdkit.value='';
   document.form.aux_lsvlrkit.value='';
   document.form.aux_lsqtdbri.value='';
   document.form.aux_lsvlrbri.value='';

   // se for mais de um registro de pa
   if (mpac.length > 1)
   {
      for(i=0;i<document.form.aux_cdagencn.length;i++)
      {
         // grava os códigos dos pa's
         if(document.form.aux_lstnovos.value=='')
            document.form.aux_lstnovos.value = document.form.aux_cdagencn[i].value;
         else
            document.form.aux_lstnovos.value = document.form.aux_lstnovos.value + ';' + document.form.aux_cdagencn[i].value;

         // Grava quantidade de kits
         if (isNaN(parseFloat(document.form.aux_qtcuskit[i].value)))
            document.form.aux_qtcuskit[i].value = "0";
         //alert(parseFloat(document.form.aux_qtcuskit[i].value));
         if(document.form.aux_lsqtdkit.value=='')
            document.form.aux_lsqtdkit.value = document.form.aux_qtcuskit[i].value;
         else
            document.form.aux_lsqtdkit.value = document.form.aux_lsqtdkit.value + ';' + document.form.aux_qtcuskit[i].value;

         // Grava valores de kits
         if(document.form.aux_lsvlrkit.value=='')
            document.form.aux_lsvlrkit.value = document.form.aux_vlcuskit[i].value;
         else
            document.form.aux_lsvlrkit.value = document.form.aux_lsvlrkit.value + ';' + document.form.aux_vlcuskit[i].value;

         // Grava quantidade de brindes
         if (isNaN(parseFloat(document.form.aux_qtcusbri[i].value)))
            document.form.aux_qtcusbri[i].value = "0";
         if(document.form.aux_lsqtdbri.value=='')
            document.form.aux_lsqtdbri.value = document.form.aux_qtcusbri[i].value;
         else
            document.form.aux_lsqtdbri.value = document.form.aux_lsqtdbri.value + ';' + document.form.aux_qtcusbri[i].value;

         // Grava valores de brindes
         if(document.form.aux_lsvlrbri.value=='')
            document.form.aux_lsvlrbri.value = document.form.aux_vlcusbri[i].value;
         else
            document.form.aux_lsvlrbri.value = document.form.aux_lsvlrbri.value + ';' + document.form.aux_vlcusbri[i].value;
      }
          
   }
   // se for somente um registro de custos
   else
   {
      document.form.aux_lstnovos.value = document.form.aux_cdagencn.value;
      document.form.aux_lsqtdkit.value = document.form.aux_qtcuskit.value;
      document.form.aux_lsvlrkit.value = document.form.aux_vlcuskit.value;
      document.form.aux_lsqtdbri.value = document.form.aux_qtcusbri.value;
      document.form.aux_lsvlrbri.value = document.form.aux_vlcusbri.value;
   }
}

function Totaliza(i)
{
   /* Se não passar parâmetro significa que todas as linhas têm que ser atualizadas */
   if (i == ''){
      for (j = 0; j < document.all.tbpac.rows.length; j++){          
         /*  Calcula o valor total do kit */
         document.form.aux_vlcuskit[j].value = parseFloat(ConverteDec(document.form.aux_qtcuskit[j].value, "1")) * parseFloat(ConverteDec(document.form.aux_vlunikit.value, "1"));
         document.form.aux_vlcuskit[j].value = formatCurrency(document.form.aux_vlcuskit[j].value, "1");
      
         /*  Calcula o valor total do brinde */
         document.form.aux_vlcusbri[j].value = parseFloat(ConverteDec(document.form.aux_qtcusbri[j].value, "1")) * parseFloat(ConverteDec(document.form.aux_vlunibri.value, "1"));
         document.form.aux_vlcusbri[j].value = formatCurrency(document.form.aux_vlcusbri[j].value,"1");

         /*  Total da linha  */      
         document.form.aux_vlcustot[j].value = parseFloat(ConverteDec(document.form.aux_vlcuskit[j].value, "1")) + parseFloat(ConverteDec(document.form.aux_vlcusbri[j].value, "1"));
         document.form.aux_vlcustot[j].value = formatCurrency(document.form.aux_vlcustot[j].value,"1");
      }
          
      /*  Acerta o campo de valor dos kits e brindes */
      document.form.aux_vlunikit.value = formatCurrency(ConverteDec(document.form.aux_vlunikit.value,"1"));
      document.form.aux_vlunibri.value = formatCurrency(ConverteDec(document.form.aux_vlunibri.value,"1"));
   }
   /* Calcula somente uma linha */
   else
   {   
      /*  Calcula o valor total do kit */
      document.form.aux_vlcuskit[i].value = parseFloat(ConverteDec(document.form.aux_qtcuskit[i].value, "1")) * parseFloat(ConverteDec(document.form.aux_vlunikit.value, "1"));
      document.form.aux_vlcuskit[i].value = formatCurrency(document.form.aux_vlcuskit[i].value, "1");
                       
      /*  Calcula o valor total do brinde */
      document.form.aux_vlcusbri[i].value = parseFloat(ConverteDec(document.form.aux_qtcusbri[i].value, "1")) * parseFloat(ConverteDec(document.form.aux_vlunibri.value, "1"));
      document.form.aux_vlcusbri[i].value = formatCurrency(document.form.aux_vlcusbri[i].value,"1");
   
             /*  Total da linha  */
      document.form.aux_vlcustot[i].value = parseFloat(ConverteDec(document.form.aux_vlcuskit[i].value, "1")) + parseFloat(ConverteDec(document.form.aux_vlcusbri[i].value, "1"));
      document.form.aux_vlcustot[i].value = formatCurrency(document.form.aux_vlcustot[i].value,"1");
   }
}

//formatação dos campos
function formatCurrency(num) 
{
   //alert(num);
   num = num.toString().replace(/\$|\,/g,'');
   if(isNaN(num))
      num = "0";
   sign = (num == (num = Math.abs(num)));
   num = Math.floor(num*100+0.50000000001);
   cents = num%100;
   num = Math.floor(num/100).toString();
   if(cents<10)
      cents = "0" + cents;
   for (var i = 0; i < Math.floor((num.length-(1+i))/3); i++)
      num = num.substring(0,num.length-(4*i+3))+'.'+
   num.substring(num.length-(4*i+3));
   return (((sign)?'':'-') + num + ',' + cents);
}

// Converte um valor com decimal separado por "," para separado por "."
function ConverteDec(str, tipo)
{
   if(tipo == "1")
   {
      str = str.replace(".","");
      str = str.replace(",",".");
      return str;
   }
   else
   {
      str = str.replace(",","");
      str = str.replace(".",",");
      return str;
   }
}

function carrega_registros(direcao){

   if(mevento.length==0){
      alert('Não há rgistros de eventos!');
      return false;
   } 

   if  ((document.form.aux_contarow.value >= document.form.aux_maxrows.value) || 
       ((document.form.aux_contarow.value < document.form.aux_maxrows.value) && 
        (direcao == 'anteriores'))){ 
           document.form.aux_carregar.value = direcao;
           document.form.submit();
   }

}


mostraDiv(document.form.pagina.value);

// valida os parâmetros da agenda
if(document.form.aux_dtanoage.value == ''){
   alert('Parâmetro da Agenda Não Encontrado!!!');
   
   document.form.aux_dtanoage.value = '';
   document.form.aux_cdcooper.value = '';   
}
else{
   mostraEventos();
   mostraCusto();
   mostraPAC();
}




</script>
</body>
</html>
