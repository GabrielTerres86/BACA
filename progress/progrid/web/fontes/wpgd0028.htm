<!-- Generated by WebSpeed - http://www.webspeed.com/ -->
<html>
<head>
<meta name="AUTHOR" content="Rosangela">
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta name="wsoptions" content="no-output">
<meta name="GENERATOR" content="Microsoft FrontPage 4.0">
<meta http-equiv="Cache-Control" content="No-Cache">
<meta http-equiv="Pragma"        content="No-Cache">
<meta http-equiv="Expires"       content="0">
<title>Custos dos Eventos</title>
<link href="/cecred/estilos/progrid.css" rel="stylesheet" type="text/css">
<script SRC="/cecred/jsbiblio/sorttable.js"></script>
</head>
<body>
<script language="JavaScript">
   NomeDoProgramaPrincipal  = '/wpgd0028.w';
   NomeDoProgramaDeListagem = '/wpgd0028ls.w';
   NomeDoProgramaDeAjuda    = '/wpgd0028aj.w';
   NomeDoProgramaDeZoom     = '/zoom/zwpgd0028.w';
</script>
<form action="#." method="POST" name="form"><div align="right">
  <input type="hidden" name="aux_dsendurl" value="">
  <input type="hidden" name="aux_idevento" value="">
  <input type="hidden" name="aux_cddopcao" value="">
  <input type="hidden" name="aux_nrdrowid" value="">
  <input type="hidden" name="aux_lspermis" value="">
  <input type="hidden" name="aux_dsretorn" value="">
  <input type="hidden" name="aux_stdopcao" value="">
  <input type="hidden" name="aux_idexclui" value="">
  <input type="hidden" name="aux_cdevento" value="">
  <input type="hidden" name="aux_vlcusind" value="">
  <input type="hidden" name="aux_lstcusto" value="">
  <input type="hidden" name="pagina" value="">
  <!-- Inicio do modelo -->
  <div id="Layer1" style="position:absolute; border:0px; width:35px; height:35; z-index:1; left: 25px; top: 2px; visibility: ;"><img src="/cecred/images/icones/ico_fornecedor.gif" width="28" height="32" align="bottom"> </div>
  <table width="575" height="360"  border="0" align="left" cellpadding="0" cellspacing="0" background="/cecred/images/geral/guia_fundo.gif">
    <tr>
      <td height="20" colspan="5">
	  <table width="100%"  border="0" cellspacing="0" cellpadding="0">
        <tr>
		  <td width="11"><img src="/cecred/images/geral/guia_esquerda.gif" width="11" height="21"></td>
		  <td width="56"><img src="/cecred/images/geral/spacer.gif" width="3" height="10"></td>
		  <td width="427" height="20" class="linkGuia"><div align="left">Controle de Frequencia</div></td>
		  <td width="70" class="linkGuia"><div align="right">wpgd0028 </div></td>
		  <td width="11" align="right" valign="middle" class="linkGuia"><img src="/cecred/images/geral/guia_direita.gif" width="11" height="21"></td>
		</tr>
      </table>
	  </td>
      </tr>
    <tr valign="top" bgcolor="#FFFFFF">
      <td colspan="5">
        <table width="100%" height="100%"  border="0" align="left" cellpadding="0" cellspacing="1" bgcolor="#999999">
          <tr>
            <td valign="top" bgcolor="#FFFFFF">
              <table width="100%" height="40" border="0" align="center" cellspacing="1">
                <tr>				
                  <td height="10" colspan="6" align="left"><img src="/cecred/images/geral/spacer.gif" width="1" height="10"></td>
                  </tr>
                <tr>
                	<td width="15%" class="NomeCampo"><div align="right" class="NomeCampo">Agenda:</div></td>
                    <td width="16%" class="NomeCampo"><input type="text" name="dtanoage" size="4" class="Campo" readOnly></td>
                    <td width="22%" class="NomeCampo"><div align="right" class="NomeCampo">Cooperativa: </div></td>
                    <td width="9%" class="NomeCampo" ><select name="aux_cdcooper" class="Campo" id="cdcooper" onChange="mostraEventos();">
                    </select></td>
                    <td width="25%" class="NomeCampo" ><div align="right">Pac:</div></td>
                    <td width="13%" class="NomeCampo" ><select name="aux_cdagenci" class="Campo" id="aux_cdagenci" onChange="mostraEventos();">
                    </select></td>
                </tr>
                <tr>
                    <td class="NomeCampo"><div align="right">Evento:</div></td>
                    <td class="NomeCampo"><select name="aux_cdcooper" class="Campo" id="cdcooper" onChange="mostraEventos();">
                    </select></td>
                    <td class="NomeCampo"><div align="right">Per&iacute;odo:</div></td>
                    <td class="NomeCampo" ><input type="text" name="dtanoage" size="4" class="Campo" readOnly></td>
                    <td class="NomeCampo" ><div align="right">% Frequencia exigida: </div></td>
                    <td class="NomeCampo" ><input type="text" name="dtanoage" size="4" class="Campo" readOnly></td>
                </tr>
              </table>
              <table width="100%"   border="0" cellpadding="0" cellspacing="0">
                <tr>
                  <td height="15" align="left">
                  <!-- Interrupcao do modelo - início das abas -->
                  <br>
                  <br>
                  <!-- Fim das abas - Início dos dados do programa -->
                   
                   <table width="100%" border="0" cellpadding="0" cellspacing="0" class="dataTable">
                         <tr>
						 	  <td id="separador1" width="5" background="/cecred/images/menu/fnd_title.jpg">&nbsp;</td>
                              <td width="300" height="25" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos" id="tbevento_col1">Participantes</td>
                              <td width="5" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                              <td width="138" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos" id="tbevento_col2" title="Honorários">Faltas</td>
                              <td width="5" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                              <td width="100" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos" id="tbevento_col3" title="Local">% de frequencia </td>
                              <td width="5" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                              <td width="15" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos" id="tbevento_col4" >&nbsp;</td>
                         </tr>
                   </table>
				   <div style="overflow: auto; height:'200px';">
					   <table id="tbevento" width="100%" border="0" cellpadding="0" cellspacing="0" class="dataTable">
							<!-- INCLUI DADOS -->
					   </table>
                   </div>
                    <!-- Fim dos dados do programa - retorno ao modelo -->
                  </td>
                </tr>
              </table>
            </td>
          </tr>
        </table>
      </td>
    </tr>
  </table>
</div>
<!-- fim do modelo -->
</form>
   <script language="JavaScript">

NomeDoProgramaPrincipal = document.form.aux_dsendurl.value + NomeDoProgramaPrincipal +' ?aux_idevento=' + document.form.aux_idevento.value;
document.form.action = NomeDoProgramaPrincipal;

function ValidaDados(form)
{
   var msg="";

   /*if(document.form.aux_vlcusind.length > 1) 
   {
      for(i=0;i<document.form.aux_vlcusind.length; i++)
         msg = msg + top.frcod.VE("de",form.aux_vlcusind[i],"Valor","nao",0,9999);

   }
   else
      msg = msg + top.frcod.VE("de",form.aux_vlcusind,"Valor","nao",0,9999);*/

   if (msg == "")
     return true;
   else
   {
     top.frcod.MostraResultado('1',msg);
     return false;
   }
   
}

function LimparCampos()
{

}

function CarregaPrincipal () 
{
   //top.topFrame.document.all.titulo.innerHTML = 'Custo dos Eventos - ' + document.form.aux_idevento.value;
}

// Traz as informações atualizadas do banco de dados
function Recarrega(){
  document.form.submit();  
}

function Incluir()
{
   ZeraModoExclusao();
   var vaux =document.form.aux_lspermis.value; 
   if (vaux.substring(0,1) == 'I') 
       { 
          if (document.form.aux_stdopcao.value == 'i') 
                { 
                   MostraResultado('1','Você já esta no modo de inclusão'); 
                   return false
                } 
             else 
                { 
                   document.form.aux_cddopcao.value='in';
                   document.form.aux_stdopcao.value='i'
                   LimparCampos(); 
                   return true
                } 
       } 
    else 
       { 
          MostraResultado('1','Desculpe, mas você não tem permissão para executar esta função.'); 
          return false
       }
}

function Salvar()
{
   ZeraModoExclusao();
   var vaux = document.form.aux_lspermis.value; 
   if ((vaux.substring(1,2) == 'A') || (document.form.aux_stdopcao.value == 'i')) { 
        if ( document.form.aux_cddopcao.value!='sa')  {
           if (ValidaDados(document.forms[0])) {
               document.form.aux_cddopcao.value='sa'; 
               status = 'Salvando. Por favor, aguarde ...'; 
               document.form.submit(); 
               return true;
            } 
            else { 
              return false;
            }  
        } 
   }
   else { 
         MostraResultado('1','Desculpe, mas você não tem permissão para executar esta função.'); 
         return false;
   }
}


// Funcoes declaradas para manter compatilibidade com as funcoes da biblioteca padrão
function Habilita(){}
// Funcoes declaradas para manter compatilibidade com as funcoes da biblioteca padrão
function HabilitaSalvar(){}

function FechaZoom(campo,valor,valor2,valor3,valor4,valor5,valor6,valor7,valor8)
   {
      ZeraModoExclusao();   
      if (window.WZoom != null)
            {  
               alert('1');
               if (WZoom.closed != true)
                     {
                        alert('2');
                        WZoom.close();
                     }
            }
   }
   
// Preenche a tabela de Eventos com seus custos
function mostraEventos(){

  var row; var cell;

  var cor='#F7F7F7';
  
  // limpa a tabela de Eventos, menos a 1ª linha - linha do cabecalho
  for (var i=document.all.tbevento.rows.length; i>1; i--)
      document.all.tbevento.deleteRow(i-1);
	  
  for(i=0;i<mevento.length;i++) // insere linhas na tabela de eventos
  {     
     // verifica se os dados são da cooperativa selecionada na tela
     if (document.form.aux_cdcooper.value == mevento[i].cdcooper) 
     {

        row=tbevento.insertRow();  
        //row.id=mevento[i].cdevento;
        //row.ondblclick=InsereCusto;

        if (cor == '#FFFFFF')
           cor = '#F7F7F7';
        else
           cor = '#FFFFFF';
      
        row.bgColor = cor;
        //row.title = 'Duplo-clique para lançar os custos por PAC';
        //row.style.cursor = 'hand';
   
        
        cell=row.insertCell();         // primeira celula da linha (descricao do evento)
        cell.className = 'txtNormal';
        cell.width = document.all.tbevento_col1.width;
        cell.height = 20;
        cell.align = 'left';
        cell.title = mevento[i].nmevento;
        cell.id=mevento[i].cdevento;
        cell.onclick=InsereCusto;
        linky='<a href="#.">' + mevento[i].nmevento.substring(0,10) + '</a>';
        cell.innerHTML= linky;

        cell=row.insertCell();   // Separador
        cell.className = 'txtNormal';
        cell.width= 1;
        cell.height = 30;
        cell.align = 'left';
        cell.innerText='';
   
        // 1 - Honorários
        cell=row.insertCell();         
        cell.className = 'txtNormal';
        cell.width = document.all.tbevento_col2.width;
        cell.height = 20;
        cell.align = 'right';
        cell.style.textAlign='right';
        cell.innerText=mevento[i].vlhonora;

        cell=row.insertCell();   // Separador
        cell.className = 'txtNormal';
        cell.width= 159;
        cell.height = 30;
        cell.align = 'left';
        cell.innerText='';
   
        // 2 - Local
        cell=row.insertCell();         
        cell.className = 'txtNormal';
        cell.width = document.all.tbevento_col3.width;
        cell.height = 20;
        cell.align = 'right';
        cell.style.textAlign='right';
        cell.innerText=mevento[i].vlrlocal;

        cell=row.insertCell();   // Separador
        cell.className = 'txtNormal';
        cell.width= 159;
        cell.height = 30;
        cell.align = 'left';
        cell.innerText='';
   
        // 3 - Alimentação
        cell=row.insertCell();         
        cell.className = 'txtNormal';
        cell.width = 200;
        cell.height = 20;
        cell.align = 'right';
        cell.style.textAlign='right';
        cell.innerText=mevento[i].vlalimen;

        cell=row.insertCell();   // Separador
        cell.className = 'txtNormal';
        cell.width= 159;
        cell.height = 30;
        cell.align = 'left';
        cell.innerText='';
   
        // 4 - Material
        cell=row.insertCell();         
        cell.className = 'txtNormal';
        cell.width = 200;
        cell.height = 20;
        cell.align = 'right';
        cell.style.textAlign='right';
        cell.innerText=mevento[i].vlmateri;

        cell=row.insertCell();   // Separador
        cell.className = 'txtNormal';
        cell.width= 159;
        cell.height = 30;
        cell.align = 'left';
        cell.innerText='';
   
        // 5 - Transportes
        cell=row.insertCell();         
        cell.className = 'txtNormal';
        cell.width = 200;
        cell.height = 20;
        cell.align = 'right';
        cell.style.textAlign='right';
        cell.innerText=mevento[i].vltransp;

        cell=row.insertCell();   // Separador
        cell.className = 'txtNormal';
        cell.width= 159;
        cell.height = 30;
        cell.align = 'left';
        cell.innerText='';
   
        // 6 - Brindes
        cell=row.insertCell();         
        cell.className = 'txtNormal';
        cell.width = 200;
        cell.height = 20;
        cell.align = 'right';
        cell.style.textAlign='right';
        cell.innerText=mevento[i].vlbrinde;

        cell=row.insertCell();   // Separador
        cell.className = 'txtNormal';
        cell.width= 159;
        cell.height = 30;
        cell.align = 'left';
        cell.innerText='';
   
        // 7 - Divulgação
        cell=row.insertCell();         
        cell.className = 'txtNormal';
        cell.width = 200;
        cell.height = 20;
        cell.align = 'right';
        cell.style.textAlign='right';
        cell.innerText=mevento[i].vldivulg;

        cell=row.insertCell();   // Separador
        cell.className = 'txtNormal';
        cell.width= 159;
        cell.height = 30;
        cell.align = 'left';
        cell.innerText='';
   
        // 8 - Outros
        cell=row.insertCell();         
        cell.className = 'txtNormal';
        cell.width = 200;
        cell.height = 20;
        cell.align = 'right';
        cell.style.textAlign='right';
        cell.innerText=mevento[i].vloutros;

        cell=row.insertCell();   // Separador
        cell.className = 'txtNormal';
        cell.width= 159;
        cell.height = 30;
        cell.align = 'left';
        cell.innerText='';

        // Total
        cell=row.insertCell();         
        cell.className = 'txtNormal';
        cell.width = 200;
        cell.height = 20;
        cell.align = 'right';
        cell.style.textAlign='right';
        cell.innerText=mevento[i].ttevento;

        cell=row.insertCell();   // Separador
        cell.className = 'txtNormal';
        cell.width= 159;
        cell.height = 30;
        cell.align = 'left';
        cell.innerText='';
   	 
        // Botão de Excluir
        cell=row.insertCell();   
        cell.className = 'txtNormal';
        cell.align = 'left';
        cell.width = 20;
        cell.height = 20;	 
        linky='<a href="#." onClick=ExEvento(' + mevento[i].cdevento + '); class="linkGuia"><img src="/cecred/images/botoes/btn_excluir.gif" border="0" title="Excluir"></a>';
        cell.innerHTML=linky; 

     } // if (document.form.aux_cdcooper.value == mevento[i].cdcooper)
  } // for(i=0;i<mevento.length;i++)
  
  //completa a tabela, caso necessário
  //PreencheBrancos(tbevento, 0, (7 - tbevento.rows.length), 11);
  
}

// Abre a janela para a seleção de eventos para lançar custos
function AdEvento(){

   VarURL = document.form.aux_dsendurl.value  + '/wpgd0018a.htm' 
      + '?aux_idevento=' + document.form.aux_idevento.value
      + '&aux_dtanoage=' + document.form.dtanoage.value
      + '&aux_cdcooper=' + document.form.aux_cdcooper.value;
   window.open(VarURL,'','toolbar=no,location=no,diretories=no,status=no,menubar=no,scrollbars=yes,resizable=no,width=630,height=400');   
}

// Exclui os custos do evento selecionado
function ExEvento(evento){
   if(evento != "")   {
      if (!confirm('Confirma Exclusão do Evento?')){
         return false;
      }

      document.form.aux_cdevento.value = evento;
      document.form.aux_cddopcao.value = "exe";
      document.form.submit();
   }
}

// função que preenche tabelas com linhas em branco
function PreencheBrancos(tabela,limpa,numlinhas,numcolunas)
{
   if (limpa == 1) {
      for (var i=tabela.rows.length; i>1; i--)
         tabela.deleteRow(i-1); 
   }

   for(i=0;i<numlinhas;i++){
      row=tabela.insertRow();
      for(j=0;j<numcolunas;j++)
      {
         cell=row.insertCell();
         cell.height = 20;
         cell.width = 20;
      }
   }
}

// Abre a tela de distribuição de custos entre os PACs
function InsereCusto()
{
   VarURL = document.form.aux_dsendurl.value  + '/wpgd0018b.htm' 
      + '?aux_cdevento=' + this.id
      + '&aux_cdcooper=' + document.form.aux_cdcooper.value 
      + '&aux_idevento=' + document.form.aux_idevento.value
      + '&aux_dtanoage=' + document.form.dtanoage.value;
   window.open(VarURL,'','toolbar=no,location=no,diretories=no,status=no,menubar=no,scrollbars=yes,resizable=no,width=800,height=500');	  

}

function mostraDiv(nomediv)
{   
   var nomeaba = '';

   if (nomediv=='') {nomediv='divEventos';}

   if (nomediv=='divEventos') {nomeaba='AbaEventos';}
   if (nomediv=='divIndiretos')    {nomeaba='AbaIndiretos';}

   document.form.pagina.value=nomediv;
   document.all.divEventos.style.display = 'none';
   document.all.divIndiretos.style.display = 'none';

   document.all.AbaEventos.rows[0].cells[0].background="/cecred/images/menu/mnu_nle.gif";
   document.all.AbaEventos.rows[0].cells[1].background="/cecred/images/menu/mnu_nlc.gif";
   document.all.AbaEventos.rows[0].cells[2].background="/cecred/images/menu/mnu_nld.gif";
   document.all.AbaEventos.rows[0].cells[1].className="txtTituloHid";
   
   document.all.AbaIndiretos.rows[0].cells[0].background="/cecred/images/menu/mnu_nle.gif";
   document.all.AbaIndiretos.rows[0].cells[1].background="/cecred/images/menu/mnu_nlc.gif";
   document.all.AbaIndiretos.rows[0].cells[2].background="/cecred/images/menu/mnu_nld.gif";
   document.all.AbaIndiretos.rows[0].cells[1].className="txtTituloHid";

   document.all[nomeaba].rows[0].cells[0].background="/cecred/images/menu/mnu_sle.gif";
   document.all[nomeaba].rows[0].cells[1].background="/cecred/images/menu/mnu_slc.gif";
   document.all[nomeaba].rows[0].cells[2].background="/cecred/images/menu/mnu_sld.gif";
   document.all[nomeaba].rows[0].cells[1].className="txtTituloVis";

   document.all.adicionar.style.visibility = 'visible';

   document.all[nomediv].style.display = 'block';
}

// Altera o link da função de adicionar
function mudaAdicionar()
{
   if(document.all.divEventos.style.display == 'block')
      AdEvento();

   if(document.all.divIndiretos.style.display == 'block')
     AdCusto();
}

// Abre a janela para a seleção de custos indiretos
function AdCusto()
{
   VarURL = document.form.aux_dsendurl.value  + '/wpgd0018e.htm?' +
      'aux_idevento=' + document.form.aux_idevento.value +
     '&aux_cdcooper=' + document.form.aux_cdcooper.value + 
     '&aux_dtanoage=' + document.form.dtanoage.value;
   window.open(VarURL,'','toolbar=no,location=no,diretories=no,status=no,menubar=no,scrollbars=yes,resizable=no,width=400,height=400');   
}

function mostraCusto(){
  var row;var cell;

  var cor='#F7F7F7';

  for(var i=document.all.tbcusto.rows.length; i>1; i--)
     document.all.tbcusto.deleteRow(i-1); 

  for(i=0;i<mcusto.length;i++){
     // verifica se os dados são da cooperativa selecionada na tela
     if (document.form.aux_cdcooper.value == mcusto[i].cdcooper) 
     {

        row=tbcusto.insertRow();         
        row.checked = false;
        row.value=mcusto[i].nmcusto;
        
        if (cor == '#FFFFFF')
           cor = '#F7F7F7';
        else
           cor = '#FFFFFF';
      
        row.bgColor = cor;
   
        cell=row.insertCell();   
        cell.className = 'txtNormal';
        cell.height = 20;
        cell.align = 'left';
        linky=mcusto[i].nmcusto + '<input type="hidden" name="custo" value="' + mcusto[i].idcusto + '">';
        cell.innerHTML=linky;

        cell=row.insertCell();   // Separador
        cell.className = 'txtNormal';
        cell.width= 10;
        cell.height = 30;
        cell.align = 'left';
        cell.innerText='';

        cell=row.insertCell();   
        cell.className = 'txtNormal';
        cell.height = 20;
        cell.align = 'left';
        linky= '<in' + 'put type="text" name="vlcusind" size="10" class="Campo" style="text-align:right;" value="' + mcusto[i].vlcusto + '">';
        cell.innerHTML=linky;


     }
  }
}

function SalvarIndiretos()
{
   var vaux = document.form.aux_lspermis.value;
   if ((vaux.substring(1,2) == 'A') || (document.form.aux_stdopcao.value == 'i')) { 
        if ( document.form.aux_cddopcao.value!='sa')  {
           if (ValidaDados(document.forms[0])) 
           {
              document.form.aux_cddopcao.value='si'; 
              armazenaIndiretos();
              status = 'Salvando. Por favor, aguarde ...'; 
              document.form.submit(); 
              return true;
            } 
            else { 
              return false;
            }  
        } 
   }
   else { 
         alert('Desculpe, mas você não tem permissão para executar esta função.'); 
         return false;
   }
}

function armazenaIndiretos()
{
   var i;

   // se for mais de um registro de custo
   if (mcusto.length > 1)
   {
      for(i=0;i<document.form.custo.length;i++)
      {
         // grava os códigos dos custos indiretos
         if(document.form.aux_lstcusto.value=='')
            document.form.aux_lstcusto.value = document.form.custo[i].value;
         else
            document.form.aux_lstcusto.value = document.form.aux_lstcusto.value + ';' + document.form.custo[i].value;

         // Grava os valores digitados
         if(document.form.aux_vlcusind.value=='')
            document.form.aux_vlcusind.value = document.form.custo[i].value;
         else
            document.form.aux_vlcusind.value = document.form.aux_vlcusind.value + ';' + document.form.vlcusind[i].value;
      }
          
   }
   // se for somente um registro de custos
   else
   {
      document.form.aux_lstcusto.value = document.form.custo.value;
      document.form.aux_vlcusind.value = document.form.vlcusind.value;
   }
}


mostraDiv(document.form.pagina.value);

mostraEventos();

mostraCusto();

</script>
</body>
</html>
