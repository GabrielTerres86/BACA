<!--
	Alterações:
-->
<html>
	<head>
		<title>Eventos para Sele&ccedil;&atilde;o - Pr&eacute;-Assembleia(wpgd0052b)</title>
		<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
		<link href="/cecred/estilos/progrid.css" rel="stylesheet" type="text/css">
	</head>
	<body>
		<script SRC="/cecred/jsbiblio/sorttable.js"></script>
		<script language="JavaScript">
			NomeDoProgramaPrincipal  = '/wpgd0052b.w';
		</script>
		<form method="POST" name="form">
			<input type="hidden" name="aux_dsendurl" value="">
			<input type="hidden" name="aux_cddopcao" value="">           
			<input type="hidden" name="aux_nrdrowid" value="">
			<input type="hidden" name="aux_lspermis" value="">
			<input type="hidden" name="aux_stdopcao" value="">
			<input type="hidden" name="aux_lsagenci" value="">
			<input type="hidden" name="aux_cdevento" value="">  
			<input type="hidden" name="aux_idevento" value="">  
			<input type="hidden" name="glb_cdcooper" value="">
			<input type="hidden" name="aux_cdcooper" value="0">
			<input type="hidden" name="aux_dtanoage" value="">
			<input type="hidden" name="aux_cdcopope" value="">
			<input type="hidden" name="aux_cdoperad" value="">

			<table width="100%"  border="0" cellspacing="0" cellpadding="0">
				<tr>
					<td>
					<table border="0" cellpadding="0" cellspacing="0" background="/cecred/images/geral/guia_fundo.gif">
							<tr>
						<td width="11"><img src="/cecred/images/geral/guia_esquerda.gif" width="11" height="21"></td>
								<td nowrap class="linkGuia">
						<div align="center">
							Evento:
						<input class="linkGuia" type="text" name="nmevento" readonly="true" size="50" value="">
						</div>
					</td>
					<td width="11" align="right"><img src="/cecred/images/geral/guia_direita.gif" width="8" height="21"></td>
				</tr>
			</table>
		</td>
		<td align="right" class="txtTituloHid"></td>
	</tr>
	<tr>
		<td colspan="2" height="2" bgcolor="#999999"></td>
	</tr>
	<tr>
	<td colspan="2">
			<table width="100%" border="0" cellspacing="0" cellpadding="0">
		<tr> 
			<td>
			<table class="tableBranca" id="tbpacs" width="100%" border="0" cellpadding="0" cellspacing="0" bgColor="#FFFFFF">
				
			</table>
		</td>
		</tr>
		<tr>
			<td>&nbsp;</td>
		</tr>
		<tr>
			<td align="center" valign="bottom">
			<a style="cursor:hand;" onClick="Salvar();" >
			<input name="imageField" type="image" src="/cecred/images/botoes/btn_salvar.gif" width="60" height="20">
			</a>
		</td>
		</tr>
	</table>	
		</td>
	</tr>
			</table>
		</form>
	</body>
	<script language="JavaScript">

		NomeDoProgramaPrincipal  = '/wpgd0052b.w';
		NomeDoProgramaDeListagem = '/wpgd0052bs.w';
		NomeDoProgramaDeAjuda    = '/wpgd0052baj.w';
		NomeDoProgramaDeZoom     = '';

		NomeDoProgramaPrincipal = document.form.aux_dsendurl.value + NomeDoProgramaPrincipal;
		document.form.action = NomeDoProgramaPrincipal;

		function Recarrega(){
			document.form.submit();
		}

		function Salvar(){
			//ZeraModoExclusao();
			var vaux = document.form.aux_lspermis.value; 

			if ((vaux.substring(1,2) == 'A') || (document.form.aux_stdopcao.value == 'i')){ 
				if (document.form.aux_cddopcao.value != 'sa')  {
				document.form.aux_cddopcao.value = 'sa';
				// "força" a opção para i = Inclusão											
				document.form.aux_stdopcao.value = 'i'; 
				status = 'Salvando. Por favor, aguarde ...';			
				armazenaPACS();
				document.form.submit();
					return true;
				}else{ 
				 return false;
				}  
			}else { 
				alert('Desculpe, mas você não tem permissão para executar esta função.'); 
				return false;
			}
		}

		function mudaCor(linha){  
			if(document.activeElement.tagName != "INPUT"){
				if(linha!=null){  
					if(linha.checked==false){
						linha.bgColor = '#CCCCCC';
						linha.checked = true;		 
					}else{
						linha.bgColor = '#FFFFFF';
						linha.checked = false;
					}
				}else{
					if(this.checked==false){
						this.bgColor = '#CCCCCC';
						this.checked = true;
					}else{
						this.bgColor = '#FFFFFF';
						this.checked = false;
						document.getElementsByName('chk_' + this.id).checked = false;
					}
				}
			}  
		}

		function armazenaPACS(){
			for(var i = 1;i < tbpacs.rows.length;i++){    
				if (tbpacs.rows[i].checked){
					if (document.form.aux_lsagenci.value == ""){
						document.form.aux_lsagenci.value = tbpacs.rows[i].value;
					}else{
						document.form.aux_lsagenci.value = document.form.aux_lsagenci.value + ";" + tbpacs.rows[i].value ;			
					}
				}
			}
		}

		function CustomizaEvento(){
			VarURL = document.form.aux_dsendurl.value  + "/wpgd0008.htm?aux_idevento=" + document.form.aux_idevento.value + "&aux_cdorigem=3&LinkRowid=" + document.form.aux_nrdrowid.value;
			window.open(VarURL,"Evento","toolbar=no,location=no,diretories=no,status=no,menubar=no,scrollbars=no,resizable=no,width=790,height=490,top=10,left=10");
		}

		function mostraPACS(){

			var row;
			var cell;  

			// Coloca o nome do Evento
			document.form.nmevento.value = document.form.aux_cdevento.value + ' - ' + mpacs[0].nmevento;
			document.form.nmevento.style.background = '';
			document.form.nmevento.style.border = 'none';

			// limpa a tabela de PAS
			for (var i=document.all.tbpacs.rows.length; i>0; i--){
				document.all.tbpacs.deleteRow(i-1);
			}

			// cria as linhas com as células...
			for(var j=0;j<mpacs.length;j++){    
				row = tbpacs.insertRow();
				row.id = j;
				row.checked = false; 
			
				if (j>0){
					row.value=mpacs[j].cdagenci;
					// Se o PA já foi escolhido aí muda a cor para selecionado
					if(mpacs[j].flgativo == 'yes'){
						row.bgColor = '#CCCCCC';
						row.checked = true;
					}	      
					
					// Se os eventos do PA já foram enviados, diferencia a cor e não deixa clicar para desmarcar o PA
					if(mpacs[j].flpacenv=='yes'){
						row.bgColor = '#e6ffff';
					}else{
						row.onclick=mudaCor;
						row.style.cursor='hand';
					}
				}
			
				// Nome do PA
				cell=row.insertCell();      
				row.onclick=mudaCor;
				
				cell.style.cursor='hand';
				cell.className = 'txtNormal';
				linky=mpacs[j].nmresage;  
				cell.innerHTML=linky;
				cell.width= "100%";
			
				if (j>0)
					cell.align="left";
				else{
					cell.align="center";
					cell.background="/cecred/images/menu/fnd_title.jpg";
				}

				// Separador
				cell=row.insertCell();
				cell.className = 'txtNormal';
				cell.width= 5;
				cell.height = 25;
				cell.align = 'left';     
			
				if (j == 0){
					cell.background="/cecred/images/menu/fnd_title.jpg";
					cell.innerHTML='<img src="/cecred/images/geral/div.gif" width="2" height="15">';
				}
			}
		}  
		
		mostraPACS();
		
	</script>
</html>