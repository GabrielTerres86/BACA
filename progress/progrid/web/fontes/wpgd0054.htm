<!--
  Alterações:  
-->
<html>
  <head>
    <meta name="AUTHOR" content="Solusoft/Bt - wpgd0054 - C.18">
    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
    <meta name="wsoptions" content="no-output">
    <meta name="GENERATOR" content="Microsoft FrontPage 4.0">
    <meta http-equiv="Cache-Control" content="No-Cache">
    <meta http-equiv="Pragma"        content="No-Cache">
    <meta http-equiv="Expires"       content="0">
    <title>Sele&ccedil;&atilde;o dos Eventos - Pr&eacute;-Assembl&eacute;ia</title>
    <link href="/cecred/estilos/progrid.css" rel="stylesheet" type="text/css">
    <script SRC="/cecred/scripts/jquery.js"></script>
  </head>
  <body style="margin-left: 3px; " >

    <script language="JavaScript">
      NomeDoProgramaPrincipal = '/wpgd0054.w';
      NomeDoProgramaDeListagem = '/wpgd0054ls.w';
      NomeDoProgramaDeAjuda = '/wpgd0054aj.w';
      NomeDoProgramaDeZoom = '/zoom/zoei04.w';
    </script>
    <form action="#." method="POST" name="form"><div align="right">
      <input type="hidden" name="aux_dsendurl" value="">
      <input type="hidden" name="aux_idevento" value="">
      <input type="hidden" name="aux_cddopcao" value="">
      <input type="hidden" name="aux_nrdrowid" value="">
      <input type="hidden" name="aux_lspermis" value="">
      <input type="hidden" name="aux_dsretorn" value="">
      <input type="hidden" name="aux_stdopcao" value="">      
      <input type="hidden" name="aux_lsfselec" value="">
      <input type="hidden" name="aux_lscuseve" value="">
      <input type="hidden" name="aux_dsurlphp" value="">
      <input type="hidden" name="aux_cdoperad" value="">
      <input type="hidden" name="aux_qttoteve" value=""> 
      <input type="hidden" name="cdevento" 	 value="">
      <input type="hidden" name="cdagenci"     value="">
      <input type="hidden" name="aux_cdcopope" value="">  
      <input type="hidden" name="aux_eventsel" value="">  

      <div id="Layer1" style="position:absolute; border:0px; width:35px; height:35; z-index:1; left: 18px; top: 2px; visibility: visible;"><img src="/cecred/images/icones/ico_fornecedor.gif" width="28" height="32" align="bottom"></div>
      <!-- Inicio do modelo sem abas -->
      <table width="900" height="540"  border="0" align="left" cellpadding="0" cellspacing="0" background="/cecred/images/geral/guia_fundo.gif">
        <tr>
          <td height="20" colspan="5">
            <table width="968" border="0" cellspacing="0" cellpadding="0">
              <tr>
                <td width="11"><img src="/cecred/images/geral/guia_esquerda.gif" width="11" height="21"></td>
                <td width="56"><img src="/cecred/images/geral/spacer.gif" width="48" height="10"></td>
                <td width="820" height="20" class="linkGuia">Sele&ccedil;&atilde;o dos Eventos - Pr&eacute;-Assembl&eacute;ia</td>
                <td width="78" class="linkGuia" align="right">wpgd0054</td>
                <td width="11" align="right" valign="middle" class="linkGuia"><img src="/cecred/images/geral/guia_direita.gif" width="11" height="21"></td>
              </tr>
            </table>
          </td>
        </tr>
        <tr valign="top" bgcolor="#FFFFFF">
          <td colspan="5">
            <table width="100%" height="100%"  border="0" align="left" cellpadding="0" cellspacing="1" bgcolor="#999999">
              <tr>
                <td height="200" valign="top" bgcolor="#FFFFFF">
                  <table width="100%" height="100%"  border="0" cellpadding="0" cellspacing="0">
                    <tr>
                      <td height="15"  align="left" valign="top">
                        <!-- Interrupcao do modelo - início dos dados do programa -->
                        <table width="99%"  border="0" align="center" cellpadding="0" cellspacing="1">
                          <tr>
                            <td colspan="6" align="right" class="NomeCampo">&nbsp;</td>
                          </tr>
                          <tr>
                            <td colspan="1" align="right" class="NomeCampo">Agenda:</td>
                            <td colspan="1" class="NomeCampo">                                                
                                <input name="aux_dtanoage" class="Campo" type="text" size="8" onChange="document.form.aux_cddopcao.value = '';document.form.submit();" value="0">
                            </td>

                            <td colspan="1" align="right" class="NomeCampo">Cooperativa:</td>                                                            
                            <td colspan="1" class="NomeCampo">
                                <select name="aux_cdcooper" class="Campo" id="cdcooper" onChange="document.form.aux_dtanoage.value = '';document.form.aux_cddopcao.value = '';document.form.submit();"></select>
                            </td>
                            
                            <td colspan="1" align="right" class="NomeCampo">PA:</td>
                            <td colspan="1" class="NomeCampo">
                                <select name="aux_cdagenci" class="Campo" id="aux_cdagenci" onChange="document.form.cdagenci.value = document.form.aux_cdagenci.value;document.form.submit();"></select>
                            </td>
                          </tr> 
                          <tr>
                            <td colspan="6" align="right" class="NomeCampo">&nbsp;</td>
                          </tr>
                        </table>
                        <div id="divVerba" align="left">
                          <table width="100%" border="0" align="center" cellpadding="0" cellspacing="0">
                            <tr>
                              <td>
                                <table width="950" border="0" cellpadding="0" cellspacing="0" class="dataTable">
                                  <tr>
                                    <td id="separador1" height="25" width="1" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos">&nbsp;</td>
                                    <td id="tbevento_col1" width="25" align="left" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos">&nbsp</td>
                                    <td id="separador3" height="25" width="5" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos"><img src="/cecred/images/geral/div.gif"></td>
                                    <td id="tbevento_col3" width="120" align="left" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos">Evento</td>
                                    <td id="separador4" height="25" width="5" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos"><img src="/cecred/images/geral/div.gif"></td>
                                    <td id="tbevento_col4" width="80" align="left" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos">Tipo</td>
                                    <td id="separador5" height="20" width="5" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos"><img src="/cecred/images/geral/div.gif"></td>
                                    <td id="tbevento_col7" width="40" align="left" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos">Qtde.</td>
                                    <td id="separador8" height="25" width="5" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos"><img src="/cecred/images/geral/div.gif"></td>
                                    <td id="tbevento_col8" width="40" align="left" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos">Sug.Datas</td>
                                    <td id="separador9" height="25" width="5" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos"><img src="/cecred/images/geral/div.gif"></td>
                                  </tr>
                                </table> 
                              </td>
                            </tr>
                            <tr>
                              <td>
                                <div style="overflow: auto; height:'280px';">
                                  <table width="950" border="0" cellpadding="0" cellspacing="0" class="dataTable" id="tbevento">
                                    <!-- INCLIU DADOS -->
                                  </table>      
                                </div>
                              </td>
                            </tr>
                          </table>
                          <!-- Fim dos dados do programa - retorno ao modelo -->
                        </div>
                      </td>
                    </tr>
                    <tr>
                      <td height="15"  align="left" valign="bottom">
                        <table border="0" align="center" cellpadding="0" cellspacing="0">
                          <tr>
                            <td width="100" align="center" valign="bottom">
                              <img src="/cecred/images/botoes/btn_salvar.gif" style="cursor:hand; " onClick="Salvar()">
                            </td>
                            <td align="center" valign="bottom">
                              <img id="encerrar"  src="/cecred/images/botoes/enviar.gif" title="Encerrar a seleção de eventos" onClick="Encerra();" style="cursor:hand; display:none;margin-bottom:4px">
                              <img id="encerrado" src="/cecred/images/botoes/enviado.gif" title="A seleção de eventos já foi enviada para formação da agenda, não pode mais ser feita alteração." style="display:none;margin-bottom:4px">
                            </td>
                          </tr>
                        </table>
                      </td>
                    </tr>
                  </table>
                </td>
              </tr>
            </table>
          </td>
        </tr>
      </table>
    </div>
    <!-- fim do modelo -->
    </form>
  </body>
  
  <script language="JavaScript">
    NomeDoProgramaPrincipal = document.form.aux_dsendurl.value + NomeDoProgramaPrincipal;
    document.form.action = NomeDoProgramaPrincipal;

      function mostraEventos() {
        var row;
        var cell;

        var cor = '#F7F7F7';
        var cpgevobr;
        
        document.all.encerrar.style.display = "none";
        document.all.encerrado.style.display = "none";

        // Apaga todas as linhas, menos a do cabeçalho
        for (var i = document.all.tbevento.rows.length; i > 0; i--)
            document.all.tbevento.deleteRow(i - 1);
      
       if (document.form.aux_lsfselec.value != "") {
            var arrFlag = document.form.aux_lsfselec.value.split(';');
            document.form.aux_cddopcao.value = '';
        }
  
        for (i = 0; i < mevento.length; i++){

            if ((mevento[i].cdcooper == document.form.aux_cdcooper.value) &&
                (mevento[i].cdagenci == document.form.aux_cdagenci.value)){

              /* verifica se ja esta liberado para o PAC */
              if (mevento[i].flgcusfe == "1") {
                alert("Os dados para este PA não estão prontos. Por favor aguarde mais alguns dias.");
                return false;
              }


                /* Não é integração - preenche a tabela normalmente */
                /* else
                 { */
                row = tbevento.insertRow();
                row.id = mevento[i].cdagenci;

                if (cor == '#FFFFFF')
                    cor = '#F7F7F7';
                else
                    cor = '#FFFFFF';

                row.bgColor = cor;

                cell = row.insertCell();   // Separador
                cell.className = 'txtNormal';
                cell.width = document.all.separador1.width;
                cell.height = 26;
                cell.align = 'left';
                cell.innerText = '';

                // Flag de Selecionado
                cell = row.insertCell();
                cell.className = 'txtNormal';
                cell.width = document.all.tbevento_col1.width;
                cell.height = 10;
                cell.align = 'left';
                if (document.form.aux_lsfselec.value != "") {
                    if (arrFlag[i] == 'true') {
                        var marcar = "checked";
                    } else {
                        var marcar = "";
                    }
                }
                if (mevento[i].flgevobr){
				  cell.title = 'Evento obrigatório para a composição da agenda.';
				}
                linky = '<in' + 'put type="checkbox" name="aux_flgselec" id="aux_flgselec" ' + mevento[i].flgevsel + ' ' + mevento[i].flgevobr + ' ' + marcar + '>';
                cell.innerHTML = linky;

                cell = row.insertCell();   // Separador
                cell.className = 'txtNormal';
                cell.width = document.all.separador1.width;
                cell.height = 26;
                cell.align = 'left';
                cell.innerText = '';

                // Evento
                cell = row.insertCell();
                cell.className = 'txtPequeno';
                cell.width = document.all.tbevento_col3.width;
                cell.height = 10;
                cell.align = 'left';
                //linky = mevento[i].nmevento + '<in' + 'put type="hidden" name="aux_cdevento" value="' + mevento[i].cdevento + '">';
    linky = mevento[i].nmevento + '<in' + 'put type="hidden" name="aux_cdevento" value="' + mevento[i].cdevento + '">'
                  + '<in' + 'put type="hidden" name="aux_nmevento" value="' + mevento[i].nmevento + '">'; 
                cell.innerHTML = linky;

                cell = row.insertCell();
                cell.className = 'txtNormal';
                cell.width = document.all.separador1.width;
                cell.height = 26;
                cell.align = 'left';
                cell.innerText = '';

                // Tipo
                cell = row.insertCell();
                cell.className = 'txtPequeno';
                cell.width = document.all.tbevento_col4.width;
                cell.height = 10;
                cell.align = 'left';
                //campo hidden com o codigo do tipo do evento
                linky = mevento[i].tpevento + '<in' + 'put type="hidden" name="aux_dstpeven" value="' + mevento[i].dstpeven + '">';
                cell.innerHTML = linky;                        
                
                cell = row.insertCell();
                cell.className = 'txtNormal';
                cell.width = document.all.separador1.width;
                cell.height = 26;
                cell.align = 'left';
                cell.innerText = '';

                // sugestoes
                cell = row.insertCell();
                cell.className = 'txtNormal';
                cell.width = document.all.tbevento_col7.width;
                cell.height = 10;
                cell.align = 'center';
                cell.textAlign = 'center';

                linky = '<in' + 'put type="text" size="3"  style="margin-right:5px" class="qttoteve" maxlength="5" name="qttoteve" id="qttoteve'+i+'" value="' + ConverteDec(mevento[i].qttoteve, "1") + '" onkeypress="if(event.keyCode == 13){atribuiQtdEventos(this.value, ' + i + '); cadastraQtdEventos(' + ConverteDec(mevento[i].qttoteve, "1") + ',' + mevento[i].cdevento + ',' + i + ',' + mevento[i].dstpeven + ');}" >';

                cell.innerHTML = linky;
                cell = row.insertCell();
                cell.className = 'txtNormal';
                cell.width = document.all.separador1.width;
                cell.height = 26;
                cell.align = 'left';
                cell.innerText = '';

                // Datas
                cell = row.insertCell();
                cell.className = 'txtNormal';
                cell.width = document.all.tbevento_col8.width;
                cell.height = 10;
                cell.align = 'center';
                cell.textAlign = 'center';

                linky = '<in' + 'put type="hidden" size="3"  maxlength="5" id="hdnqttoteve' + i + '" name="hdnqttoteve' + i + '" value="' + ConverteDec(mevento[i].qttoteve, "1") + '"><img src="/cecred/images/btn_calendario.gif" style="cursor:hand;margin-right:5px" width="15" height="15" onclick="cadastraQtdEventos(' + ConverteDec(mevento[i].qttoteve, "1") + ',' + mevento[i].cdevento + ',' + i + ',' + mevento[i].dstpeven + ')">';

                cell.innerHTML = linky;
                
                cell = row.insertCell();
                cell.className = 'txtNormal';
                cell.width = document.all.separador1.width;
                cell.height = 26;
                cell.align = 'left';
                cell.innerText = '';
                
                cell = row.insertCell();   // Separador
                cell.className = 'txtNormal';
                cell.width = 20;
                cell.height = 26;
                cell.align = 'left';
                cell.innerText = '';                        
                
                if (mevento[i].flgcusfe == "2") {
                    document.all.encerrar.style.display = "none";
                    document.all.encerrado.style.display = "block";
                    $(".qttoteve").attr('disabled', 'disabled');

                } else {
                    document.all.encerrar.style.display = "block";
                    document.all.encerrado.style.display = "none";
                    $(".qttoteve").removeAttr('disabled');

                }

            }
        }

        document.form.aux_lsfselec.value = " ";

      }

      function CarregaPrincipal() {
        window.status = "";
      }

      function LimparCampos(){}
      
      function Habilita(){}
      
      function HabilitaSalvar(){}

      function ValidaDados(form){
        var msg = "";

        if (msg == ""){
          return true
        }else{
          top.frcod.MostraResultado('1', msg);
          return false
        }
      }

      function Recarrega(){
        document.form.submit();
      }

      function Salvar(){
          // Se não tem nada, não pode fazer nada.
          if (document.all.tbevento.rows.length == 0)
          {
              return false;
          }
          document.form.aux_stdopcao.value = 'al';
          var vaux = document.form.aux_lspermis.value;
          var valida = "";
          if ((vaux.substring(1, 2) == 'A') || (document.form.aux_stdopcao.value == 'i')) {
              if (document.form.aux_cddopcao.value != 'sa') { //vanessa 
                  Habilita();
                  HabilitaSalvar();
                  valida = ValidaSalvar();
                  ArmazenaValores();

                  status = 'Salvando. Por favor, aguarde ...';
                  if (valida == true) {
                      document.form.aux_cddopcao.value = 'sa';
                      document.form.submit();
                      return true;
                  }
              }
          }
          else {
              alert('Desculpe, mas você não tem permissão para executar esta função.');
              return false;
          }
      }

      function RetornoDaPesquisa(campo, valor, valor2, valor3, valor4, valor5, valor6, valor7, valor8, valor9, valor10)
      {
          if (campo == "media")
          {
              document.form.aux_vlrtotal.value = valor;  // Valor Total (retorna por causa da formatação
              document.form.aux_vlmedpac.value = valor2; // Média por PAC(R$)
              document.form.aux_pemedpac.value = valor3; // Média por PAC(%)
              document.form.aux_vldispac.value = valor4; // Distribuído (R$)
              document.form.aux_pedispac.value = valor5; // Distribuído (%)
              document.form.aux_vlrsaldo.value = valor6; // Saldo (R$)
              document.form.aux_persaldo.value = valor7; // Saldo (%)

              document.form.aux_peprogri[parseInt(valor8) - 1].value = valor10;
          }

      }

      function PesquisaCooper()
      {
          document.form.aux_vlrtotal.value = '';
          document.form.aux_cddopcao.value = 'pe';
          status = 'Pesquisando. Por favor, aguarde ...';
          document.form.submit();
          return true;
      }

      function MostraPACs(){
        
        var oOption;
        
        for (var i = document.all.aux_cdagenci.options.length; i >= 0; i--){
          document.all.aux_cdagenci.remove(i);
        }        

        for (i = 0; i < mpac.length; i++){
          if (mpac[i].cdcooper == document.form.aux_cdcooper.value){
            oOption = document.createElement("OPTION");
            document.all.aux_cdagenci.options.add(oOption);
            oOption.innerText = mpac[i].nmresage.substring(0,15);
            oOption.value = mpac[i].cdagenci;
          }
        }
      }

      function PosicionaPAC(){
        if (document.form.aux_cdagenci.value != ""){
          MostraPACs();
          document.form.aux_cdagenci.value = document.form.cdagenci.value;
        }else{
          // posiciona a seleção no primeiro registro de Cooperativas, se só tiver 1
          if (document.all.aux_cdcooper.options.length == 1){
            document.form.aux_cdcooper.value = document.all.aux_cdcooper.options[0].value;
          }else{
            document.form.aux_cdcooper.value = '';
          }
          // posiciona a seleção no primeiro registro de PACs, se só tiver 1
          if (document.all.aux_cdagenci.options.length == 1){
            document.form.aux_cdagenci.value = document.all.aux_cdagenci.options[0].value;
          }else{
            document.form.aux_cdagenci.value = '';
          }
        }
        mostraEventos();
      }

  // Converte um valor com decimal separado por "," para separado por "."
      function ConverteDec(str, tipo)
      {
          if (tipo == "1")
          {
              str = str.replace(".", "");
              str = str.replace(",", ".");
              return str;
          }
          else
          {
              str = str.replace(",", "");
              str = str.replace(".", ",");
              return str;
          }
      }

  // Guardar os valores da tabela para que sejam salvos no banco de dados
      function ArmazenaValores(){
          document.form.aux_lsfselec.value = '';
          document.form.aux_lscuseve.value = '';
          document.form.aux_qttoteve.value = '';
          
          if (document.all.tbevento.rows.length > 0){
              if (document.form.aux_flgselec.length > 1){ // Se tem mais de um evento
                  for (i = 0; i < document.all.tbevento.rows.length; i++){
                      // Grava os valores em forma de lista, separados por ";", para que seja lido pelo progress
                      if (document.form.aux_lscuseve.value == ''){
                          document.form.aux_lsfselec.value = document.form.aux_flgselec[i].checked;
                          document.form.aux_lscuseve.value = document.form.aux_cdevento[i].value;
                          document.form.aux_qttoteve.value = document.getElementById("qttoteve"+i).value;
                      }else{
                          document.form.aux_lsfselec.value = document.form.aux_lsfselec.value + ';' +
                                  document.form.aux_flgselec[i].checked;
                          document.form.aux_lscuseve.value = document.form.aux_lscuseve.value + ';'
                                  + document.form.aux_cdevento[i].value;
                          document.form.aux_qttoteve.value = document.form.aux_qttoteve.value + ';' + document.getElementById("qttoteve"+i).value;
                      }
                  }
              }else{
                  document.form.aux_lsfselec.value = document.form.aux_flgselec.checked;
                  document.form.aux_lscuseve.value = document.form.aux_cdevento.value;
                  document.form.aux_qttoteve.value = document.form.qttoteve.value;
              }
          }
      }

  // Emite as condições básicas na seleção de eventos
      function Valida()
      {
          var aux_qtdesele = 0;
          var erro = "";
  

          // Se não tem nada, não pode fazer nada.
          if (document.all.tbevento.rows.length == 0)
          {   //Ajuste JMD
              alert("A quantidade de eventos selecionados não é o mesmo que o previsto.");
              erro = "1";

              if (erro == "1") {
                  return false;
              } else {
                  return true;
              }


          }
          else
          {
              for (i = 0; i < document.all.tbevento.rows.length; i++)
              {
                  if (document.form.aux_flgselec.length > 1)
                  {
                      if (document.form.aux_flgselec[i].checked && ( parseInt(document.form.aux_dstpeven[i].value, 10) != 2 ) )
                      {  
          //aux_qtdesele = aux_qtdesele + 1;
          aux_qtdesele = aux_qtdesele + parseInt(document.getElementById("qttoteve"+i).value);
                      }
                  }
                  else
                  {
                      if (document.form.aux_flgselec.checked && ( parseInt(document.form.aux_dstpeven.value, 10) != 2 ))
                      { 
                          //aux_qtdesele = aux_qtdesele + 1;
          aux_qtdesele = aux_qtdesele + parseInt(document.getElementById("qttoteve"+i).value);
                      }
                  }
              }
    
    document.form.aux_eventsel.value = aux_qtdesele;
  
              return true;

          }

      }

  // Clicou no fechar o cadeado
      function Encerra() {
          
          // Verifica se o usuário tem permissão de salvar
          if (document.form.aux_lspermis.value.substring(1, 2) != 'A') {
              alert('Desculpe, mas você não tem permissão para executar esta função.');
              return false;
          }
          
          if(!ValidaSalvar()){
            return false;
          }

          if (Valida()){
            if (confirm("Após encerrada a seleção dos eventos, os mesmos ficarão bloqueados e as alterações só poderão ser feitas pela coordenação das Assembléias. Deseja prosseguir?") == false){
              return false;
			}	

            ArmazenaValores();
            document.form.aux_cddopcao.value = 'enc';
            status = 'Salvando. Por favor, aguarde ...';
            document.form.submit();
            return true;
          }


      }

  //formatação dos campos
      function formatCurrency(num){
          //alert(num);
          num = num.toString().replace(/\$|\,/g, '');
          if (isNaN(num))
              num = "0";
          sign = (num == (num = Math.abs(num)));
          num = Math.floor(num * 100 + 0.50000000001);
          cents = num % 100;
          num = Math.floor(num / 100).toString();
          if (cents < 10)
              cents = "0" + cents;
          for (var i = 0; i < Math.floor((num.length - (1 + i)) / 3); i++)
              num = num.substring(0, num.length - (4 * i + 3)) + '.' +
                      num.substring(num.length - (4 * i + 3));
          return (((sign) ? '' : '-') + num + ',' + cents);
      }

      //Valida botão Salvar
      function ValidaSalvar(){
        var itemselec = false;
        var valida = true
        var cont = 0;
        var totalEventos = 0;
        		
		if(document.all.tbevento.rows.length > 1){	
			for (i = 0; i < document.form.aux_flgselec.length; i++) {
			  if (document.form.aux_flgselec[i].checked == true) {
				cont = cont + 1;
				itemselec = true;
			  }else{ 
				if(document.form.qttoteve[i].value > 0){
				  alert("O Evento " + document.form.aux_nmevento[i].value + " possui datas cadastradas, porém não está selecionado!");
				  return false;
				  break;
				}					
			  }
			}
		}else{
		  if (document.form.aux_flgselec.checked == true) {
            cont = cont + 1;
            itemselec = true;
          }
		}
        //armazena a Qtde dos eventos selecionados
        document.form.aux_eventsel.value = totalEventos;

        if (itemselec == false) {
            alert("Nenhum evento selecionado para ser salvo.");
        }
        return true;
      }
      
      function formularioEmail() {
          var arrCaminho = document.form.aux_dsurlphp.value.split('-');
          VarURL = arrCaminho[0] + '/telas/wpgd0054/envia_sugestao.php?cdcooper=' + document.form.aux_cdcopope.value + '&aux_cdcooper=' + document.form.aux_cdcooper.value + '&cdoperad=' + document.form.aux_cdoperad.value + '&idevento=' + document.form.aux_idevento.value + '&dtanoage=' + document.form.aux_dtanoage.value + '&nmdatela=wpgd0054&tldatela=Sugestão&idcokses=' + arrCaminho[1] + '&cdagenci=' + document.form.aux_cdagenci.value;
          window.open(VarURL, '', 'toolbar=no,location=no,diretories=no,status=no,menubar=no,scrollbars=yes,resizable=yes,width=600,height=450,top=10,left=10');


      }
      function atribuiQtdEventos(quantidade, i) {
          $("#qttoteve" + i).val(quantidade);
      }

      function cadastraQtdEventos(quantidade, cdevento, i, tpevento) {
          var arrCaminho = document.form.aux_dsurlphp.value.split('-');
                  
          if (quantidade != $("#qttoteve" + i).val()) {
              quantidade = $("#qttoteve" + i).val();
          }
          
          if (quantidade > 0) {          
              VarURL = arrCaminho[0] + '/telas/wpgd0054/cadastra_qtdeventos.php?cdcooper=' + document.form.aux_cdcopope.value + '&aux_cdcooper=' + document.form.aux_cdcooper.value + '&cdoperad=' + document.form.aux_cdoperad.value + '&idevento=' + document.form.aux_idevento.value + '&cdevento=' + cdevento + '&dtanoage=' + document.form.aux_dtanoage.value + '&nmdatela=wpgd0054&tldatela=Sugestão de Datas&idcokses=' + arrCaminho[1] + '&cdagenci=' + document.form.aux_cdagenci.value + '&qtdeventos=' + quantidade + '&tpevento=' + tpevento + '&flgcusfe=' + mevento[i].flgcusfe;
              window.open(VarURL, '', 'toolbar=no,location=no,diretories=no,status=yes,menubar=no,scrollbars=yes,resizable=yes,width=835,height=530,top=10,left=10');

          } else {
              var exclui = confirm('Informações de datas já gravadas serão excluídas!');
              if (exclui == true) {
                  document.form.aux_cddopcao.value = 'exe';
                  document.form.cdevento.value = cdevento;
                  status = 'Excluindo. Por favor, aguarde ...';
                  document.form.submit();
                  $("#qttoteve" + i).val(quantidade);
                  return true;
              }
          }
      }

      // valida os parâmetros da agenda
      if (document.form.aux_dtanoage.value == '') {
          alert('Parâmetro da Agenda Não Encontrado!!!');

          document.form.aux_dtanoage.value = '';
          document.form.aux_cdagenci.value = '';
          document.form.aux_cdcooper.value = '';

      } else {
          MostraPACs();
      }
  </script>
</html>