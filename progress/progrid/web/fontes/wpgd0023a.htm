<html>
<head>
<meta name="AUTHOR" content="Solusoft/Bt - wpgd0023a - C.18">
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta name="wsoptions" content="no-output">
<meta name="GENERATOR" content="Microsoft FrontPage 4.0">
<meta http-equiv="Cache-Control" content="No-Cache">
<meta http-equiv="Pragma"        content="No-Cache">
<meta http-equiv="Expires"       content="0">
<title>Sele&ccedil;&atilde;o de Eventos (wpgd0023a)</title>
<link href="/cecred/estilos/progrid.css" rel="stylesheet" type="text/css">

<!--script SRC="/cecred/jsbiblio/sorttable.js"></script-->
</head>
<body>

<script language="JavaScript">
   NomeDoProgramaPrincipal  = '/wpgd0023a.w';
   NomeDoProgramaDeListagem = '/wpgd0023als.w';
   NomeDoProgramaDeAjuda    = '/wpgd0023aaj.w';
   NomeDoProgramaDeZoom     = '/zoom/zoei04.w';
</script>
<form action="#." method="POST" name="form"><div align="right">
  <input type="hidden" name="aux_dsendurl" value="">
  <input type="hidden" name="aux_idevento" value="">
  <input type="hidden" name="aux_cddopcao" value="">
  <input type="hidden" name="aux_nrdrowid" value="">
  <input type="hidden" name="aux_lspermis" value="">
  <input type="hidden" name="aux_dsretorn" value="">
  <input type="hidden" name="aux_stdopcao" value="">  
  <input type="hidden" name="aux_lsevento" value="">
  <input type="hidden" name="aux_cdcooper" value="">
  <input type="hidden" name="aux_cdagenci" value="">
  <input type="hidden" name="aux_dtanoage" value="">
  <input type="hidden" name="dtanoage"     value="">
  <!-- Inicio do modelo com abas -->
  <table width="445" height="280"  border="0" align="center" cellpadding="0" cellspacing="0">
    <tr>
      <td width="100%" height="20">
	  <table width="100%" border="0" cellpadding="0" cellspacing="0">
        <tr>
          <td width="100%">
            <table width="100%" border="0" cellpadding="0" cellspacing="0">
              <tr>
                <td width="11" background="/cecred/images/geral/guia_fundo.gif"><img src="/cecred/images/geral/guia_esquerda.gif" width="11" height="21"></td>
                <td background="/cecred/images/geral/guia_fundo.gif" align="center" nowrap width="95" class="linkGuia">Eventos </td>
                <td background="/cecred/images/geral/guia_fundo.gif" width="11" align="right"><img src="/cecred/images/geral/guia_direita.gif" width="11" height="21"></td>
				<td>&nbsp;</td>
              </tr>
	      	  <tr>
                <td colspan="4" height="3" align="left" background="/cecred/images/menu/mnu_slc.gif"></td>
              </tr>
            </table>
		  </td>
        </tr>
      </table>
	  </td>
    </tr>
    <tr valign="top" bgcolor="#FFFFFF">
      <td>
      <table width="100%" height="100%"  border="0" align="left" cellpadding="0" cellspacing="0" >
		<tr>
		  <td height="1" valign="top" bgcolor="#FFFFFF">            
		  <table border="0" width="100%" cellpadding="0" cellspacing="0">
        	<tr>
			  <td height="1">
			  <table width="100%" border="0" cellpadding="0" cellspacing="0">
				<tr>
				  <td height="25" width="230" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos">&nbsp;&nbsp;Descri&ccedil;&atilde;o</td>
				</tr>
			  </table>
			  </td>
		    </tr>
			<tr>
			  <td height="1">
		      <div style="overflow: auto; height:'230';">
			  <table width="100%" border="1" bordercolor="#CCCCCC" cellpadding="0" cellspacing="0" id="tbevento">
				<!-- INCLUI DADOS -->
			  </table>
			  </div>
			  </td>
		    </tr>       
          </table>
          </td>
        </tr>
      </table>
      </td>
    </tr>
</table>
<div id="btSalvar" align="center"><br><img src="/cecred/images/botoes/btn_salvar.gif"  onClick="Salvar();"  style="cursor:hand;"></div>
	
</body>
</html>
<script language="Javascript">
   NomeDoProgramaPrincipal = document.form.aux_dsendurl.value + NomeDoProgramaPrincipal;
   document.form.action = NomeDoProgramaPrincipal;

function Salvar() { 
	
   var vaux = document.form.aux_lspermis.value; 
   if ((vaux.substring(1,2) == 'A') || (document.form.aux_stdopcao.value == 'i')) { 
        if (document.form.aux_cddopcao.value!='sa') {			
            document.form.aux_cddopcao.value='sa'; 
            document.form.aux_stdopcao.value='i';
            armazenaEventos();
            status = 'Salvando. Por favor, aguarde ...';
            document.form.submit();
			
            return false;
        } else { 
            return false;
        }  
   } else {
      alert('Desculpe, mas você não tem permissão para executar esta função.'); 
      return false;
   }
   
}

function mostraEventos()
{
  var row; var cell;  
  
  // limpa a tabela de Eventos, menos a 1ª linha - linha do cabecalho
  for (var i=document.all.tbevento.rows.length; i>1; i--)
      document.all.tbevento.deleteRow(i-1);
	  
  for(i=0;i<mevcoop.length;i++){      // insere linhas na tabela de eventos
     
     row=tbevento.insertRow();  // nova linha
     row.id=i;
     row.onclick=mudaCor;

     cell=row.insertCell();      
	 cell.style.cursor = 'hand';
	 cell.height = '20px';
	 cell.width = '100%';
     cell.className = 'txtNormal';
     linky='&nbsp;&nbsp;'+mevcoop[i].nmevento + '<in' + 'put type="hidden" name="evento" value="' + mevcoop[i].cdevento + '">';
     cell.innerHTML=linky; 
  }
}

function armazenaEventos(){
  var i;

  // se for mais de um registro de evento
	if (mevcoop.length > 1) { 
		for(i=0;i<document.form.evento.length;i++) { 
               
       if(document.form.evento[i].checked){
				if(document.form.aux_lsevento.value == '') { 
             document.form.aux_lsevento.value = document.form.evento[i].value;
				}else{	
	         document.form.aux_lsevento.value = document.form.aux_lsevento.value + ',' + document.form.evento[i].value;
       } 
     }
		}
	} else{ // se for somente um registro de evento
		
		 if(document.form.evento.checked) {
	    document.form.aux_lsevento.value = document.form.evento.value;
  }
}
}

function CarregaPrincipal()
{
}

function LimparCampos()
{
}

function mudaCor()
{

  // se houver mais de um registro de recursos
  if (mevcoop.length > 1){
     if (document.form.evento[this.id].checked==false){
         this.bgColor = '#CCCCCC';
         document.form.evento[this.id].checked=true;
     }
     else{
         this.bgColor = '#FFFFFF';
         document.form.evento[this.id].checked=false;
	 }
  }
  // se for somente um registro de eventos
  else{
     if (document.form.evento.checked==false){
         this.bgColor = '#CCCCCC';
         document.form.evento.checked=true;
     }
     else{
         this.bgColor = '#FFFFFF';
	     document.form.evento.checked=false;
     }
  }  
}

mostraEventos();

</script>
