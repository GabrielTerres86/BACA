<!------------------------------------------------------------------------------------

  Alterações: 25/07/2017 - Criaçao da Tela para Eventos Assembleares, fonte cópia da
                           tela WPGD0019, Prj. 322 (Jean Michel).
                         
------------------------------------------------------------------------------------>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>Evento</title>
<link href="/cecred/estilos/progrid.css" rel="stylesheet" type="text/css">

		<link href="/cecred/css/estilo2.css" rel="stylesheet" type="text/css">		
		<link href="/cecred/css/tooltip.css" rel="stylesheet" type="text/css">
		<link href="/cecred/css/jquery.ui.datepicker.css" rel="stylesheet" type="text/css">
		<link rel="stylesheet" href="/cecred/css/base/jquery.ui.all.css">
		
		<script type="text/javascript" src="/cecred/scripts/scripts.js"></script>
		<script type="text/javascript" src="/cecred/scripts/dimensions.js"></script>
		<script type="text/javascript" src="/cecred/scripts/funcoes.js"></script>
		<script type="text/javascript" src="/cecred/scripts/mascara.js"></script>
		<!--<script type="text/javascript" src="/cecred/scripts/menu.js"></script>-->		
		<script type="text/javascript" src="/cecred/scripts/tooltip.js"></script>

		<script type="text/javascript" src="/cecred/scripts/jquery.ui.core.js"></script>
		<script type="text/javascript" src="/cecred/scripts/jquery.ui.datepicker.js"></script>
		<script type="text/javascript" src="/cecred/scripts/i18n/jquery.ui.datepicker-pt-BR.js"></script>
		
		<style>
			.ui-datepicker-trigger{
				margin-left:6px;
				margin-top:6px;
			}

			.radio{
				margin-left:6px;
				margin-top:6px;
			}
		</style>
		<script type="text/javascript" >
		function maximoCaracteres(dsc,qtd){
			var str = document.getElementById(dsc).value;
			
			if(str.length > qtd){
			  document.getElementById(dsc).value = str.substr(0,qtd-1);
			  return false;
			};
		  }
		</script>
</head>
<body>

		<form action="#." method="POST" name="form" name="form" >
			<input name="cdagenci" type="hidden" value="">
			<input name="cdcooper" type="hidden" value="">
			<input name="cdlocali" type="hidden" value="">
			<input name="nrseqfea" type="hidden" value="">
			<input name="idstaeve" type="hidden" value="">
			<input name="aux_cddopcao" type="hidden" value="">
			<input name="aux_lspermis" type="hidden" value="">
			<input name="aux_nrdrowid" type="hidden" value="">      
			<input name="aux_dtanoage" type="hidden" value="">
			<input name="aux_cdevento" type="hidden" value="">      
			<input name="aux_dsretorn" type="hidden" value="">
			<input name="aux_stdopcao" type="hidden" value="?">
			<input name="aux_dsendurl" type="hidden" value="">
			<input name="aux_idevento" type="hidden" value="">
			<input name="aux_idexclui" type="hidden" value="">
			<input name="aux_nmpagina" type="hidden" value="">
			<input name="aux_idinseve" type="hidden" value="">
			<input name="aux_idfernac" type="hidden" value="">
			<input name="aux_idfermun" type="hidden" value="">
			<input name="aux_idfimsem" type="hidden" value="">
			<input name="aux_preferna" type="hidden" value="">
			<input name="aux_prefermu" type="hidden" value="">
			<input name="aux_posferna" type="hidden" value="">
			<input name="aux_posfermu" type="hidden" value="">			
			<input name="aux_idvapost" type="hidden" value="">      
			<input name="aux_vercoope" type="hidden" value="">			
			<input name="aux_verregio" type="hidden" value="">
			<input name="aux_nrseqdig" type="hidden" value="">
			<input name="aux_nrcpfcgc" type="hidden" value="">
			<input name="aux_semanadi" type="hidden" value="">
			<input name="aux_verfimes" type="hidden" value="">
			<input name="aux_semapost" type="hidden" value="">
			<input name="aux_cdcopope" type="hidden" value="">
			<input name="aux_cdoperad" type="hidden" value="">
			<input name="tel_dsdiaeve" type="hidden" value="">
			<input name="aux_mesevent" type="hidden" value="">
			<input name="aux_alteraca" type="hidden" value="">
			<input name="aux_idstagen" type="hidden" value="">
			<input name="aux_pessoapost" type="hidden" value="">
			<input name="aux_pessoaab" type="hidden" value="">
			
      <div id="divCabecalho">
				<table border="0" cellpadding="0" cellspacing="0" width="200" >
    <tr>
						<td width="100" align="left" height="15">
              <table width="100" id="AbaEvento" border="0" cellpadding="0" cellspacing="0">
                <tr style="cursor:hand;">
                  <td background="/cecred/images/menu/mnu_nle.gif" width="4" height="21"></td>
                  <td width="92" align="center" class="txtTituloHid" onclick="mostraDiv('divEvento')">Evento</td>
                  <td background="/cecred/images/menu/mnu_nld.gif" width="4" height="21"></td>
                </tr>
              </table>
            </td>
						<td width="100" align="left" height="15">
              <table width="100" id="AbaHistorico" border="0" cellpadding="0" cellspacing="0">
                <tr style="cursor:hand;">
                  <td background="/cecred/images/menu/mnu_nle.gif" width="4" height="21"></td>
                  <td width="92" align="center" class="txtTituloHid" onclick="mostraDiv('divHistorico')">Histórico</td>
                  <td background="/cecred/images/menu/mnu_nld.gif" width="4" height="21"></td>
                </tr>
              </table>
            </td>
          </tr>
        </table>
			</div>
			
    <div id="divEvento">
				<table width="600" align="left" cellpadding="0" cellspacing="1" bgColor="#FFFFFF">
        <tr>
						<td height="24" align="right" class="NomeCampo">Evento:</td>
						<td height="24"><input name="aux_nmevento" type="text" class="Campo" size="40" maxlength="40" readOnly VALUE="">
                                        Integração BRC:<input name="aux_recid" type="text" class="Campo" size="8" maxlength="8" readOnly VALUE="">						
						</td>
                </tr>                                    
              <tr>
						<td height="24" align="right" class="NomeCampo">PA:</td>
						<td height="24"><input name="aux_nmresage" type="text" class="Campo" size="40" maxlength="40" readOnly VALUE=""></td>
              </tr>
	      	  <tr>
						<td height="24" align="right" class="NomeCampo">Mês:</td>
						<td height="24"><input name="aux_nrmeseve" type="text" class="Campo" size="40" maxlength="40" readOnly VALUE=""></td>
              </tr>
          <tr>
						<td height="24" class="NomeCampo" align="right">Data início:</td>
						<td height="24" class="NomeCampo">
							<input name="dtinieve" id="dtinieve" type="text" class="Campo" size="8" onchange="preencheDia(this.name,this.value);" onkeyup="validaData(this.name,this.value)" >
		  </td>
        </tr>
          <tr>
						<td height="24" class="NomeCampo" align="right">Data término:</td>
						<td height="24" >
							<input name="dtfineve" id="dtfineve" type="text" class="Campo" size="8" onchange="preencheDia(this.name,this.value);" onkeyup="validaData(this.name,this.value)" >
	  </td>
    </tr>
		<tr>
						<td height="24" class="NomeCampo" align="right">Dias do Evento:</td>
						<td height="24" class="NomeCampo">
							<input type="checkbox" id="aux_dsdiaeve1" name="aux_dsdiaeve" value="1"/>Seg
							<input type="checkbox" id="aux_dsdiaeve2" name="aux_dsdiaeve" value="2"/>Ter
							<input type="checkbox" id="aux_dsdiaeve3" name="aux_dsdiaeve" value="3"/>Qua
							<input type="checkbox" id="aux_dsdiaeve4" name="aux_dsdiaeve" value="4"/>Qui
							<input type="checkbox" id="aux_dsdiaeve5" name="aux_dsdiaeve" value="5"/>Sex
							<input type="checkbox" id="aux_dsdiaeve6" name="aux_dsdiaeve" value="6"/>Sab
							<input type="checkbox" id="aux_dsdiaeve0" name="aux_dsdiaeve" value="0"/>Dom
						</td>
           </tr>  
        	<tr>
						<td height="24" class="NomeCampo" align="right">Número de Dias do Evento:</td>
						<td height="24" class="NomeCampo"><input id="qtdiaeve" name="qtdiaeve" type="text" class="Campo inteiro" style="width:40px; text-align:right;" value="0" readOnly></td>
           </tr>  
				<tr>
						<td height="24" class="NomeCampo" align="right">Qtde. Participantes:</td>
						<td height="24" class="NomeCampo"><input id="qtparpre" name="qtparpre" type="text" class="Campo inteiro" style="width:20px; text-align:right;" onchange="resetaJustificativa();" value="0" readOnly>
                                                          Número do Grupo:<input id="nrdgrupo" name="nrdgrupo" type="text" class="Campo inteiro" style="width:30px; text-align:right;" maxlength="4" value="0" >						
						                                  Nome do Grupo:<input name="nmdgrupo" id="nmdgrupo" type="text" class="Campo" maxlength="12" value="" >
				</tr>
           <tr>
						<td height="24" class="NomeCampo" align="right">Horário:</td>
						<td height="24"><input name="dshroeve" id="dshroeve" type="text" class="Campo" maxlength="20" value="" ></td>
                 </tr>
           <tr>


           </tr>
           <tr>
           </tr>
		   
                 <tr>
						<td height="24" class="NomeCampo" align="right">Local:</td>
						<td height="24"><select name="aux_cdlocali" style="width: 370px;" class="Campo" onchange="resetaJustificativa();"></select></td>
                                 </tr>
                                 <tr>
						<td height="24" class="NomeCampo" align="right">Abertura:</td>
						<td height="24"><select name="aux_nrseqfea" style="width: 370px;" class="Campo" onchange="resetaJustificativa();"></select></td>
                 </tr>
					<tr>
						<td height="24" class="NomeCampo" align="right">Justificativa:</td>
						<td height="24" class="NomeCampo" align="left">
							<textarea name="aux_dsjustif" id="aux_dsjustif" cols="70" rows="3" onkeypress="maximoCaracteres('aux_dsjustif',100);" class="textarea" ></textarea>
           </td>   
          </tr>  
					<tr>
						<td height="24" class="NomeCampo" align="right">Operador:</td>
						<td height="24" class="NomeCampo" align="left">
							<input name="tel_cdoperad" type="text" class="campoTelaSemBorda" size="50" value="">
        </td>
    </tr>
			  </table>
  </div>
<div id="divHistorico">
				<table cellpadding="0" cellspacing="1" border="0" bgcolor="#999999" width="600" height="230">
<tr>
						<td height="26" align="left" valign="bottom">
							<table cellpadding="0" cellspacing="0" border="0" bgcolor="#FFFFFF" width="600" height="230">
        <tr>
          <td height="26" align="left" valign="top">
                <table cellpadding="0" background="/cecred/images/menu/fnd_title.jpg" cellspacing="0" border="0" width="100%" height="26">
                  <tr>
                        <td width="5" height="26" id="separador1" background="/cecred/images/menu/fnd_title.jpg">&nbsp;</td>
                        <td width="80" id="tbhistorico_col1" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos">Data</td>
                        <td width="5" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                        <td id="tbhistorico_col2" align="left" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos">Descrição</td>
                        <td width="15" id="tbhistorico_col3" align="left" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                  </tr>
                </table>
			  </td>
		    </tr>
			<tr>
          <td align="left" valign="top"> 
                <div style="overflow: auto; height:'229px';">
                        <table id="tbhistorico" cellpadding="0" cellspacing="0" border="0" width="100%">
				<!-- INCLUI DADOS -->
			  </table>
			  </div>
			  </td>
		    </tr>       
          </table>
          </td>
        </tr>
      </table>
</div>

<div id="divMotivo">
				<table cellpadding="0" cellspacing="1" border="0" bgcolor="#999999" width="375" height="230">
<tr>
  <td height="26" align="left" valign="top">
    <table cellpadding="0" border="0" cellspacing="0" bgColor="#FFFFFF" width="100%" height="100%">
          <tr>
                  <td width="5" height="26" align="left" background="/cecred/images/menu/fnd_title.jpg">&nbsp;</td>
            <td height="26" align="left" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos">Motivo</td>
          </tr>
      <tr>
                  <td width="5" height="26" align="left">&nbsp;</td>
                <td align="left" valign="top"><textarea name="aux_motivo" class="CampoTextArea" cols="75" rows="10"></textarea></td>
          </tr>
    </table>
      </td>
    </tr>
</table>
</div>
			<br>
			<div id="divBotoes">
  <table align=center>
  <tr>
    <td align="center" valign="bottom" colspan="4" height="8"></td>
  </tr>
  <tr>
    <td align="center" valign="bottom">
       <div><img style="cursor:hand" src="/cecred/images/botoes/btn_salvar.gif" onClick="Salvar()"></div>
    </td>
    <td align="center" valign="bottom">
       <div id="btncancela"><img style="cursor:hand" src="/cecred/images/botoes/btn_cancelar_evento.gif" onClick="Cancelar()"></div>
    </td>
    <td align="center" valign="bottom">
       <div id="btnreativa"><img style="cursor:hand" src="/cecred/images/botoes/btn_reativar_evento.gif" onClick="Reativa()" alt="Reativa Evento"></div>
    </td>
        <td align="center" valign="bottom">
       <div><img style="cursor:hand" src="/cecred/images/botoes/btn_excluir_botao.gif" onClick="Excluir()"></div>
    </td>
    <td align="center" valign="bottom">
       <div><img style="cursor:hand" src="/cecred/images/botoes/btn_fechar.gif" onClick="window.close();"></div>
    </td>              
  </tr>
  </table>
			<div>
</form>
</body>
  <script language="JavaScript">

    var arrDataMesEve = document.form.aux_mesevent.value.split('/');
    var aux_mesevent = arrDataMesEve[1] + '/' + arrDataMesEve[0] + '/' + arrDataMesEve[2];
    aux_mesevent = new Date(aux_mesevent);
    
  
   NomeDoProgramaPrincipal  = '/wpgd0023a.w';
   NomeDoProgramaDeListagem = '/wpgd0023als.w';
   NomeDoProgramaDeAjuda    = '/wpgd0023aaj.w';
   
   NomeDoProgramaPrincipal = document.form.aux_dsendurl.value + NomeDoProgramaPrincipal;
   document.form.action = NomeDoProgramaPrincipal;

    document.form.dshroeve.onkeypress=function(){resetaJustificativa()}
	
   if (parseInt(document.form.idstaeve.value)==2) {
      document.all.btncancela.style.display='none';
      document.all.btnreativa.style.display='inline';
    }else{
      document.all.btncancela.style.display='inline';
      document.all.btnreativa.style.display='none';
   }
   

	function diaSemana(date) { 
		var checkDate = new Date(date); 
		var firstDay  = new Date(); 
		return checkDate.getDay();		
	}
	
	function somaDias(date){ 
		var DataMais7 = new Date(date); 
		DataMais7.setDate(date.getDate() + 7);
		//alert(DataMais7);
		return DataMais7;
	}
	
	function numSemana(dateIni, dateFim) {
		//alert(dateIni); alert(dateFim);
		var	diaI;
		var diaF;
		var data_ini_7;
		
		diaI = diaSemana(dateIni);
		diaF = diaSemana(dateFim);
		data_ini_7 = somaDias(dateIni);
		
		if (diaF < diaI || data_ini_7 <= dateFim){
			var conf = confirm("Semana de início de evento diferente da semana final. Deseja continuar?");
			return (!conf) ? false : true;
		}else{
			return true;
		}
 	}  
	
				
	
		// valida a digitação da data nos campos
	function validaData(campo,valor){

	   if((event.keyCode==9)||    // TAB
		  (event.keyCode==16)){   // BACK-TAB
			  return true;
	   } 
	   
	   // tira as barras
	   document.form[campo].value = document.form[campo].value.replace("/","");
	   document.form[campo].value = document.form[campo].value.replace("/","");
	   
	   // data são 8 caracteres
	   document.form[campo].value = document.form[campo].value.substring(0,8);

	   // varre o campo em busca de caracteres inválidos e remove-os
	   for(var i=0;i< document.form[campo].value.length;i++){
		  
			  if((document.form[campo].value.substring(i,i+1)!='0')&&
			 (document.form[campo].value.substring(i,i+1)!='1')&&
			 (document.form[campo].value.substring(i,i+1)!='2')&&
			 (document.form[campo].value.substring(i,i+1)!='3')&&
			 (document.form[campo].value.substring(i,i+1)!='4')&&
			 (document.form[campo].value.substring(i,i+1)!='5')&&
			 (document.form[campo].value.substring(i,i+1)!='6')&&
			 (document.form[campo].value.substring(i,i+1)!='7')&&
			 (document.form[campo].value.substring(i,i+1)!='8')&&
			 (document.form[campo].value.substring(i,i+1)!='9'))          
				  document.form[campo].value = document.form[campo].value.substring(0,i);   
	   }   
		  
	   // valida o dia e formata a data - DD/MM
	   if(document.form[campo].value.length > 2){
		  if((document.form[campo].value.substring(0,2) > "31")||
			 (document.form[campo].value.substring(0,2) == "00")){
				 alert("Dia inválido! Deve ser entre 01 e 31!");
					 document.form[campo].value="";
					 return false;
			  }
	   
		  document.form[campo].value = document.form[campo].value.substring(0,2) + "/" +
										   document.form[campo].value.substring(2,document.form[campo].value.length);
	   }                                                           

	   // valida o mes e formata a data - MM/AAAA
	   if(document.form[campo].value.length > 5){
		  if((document.form[campo].value.substring(3,5) > "12")||
			 (document.form[campo].value.substring(3,5) == "00")){
				 alert("Mês inválido! Deve ser entre 01 e 12!");
					 document.form[campo].value="";
					 return false;
			  }
				 
		  document.form[campo].value = document.form[campo].value.substring(0,5) + "/" +
										   document.form[campo].value.substring(5,document.form[campo].value.length);                                                                    
	   }
	   
	   if(valor.length == 10){
		  preencheDia(campo,valor);
	   }
	}

function ValidaDados(form){ 
    
    var msg = "";
         
        //msg = msg + top.frcod.VE("ca",form.dseixtem,"A descrição do eixo temático","nao");
      
        if (msg == "")
       return true
    else{
           alert(msg);
           return false
         }
}

  function LimparCampos(){
   document.form.cdevento.value = '';
   document.form.cdeixtem.value = '';
}

function Recarrega(){
  document.form.cdeixtem.value = document.form.aux_cdeixtem.value;
  document.form.cdevento.value = document.form.aux_cdevento.value;
  document.form.submit();  
}

  
  function Incluir(){
   var vaux = document.form.aux_lspermis.value; 
   if (vaux.substring(0,1) == 'I'){ 
          if (document.form.aux_stdopcao.value == 'i'){ 
                   alert('Você já esta no modo de inclusão'); 
                     return false;
                } 
             else{ 
                   document.form.aux_cddopcao.value ='in'; 
                   document.form.aux_stdopcao.value ='i';
                   LimparCampos(); 
                     return true;
                } 
       } 
    else{ 
          alert('Desculpe, mas você não tem permissão para executar esta função.'); 
            return false;
       }
}

function Salvar(){

   //ZeraModoExclusao();
   var vaux = document.form.aux_lspermis.value; 
    var dtinieve = $('#dtinieve').val();
    var dtfineve = $('#dtfineve').val();
    var dsjustif = $('#aux_dsjustif').val();
	var tel_dsdiaeve = "";
    
    for(i=0;i<=6;i++){
      
      if($("#aux_dsdiaeve" + i).prop('checked')){
        tel_dsdiaeve = tel_dsdiaeve + i + ',';
      }
    }
    tel_dsdiaeve = tel_dsdiaeve.substring(0, tel_dsdiaeve.length - 1);
    
    document.form.tel_dsdiaeve.value = tel_dsdiaeve;
   
    if(document.form.qtparpre.value == 0 || document.form.qtparpre.value == ""){
      alert('Preencha a quantidade de participantes do evento.'); 
		  return false;
    }
   
    if (dtinieve.length < 10){
      document.form.aux_verfimes.value = "S";		
    }
	
   // if(parseInt(document.form.aux_idstagen.value) > 4){ //Somente se a agenda já estiver liberada obrigar a justificativa
		if((dsjustif == null || dsjustif == "" ) && (document.form.aux_alteraca.value == "1")){		   
		  alert('Desculpe, mas você não preencheu a justificativa do evento corretamente.'); 
		  document.form.aux_alteraca.value = "";
		  document.form.aux_dsjustif.value = "";
		  return false;
		}
	//}
     
   if ((vaux.substring(1,2) == 'A') || (document.form.aux_stdopcao.value == 'i')) { 
      if (ValidaDados(document.forms[0])) {
            document.form.aux_cddopcao.value='sa'; 
            status = 'Salvando. Por favor, aguarde ...';
            document.form.submit();
         return true;
      } 
      else { 
            return false;
      }  
   }
   else { 
         alert('Desculpe, mas você não tem permissão para executar esta função.'); 
         return false;
   }
}
 
 
function Reativa(){
   var vaux = document.form.aux_lspermis.value; 
	 
	 if ($('#dtinieve').val().length < 10){
		document.form.aux_verfimes.value = "S";		
	 }
	 
   if ((vaux.substring(1,2) == 'A') || (document.form.aux_stdopcao.value == 'i')) { 
      if (ValidaDados(document.forms[0])) {
         document.form.aux_cddopcao.value='sa';
         if (confirm("Deseja realmente reativar esse evento ?")){if (document.form.aux_idexclui.value=prompt('Motivo da Reativação do Evento','')){document.form.idstaeve.value="01";document.form.submit();}}
           
         return true;
      } 
      else { 
            return false;
      }  
   }
   else { 
         alert('Desculpe, mas você não tem permissão para executar esta função.'); 
         return false;
   }
}
 
function Cancelar(){
   
   var vaux = document.form.aux_lspermis.value; 
   if ((vaux.substring(1,2) == 'A') || (document.form.aux_stdopcao.value == 'i')) { 
      if (ValidaDados(document.forms[0])) {
         document.form.aux_cddopcao.value='sa';
                 
                 // exestem pré-inscritos
                 if((document.form.aux_idinseve.value=="yes")&&
            (!confirm("Existem pré-inscritos neste evento, deseja continuar?")))
                        return false;         
                                  
         if (confirm("Deseja realmente cancelar esse evento ?")){
                         if (document.form.aux_idexclui.value=prompt('Motivo do Cancelamento do Evento','')){
                            document.form.idstaeve.value="02";
					  document.form.aux_verfimes.value = "S";
                                document.form.submit();
                        }
                 }           
         return true;
      } 
      else { 
            return false;
      }  
   }
   else { 
         alert('Desculpe, mas você não tem permissão para executar esta função.'); 
         return false;
   }
}

function Excluir(){
   var vaux = document.form.aux_lspermis.value; 
	  document.form.aux_idfernac.value = "S";
      document.form.aux_idfermun.value = "S";
      document.form.aux_idfimsem.value = "S";
      document.form.aux_preferna.value = "S";
      document.form.aux_prefermu.value = "S";		
      document.form.aux_posferna.value = "S";
      document.form.aux_posfermu.value = "S";
      document.form.aux_vercoope.value = "S";
      document.form.aux_verregio.value = "S";
      document.form.aux_semanadi.value = "S";
      document.form.aux_semapost.value = "S";
	  document.form.aux_pessoaab.value = "S";
	  document.form.aux_pessoapost.value = "S";		
      document.form.aux_verfimes.value = "S";
   if (vaux.substring(2,3) == 'E') { 
         document.form.aux_cddopcao.value='ex';
			
                 // exestem pré-inscritos
                 if((document.form.aux_idinseve.value=="yes")&&
            (!confirm("Existem pré-inscritos neste evento, deseja continuar?")))
            return false;
                        
                if (confirm("Deseja realmente excluir este evento?"))
                    document.form.submit();
                else
            return false;
        }  
   else { 
      alert('Desculpe, mas você não tem permissão para executar esta função.'); 
      return false;
   }
}

  function mostraDiv(nomediv){
  var nomeaba = '';

  if (nomediv == '') {
     nomediv = 'divEvento';
  }
   
  if (nomediv=='divEvento')  {nomeaba='AbaEvento';}
  if (nomediv=='divHistorico') {nomeaba='AbaHistorico';}
  
  // guarda a página atual
  document.form.aux_nmpagina.value = nomediv;

  // Define todas as abas como não selecionadas
  document.all.AbaEvento.rows[0].cells[0].background="/cecred/images/menu/mnu_nle.gif";
  document.all.AbaEvento.rows[0].cells[1].background="/cecred/images/menu/mnu_nlc.gif";
  document.all.AbaEvento.rows[0].cells[2].background="/cecred/images/menu/mnu_nld.gif";
  document.all.AbaEvento.rows[0].cells[1].className="txtTituloHid";

  document.all.AbaHistorico.rows[0].cells[0].background="/cecred/images/menu/mnu_nle.gif";
  document.all.AbaHistorico.rows[0].cells[1].background="/cecred/images/menu/mnu_nlc.gif";
  document.all.AbaHistorico.rows[0].cells[2].background="/cecred/images/menu/mnu_nld.gif";
  document.all.AbaHistorico.rows[0].cells[1].className="txtTituloHid";

  // Altera a imagem da aba selecionada
  document.all[nomeaba].rows[0].cells[0].background="/cecred/images/menu/mnu_sle.gif";
  document.all[nomeaba].rows[0].cells[1].background="/cecred/images/menu/mnu_slc.gif";
  document.all[nomeaba].rows[0].cells[2].background="/cecred/images/menu/mnu_sld.gif";
  document.all[nomeaba].rows[0].cells[1].className="txtTituloVis";

  
  // apaga todas as DIV
  document.all.divEvento.style.display = 'none';
  document.all.divHistorico.style.display = 'none';
  document.all.divMotivo.style.display = 'none';
  
  // ativa a DIV escolhida
  document.all[nomediv].style.display = 'block';
}

function mostraHistorico(){

  var row; var cell;  
  
  var cor = '#F7F7F7';
  
  // limpa a tabela de historicos, menos a 1ª linha - linha do cabecalho
  for (var i=document.all.tbhistorico.rows.length; i>1; i--)
      document.all.tbhistorico.deleteRow(i-1);
  for(i=0;i<mhistorico.length;i++){      // insere linhas na tabela de historicos
     row=tbhistorico.insertRow();  // nova linha 
     if (cor == '#FFFFFF')
        cor = '#F7F7F7';
     else
        cor = '#FFFFFF';
     row.bgColor = cor;
         
         //separador
     cell=row.insertCell();
     cell.className = 'txtNormal';
     cell.width = document.all.separador1.width;
     cell.height = 26;
     cell.innerText='';

     cell=row.insertCell();      // primeira celula da linha (data do historico)
     cell.className = 'txtNormal';
     cell.width = document.all.tbhistorico_col1.width;
     cell.height = 26;
     cell.align = 'left';
     cell.innerText=mhistorico[i].dthist; // fim primeira celula (data do historico)
	  
         //separador
     cell=row.insertCell();
     cell.className = 'txtNormal';
     cell.width = document.all.separador1.width;
     cell.height = 26;
     cell.innerText='';
     
     cell=row.insertCell();      // segunda celula da linha (descricao do historico)
     cell.className = 'txtNormal';
     cell.width = document.all.tbhistorico_col2.width;
     cell.height = 26;
     cell.align = 'left';
     cell.innerText=mhistorico[i].dshist; // fim segunda celula (descricao do historico)

         //separador
     cell=row.insertCell();      
     cell.className = 'txtNormal';
     cell.width = document.all.tbhistorico_col3.width;
     cell.height = 26;
     cell.innerText='';
  }
}

// valida a digitação da data nos campos
  function preencheDia(nome,data){

    var diaSem = 0;
    var diaSemIni = 0;
    var dtinieve;
	
    
    arrData = data.split('/');
    data = arrData[1] + '/' + arrData[0] + '/' + arrData[2];
    data = new Date(data + ' 03:00:00');
    diaSem = data.getDay();

    //Limpa o cheack box selecionados
    for(i=0;i<=6;i++){
      $("#aux_dsdiaeve" + i).prop('checked', false);
    }
               
    //Verifica se o campo selecionado é o de data inicial	
    if(nome == "dtinieve"){
      $("#qtdiaeve").val(0);		
      $("#aux_dsdiaeve" + diaSem).prop('checked', true);
      $('#dtfineve').val("");
				}else{	
      
      $("#aux_dsdiaeve" + diaSem).prop('checked', true);
      
      dtinieve = $('#dtinieve').val();
      arrData = dtinieve.split('/');
      dtinieve = arrData[1] + '/' + arrData[0] + '/' + arrData[2];
      dtinieve = new Date(dtinieve + ' 03:00:00');
			diaSemIni = dtinieve.getDay();
			
      if(Math.abs(dtinieve > data)){ 
        alert("Data final de evento nao pode ser menor que data inicial!");
        //Limpa checkbox selecionados
        for(i=0;i<=6;i++){
          $("#aux_dsdiaeve" + i).prop('checked', false);
        }
        //Limpa campos de datas preenchidos
        $('#dtinieve').val("");
        $('#dtfineve').val("");
        return false;
      }
      
      $("#aux_dsdiaeve" + diaSemIni).prop('checked', true);
      resetaJustificativa()
			diasEvento();
    }	     
       } 
    
  function diasEvento(){
    var qtdiaeve = 0;
    var contador = 0;
    var dtinieve;	
    var dtfineve;
		var seminiev ;
		var flg = false;
    var aux_semanadi = false;
    
    dtinieve = $('#dtinieve').val();
    dtfineve = $('#dtfineve').val();

    if(dtinieve != dtfineve){ ;
	
	 
      arrData = dtinieve.split('/');
      dtinieve = arrData[1] + '/' + arrData[0] + '/' + arrData[2];
			dtinieve = new Date(dtinieve + ' 03:00:00');
	  
    
      arrData = dtfineve.split('/');
      dtfineve = arrData[1] + '/' + arrData[0] + '/' + arrData[2];
			dtfineve = new Date(dtfineve + ' 03:00:00');
			seminiev = numSemana(dtinieve, dtfineve); 
     
	  contador = dtinieve.getDay();
    
	 //Verifica se são de semanas diferentes
	  if(!seminiev){
		limpaDados();			
	  }else{
		document.form.aux_semanadi.value = "N";
     }
      
	  $("#qtdiaeve").val(0);
      
      qtdiaeve = (Math.abs(dtfineve - dtinieve) / 86400000) + 1;
      qtdiaeve = Math.round(qtdiaeve);
      
      $("#qtdiaeve").val(qtdiaeve);
      
      if(qtdiaeve > 1 && qtdiaeve < 7){
        for(i = 0; i < qtdiaeve; i++){
          
          if(contador == 7){
            aux_semanadi = true;
            contador = 0;
		}
          
          $("#aux_dsdiaeve" + contador).prop('checked', true);			
		
          contador++;
        }
      }else{
        for(i = 0; i <= 6; i++){
          $("#aux_dsdiaeve" + i).prop('checked', true);
  }
}
    }else{  
      arrData = dtinieve.split('/');
      dtinieve = arrData[1] + '/' + arrData[0] + '/' + arrData[2];
      dtinieve = new Date(dtinieve + ' 03:00:00');
      /*diainiev.setFullYear(arrData[2], arrData[1]-1, arrData[0]);
	  diainiev = diainiev.getDay();*/

      contador = dtinieve.getDay();
      $("#aux_dsdiaeve" + contador).prop('checked', true);	
      $("#qtdiaeve").val(1);
}

   if(aux_semanadi){
      document.form.aux_semanadi.value = "S";
    }
}

    function limpaDados(){
      //Limpa checkbox selecionados
      for(i=0;i<=6;i++){
        $("#aux_dsdiaeve" + i).prop('checked', false);
}
      //Limpa campos de datas preenchidos
      setTimeout(function() { document.getElementById('dtinieve').focus(); }, 10);

      $('#dtinieve').val("");
      $('#dtfineve').val("");
      $('#qtdiaeve').val("");
    }

    function abreFornecedor(){
	  resetaJustificativa()
      VarURL = document.form.aux_dsendurl.value  + '/wpgd0023b.htm'
                                                 + '?aux_idevento=' + document.form.aux_idevento.value
                                                 + '&aux_cdcooper=' + document.form.cdcooper.value
                                                 + '&aux_dtanoage=' + document.form.aux_dtanoage.value
                                                 + '&aux_cdevento=' + document.form.aux_cdevento.value
                                                 + '&aux_nrseqdig=' + document.form.aux_nrseqdig.value
                                                 + '&aux_cdagenci=' + document.form.cdagenci.value;
      window.open(VarURL,'','toolbar=no,location=no,diretories=no,status=no,menubar=no,scrollbars=yes,resizable=yes,width=740,height=340,top=10,left=10'); 
     }
      
	function resetaJustificativa(){
		document.form.aux_alteraca.value = 1; 
		document.form.aux_dsjustif.value = ''; 
	 }
   
    function Recarrega(){
	  //location.reload();  
	  history.go(0);
	  resetaJustificativa()
	  
  }

    function preencheDiaSalvo(dsdiaeve){
 
      var arrDiasEve = dsdiaeve.split(',');
      
      for(i=0;i<=6;i++){
        $("#aux_dsdiaeve" + i).prop('checked', false);
     }
             
      for(i=0;i<=arrDiasEve.length;i++){   
        $("#aux_dsdiaeve" + arrDiasEve[i]).prop('checked', true);
     }
  }  
	
	mostraDiv(document.form.aux_nmpagina.value);
	mostraHistorico();
    
    $.datepicker.setDefaults( $.datepicker.regional[ "pt-BR" ] );
    
    /*Mascara referente a campo de inicio de periodo de Ano*/
    $('#dtinieve').datepicker({
      dateFormat: "dd/mm/yy",
	  showWeek:true,
      changeYear: true,
      changeMonth: true,
      changeDay: true,
      showOn: "button",
      buttonImage: "/cecred/images/btn_calendario.gif",
      buttonImageOnly: true,
      defaultDate: aux_mesevent
    });
    
    /* Mascara referente a campo de fim de periodo de Ano */
    $('#dtfineve').datepicker({
      dateFormat: "dd/mm/yy",
	   showWeek:true,
      changeYear: true,
      changeMonth: true,
      changeDay: true,
      showOn: "button",
      buttonImage: "/cecred/images/btn_calendario.gif",
      buttonImageOnly: true,
      defaultDate: aux_mesevent
    });
	
	
    var post = document.form.aux_idvapost.value;
    
    if (post == "" || post == null){
      document.form.aux_idfernac.value = "N";
      document.form.aux_idfermun.value = "N";
      document.form.aux_idfimsem.value = "N";
      document.form.aux_preferna.value = "N";
      document.form.aux_prefermu.value = "N";		
      document.form.aux_posferna.value = "N";
      document.form.aux_posfermu.value = "N";
      document.form.aux_vercoope.value = "N";
      document.form.aux_verregio.value = "N";
      document.form.aux_semanadi.value = "N";
      document.form.aux_semapost.value = "N";
      document.form.aux_verfimes.value = "N";	  
	  document.form.aux_pessoaab.value = "N";
	  document.form.aux_pessoapost.value = "N";	  
      document.form.aux_idvapost.value = "S";
}

    var dsdiaeve = document.form.tel_dsdiaeve.value;    
        
    if(dsdiaeve != ""){
      //preencheDia("dtfineve",$("#dtfineve").val())();
	  preencheDiaSalvo(dsdiaeve);
    }

		layoutPadrao();
</script>
</html>