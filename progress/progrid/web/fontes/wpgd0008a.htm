<html>
<head>
<title>Recursos (wpgd0008a)</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link href="/cecred/estilos/progrid.css" rel="stylesheet" type="text/css">
</head>
<body>
<script language="JavaScript">
NomeDoProgramaPrincipal  = '/wpgd0008a.w';
</script>
<form action="#." method="POST" name="form">
  <input type="hidden" name="aux_dsendurl" value="">
  <input type="hidden" name="aux_cddopcao" value="">           
  <input type="hidden" name="aux_nrdrowid" value="">
  <input type="hidden" name="aux_lspermis" value="">
  <input type="hidden" name="aux_dsretorn" value="">
  <input type="hidden" name="aux_stdopcao" value="">
  <input type="hidden" name="aux_nrcpfcgc" value="">
  <input type="hidden" name="aux_lsrecurs" value="">
  <input type="hidden" name="aux_cdevento" value="">
  <input type="hidden" name="aux_idevento" value="">
  <table width="100%"  border="0" cellspacing="0" cellpadding="0">
    <tr>
      <td height="21" align="left">
	    <table height="21" border="0" cellpadding="0" cellspacing="0" background="/cecred/images/geral/guia_fundo.gif">
          <tr>
		    <td width="11"><img src="/cecred/images/geral/guia_esquerda.gif" width="11" height="21"></td>
            <td class="linkGuia"><div align="center">Recursos</div></td>
            <td width="11" align="right"><img src="/cecred/images/geral/guia_direita.gif" width="8" height="21"></td>
          </tr>
	    </table>
	  </td>
    </tr>
	<tr>
	  <td height="2" bgcolor="#999999"></td>
	</tr>
	<tr>
	  <td height="22" class="txtMenuTitulos" background="/cecred/images/menu/fnd_title.jpg">&nbsp;&nbsp;Descri&ccedil;&atilde;o</td>
	</tr>
	<tr>
	  <td>
	  <table id="tbrecurso" width="100%" cellpadding="0" cellspacing="0" border="1" bgColor="#ffffff">
		
	  </table>
	  </td>	  
	</tr>
	<tr>
	  <td height="10"></td>
	</tr>
    <tr>
	  <td align="center">
	    <a href="#." onClick="Salvar();" style="cursor: hand; ">
		<input name="imageField" type="image"  src="/cecred/images/botoes/btn_salvar.gif" width="60" height="20">
		</a>
	  </td>
	</tr>	
  </table>
</form>
</body>
</html>
<SCRIPT LANGUAGE="JAVASCRIPT">
   NomeDoProgramaPrincipal  = '/wpgd0008a.w';
   NomeDoProgramaDeListagem = '/wpgd0008as.w';
   NomeDoProgramaDeAjuda    = '/wpgd0008aaj.w';
   NomeDoProgramaDeZoom     = '/zoom/zwpgd0008a.w';
   
   NomeDoProgramaPrincipal = document.form.aux_dsendurl.value + NomeDoProgramaPrincipal;
   document.form.action = NomeDoProgramaPrincipal;


function Salvar()
{
   //ZeraModoExclusao();
   var vaux = document.form.aux_lspermis.value; 
   if ((vaux.substring(1,2) == 'A') || (document.form.aux_stdopcao.value == 'i')){ 
        if (document.form.aux_cddopcao.value!='sa')  {
            document.form.aux_cddopcao.value='sa'; 
			document.form.aux_stdopcao.value='i';
            status = 'Salvando. Por favor, aguarde ...';			
			armazenaRecursos();
			document.form.submit();
            return true;
        } 
        else{ 
            return false;
        }  
   }
   else { 
         alert('Desculpe, mas você não tem permissão para executar esta função.'); 
         return false;
   }
}

function mudaCor(){

  // se houver mais de um registro de recursos
  if (mrecurso.length > 1){
     if (document.form.recurso[this.id].checked==false){
         this.bgColor = '#CCCCCC';
         document.form.recurso[this.id].checked=true;
     }
     else{
         this.bgColor = '#FFFFFF';
         document.form.recurso[this.id].checked=false;
	 }
  }
  // se for somente um registro de recursos
  else{
     if (document.form.recurso.checked==false){
         this.bgColor = '#CCCCCC';
         document.form.recurso.checked=true;
     }
     else{
         this.bgColor = '#FFFFFF';
	     document.form.recurso.checked=false;
     }
  }  
}

function mostraRecursos(){

  var row; var cell;  

  // limpa a tabela de Recursos, menos a 1ª linha - linha do cabecalho
  for (var i=document.all.tbrecurso.rows.length; i>3; i--)
      document.all.tbrecurso.deleteRow(i-1);
	  
  for(i=0;i<mrecurso.length;i++){      // insere linhas na tabela de recursos
	 row=tbrecurso.insertRow();  // nova linha
	 row.id=i;
	 row.onclick=mudaCor;	 
	 cell=row.insertCell();      // primeira celula da linha (descricao do recurso)
	 cell.style.cursor = 'hand';
	 cell.height = '20px';
	 cell.width = '100%';
     cell.className = 'txtNormal';
     linky='&nbsp;&nbsp;'+mrecurso[i].dsrecurs + '<input type="hidden" name="recurso" value="' + mrecurso[i].nrseqdig + '">';
     cell.innerHTML=linky;
 }
}

function armazenaRecursos(){
  var i;

  // se for mais de um registro de recursos
  if (mrecurso.length > 1){
     for(i=0;i<document.form.recurso.length;i++)
       if(document.form.recurso[i].checked){
	      if(document.form.aux_lsrecurs.value=='')
             document.form.aux_lsrecurs.value = document.form.recurso[i].value;
   	      else
	         document.form.aux_lsrecurs.value = document.form.aux_lsrecurs.value + ',' + document.form.recurso[i].value;
       } 
     }
  // se for somente um registro de recursos
  else{
     if(document.form.recurso.checked)
	    document.form.aux_lsrecurs.value = document.form.recurso.value;
  }
}

if (mrecurso.length == 0){
   alert('Não há recursos cadastrados');
   self.close();
}   
   
mostraRecursos();

</SCRIPT>
