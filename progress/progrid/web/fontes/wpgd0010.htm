<!-- 

Programa: wpgd0010.htm

Alteracoes: 24/08/2010 - Aumento da largura do frame na chamada do fonte 
                         wpgd0010a.htm (Elton).
                                                 
                        05/06/2012 - Adaptação dos fontes para projeto Oracle. Alterado
                                     busca na gnapses de CONTAINS para MATCHES (Guilherme Maba).
									 
						15/06/2015 - Melhorias OQS (Gabriel-RKAM).	
						
						14/07/2015 - Melhorias OQS - Exibição do Tema e retirada do nome do evento (Vanessa). 

						09/10/2015 - Melhorias OQS - Ordenação das sugestoes para ordem decrescente(Vanessa). 

-->

<html>
<head>
<link href="/cecred/estilos/progrid.css" rel="stylesheet" type="text/css">
<base target="mainFrame">
<script SRC="/cecred/jsbiblio/sorttable.js"></script>
</head> 
<script language="JavaScript">

var frsel = 0;


//Abre a janela de seleção de evento para a sugestão
function carregar(cdevento)
{   
   var vaux = document.form.aux_lspermis.value; 
   if (document.form.aux_lspermis.value.substring(1,2) != 'A'){ 
      alert('Desculpe, mas você não tem permissão para executar esta função.'); 
      return false;
   }
   else {
   VarURL = document.form.aux_dsendurl.value + '/wpgd0010a.htm?LinkRowid=' + document.form.aux_nrdrowid.value
      + '&dtaini=' + document.form.dtaini.value 
      + '&dtafim=' + document.form.dtafim.value
      + '&tpfiltro='  + frsel
      + '&cdevento='  + cdevento
	  + '&idevento=1' 
	  + '&cdcooper=' + document.form.aux_cdcooper.value ;
	  	  	  
   window.open(VarURL,'','height=220,width=480,scrollBars=no,resizable=no,top=10,left=10,ScreenX=0,ScreenY=0');
   }   
}

function mudaCorSaindo(linha,mensagem){
   var cell=linha.parentElement;
   var row=cell.parentElement;
   // linhas ímpares são cinzas, pares são brancas
   if((linha.rowIndex % 2==0))
      linha.bgColor='#F7F7F7';
   else
      linha.bgColor='#FFFFFF';
}


//Coloca a descrição da sugestão na área de texto
function mudaCorEntrANDo(linha,mensagem)
{
   linha.bgColor='#CCCCCC';   
   document.form.sugestao.value = document.form['msg' + mensagem].value;   
}

// Recarrega a tela aplicANDo os filtros selecionados
function AtualizaDados()
{
   VarURL = document.form.aux_dsendurl.value  + '/wpgd0010.htm?' +
      'dtaini=' + document.form.dtaini.value +
      '&dtafim=' + document.form.dtafim.value + 
      '&tpfiltro=' + frsel + 
      '&cdCooper=' + document.form.aux_cdcooper.value + 
      '&chPri=' + document.form.aux_prichave.value + 
      '&chUlt=' + document.form.aux_ultchave.value + 
      '&pagina=' + document.form.aux_paginacao.value;
   window.open(VarURL,'mainFrame');
}

// Analisa o filtro selecionado e esconde campos
// grava na variavel frsel qual filtro foi selecionado
function AtualizaFiltro()
{
   for(i=0;i<document.form.tpfiltro.length;i++)
   {
      if (document.form.tpfiltro[i].checked) 
      {
         frsel = i;
      }
   }

   if (frsel == 0) 
   {
      document.all.data1.style.display="none";

   }
   if (frsel == 1) 
   {
      document.all.data1.style.display="block";
   }
}
</script>
<script language="SpeedScript">

/*...............................................................................

Alterações: 10/12/2008 - Melhoria de performance para a tabela gnapses (Evandro).

            16/03/2009 - Acerto de erro de travamento de Agente (Martin)
...............................................................................*/


DEFINE VARIABLE aux_lspermis AS CHARACTER.
DEFINE VARIABLE IdentificacaoDaSessao AS CHARACTER FORMAT "x(47)".

RUN PermissaoDeAcesso(INPUT 'wpgd0010', OUTPUT IdentificacaoDaSessao, OUTPUT aux_lspermis).

DEF VAR dtaini          AS DATE                                             NO-UNDO.
DEF VAR dtafim          AS DATE                                             NO-UNDO.
DEF VAR tpfiltro        AS INT                                              NO-UNDO.
DEF VAR aux_qtsugeve    AS CHAR                                             NO-UNDO.
DEF VAR v-identificacao AS CHARACTER                                        NO-UNDO.
DEF VAR aux_nmextttl    LIKE crapttl.nmextttl                               NO-UNDO.
DEF VAR aux_dstemeix    as char format "x(50)"      initial "" NO-UNDO.
DEF VAR aux_nmevento    as char format "x(50)"      initial "" NO-UNDO.
DEF VAR aux_nmrescop    as char format "x(50)"      initial "" NO-UNDO.
DEF VAR aux_nmresage    as char format "x(50)"      initial "" NO-UNDO.
DEF VAR aux_cdorisug    AS CHAR format "x(50)"      initial "" NO-UNDO.
def var aux_nrdconta    as char format "zzzz,zzz,9" initial "" no-undo.
DEF VAR aux_cor                        AS CHAR                                                                      NO-UNDO.
DEF VAR aux_cdcooper    as INT                                 NO-UNDO.
DEF VAR aux_selected    as char                                NO-UNDO.

DEF VAR aux_paginacao         AS CHAR                          NO-UNDO.
DEF VAR aux_ultchave          AS CHAR                          NO-UNDO.
DEF VAR aux_prichave          AS CHAR                          NO-UNDO.
DEF VAR aux_maxrows           AS INT  INIT 60                  NO-UNDO. 
def var aux_contarows         as int                           NO-UNDO.
DEF VAR cQuery                AS CHAR                           NO-UNDO.
DEF VAR hQuery                AS HANDLE                         NO-UNDO. 

ASSIGN dtaini          = DATE(get-value("dtaini"))
       dtafim          = DATE(get-value("dtafim"))
       tpfiltro        = INT(get-value("tpfiltro"))

       aux_cdcooper    = int(get-value("cdCooper"))
                                
       v-identificacao = get-cookie("cookie-usuario-em-uso").

ASSIGN aux_paginacao = if GET-VALUE("pagina") = "" THEN "" ELSE GET-VALUE("pagina").
       aux_ultchave  = IF GET-VALUE("chUlt") = "" THEN "" ELSE GET-VALUE("chUlt").
       aux_prichave  = IF GET-VALUE("chPri") = "" THEN "" ELSE GET-VALUE("chPri").

/* Usado FOR EACH para poder utilizar o CONTAINS e WORD-INDEX, alterado para MATCHES */
FOR EACH gnapses WHERE gnapses.idsessao MATCHES "*" + v-identificacao + "*" NO-LOCK:
    LEAVE.
END.
                        
IF dtaini = ? THEN dtaini = today.
IF dtafim = ? THEN dtafim = today.
                       

PROCEDURE PermissaoDeAcesso :
{includes/wpgd0009.i}
END PROCEDURE.

PROCEDURE RodaJavaScript :
{includes/rodajava.i}
END PROCEDURE.

</script>
<body style="margin-left: 3px; ">
<form name="form" >
<input name="aux_dsendurl" type="hidden" id="aux_dsendurl" value="`AppURL`">
<input name="aux_nrdrowid" type="hidden" id="aux_nrdrowid" value="">
<input type="hidden" name="aux_lspermis" value="`aux_lspermis`">

<!-- Inicio do modelo com abas -->
<div id="Layer1" style="position:absolute; border:0px; width:35px; height:35; z-index:1; left: 25px; top: 2px; visibility: ;"><img src="/cecred/images/icones/ico_fornecedor.gif" width="28" height="32" align="bottom">        </div>
  <table width="800" height="360"  border="0" align="left" cellpadding="0" cellspacing="0" background="/cecred/images/geral/guia_fundo.gif">
        <tr>
      <td width="11"><img src="/cecred/images/geral/guia_esquerda.gif" width="11" height="21"></td>
      <td width="56"><img src="/cecred/images/geral/spacer.gif" width="48" height="10"></td>
      <td width="477" height="20" align="left" class="linkGuia">Análise de Sugestões</td>
      <td width="90" class="linkGuia" align="right">wpgd0010</td>
      <td width="11" align="right" valign="middle" class="linkGuia"><img src="/cecred/images/geral/guia_direita.gif" width="11" height="21"></td>
    </tr>
    <tr valign="top" bgcolor="#FFFFFF">
      <td colspan="5">
        <table width="100%" height="100%" border="0" align="center" cellpadding="0" cellspacing="1" bgcolor="#999999">
          <tr>
            <td height="200" valign="top" bgcolor="#FFFFFF">
              <table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
                <tr>
                  <td height="15" align="left">&nbsp;</td>
                  <td height="15" align="left">
                    <!-- Interrupcao do modelo - início dos dados do programa --> 
                    <table align="center" border="0">
                      <tr>
                        <td class="NomeCampo"><div align="right" class="NomeCampo">Cooperativa: </div></td>
                          <td class="NomeCampo" width="150">
                          <select name="aux_cdcooper" class="Campo" id="cdcooper" onChange="AtualizaDados();">
                                 <OPTION VALUE="0" class="LinhaTabelaSelect">TODAS</OPTION>
                                                             <script language="SpeedScript">
                                                        /*criando lista de cooperaticas que participam do PROGRID */
                                                         FOR EACH crapcop NO-LOCK:
                                                                         /* Controle de cooperativas (igual a includes/wpgd0099.i) */
                                                                 IF NOT AVAIL gnapses OR (gnapses.nvoperad <> 0 AND gnapses.cdcooper <> crapcop.cdcooper) THEN
                                                                            NEXT.
                                                                 IF aux_cdcooper = crapcop.cdcooper THEN
                                                                        aux_selected = "SELECTED".
                                                                 ELSE
                                                                        aux_selected = "".
                                                    </script>
                                             <OPTION VALUE="`crapcop.cdcooper`" class="LinhaTabelaSelect" `aux_selected` >`CAPS(crapcop.nmrescop)`</OPTION>
                                             <script language="SpeedScript">
                                                         END.
                                                 </script> 
                                          </select>
                                          </td>
                                <script language="SpeedScript">
                                  {&out}
                                        '<td><div class="NomeCampo">Filtro:<input type=radio name="tpfiltro" onclick="AtualizaFiltro()" '.
                                  if get-value("tpfiltro") <> "1" then  {&out} 'checked'. 
                                  {&out} 
                                        '>Pendentes'
                                        '<input type=radio name="tpfiltro" onclick="AtualizaFiltro()" '. 
                                  if get-value("tpfiltro") = "1" then {&out} 'checked'.
                                  {&out} 
                                        '>Período</div></td>'.
                                </script>
                                <td align="left" width="60">
                          <img src="/cecred/images/botoes/pesquisar.jpg" width="27" height="22" style="cursor:hand" title="Pesquisar sugestões" onClick="document.form.aux_paginacao.value=''; document.form.aux_prichave.value=''; document.form.aux_ultchave.value=''; AtualizaDados();">
                        </td>
                      </tr>
                      <tr>
                                <script language="SpeedScript" class="NomeCampo">
                                  {&out}
                                          '<td colspan="2">'
                                          '<td colspan="2">'
                                          '<div id="data1" class="NomeCampo">Data:&nbsp;'
                                          '<input type="text" class="Campo" name="dtaini" size="10" value="' 
                                          get-value("dtaini") 
                                          '" onkeypress = "top.frcod.FormataData(this.name, this.value)">'
                                          '&nbsp;até:&nbsp;<input type="text" name="dtafim" class="Campo" size="10" value="' 
                                          get-value("dtafim") 
                                          '" onkeypress = "top.frcod.FormataData(this.name, this.value)">'
                                          '</div></td>'
                                                                                  '</td>'.
                                </script>
                      </tr>
                    </table> 
                     <table border="0" cellpadding="0" cellspacing="0" width="100%">
                     <tr>
                        <td id="separador1" width="5" background="/cecred/images/menu/fnd_title.jpg">&nbsp;</td>
                        <td id="tbsug_col1" width="40" height="25" align="left" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos">C&oacute;d.</td>
                        <td width="5" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                        <td id="tbsug_col2" width="90" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos">Cooperativa</td>       
                        <td width="5" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                        <td id="tbsug_col3" width="90" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos">PA</td>               
                        <td width="5" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                        <td id="tbsug_col4" width="50" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos">Data</td>              
                        <td width="5" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                        <td id="tbsug_col5" width="60" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos">Conta</td>             
                        <td width="5" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                        <td id="tbsug_col6" width="205" class="txtMenuTitulos" background="/cecred/images/menu/fnd_title.jpg">Evento</td>
					    <td width="5" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                        <td id="tbsug_col6" width="130" class="txtMenuTitulos" background="/cecred/images/menu/fnd_title.jpg">Tema</td>
                        <td width="5" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                        <td id="tbsug_col7"width="110" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos">Origem</td>
                      </tr>    
                    </table>  
                    <table border="0" align="center">
                      <tr>
                        <td>
                          <div style="overflow: auto; height:'360'; margin-left:0">
                            <table border="0" cellpadding="0" cellspacing="0" id="tbsug" class="dataTable" width="100%" style="margim:0; float:left; padding:0">
                            <script language="SpeedScript">
                             ASSIGN  aux_cor = "#F7F7F7".
                                                                        
                                /** montagem da query dinamica **/
                                create query hQuery.
                                hQuery:SET-BUFFERS(BUFFER crapsdp:HANDLE).
                                IF aux_cdcooper = 0 THEN
                                    assign cQuery = "FOR EACH crapsdp WHERE crapsdp.idevento = 1".  
                                ELSE
                                    assign cQuery = "FOR EACH crapsdp WHERE crapsdp.cdcooper = " + string(aux_cdcooper) + 
                                                                      " AND crapsdp.idevento = 1".  
                                IF tpFiltro = 0 THEN
                                   ASSIGN  cQuery = cQuery + " AND crapsdp.flgsugca = no AND crapsdp.cdevento = ? AND (crapsdp.nrseqtem = ? or crapsdp.nrseqtem = 0)".
                                ELSE
                                   ASSIGN  cQuery = cQuery + " AND crapsdp.dtmvtolt >= " + string(dtaini) + " AND crapsdp.dtmvtolt <= " + string(dtafim).
                                assign cQuery = cQuery + " NO-LOCK BY crapsdp.nrseqdig DESC:". 
								
                                hQuery:query-prepare(cQuery).
                                hQuery:query-open().
                                IF aux_paginacao <> "" THEN DO:
                                   IF aux_paginacao = "C" THEN DO:  /* PAGINA CORRENTE */
                                       hQuery:REPOSITION-TO-ROWID(TO-ROWID(aux_prichave)).
                                       hQuery:get-next().
                                   END.
                                   ELSE
                                   IF aux_paginacao = "P" THEN DO:  /* PROXIMA PAGINA */
                                      hQuery:REPOSITION-TO-ROWID(TO-ROWID(aux_ultchave)).
                                      hQuery:get-next().
                                      hQuery:get-next().
                                      IF hQuery:QUERY-OFF-END THEN
                                         hQuery:get-prev().
                                   END.
                                   ELSE DO: /* PAGINA ANTERIOR */
                                      hQuery:REPOSITION-TO-ROWID(TO-ROWID(aux_prichave)).
                                      hQuery:REPOSITION-BACKWARD(aux_maxrows).
                                      hQuery:get-next().
                                      IF hQuery:QUERY-OFF-END THEN
                                         hQuery:get-first().
                                   END.
                                END.
                                ELSE DO:
                                   hQuery:get-first().
                                END.

                                /** primeira chave **/
                                ASSIGN aux_prichave = string(rowid(crapsdp))
                                       aux_contarows = 0.
                                REPEAT:
                                /* lista todos os eventos do progrid */
                                                                           
                                    /***** FILTROS ELIMINADOS - PASSAM A FAZER PARTE DA QUERY 
                                    if tpfiltro = 1 AND
                                       (crapsdp.dtmvtolt < dtaini or crapsdp.dtmvtolt > dtafim) THEN NEXT.

                                    IF tpfiltro = 0 AND crapsdp.cdevento <> ?  THEN NEXT.
                                    IF tpfiltro = 0 AND crapsdp.flgsugca = yes THEN NEXT.
                                    *******************************************************/ 

                                    /* Segurança por Cooperativa */
                                    IF gnapses.cdcooper <> 0 and 
                                       gnapses.nvoperad <> 0 and 
                                       gnapses.cdcooper <> crapsdp.cdcooper THEN do:
                                       assign aux_ultchave = string(rowid(crapsdp)).
                                       hQuery:get-next().
                                       IF hQuery:QUERY-OFF-END THEN 
                                          LEAVE.
                                       ELSE
                                          NEXT.
                                    end.

                                    assign aux_nrdconta = string(crapsdp.nrdconta).
                                   
                                    /* Busca o nome da Cooperativa */
                                    FIND FIRST crapcop WHERE crapcop.cdcooper = crapsdp.cdcooper NO-LOCK NO-ERROR.
                                    IF AVAIL crapcop THEN do:
                                        aux_nmrescop = crapcop.nmrescop.
                                    END.
                                    ELSE do:
                                        aux_nmrescop = "".
                                    END.

                                    /* Busca o nome do PAC */
                                    FIND FIRST crapage WHERE crapage.cdcooper = crapsdp.cdcooper    AND
                                                             crapage.cdagenci = crapsdp.cdagenci    
                                                             NO-LOCK NO-ERROR.

                                    IF AVAIL crapage THEN do:
                                       aux_nmresage = CAPS(crapage.nmresage).
                                    END.
                                    ELSE do:
                                       aux_nmresage = "".
                                    END.
                                                                                     
                                    /* Busca a descrição da origem da sugestão */
                                    ASSIGN aux_cdorisug = STRING(crapsdp.cdorisug).
                                    FIND FIRST craptab WHERE craptab.cdcooper = 0               AND
                                                             craptab.nmsistem = "CRED"          AND
                                                             craptab.tptabela = "CONFIG"        AND
                                                             craptab.cdempres = 0               AND
                                                             craptab.cdacesso = "PGTPORIGEM"    AND
                                                             craptab.tpregist = 0               NO-LOCK NO-ERROR.
     
                                    IF AVAIL craptab THEN do:
                                       ASSIGN aux_cdorisug = ENTRY(LOOKUP(aux_cdorisug, craptab.dstextab) - 1, craptab.dstextab).
                                    END.
                                    ELSE do:
                                       ASSIGN aux_cdorisug = STRING(crapsdp.cdorisug).
                                    END.
									
									/* Busca a descrição do evento */
                                    FIND FIRST crapedp WHERE crapedp.idevento = 1                   AND
                                                             crapedp.cdcooper = 0                   AND
                                                             crapedp.dtanoage = 0                   AND
                                                             crapedp.cdevento = crapsdp.cdevento    
                                                             NO-LOCK NO-ERROR.
                                           
                                    IF AVAIL crapedp THEN do:
                                       aux_nmevento = crapedp.nmevento.
                                    END.
                                    ELSE do:
                                       aux_nmevento = "".
                                    END.
									

                                    /* Busca a descrição do Tema */
                                    FIND FIRST craptem WHERE craptem.nrseqtem = crapsdp.nrseqtem	NO-LOCK NO-ERROR.
										IF AVAIL craptem THEN do:
											aux_dstemeix = craptem.dstemeix.
									    END.
										ELSE do:
										   aux_dstemeix = "".
										END.
										
                                    /* Busca o nome do cooperado */
                                    FIND FIRST crapttl WHERE crapttl.cdcooper = crapsdp.cdcooper    AND
                                                             crapttl.nrdconta = crapsdp.nrdconta    AND
                                                             crapttl.idseqttl = crapsdp.idseqttl 
                                                             NO-LOCK NO-ERROR.

                                    IF AVAIL crapttl THEN do:
                                       ASSIGN aux_nmextttl = "Autor da Sugestão: " + crapttl.nmextttl.
                                    END.
                                    ELSE do:
                                        ASSIGN aux_nmextttl = "".
                                    END.

                                    /* Se é pesquisa, mostra a quantidade de sugestões do mesmo tema. */
                                    IF crapsdp.cdorisug = 2 or crapsdp.cdorisug = 7 THEN
                                        ASSIGN aux_qtsugeve = "Quantidade de Sugestões: " + STRING(crapsdp.qtsugeve).
                                    ELSE
                                        ASSIGN aux_qtsugeve = "".

                                    IF aux_nmrescop = ? THEN aux_nmrescop = "".
                                    IF aux_nmresage = ? THEN aux_nmresage = "".
                                    IF aux_nrdconta = ? THEN aux_nrdconta = "".
                                    IF aux_nmextttl = ? THEN aux_nmextttl = "".
                                    IF aux_dstemeix = ? THEN aux_dstemeix = "".
                                    IF aux_cdorisug = ? THEN aux_cdorisug = "".
                                                                
                                                                    /* Cor da linha */
                                                                    IF aux_cor = "#FFFFFF" THEN
                                                                       aux_cor = "#F7F7F7".
                                                                    ELSE
                                                                       aux_cor = "#FFFFFF".

                                                                    {&out} '  <tr onclick="RowonClick(this,~'' string(rowid(crapsdp)) '~')" onmouseover="RowonMouseOver(this, ' crapsdp.nrseqdig ')" onmouseout="RowonMouseOut(this, ' crapsdp.nrseqdig ')" id="' crapsdp.nrseqdig '" bgColor=' aux_cor ' style="cursor:hand">' SKIP
                                                                               '    <td class="txtNormal" height=26 width="5" align="left"></td>' SKIP
                                                                               '    <td class="txtNormal" height=26 width="40">' crapsdp.nrseqdig '</td>' SKIP
                                                                               '    <td class="txtNormal" height=26 width="5" align="left"></td>' SKIP
                                                                               '    <td class="txtNormal" height=26 width="90">' aux_nmrescop '</td>' SKIP
                                                                               '    <td class="txtNormal" height=26 width="5" align="left"></td>' SKIP
                                                                               '    <td class="txtNormal" height=26 width="90">' aux_nmresage '</td>' SKIP
                                                                               '    <td class="txtNormal" height=26 width="5" align="left"></td>' SKIP
                                                                               '    <td class="txtNormal" height=26 width="50">' crapsdp.dtmvtolt '</td>' SKIP
                                                                               '    <td class="txtNormal" height=26 width="5" align="left"></td>' SKIP
                                                                               '    <td class="txtNormal" height=26 width="70" title="' aux_nmextttl '">' aux_nrdconta '</td>' SKIP
                                                                               '    <td class="txtNormal" height=26 width="5" align="left"></td>' SKIP
                                                                               '    <td class="txtNormal" height=26 width="205"  title="' aux_nmevento '">    ' aux_nmevento '</td>' SKIP
                                                                               '    <td class="txtNormal" height=26 width="5" align="left"></td>' SKIP
                                                                               '    <td class="txtNormal" height=26 width="130" title="' aux_dstemeix '">     ' aux_dstemeix '</td>' SKIP
                                                                               '    <td class="txtNormal" height=26 width="5" align="left"></td>' SKIP
                                                                               '    <td class="txtNormal" height=26 width="90" title="' aux_qtsugeve '">     ' aux_cdorisug '</td>' SKIP
                                                                            '  </tr>'.

                                    {&out} '<input type="hidden" name="msg' crapsdp.nrseqdig '" value="' 
                                           replace(trim(crapsdp.dssugeve),'"','`') '">'.

                                    assign aux_ultchave = string(rowid(crapsdp))
                                           aux_contarows = aux_contarows + 1.
                                    hQuery:get-next().
                                    IF hQuery:QUERY-OFF-END OR aux_contarows >= aux_maxrows THEN do:
                                       LEAVE.
                                    END.
                                END. /* for each */
                                hQuery:query-close().
                                DELETE OBJECT hQuery. 
                                /* checa se acabou listagem */
                                IF aux_contarows < aux_maxrows THEN do:
                                   /* Cor da linha */
                                   IF aux_cor = "#FFFFFF" THEN
                                      aux_cor = "#F7F7F7".
                                   ELSE
                                      aux_cor = "#FFFFFF".
                                   {&out} '  <tr bgColor=' aux_cor ' style="cursor:hand">' SKIP
                                          '    <td class="txtNormal" height=26 align="center" colspan=14>Fim da Listagem</td>' SKIP
                                          '  </tr>'.
                                END.
                              </script>                               
                            </table>
                          </div>
                        </td>
                      </tr>
                    </table>                                                                                    
                    <table width="100%" align=center>
                      <tr>
                        <td align="left" valign="bottom"><textarea class="text" name="sugestao" rows=3 cols=80 style=" width:100%; border: 1px solid #CCCCCC;" readonly>.</textarea></td>
                      <tr>
                      <tr>
                          <td align="right" valign="bottom" scope="col">
                            <img style="cursor:hand" src="/cecred/images/botoes/btn_anterior.gif"  onClick="document.form.aux_paginacao.value='A'; AtualizaDados();" title="Anterior">
                                                        <script language="SpeedScript">
                                                        IF   aux_contarows < aux_maxrows   THEN
                                                        </script>                                                                                                                                    
                            <img style="cursor:hand" src="/cecred/images/botoes/btn_posterior.gif" title="Proximo">
                                                        <script language="SpeedScript">
                                                        ELSE
                                                        </script>
                                                        <img style="cursor:hand" src="/cecred/images/botoes/btn_posterior.gif" onClick="document.form.aux_paginacao.value='P'; AtualizaDados();" title="Proximo">                                                                            
                            <input type="hidden" name="aux_paginacao" value="`aux_paginacao`">
                            <input type="hidden" name="aux_prichave" value="`aux_prichave`">
                            <input type="hidden" name="aux_ultchave" value="`aux_ultchave`">
                          </td>
                      <tr>
                    </table>
                  <!-- Fim dos dados do programa - retorno ao modelo --> 
                  </td>
                </tr>
              </table>
            </td>
          </tr>
        </table>
      </td>
    </tr>
  </table>
</div>
<!-- fim do modelo -->
</form>
</body>
<script language="JavaScript">
//top.topFrame.document.all.titulo.innerHTML = 'Análise de Sugestões';
AtualizaFiltro();
</script>
<script language="JavaScript">
          
function RowonClick(linha, rowid){
   linha.bgColor='#B0C4DE';
   document.form.aux_nrdrowid.value=rowid;
   carregar('');
}         

function RowonMouseOver(linha, nrseqdig)
{
   mudaCorEntrANDo(linha,nrseqdig);
}

function RowonMouseOut(linha, nrseqdig)
{
   mudaCorSaindo(linha,nrseqdig);
}

</script>
</html>
