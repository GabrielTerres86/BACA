<!--------------------------------------------------------------------------------------------------------------

   Alterações: 28/01/2008 - Acrescentados Data e Hora na descrição dos eventos no Combo (Diego).
   
               01/02/2008 - Efetuar ordenação através do campo crapgap.nrordgru (Diego).
   
               10/12/2008 - Melhoria de performance para a tabela gnapses (Evandro).
               
               30/04/2009 - Utilizar cdcooper = 0 nas consultas (David).
               
               09/06/2011 - Corrigido os itens da aba Sugestão para não aparecerem
                            mais de uma vez.
                          - Mostrar os eventos de integração.
                          (Isara - RKAM)
                                                  
                           05/06/2012 - Adaptação dos fontes para projeto Oracle. Alterado
                                                    busca na gnapses de CONTAINS para MATCHES (Guilherme Maba).
                            
               08/07/2012 - Tratamento de CLOB com CHAR (Guilherme).
               
               05/09/2012 - Desfeito tratamento no campo dsobserv clob (Tiago).           
               
               16/06/2014 - Ajustes na procedure local-delete-record para
                            gravar registros na temp-table do buffer Softdesk
                            165668 (Lucas R.)
                            
               05/08/2015 - Implementação de novas funcionalidades  referente ao projeto de melhorias
                            do progrid etapa rf01(Jean MICHEL).
-------------------------------------------------------------------------------------------------------------->

<html>
<head>
<title>Avaliações</title>
</head>
<body onunload="FechaMens()" style="margin-left: 3px; ">
<link href="/cecred/estilos/progrid.css" rel="stylesheet" type="text/css">
<script SRC="/cecred/jsbiblio/sorttable.js"></script>
<script SRC="/cecred/jsbiblio/biblio.js"></script>
<script SRC="/cecred/jsbiblio/frcod.js"></script>
<script language="JavaScript">
   NomeDoProgramaPrincipal  = '/wpgd0029.w';
   NomeDoProgramaDeListagem = '/wpgd0029ls.w';
   NomeDoProgramaDeAjuda    = '/wpgd0029aj.w';
   NomeDoProgramaDeZoom     = '/zoom/zwpgd0029.w';
</script>
<form action="#." method="POST" name="form">
<input type="hidden" name="aux_dsendurl" value="">
<input type="hidden" name="pagina" value="">
<input type="hidden" name="aux_idevento" value="">
<input type="hidden" name="aux_cddopcao" value="">
<input type="hidden" name="aux_nrdrowid" value="">
<input type="hidden" name="aux_lspermis" value="">
<input type="hidden" name="aux_dsretorn" value="">
<input type="hidden" name="aux_stdopcao" value="">
<input type="hidden" name="cdcooper"     value="">
<input type="hidden" name="cdagenci"     value="">
<!--input type="hidden" name="cdevento"     value=""-->
<input type="hidden" name="nrseqeve"     value="">
<input type="hidden" name="aux_lsaltern" value="">
<input type="hidden" name="aux_lsdescri" value="">
<input type="hidden" name="aux_iditeava" value="">
<input type="hidden" name="aux_lsiteava" value="">
<input type="hidden" name="aux_lsavaoti" value="">
<input type="hidden" name="aux_lsavabom" value="">
<input type="hidden" name="aux_lsavareg" value="">
<input type="hidden" name="aux_lsavains" value="">
<input type="hidden" name="aux_lsiteav2" value="">
<input type="hidden" name="aux_lsobserv" value="">
<input type="hidden" name="arrQtsugeve" value="">
<!-- Inicio do modelo com abas -->
<div id="Layer1" style="position:absolute; border:0px; width:35px; height:35; z-index:1; left: 25px; top: 2px; visibility: ;"><img src="/cecred/images/icones/ico_fornecedor.gif" width="28" height="32" align="bottom"></div>
  <table width="575" border="0" align="left" cellpadding="0" cellspacing="0" background="/cecred/images/geral/guia_fundo.gif">
    <tr>
      <td width="11"><img src="/cecred/images/geral/guia_esquerda.gif" width="11" height="21"></td>
      <td width="56"><img src="/cecred/images/geral/spacer.gif" width="10" height="10"></td>
      <td width="220" height="20" align="left" class="linkGuia">Avaliações</td>
      <td width="280" height="20" align="right" class="linkGuia">wpgd0029</td>          
      <td width="11" align="right"><img src="/cecred/images/geral/guia_direita.gif" width="11" height="21"></td>
    </tr>
    <tr valign="top" bgcolor="#FFFFFF">
      <td colspan="5">
        <table width="574" height="100%"  border="0" align="left" cellpadding="0" cellspacing="1" bgcolor="#999999">
          <tr>
            <td height="200" valign="top" bgcolor="#FFFFFF">
              <table width="575" height="100%" border="0" cellpadding="0" cellspacing="0">
                <tr>
                  <td height="10">
                  </td>
                </tr>
                <tr>
                  <td height="55">&nbsp;</td>
                  <td align="left" valign="top"> 
                    <table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
                      <tr>
                        <td width="124" align="right" class="NomeCampo"> Agenda: </td>
                        <td width="39" class="NomeCampo">
                          <input name="aux_dtanoage" type="text"  size="4" onChange="document.form.submit();">
                        </td>
                        <td width="89" class="NomeCampo" align="right">Cooperativa: </td>
                        <td width="93" class="NomeCampo" align="left">
                          <select name="aux_cdcooper" class="Campo"  onChange="document.form.aux_dtanoage.value=''; document.form.aux_cddopcao.value=''; document.form.submit();"></select>
                        </td>
                        <td width="89" align="right" class="NomeCampo">PA:</td>
                        <td width="131" align="left" class="NomeCampo"><select name="aux_cdagenci" class="Campo" onChange="document.form.cdagenci.value = document.form.aux_cdagenci.value; document.form.submit();">
                        </select></td>
                      </tr>
                      <tr>
                        <td align="right" class="NomeCampo">Evento:</td>
                        <td colspan="5" align="left" class="NomeCampo">
                          <select name="aux_nrseqeve" class="Campo" onChange="document.form.nrseqeve.value = document.form.aux_nrseqeve.value; document.form.submit(); /******MostraAva()*****/"></select>
                        </td>  
                                          </tr>
                                          <tr>                              
                        <td align="right" class="NomeCampo">Participantes:</td>
                        <td class="NomeCampo"><input name="aux_qtdparti" type="text" size="4" readOnly></td>
                        <td class="NomeCampo"><div align="right">Respondidas:</div></td>
                        <td colspan="3" class="NomeCampo"><input name="qtavares" id="qtavares" type="text" size="4" onChange="CalculaTodos()"></td>
                      </tr>
                    </table>
                  </td>
                </tr>
                <tr>
                  <td height="10">
                  </td>
                </tr>
                <tr>
                  <td height="10" align="left">&nbsp;</td>
                  <td height="10" align="left" valign="top" bgcolor="#F5F5F5">
                    <!-- Interrupcao do modelo - início das abas -->
                    <table height="15" border="0" align="left" cellpadding="0" cellspacing="0" bgcolor="#FFFFFF">
                      <tr align="center">
                        <td width="105" height="15">
                          <table width="100" id="AbaAlternativa" border="0" cellpadding="0" cellspacing="0">
                            <tr style="cursor:hand">
                              <td background="/cecred/images/menu/mnu_nle.gif" width="4" height="21"></td>
                              <td width="92" align="center" class="txtTituloHid" onclick="mostraDiv('divAlternativa')">Alternativa</td>
                              <td background="/cecred/images/menu/mnu_nld.gif" width="4" height="21"></td>
                            </tr>
                          </table>
                        </td>
                        <td width="105" height="15">
                          <table width="100" id="AbaDescritiva" border="0" cellpadding="0" cellspacing="0">
                            <tr style="cursor:hand">
                               <td background="/cecred/images/menu/mnu_nle.gif" width="4" height="21"></td>
                              <td width="92" align="center" class="txtTituloHid" onclick="mostraDiv('divDescritiva')">Descritiva</td>
                              <td background="/cecred/images/menu/mnu_nld.gif" width="4" height="21"></td>
                            </tr>
                          </table>
                        </td>
                        <td width="105" height="15">
                          <table width="100" id="AbaSugestao" border="0" cellpadding="0" cellspacing="0">
                            <tr style="cursor:hand">
                               <td background="/cecred/images/menu/mnu_nle.gif" width="4" height="21"></td>
                              <td width="92" align="center" class="txtTituloHid" onclick="mostraDiv('divSugestao')">Sugestao</td>
                              <td background="/cecred/images/menu/mnu_nld.gif" width="4" height="21"></td>
                            </tr>
                          </table>
                        </td>
                        <!-- Links de Adicionar -->
                        <td width="361" align="right" class="txtTituloHid">
                          <div id="adicionar">
                                 <a href="#." onclick="mudaAdicionar();">Adicionar</a>
                          </div>
                        </td>                         
                      </tr>
                      <tr>
                            <td colspan="5" height="2" align="left" background="/cecred/images/menu/mnu_slc.gif"></td>
                      </tr>
                    </table>
                    <!-- Fim das abas - Início dos dados do programa -->
                  </td>
                </tr>
                <tr>
                  <td height="15" align="left">&nbsp;</td>
                  <td height="100%" align="left" valign="bottom" bgcolor="#F5F5F5">
                    <div id="divAlternativa">
                      <table border="0" width="100%" align="left">
                        <tr>
                          <td>
                            <table width="565" border="0" cellpadding="0" cellspacing="0" class="dataTable">
                              <tr>
                                <td width="80" height="25" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos" id="tbalternativa_col1">Grupo</td>
                                <td id="separador1" width="5" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                                <td width="80" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos" id="tbalternativa_col2" >Item</td>
                                <td width="5" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                                <td width="40" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos" id="tbalternativa_col3" >&Oacute;timo</td>
                                <td width="5" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                                <td width="30" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos" id="tbalternativa_col4">%</td>
                                <td width="5" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                                <td width="40" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos" id="tbalternativa_col5">Bom</td>
                                 <td width="5" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                                <td width="30" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos" id="tbalternativa_col6">%</td>
                                <td width="5" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                                <td width="40" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos" id="tbalternativa_col7">Regular</td>
                                <td width="5" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                                <td width="30" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos" id="tbalternativa_col8">%</td>
                                <td width="5" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                                <td width="40" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos" id="tbalternativa_col9">Insuf</td>
                                <td width="5" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                                <td width="30" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos" id="tbalternativa_col10">%</td>
                                <td width="5" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                                <td width="40" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos" id="tbalternativa_col11">NR</td>
                                <td width="5" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                                <td width="30" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos" id="tbalternativa_col12">%</td>
                                <td width="5" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                                <td width="30" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos" id="tbalternativa_col13">&nbsp;</td>
                              </tr>
                            </table>
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <div style="overflow: auto; height:'161';">
                              <table id="tbalternativa" width="100%" border="0" cellpadding="0" cellspacing="0" class="dataTable">
                                <!-- INCLUI DADOS -->
                              </table>
                            </div>
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <table width="100" align="center">
                              <tr>
                                <th scope="col"><img style="cursor:hand" src="/cecred/images/botoes/btn_salvar.gif"  onClick="Salvar()"></th>
                              </tr>
                            </table>
                          </td>
                        </tr>
                      </table>
                    </div>
                    <div id="divDescritiva">
                      <table border="0" width="100%" align="left">
                        <tr>
                          <td>
                            <table width="565" border="0" cellpadding="0" cellspacing="0" class="dataTable">
                              <tr>
                                <td id="tbdescritiva_col1" width="150" height="25" class="txtMenuTitulos" background="/cecred/images/menu/fnd_title.jpg">Item Geral </td>
                                <td width="5" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                                <td id="tbdescritiva_col2" width="150" class="txtMenuTitulos" background="/cecred/images/menu/fnd_title.jpg">Item espec&iacute;fico </td>
                                <td width="5" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                                <td id="tbdescritiva_col3" width="200" class="txtMenuTitulos" background="/cecred/images/menu/fnd_title.jpg">Descrição</td>
                                <td width="5" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                                <td id="tbdescritiva_col4" width="20" class="txtMenuTitulos" background="/cecred/images/menu/fnd_title.jpg" >&nbsp;</td>
                              </tr>
                            </table>
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <div style="overflow: auto; height:'161';">
                              <table id="tbdescritiva" width="100%" border="0" cellpadding="0" cellspacing="0" class="dataTable">
                                <!-- INCLUI DADOS -->
                              </table>
                            </div>
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <table width="200" align="center">
                             <tr>
                                <th scope="col"><img style="cursor:hand" src="/cecred/images/botoes/btn_salvar.gif"  onClick="Salvar()"></th>
                              </tr>
                            </table>
                          </td>
                        </tr>
                      </table>
                    </div>
                    <div id="divSugestao">
                      <table border="0" width="100%" align="left">
                        <tr>
                          <td>
                            <table width="565" border="0" cellpadding="0" cellspacing="0" class="dataTable">
                              <tr>
                               <td id="tbsugestao_col1" width="40" height="25" class="txtMenuTitulos" background="/cecred/images/menu/fnd_title.jpg">Código </td>
                                <td width="5" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                                <td id="tbsugestao_col2" width="200" height="25" class="txtMenuTitulos" background="/cecred/images/menu/fnd_title.jpg">Avaliações </td>
                                <td width="5" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                                 <td id="tbsugestao_col3" width="60" height="25" class="txtMenuTitulos" background="/cecred/images/menu/fnd_title.jpg">Quantidade</td>
                                <td width="5" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                              </tr>
                            </table>
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <div style="overflow: auto; height:'100%';">
                              <table id="tbsugestao" width="100%" border="0" cellpadding="0" cellspacing="0" class="dataTable">
                                <!-- INCLUI DADOS -->
                              </table>
                            </div>
                          </td>
                        </tr>
						<tr rowspan="3">
							<td>
								<table id="tbsugtem" name="tbsugtem" width="100%" border="0" cellpadding="0" cellspacing="0" class="dataTable">
									<tr>
										<td colspan="3" style="text-align:left; font-size:11px"><b>Sugestões de Temas Pré-Categorizados</b></td>
									</tr>
								</table>
							</td>
            </tr>
            <tr>
							<td>
								<table width="200" align="center">
									<tr height="20px">
										<td scope="col"><img style="cursor:hand" src="/cecred/images/botoes/btn_salvar.gif"  onClick="Salvar()"></td>
									</tr>
								</table>
							</td>
                        </tr>
                      </table>
                    </div>
                  </td>
                </table>
              </div>
            </td>
          </tr>
        </table>
      <!-- Fim dos dados do programa - retorno ao modelo -->
      </td>
    </tr>                                
  </table>
<!-- fim do modelo -->
</form>
<script language="JavaScript">

NomeDoProgramaPrincipal = document.form.aux_dsendurl.value + NomeDoProgramaPrincipal;
document.form.action = NomeDoProgramaPrincipal;

function MostraAlternativa()
{  
   var row;var cell;
   
   var cor='#F7F7F7';
   
   for (var i=document.all.tbalternativa.rows.length; i>0; i--)
        document.all.tbalternativa.deleteRow(i-1); 
  
   for(i=0;i<mava.length;i++)
   {
      /*if((document.form.aux_cdcooper.value == mava[i].cdcooper)&&
         (document.form.aux_cdagenci.value == mava[i].cdagenci)&&
         (document.form.aux_cdevento.value == mava[i].cdevento)&&
         (mava[i].tpiteava == "1"))
      {*/
      /* Alteração para ler eventos iguais, mas com sequencial diferente */
      if ((document.form.aux_nrseqeve.value == mava[i].nrseqeve) &&
          (mava[i].tpiteava == "1"))
      {
         
         document.form.qtavares.value = mava[i].qtavares;
         document.form.aux_qtdparti.value = mava[i].qtpartic;
         document.form.nrseqeve.value = mava[i].nrseqeve;

         row=tbalternativa.insertRow(); 
        
         if (cor == '#FFFFFF')
            cor = '#F7F7F7';
         else
            cor = '#FFFFFF';
        
         row.bgColor = cor;
   
         // Item geral   Item específico  Ótimo  %  Bom  %  Regular  %  Insuficiente  %  
        
         // Item Geral
         cell=row.insertCell();   
         cell.className = 'txtPequeno';
         cell.align = 'left';
         cell.width = document.all.tbalternativa_col1.width;
         cell.title = mava[i].dsgruava;
         linky=mava[i].dsgruava.substring(0,11);
         cell.innerHTML=linky;
        
         cell=row.insertCell();   // Separador
         cell.className = 'txtNormal';
         cell.width= document.all.separador1.width;
         cell.align = 'left';
         cell.innerText='';
        
         // Item específico
         cell=row.insertCell();   
         cell.className = 'txtPequeno';
         cell.align = 'left';
         cell.width = document.all.tbalternativa_col2.width;
         cell.title = mava[i].dsiteava;
         linky=mava[i].dsiteava.substring(0,11) + '<in' + 'put type="hidden" name="aux_cditeava" value="' + mava[i].cditeava + '">';
         cell.innerHTML=linky; 
        
         cell=row.insertCell();   // Separador
         cell.className = 'txtNormal';
         cell.width= document.all.separador1.width;
         cell.align = 'left';
         cell.innerText='';

         if (document.form.aux_cditeava.length > 1)
            linha = document.form.aux_cditeava.length - 1;
         else
            linha = 0;

         // Qtde Ótimo
         cell=row.insertCell();   
         cell.className = 'txtPequeno';
         cell.align = 'right';
         cell.width = document.all.tbalternativa_col3.width;
         linky = '<in' + 'put type="text" name="aux_qtavaoti" size="1" class="Campo" style="text-align:right;" onChange="CalculaLinha(' + "'" + linha + "'" + ')" value="' + mava[i].qtavaoti + '">';
         cell.innerHTML=linky; 
        
         cell=row.insertCell();   // Separador
         cell.className = 'txtNormal';
         cell.width= document.all.separador1.width;
         cell.align = 'left';
         cell.innerText='';
   
         // % Ótimo
         cell=row.insertCell();   
         cell.className = 'txtPequeno';
         cell.align = 'right';
         cell.width = document.all.tbalternativa_col4.width;
         linky= '<in' + 'put type="text" name="aux_peavaoti" disabled=true size="1" class="Campo" readOnly style="text-align:right; border:none;background-color:' + cor + ';" value="' + mava[i].peavaoti + '">';
         //linky="";
         cell.innerHTML=linky; 

         cell=row.insertCell();   // Separador
         cell.className = 'txtNormal';
         cell.width= document.all.separador1.width;
         cell.align = 'left';
         cell.innerText='';

         // Qtde Bom
         cell=row.insertCell();   
         cell.className = 'txtPequeno';
         cell.align = 'right';
         cell.width = document.all.tbalternativa_col5.width;
         linky= '<in' + 'put type="text" name="aux_qtavabom" size="1" class="Campo" style="text-align:right;" onChange="CalculaLinha(' + "'" + linha + "'" + ')" value="' + mava[i].qtavabom + '">';
         cell.innerHTML=linky; 
        
         cell=row.insertCell();   // Separador
         cell.className = 'txtNormal';
         cell.width= document.all.separador1.width;
         cell.align = 'left';
         cell.innerText='';
   
         // % Bom
         cell=row.insertCell();   
         cell.className = 'txtPequeno';
         cell.align = 'right';
         cell.width = document.all.tbalternativa_col6.width;
         linky= '<in' + 'put type="text" name="aux_peavabom" disabled=true size="1" class="Campo" readOnly style="text-align:right; border:none;background-color:' + cor + ';" value="' + mava[i].peavabom + '">';
         //linky="";
         cell.innerHTML=linky; 

         cell=row.insertCell();   // Separador
         cell.className = 'txtNormal';
         cell.width= document.all.separador1.width;
         cell.align = 'left';
         cell.innerText='';

         // Qtde Regular
         cell=row.insertCell();   
         cell.className = 'txtPequeno';
         cell.align = 'right';
         cell.width = document.all.tbalternativa_col7.width;
         linky= '<in' + 'put type="text" name="aux_qtavareg" size="1" class="Campo" style="text-align:right;" onChange="CalculaLinha(' + "'" + linha + "'" + ')" value="' + mava[i].qtavareg + '">';
         cell.innerHTML=linky;  
        
         cell=row.insertCell();   // Separador
         cell.className = 'txtNormal';
         cell.width= document.all.separador1.width;
         cell.align = 'left';
         cell.innerText='';
   
         // % Regular
         cell=row.insertCell();   
         cell.className = 'txtPequeno';
         cell.align = 'right';
         cell.width = document.all.tbalternativa_col8.width;
         linky= '<in' + 'put type="text" name="aux_peavareg" disabled=true size="1" class="Campo" readOnly style="text-align:right; border:none;background-color:' + cor + ';" value="' + mava[i].peavareg + '">';
         //linky="";
         cell.innerHTML=linky; 

         cell=row.insertCell();   // Separador
         cell.className = 'txtNormal';
         cell.width= document.all.separador1.width;
         cell.align = 'left';
         cell.innerText='';

         // Qtde Insuficiente
         cell=row.insertCell();   
         cell.className = 'txtPequeno';
         cell.align = 'right';
         cell.width = document.all.tbalternativa_col9.width;
         linky= '<in' + 'put type="text" name="aux_qtavains" class="Campo" size="1" style="text-align:right;" onChange="CalculaLinha(' + "'" + linha + "'" + ')" value="' + mava[i].qtavains + '">';
         cell.innerHTML=linky; 
        
         cell=row.insertCell();   // Separador
         cell.className = 'txtNormal';
         cell.width= document.all.separador1.width;
         cell.align = 'left';
         cell.innerText='';
   
         // % Insuficiente
         cell=row.insertCell();   
         cell.className = 'txtPequeno';
         cell.align = 'right';
         cell.width = document.all.tbalternativa_col10.width;
         linky= '<in' + 'put type="text" name="aux_peavains" disabled=true size="1" class="Campo" readOnly style="text-align:right; border:none;background-color:' + cor + ';" value="' + mava[i].peavains + '">';
         //linky="";
         cell.innerHTML=linky; 

         cell=row.insertCell();   // Separador
         cell.className = 'txtNormal';
         cell.width= document.all.separador1.width;
         cell.align = 'left';
         cell.innerText='';

         // Não respondido
         cell=row.insertCell();   
         cell.className = 'txtPequeno';
         cell.align = 'right';
         cell.width = document.all.tbalternativa_col11.width;
         linky= '<in' + 'put type="text" name="aux_qtavanre" disabled=true size="1" class="Campo" readOnly style="text-align:right; border:none; background-color:' + cor + ';" value="' + mava[i].qtavanre + '">';
         //linky="";
         cell.innerHTML=linky; 

         cell=row.insertCell();   // Separador
         cell.className = 'txtNormal';
         cell.width= document.all.separador1.width;
         cell.align = 'left';
         cell.innerText='';

         // % Não respondido
         cell=row.insertCell();   
         cell.className = 'txtPequeno';
         cell.align = 'right';
         cell.width = document.all.tbalternativa_col12.width;
         linky= '<in' + 'put type="text" name="aux_peavanre" disabled=true size="1" class="Campo" readOnly style="text-align:right; border:none;background-color:' + cor + ';" value="' + mava[i].peavanre + '">';
         //linky="";
         cell.innerHTML=linky; 

         cell=row.insertCell();   // Separador
         cell.className = 'txtNormal';
         cell.width= document.all.separador1.width;
         cell.align = 'left';
         cell.innerText='';

         // Botão de Excluir
         cell=row.insertCell();   
         cell.className = 'txtNormal';
         cell.align = 'left';
         cell.height = 26;         
         cell.width = document.all.tbalternativa_col13.width;
         linky='<a href="#." onClick=ExAva("' + mava[i].iditeava + '"); class="linkGuia"><img src="/cecred/images/botoes/btn_excluir.gif" border="0" title="Excluir"></a>';
         cell.innerHTML=linky; 
                 
         }
         
   }
}

function MostraDescritiva()
{

   var row;var cell;
   
   var cor='#F7F7F7';
   
   var aux_dsobserv;
   
   for (var i=document.all.tbdescritiva.rows.length; i>0; i--)
        document.all.tbdescritiva.deleteRow(i-1); 
   
   for(i=0;i<mava.length;i++)
   {

      /*if((document.form.aux_cdcooper.value == mava[i].cdcooper)&&
         (document.form.aux_cdagenci.value == mava[i].cdagenci)&&
         (document.form.aux_cdevento.value == mava[i].cdevento)&&
         (mava[i].tpiteava == "2"))
      {*/
      /* Alteração para ler eventos iguais, mas com sequencial diferente */
           
      if ((document.form.aux_nrseqeve.value == mava[i].nrseqeve)&&
          (mava[i].tpiteava == "2"))
      {

         document.form.qtavares.value     = mava[i].qtavares;
         document.form.aux_qtdparti.value = mava[i].qtpartic;

         row=tbdescritiva.insertRow(); 
        
         if (cor == '#FFFFFF')
            cor = '#F7F7F7';
         else
            cor = '#FFFFFF';
        
         row.bgColor = cor;
   
         // Item geral   Item específico  Avaliação
        
         // Item Geral
         cell=row.insertCell();   
         cell.className = 'txtPequeno';
         cell.align = 'left';
         cell.width = document.all.tbdescritiva_col1.width;
         linky=mava[i].dsgruava;
         cell.innerHTML=linky;
        
         cell=row.insertCell();   // Separador
         cell.className = 'txtNormal';
         cell.width= document.all.separador1.width;
         cell.align = 'left';
         cell.innerText='';
        
         // Item específico
         cell=row.insertCell();   
         cell.className = 'txtPequeno';
         cell.align = 'left';
         cell.width = document.all.tbdescritiva_col2.width;
         linky=mava[i].dsiteava + '<in' + 'put type="hidden" name="aux_cditeav2" value="' + mava[i].cditeava + '">';
         cell.innerHTML=linky; 
        
         cell=row.insertCell();   // Separador
         cell.className = 'txtNormal';
         cell.width= document.all.separador1.width;
         cell.align = 'left';
         cell.innerText='';
 
         // substitui £ por '
                 aux_dsobserv = mava[i].dsobserv; 
                 while(aux_dsobserv.match('£')=='£')
                          aux_dsobserv = aux_dsobserv.replace('£',"'");        
                                  
                 // Avaliação
         cell=row.insertCell();   
         cell.className = 'txtPequeno';
         cell.align = 'left';
         cell.width = document.all.tbdescritiva_col3.width;                 
         linky='<te' + 'xtarea name="aux_dsobserv" cols="27" rows="6" class="TextoFormulario" value="">' + aux_dsobserv + '</textarea>';
         cell.innerHTML=linky; 
        
         cell=row.insertCell();   // Separador
         cell.className = 'txtNormal';
         cell.width= document.all.separador1.width;
         cell.align = 'left';
         cell.innerText='';

         // Botão de Excluir
         cell=row.insertCell();   
         cell.className = 'txtNormal';
         cell.align = 'left';
         cell.height = 26;         
             cell.width = document.all.tbdescritiva_col4.width;
         linky='<a href="#." onClick=ExAva("' + mava[i].iditeava + '"); class="linkGuia"><img src="/cecred/images/botoes/btn_excluir.gif" border="0" title="Excluir"></a>';
         cell.innerHTML=linky; 
      }
          
   }

}

function MostraSugestao(){ 
   
   var row;var cell;
   var cor='#F7F7F7';
   
   for (var i=document.all.tbsugestao.rows.length; i>0; i--)
     document.all.tbsugestao.deleteRow(i-1); 
     
   for(i=0;i<mava.length;i++){
             
		if ((document.form.aux_nrseqeve.value == mava[i].nrseqeve) && (mava[i].tpiteava == "3")){ 

         document.form.qtavares.value     = mava[i].qtavares;
         document.form.aux_qtdparti.value = mava[i].qtpartic;

         row=tbsugestao.insertRow(); 
         
         if (cor == '#FFFFFF')
            cor = '#F7F7F7';
         else
            cor = '#FFFFFF';
        
         row.bgColor = cor;
   
         
          // Código da sugestão
         cell=row.insertCell();   
         cell.className = 'txtPequeno';
         cell.align = 'left';
         cell.width = document.all.tbsugestao_col1.width;
         linky=mava[i].nrseqdig;
         cell.innerHTML=linky;
     
         cell=row.insertCell();   // Separador
         cell.className = 'txtNormal';
         cell.width= document.all.separador1.width;
                 cell.height = 26;
         cell.align = 'right';
         cell.innerText='';
                 
                 // Descrição da avaliação
         cell=row.insertCell();   
         cell.className = 'txtPequeno';
         cell.align = 'left';
         cell.width = document.all.tbsugestao_col2.width;
         linky=mava[i].dssugeve;
         cell.innerHTML=linky;
     
         cell=row.insertCell();   // Separador
         cell.className = 'txtNormal';
         cell.width= document.all.separador1.width;
		 cell.height = 26;
         cell.align = 'left';
         cell.innerText='';
                 
		  // Quantidade de sugestão
         cell=row.insertCell();   
         cell.className = 'txtPequeno';
         cell.align = 'left';
         cell.width = document.all.tbsugestao_col3.width;
         linky=mava[i].qtsugeve;
         cell.innerHTML=linky;
          }
   
   }

}

function MostraTemasSugestao(){

	var row;var cell;   
	var cor='#F7F7F7';   
	var aux_dsobserv;
  
  for(var i = document.all.tbsugtem.rows.length; i>1; i--){
    document.all.tbsugtem.deleteRow(i-1); 
  }
  
	for(i=0;i<mtema.length;i++){
		row = tbsugtem.insertRow(); 
        
		if (cor == '#FFFFFF')
			cor = '#F7F7F7';
		else
			cor = '#FFFFFF';
        
		row.bgColor = cor; 
       
		// Item específico
		cell=row.insertCell();   
		cell.className = 'txtPequeno';
		cell.align = 'left';
		cell.width = 200;
		linky = mtema[i].dstemeix + "<input type='hidden' name='nrseqtem[" + i + "]' id='nrseqtem[" + i + "]' value='" + mtema[i].nrseqtem + "'>" + "<input type='hidden' name='nrseqdig[" + i + "]' id='nrseqdig[" + i + "]' value='" + mtema[i].nrseqdig + "'>";
		cell.innerHTML=linky; 
        
		// Separador
		cell=row.insertCell();
		cell.className = 'txtNormal';
		cell.width= document.all.separador1.width;
		cell.align = 'left';
		cell.innerText='';

		// Campo Input
		cell=row.insertCell();   
		cell.className = 'txtPequeno';
		cell.align = 'center';
		cell.width = 50;
		linky = "<input type='text' id='aux_qtsugeve[" + i + "]' name='aux_qtsugeve' size='1' class='Campo' style='text-align:right; width: 50px;'  value='" + mtema[i].qtsugeve + "'>";
		cell.innerHTML=linky;

	}         
}

function CarregaPrincipal () {
   window.status = "";
}

function LimparCampos(){}
function Habilita(){}
function HabilitaSalvar(){}

function ValidaDados(form){ 
   var msg="";

   // Se evento estiver cancelado, não pode fazer nada.
   /*if (document.form.aux_idstaeve.value == "2")
   {
      alert("Evento está cancelado. Inscrições não são permitidas.");
      return false;
   }

   // Se o evento é exclusivo para cooperados e está sendo inscrito um não cooperado, tem que confirmar
   if ((document.form.aux_tppartic.value == "EXCLUSIVO A COOPERADOS")&&
       (document.form.tpinseve[0].checked) &&
       (document.form.nmcooper.value != ""))
       if (confirm("Evento é exclusivo para cooperados. Confirma inscrição de um não cooperado?") == false)
          return false;

   if (document.form.aux_cdcooper.value == "")
      msg = "Cooperativa deve ser selecionada.";

   if (document.form.aux_cdagenci.value == "")
      msg = "PA deve ser selecionado.";

   if (document.form.aux_cdevento.value == "")
      msg = "Evento deve ser selecionado.";

   if (document.form.nmcooper.value == "") 
      msg = "Cooperado deve ser informado.";

   if (document.form.nminseve.value == "") 
      msg = "Nome do inscrito deve ser informado.";

   msg = msg + VE("in",form.nrdddins,"O DDD do telefone","sim", "0", "99999999");
   msg = msg + VE("in",form.nrtelins,"O Telefone","sim", "0", "99999999");*/

   if (msg == "")
       return true
   else
   {
      top.frcod.MostraResultado('1',msg);
      return false
   }
}

function Recarrega(){
   VarURL = NomeDoProgramaPrincipal + '?LinkRowid=' + document.form.aux_nrdrowid.value + '&pagina='  + document.form.pagina.value;
   window.open(VarURL,'mainFrame','toolbar=no,location=no,diretories=no,status=no,menubar=no,scrollbars=no,resizable=yes,width=600,height=300');
}

function mostraDiv(nomediv){   
   var nomeaba = '';

   if (nomediv=='') {nomediv='divAlternativa';}

   if (nomediv=='divAlternativa') {nomeaba='AbaAlternativa';}
   if (nomediv=='divDescritiva') {nomeaba='AbaDescritiva';}
   if (nomediv=='divSugestao') {nomeaba='AbaSugestao';}

   document.form.pagina.value=nomediv;
   document.all.divAlternativa.style.display = 'none';
   document.all.divDescritiva.style.display = 'none';
   document.all.divSugestao.style.display = 'none';

  /*document.all.adicionar.style.visibility = 'hidden';*/

   document.all.AbaAlternativa.rows[0].cells[0].background="/cecred/images/menu/mnu_nle.gif";
   document.all.AbaAlternativa.rows[0].cells[1].background="/cecred/images/menu/mnu_nlc.gif";
   document.all.AbaAlternativa.rows[0].cells[2].background="/cecred/images/menu/mnu_nld.gif";
   document.all.AbaAlternativa.rows[0].cells[1].className="txtTituloHid";
   
   document.all.AbaDescritiva.rows[0].cells[0].background="/cecred/images/menu/mnu_nle.gif";
   document.all.AbaDescritiva.rows[0].cells[1].background="/cecred/images/menu/mnu_nlc.gif";
   document.all.AbaDescritiva.rows[0].cells[2].background="/cecred/images/menu/mnu_nld.gif";
   document.all.AbaDescritiva.rows[0].cells[1].className="txtTituloHid";

   document.all.AbaSugestao.rows[0].cells[0].background="/cecred/images/menu/mnu_nle.gif";
   document.all.AbaSugestao.rows[0].cells[1].background="/cecred/images/menu/mnu_nlc.gif";
   document.all.AbaSugestao.rows[0].cells[2].background="/cecred/images/menu/mnu_nld.gif";
   document.all.AbaSugestao.rows[0].cells[1].className="txtTituloHid";

   document.all[nomeaba].rows[0].cells[0].background="/cecred/images/menu/mnu_sle.gif";
   document.all[nomeaba].rows[0].cells[1].background="/cecred/images/menu/mnu_slc.gif";
   document.all[nomeaba].rows[0].cells[2].background="/cecred/images/menu/mnu_sld.gif";
   document.all[nomeaba].rows[0].cells[1].className="txtTituloVis";

  /* if(nomeaba != 'AbaAlternativa')
      document.all.adicionar.style.visibility = 'visible';*/

   document.all[nomediv].style.display = 'block';
}

function MostraPACs(){
   for (var i=document.all.aux_cdagenci.options.length; i>=0; i--)
      document.all.aux_cdagenci.remove(i); 

   var oOption;
   
   for(i=0;i<mpac.length;i++)
   {
      if (mpac[i].cdcooper == document.form.aux_cdcooper.value)
      {
         oOption = document.createElement("OPTION");
         document.all.aux_cdagenci.options.add(oOption);
         oOption.innerText = mpac[i].nmresage.substring(0, 15);
         oOption.value = mpac[i].cdagenci;
      }
   }


   document.form.aux_cdagenci.value = '';
   document.form.aux_qtdparti.value = "";
   
}

function PosicionaPAC(){

   if(document.form.cdagenci.value != "")
   {
      //document.form.aux_cdeixtem.value = document.form.cdeixtem.value;
      MostraPACs();
      document.form.aux_cdagenci.value = document.form.cdagenci.value;
   }
   else
   {
      // posiciona a seleção no primeiro registro de Cooperativas, se só tiver 1
      if(document.all.aux_cdcooper.options.length == 1)
         document.form.aux_cdcooper.value = document.all.aux_cdcooper.options[0].value;

      // posiciona a seleção no primeiro registro de PACs, se só tiver 1
      if(document.all.aux_cdagenci.options.length == 1)
         document.form.aux_cdagenci.value = document.all.aux_cdagenci.options[0].value;
   }
}

function MostraEventos(){

   for (var i=document.all.aux_nrseqeve.options.length; i>=0; i--)
      document.all.aux_nrseqeve.remove(i); 

   var oOption;

   for(i=0;i<mevento.length;i++)
   {   
      if ((mevento[i].cdcooper == document.form.aux_cdcooper.value)&&
          (mevento[i].cdagenci == document.form.aux_cdagenci.value))
      {
         oOption = document.createElement("OPTION");
         document.all.aux_nrseqeve.options.add(oOption);
         oOption.innerText = mevento[i].nmevento.substring(0, 75);
         oOption.value = mevento[i].nrseqeve;
      }
   }
   document.form.aux_nrseqeve.value = '';
   if (document.form.aux_cdagenci.value == '') 
   {
      oOption = document.createElement("OPTION");
      document.all.aux_nrseqeve.options.add(oOption);
      oOption.innerText = "--Selecione PA--";
      oOption.value = '0';
      document.form.aux_nrseqeve.value = '0';
   }

   document.form.aux_nrseqeve.value = '';
   document.form.aux_qtdparti.value = '';
   document.form.qtavares.value = '0';   
  
   MostraAva();
   
}

function PosicionaEventos()
{

   if(document.form.nrseqeve.value != "")
   {
      //document.form.aux_cdeixtem.value = document.form.cdeixtem.value;
      MostraEventos();
      document.form.aux_nrseqeve.value = document.form.nrseqeve.value;
   }
   
   /*------------------------- Nao posicionar mais quando só existir 1 Evento 
   else
   {
      // posiciona a seleção no primeiro registro de Eventos, se só tiver 1
      if(document.all.aux_nrseqeve.options.length == 1){
         document.form.aux_nrseqeve.value = document.all.aux_nrseqeve.options[0].value;
      }
      else
         document.form.aux_nrseqeve.value = '';

      if (document.form.aux_cdagenci.value == "")
         document.form.aux_nrseqeve.value = '';
   }
   ---------------------------------------------------------------------------------*/
   
}

function Incluir(){
  var vaux = document.form.aux_lspermis.value; 
  if(vaux.substring(0,1) == 'I'){ 
    if(document.form.aux_stdopcao.value == 'i'){ 
      alert('Você já esta no modo de inclusão.'); 
      return false
    } 
    else{ 
      document.form.aux_cddopcao.value='in'; 
      document.form.aux_stdopcao.value='i'
      LimparCampos(); 
      return true
    } 
  } 
  else{ 
    MostraResultado('1','Desculpe, mas você não tem permissão para executar esta função.'); 
    return false
  }
}

function Salvar()
{
   var vaux = document.form.aux_lspermis.value;
   var nrseqtem = 0;
   var qtsugeve = 0;
   var i = 0;
   var iLen = document.getElementsByName('aux_qtsugeve').length;
   var arrQtsugeve = "";
   
   for (i = 0; i < iLen; i++) {
     
     nrseqtem = document.getElementById('nrseqtem[' + i + ']').value;
     qtsugeve = document.getElementById('aux_qtsugeve[' + i + ']').value;
     nrseqdig = document.getElementById('nrseqdig[' + i + ']').value;
     
     if(i == 0){
       arrQtsugeve = nrseqtem + ',' + qtsugeve + ',' + nrseqdig;   
     }else{
       arrQtsugeve += '#' + nrseqtem + ',' + qtsugeve + ',' + nrseqdig;
     }
     
   }
	
   document.form.arrQtsugeve.value = arrQtsugeve;
   
   if((vaux.substring(1,2) == 'A') || (document.form.aux_stdopcao.value == 'i')) { 
     if(document.form.aux_cddopcao.value!='sa')  {                         
       if(ArmazenaValores())
       {
         document.form.aux_cddopcao.value='sa'; 
         status = 'Salvando. Por favor, aguarde ...';  
         document.form.submit(); 
         return true;
       } 
       else{ 
         return false;
       }  
     } 
   }
   else{ 
     MostraResultado('1','Desculpe, mas você não tem permissão para executar esta função.'); 
     return false;
   }

  // alert("Função não implementada.");
}

function Excluir(){
  ZeraModoExclusao();  
  var vaux = document.form.aux_lspermis.value;
   
  if(vaux.substring(2,3) == 'E') { 
    if(document.form.aux_stdopcao.value=='i') { 
      MostraResultado('1','Você esta no modo de inclusão.Selecione o registro apropriado e então selecione a opção exclusão.'); 
      return false
    } 
    else {
      if (!confirm('Confirma Exclusão do Facilitador?')){
         return false;
      }
          else{          
         document.form.aux_cddopcao.value = "ex";
         document.form.submit();
          }
    } 
  } 
  else { 
    MostraResultado('1','Desculpe, mas você não tem permissão para executar esta função.'); 
    return false
  }        
}

function AbreZoom(ProgramaDeZoom,ProgramaPrincipal,NomeDoCampo,TipoDeZoom,ValorCampo,ValorCampo2,ValorCampo3,ValorCampo4,ValorCampo5,ValorCampo6)
   {   
      status = 'Processando pesquisa. Por favor, aguarde ...'; 
      if (ValorCampo == null)  ValorCampo = "";
      if (ValorCampo2 == null) ValorCampo2 = "";
      if (ValorCampo3 == null) ValorCampo3 = "";
      if (ValorCampo4 == null) ValorCampo4 = "";
      if (ValorCampo5 == null) ValorCampo5 = "";
      if (ValorCampo6 == null) ValorCampo6 = "";
      if (ValorCampo != "" )  ValorCampo = Substituir(ValorCampo);  
      if (ValorCampo2 != "" ) ValorCampo2 = Substituir(ValorCampo2);  
      if (ValorCampo3 != "" ) ValorCampo3 = Substituir(ValorCampo3);  
      if (ValorCampo4 != "" ) ValorCampo4 = Substituir(ValorCampo4);  
      if (ValorCampo5 != "" ) ValorCampo5 = Substituir(ValorCampo5);  
      if (ValorCampo6 != "" ) ValorCampo6 = Substituir(ValorCampo6);  
      ProgramaPrincipal = Substituir(ProgramaPrincipal);   
      ProgramaDeZoom = document.form.aux_dsendurl.value + ProgramaDeZoom;   
      varurl = ProgramaDeZoom + '?Pesquisa='    + TipoDeZoom  + 
                                '&vprograma='   + ProgramaPrincipal + 
                                '&NomeDoCampo=' + NomeDoCampo + 
                                '&ValorCampo='  + ValorCampo  + 
                                '&ValorCampo2=' + ValorCampo2 + 
                                '&ValorCampo3=' + ValorCampo3 + 
                                '&ValorCampo4=' + ValorCampo4 + 
                                '&ValorCampo5=' + ValorCampo5 + 
                                '&ValorCampo6=' + ValorCampo6;
      WZoom = window.open(varurl,'WZoom','toolbar=no,location=no,diretories=no,status=no,menubar=no,scrollbars=no,resizable=yes,width=580,height=350,screenX=0,screenY=0,top=10,left=10');
      WZoom.focus();          
   }
   
function ArmazenaValores()
{
   document.form.aux_lsiteava.value = '';
   document.form.aux_lsavaoti.value = '';
   document.form.aux_lsavabom.value = '';
   document.form.aux_lsavareg.value = '';
   document.form.aux_lsavains.value = '';
   document.form.aux_lsiteav2.value = '';
   document.form.aux_lsobserv.value = '';

   document.form.cdcooper.value = document.form.aux_cdcooper.value;
   document.form.cdagenci.value = document.form.aux_cdagenci.value;
   document.form.nrseqeve.value = document.form.aux_nrseqeve.value;
   

   if (document.form.aux_cdcooper.value == "")
      { alert("Cooperativa não selecionada."); return false; }

   if (document.form.aux_cdagenci.value == "")
      { alert("PA não selecionado."); return false; }

   if (document.form.aux_nrseqeve.value == "")
      { alert("Evento não selecionado."); return false; }

   if (parseInt(document.form.aux_qtdparti.value) < parseInt(document.form.qtavares.value)) 
   {
      alert("Quantidade de avaliações não pode ser maior que a quantidade de participantes."); 
      /*return false;*/
   }

   /*if ((document.all.tbalternativa.rows.length == 0)&&
       (document.all.tbdescritiva.rows.length == 0)) 
      return false;*/

   /* Alternativo */
   if (document.all.tbalternativa.rows.length > 0) 
   {
      if (document.form.aux_cditeava.length > 1) 
      {
         for (i=0;i<document.form.aux_cditeava.length;i++) 
         {

            if (parseInt(document.form.aux_qtavanre[i].value) < 0) 
            {
               alert("Quantidade não pode ser menor do que zero.");
               return false;
            }
         
            if (document.form.aux_lsiteava.value == '') 
            {
               document.form.aux_lsiteava.value = document.form.aux_cditeava[i].value;
               document.form.aux_lsavaoti.value = document.form.aux_qtavaoti[i].value;
               document.form.aux_lsavabom.value = document.form.aux_qtavabom[i].value;
               document.form.aux_lsavareg.value = document.form.aux_qtavareg[i].value;
               document.form.aux_lsavains.value = document.form.aux_qtavains[i].value;
            }
            else
            {
               document.form.aux_lsiteava.value = document.form.aux_lsiteava.value + ',' + document.form.aux_cditeava[i].value;
               document.form.aux_lsavaoti.value = document.form.aux_lsavaoti.value + ',' + document.form.aux_qtavaoti[i].value;
               document.form.aux_lsavabom.value = document.form.aux_lsavabom.value + ',' + document.form.aux_qtavabom[i].value;
               document.form.aux_lsavareg.value = document.form.aux_lsavareg.value + ',' + document.form.aux_qtavareg[i].value;
               document.form.aux_lsavains.value = document.form.aux_lsavains.value + ',' + document.form.aux_qtavains[i].value;
            }
         }
      }
      else
      {
         if (parseInt(document.form.aux_qtavanre.value) < 0) 
         {
            alert("Quantidade não pode ser menor do que zero.");
            return false;
         }

         document.form.aux_lsiteava.value = document.form.aux_cditeava.value;
         document.form.aux_lsavaoti.value = document.form.aux_qtavaoti.value;
         document.form.aux_lsavabom.value = document.form.aux_qtavabom.value;
         document.form.aux_lsavareg.value = document.form.aux_qtavareg.value;
         document.form.aux_lsavains.value = document.form.aux_qtavains.value;
      }
   }

   /* Fim - alternativo */
  
   /* Descritivo */
   if (document.all.tbdescritiva.rows.length > 0) 
   {
      if (document.form.aux_cditeav2.length > 1) 
      {
         for (i=0;i<document.form.aux_cditeav2.length;i++) 
         {
         
            if (document.form.aux_lsiteav2.value == '') 
            {
               document.form.aux_lsiteav2.value = document.form.aux_cditeav2[i].value;
               document.form.aux_lsobserv.value = altera_simbolo(document.form.aux_dsobserv[i].value);
            }
            else
            {
                           document.form.aux_lsiteav2.value = document.form.aux_lsiteav2.value + ',' + document.form.aux_cditeav2[i].value;
               document.form.aux_lsobserv.value = document.form.aux_lsobserv.value + '§' + altera_simbolo(document.form.aux_dsobserv[i].value);
            }
         }
      }
      else
      {
             document.form.aux_lsiteav2.value = document.form.aux_cditeav2.value;
         document.form.aux_lsobserv.value = altera_simbolo(document.form.aux_dsobserv.value);
      }
   }
   /* Fim - descritivo */ 
   
   return true;
}

// Funcao: VE(Valida Elemento)
// Objetivo: verificar se um elemento(componente) está no formato adequado (caracter, inteiro, data, decimal)
// Parametros de entrada:
//    tc = tipo do componente. "ca":caracter, "da":data, "de":decimal, "in":inteiro
//    nc = nome do componente.
//    lc = label do componente.
//    pn = componente pode ser nulo? "sim"/"nao"
//    mi = valor mínimo do componente
//    ma = valor máximo do componente
// Parametros de saída:
//    msg = Mensagem de Erro da validação
function VE(tc,nc,lc,pn,mi,ma)
{  
  var msg = "";
  var p = "xx";
  var z = 1;
  var x = 0; 
  var cv = 0;
  var dia = 0;
  var mes = 0;
  var ano = 0;
  var aux = "";
  var aux2 = nc.value;
  pn.toLowerCase();
  tc.toLowerCase();

  if (tc == "de") {
    for (var x = 0; x < aux2.length; x++) {
      if (aux2.substring(x,x+1) != " ")
        aux = aux + aux2.substring(x,x+1);
    } 
    nc.value = aux;
  }
  if (tc == "ca") {
    if (pn == "sim")
      {}
    else {
      if (nc.value == "")
        msg = lc + " não pode ser nulo.";
    }
    if (nc.value.substring(0,1) == " ")
      msg = msg + lc + " não pode começar com branco.";
  }
  else
  if (tc == "in") {
    p = "0123456789";
    if (pn == "sim") {  
      if (nc.value == "")
        nc.value = "0";
      else {
        for (var x = 0; x < nc.value.length; x++)  {
          if (p.indexOf(nc.value.substring(x,x+1)) == -1)
            z = 0;
        } 
        if (z == 0)
          msg = msg + lc + " possui caracteres que não são validos.";  
        if (msg == "") {
          if (nc.value < mi)
            msg = msg + lc + " deve ser maior que " + mi.toString() + ".";
          if (nc.value > ma)
            msg = msg + lc + " deve ser menor que " + ma.toString() + ".";
        }
      }
    }
    else {
      if (nc.value == "")
        msg = msg + lc + " não pode ser nulo.";
        for (var x = 0; x < nc.value.length; x++) {
        if (p.indexOf(nc.value.substring(x,x+1)) == -1)
                      z = 0;
               } 
               if (z == 0)
                  msg = msg + lc + " possui caracteres que não são validos.";  
               if (msg == "") {
                  if (nc.value < mi)
                     msg = msg + lc + " deve ser maior que " + mi.toString() + ".";
                  if (nc.value > ma)
                     msg = msg + lc + " deve ser menor que " + ma.toString() + ".";
               }
         }
      }
      else
      if (tc == "de") {
         p = ",0123456789";
         if (pn == "sim") {  
            if (nc.value == "")
               nc.value = "0";
            else {
                 for (var x = 0; x < nc.value.length; x++) {
                     if (p.indexOf(nc.value.substring(x,x+1)) == -1 & nc.value.substring(x,x+1) != ".") {
                        z = 0;
                     }
                     if (nc.value.substring(x,x+1) == ".")
                        cv = cv + 1;
                 } 
                 if (cv > 1)
                    z = 0;
                 if (z == 0) {
                    msg = msg + lc + " possui caracteres que não são validos.";  
                 }
                 if (msg == "") {
                    if (nc.value < mi) 
                       msg = msg + lc + " deve ser maior que " + mi.toString() + ".";  
                    if (nc.value > ma)
                       msg = msg + lc + " deve ser menor que " + ma.toString() + ".";
                 }
            }
         }
         else {
              if (nc.value == "")
                 msg = msg + lc + " não pode ser nulo.";
              for (var x = 0; x < nc.value.length; x++) {
                  if (p.indexOf(nc.value.substring(x,x+1)) == -1  & nc.value.substring(x,x+1) != ".")
                     z = 0;
                  if (nc.value.substring(x,x+1) == ".")
                     cv = cv + 1;
              } 
              if (cv > 1)
                 z = 0;
              if (z == 0) {
                 msg = msg + lc + " possui caracteres que não são validos.";  
              }
              if (msg == "") {
                 if (nc.value < mi)
                    msg = msg + lc + " deve ser maior que " + mi.toString() + ".";
                 if (nc.value > ma)
                    msg = msg + lc + " deve ser menor que " + ma.toString() + ".";
              }
         }
      }
      else
      if (tc == "da") {
         p = "0123456789/";
         if (pn == "sim") {  
            if (nc.value == "")
               {}
            else {
                 for (var x = 0; x < nc.value.length; x++) {
                     if (p.indexOf(nc.value.substring(x,x+1)) == -1)
                        z = 0;
                     if (nc.value.substring(x,x+1) == "/")
                        cv = cv + 1;
                 } 
                 if (cv != 2)
                    z = 0;
                 if (z == 0)
                    msg = msg + lc + " possui caracteres que não são validos.";  
                 if (msg == "") {
                    p1 = nc.value.indexOf("/") ;
                    p2 = nc.value.lastIndexOf("/") ;
                    if ((p2 == (p1 + 1)) || (nc.value.substring(0,p1).length == 0) || (nc.value.substring(p1+1,p2).length == 0) || (nc.value.substring(p2+1,nc.value.length).length == 0))
                       msg = msg + lc + " possui os separadores fora de lugar.";
                    else {
                          dia = parseInt(nc.value.substring(0,p1),10);
                          mes = parseInt(nc.value.substring(p1+1,p2),10);
                          ano = parseInt(nc.value.substring(p2+1,nc.value.length),10);
                          if ((mes < 1) || (mes > 12))
                             msg = msg + lc + " deve possuir o mês entre 1 e 12.";
                          if ((mes==1) || (mes==3) || (mes==5) || (mes==7) || (mes==8) || (mes==10) || (mes==12))  {
                             if ((dia < 1) || (dia > 31))
                                msg = msg + lc + " deve possuir o dia entre 1 e 31.";
                             }
                             else {        
                                  if (mes!=2) {
                                     if ((dia < 1) || (dia > 30))
                                        msg = msg + lc + " deve possuir o dia entre 1 e 30.";
                                  }
                                  else {
                                       if (mes==2) {
                                          if ((ano % 4) == 0) { 
                                             if ((dia < 1) || (dia > 29))
                                                msg = msg + lc + " deve possuir o dia entre 1 e 29.";
                                          }
                                          else  {
                                                if ((dia < 1) || (dia > 28))
                                                msg = msg + lc + " deve possuir o dia entre 1 e 28.";
                                          }
                                       }
                                  }
                             }
                         }
                     }
                 }
              }
          }
          else
            msg = "Validação não pode ser realizada.<br> Tipo de dado do campo não identificado.";                                
          return msg;
   }

function FechaZoom(campo,valor,valor2,valor3,valor4,valor5,valor6,valor7,valor8)
{

   if (window.WZoom != null)
   {        
      if (WZoom.closed != true)
      {
         WZoom.close();
      }
   }
}

// Altera o link da função de adicionar
function mudaAdicionar(){

   // Verifica se o usuário tem permissão de incluir
   if (document.form.aux_lspermis.value.substring(0,1) != 'I'){ 
      alert('Desculpe, mas você não tem permissão para executar esta função.'); 
      return false;
   }

   if ((document.form.aux_cdagenci.value == '')||(document.form.aux_nrseqeve.value == '')) 
   {
      alert("Por favor, selecione PA e Evento.");
      return false;
   }

   if(document.all.divAlternativa.style.display == 'block')
      AdAlternativa();

   if(document.all.divDescritiva.style.display == 'block')
     AdDescritiva();

   if(document.all.divSugestao.style.display == 'block')
     AdSugestao();
}

function AdAlternativa()
{
   VarURL = document.form.aux_dsendurl.value  + '/wpgd0029a.htm?' +
      'aux_tpiteava='  + '1'                              +
      '&aux_idevento=' + document.form.aux_idevento.value +
      '&aux_cdcooper=' + document.form.aux_cdcooper.value +
      '&aux_cdagenci=' + document.form.aux_cdagenci.value +
      '&aux_dtanoage=' + document.form.aux_dtanoage.value +
      '&aux_nrseqeve=' + document.form.aux_nrseqeve.value +
      '&aux_qtavares=' + document.form.qtavares.value;
   window.open(VarURL,'','toolbar=no,location=no,diretories=no,status=no,menubar=no,scrollbars=yes,resizable=no,width=500,height=450,TOP=10,LEFT=10');   
}

function AdDescritiva()
{
   VarURL = document.form.aux_dsendurl.value  + '/wpgd0029a.htm?' +
      'aux_tpiteava='  + '2'                              +
      '&aux_idevento=' + document.form.aux_idevento.value +
      '&aux_cdcooper=' + document.form.aux_cdcooper.value +
      '&aux_cdagenci=' + document.form.aux_cdagenci.value +
      '&aux_dtanoage=' + document.form.aux_dtanoage.value +
      '&aux_nrseqeve=' + document.form.aux_nrseqeve.value +
      '&aux_qtavares=' + document.form.qtavares.value;
   window.open(VarURL,'','toolbar=no,location=no,diretories=no,status=no,menubar=no,scrollbars=yes,resizable=no,width=360,height=400,TOP=10,LEFT=10');   
}

function AdSugestao()
{
   VarURL = document.form.aux_dsendurl.value  + '/wpgd0011.htm?' +
      'aux_tpiteava='  + '3'                              +
      '&aux_idevento=' + document.form.aux_idevento.value +
      '&aux_cdcooper=' + document.form.aux_cdcooper.value +
      '&cdagenci='     + document.form.aux_cdagenci.value +
      '&aux_dtanoage=' + document.form.aux_dtanoage.value +
      '&aux_nrseqeve=' + document.form.aux_nrseqeve.value +
      '&origem='       + 'ava';
   window.open(VarURL,'','toolbar=no,location=no,diretories=no,status=no,menubar=no,scrollbars=yes,resizable=no,width=610,height=420,TOP=10,LEFT=10');   
}

function MostraAva()
{
  
   document.form.aux_qtdparti.value = "";
   
   MostraAlternativa();
   MostraDescritiva();
   MostraSugestao();
   MostraTemasSugestao();
}

function ExAva(rowid)
{
   // Verifica se o usuário tem permissão de exclusao
   if (document.form.aux_lspermis.value.substring(2,3) != 'E'){ 
      alert('Desculpe, mas você não tem permissão para executar esta função.'); 
      return false;
   }
   
   if(!confirm("Este item será excluido para TODOS OS PA's, deseja continuar?"))
     return false;

   document.form.cdcooper.value = document.form.aux_cdcooper.value;
   document.form.cdagenci.value = document.form.aux_cdagenci.value;
   document.form.nrseqeve.value = document.form.aux_nrseqeve.value;

   document.form.aux_iditeava.value = rowid;
   document.form.aux_cddopcao.value = 'exa'; 
   document.form.submit();
}

function CalculaLinha(indice)
{
   var qtoti = 0;
   var qtbom = 0;
   var qtreg = 0;
   var qtins = 0;
   var qtnre = 0;
   var qtres = parseFloat(document.form.qtavares.value);

   if (document.form.aux_cditeava.length > 1) 
   {
      qtoti = parseFloat(ConverteDec(document.form.aux_qtavaoti[indice].value, "1"));
      qtbom = parseFloat(ConverteDec(document.form.aux_qtavabom[indice].value, "1"));
      qtreg = parseFloat(ConverteDec(document.form.aux_qtavareg[indice].value, "1"));
      qtins = parseFloat(ConverteDec(document.form.aux_qtavains[indice].value, "1"));
      //qtnre = parseFloat(ConverteDec(document.form.aux_qtavanre[indice].value, "1"));

      document.form.aux_peavaoti[indice].value = parseInt(qtoti / qtres * 100);
      document.form.aux_peavabom[indice].value = parseInt(qtbom / qtres * 100);
      document.form.aux_peavareg[indice].value = parseInt(qtreg / qtres * 100);
      document.form.aux_peavains[indice].value = parseInt(qtins / qtres * 100);

      qtnre = qtres - (qtoti + qtbom + qtreg + qtins);

      document.form.aux_qtavanre[indice].value = qtnre;
      document.form.aux_peavanre[indice].value = parseInt(qtnre / qtres * 100);
   }
   else
   {
      qtoti = parseFloat(ConverteDec(document.form.aux_qtavaoti.value, "1"));
      qtbom = parseFloat(ConverteDec(document.form.aux_qtavabom.value, "1"));
      qtreg = parseFloat(ConverteDec(document.form.aux_qtavareg.value, "1"));
      qtins = parseFloat(ConverteDec(document.form.aux_qtavains.value, "1"));
      //qtnre = parseFloat(ConverteDec(document.form.aux_qtavanre[indice].value, "1"));

      document.form.aux_peavaoti.value = parseInt(qtoti / qtres * 100);
      document.form.aux_peavabom.value = parseInt(qtbom / qtres * 100);
      document.form.aux_peavareg.value = parseInt(qtreg / qtres * 100);
      document.form.aux_peavains.value = parseInt(qtins / qtres * 100);

      qtnre = qtres - (qtoti + qtbom + qtreg + qtins);

      document.form.aux_qtavanre.value = qtnre;
      document.form.aux_peavanre.value = parseInt(qtnre / qtres * 100);

   }
}

function CalculaTodos()
{
   if (document.all.tbalternativa.rows.length == 0) 
      return false;

   if (document.form.aux_cditeava.length > 1) 
   {
      for (i = 0; i < document.form.aux_cditeava.length; i++) 
      {
         CalculaLinha(i);
      }
   }
   else
      CalculaLinha('0');
   
}

//formatação dos campos
function formatCurrency(num) 
{
   //alert(num);
   num = num.toString().replace(/\$|\,/g,'');
   if(isNaN(num))
      num = "0";
   sign = (num == (num = Math.abs(num)));
   num = Math.floor(num*100+0.50000000001);
   cents = num%100;
   num = Math.floor(num/100).toString();
   if(cents<10)
      cents = "0" + cents;
   for (var i = 0; i < Math.floor((num.length-(1+i))/3); i++)
      num = num.substring(0,num.length-(4*i+3))+'.'+
   num.substring(num.length-(4*i+3));
   return (((sign)?'':'-') + num + ',' + cents);
}

// Converte um valor com decimal separado por "," para separado por "."
function ConverteDec(str, tipo)
{
   if(tipo == "1")
   {
      str = str.replace(".","");
      str = str.replace(",",".");
      return str;
   }
   else
   {
      str = str.replace(",","");
      str = str.replace(".",",");
      return str;
   }
}

function altera_simbolo(str){
   
  while(str.match("'")=="'")
            str = str.replace("'","£");
                  
  return str;
}

mostraDiv(document.form.pagina.value);

MostraPACs();
PosicionaPAC();

MostraEventos();      
PosicionaEventos();
MostraAva();
</script>
</body>
