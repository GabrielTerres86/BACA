<!--------------------------------------------------------------------------------------------------------------

   Alteraçoes: 28/01/2008 - Acrescentados Data e Hora na descriçao dos eventos no Combo (Diego).
   
               01/02/2008 - Efetuar ordenaçao através do campo crapgap.nrordgru (Diego).
   
               10/12/2008 - Melhoria de performance para a tabela gnapses (Evandro).
               
               30/04/2009 - Utilizar cdcooper = 0 nas consultas (David).
               
               09/06/2011 - Corrigido os itens da aba Sugestao para nao aparecerem
                            mais de uma vez.
                          - Mostrar os eventos de integraçao.
                           (Isara - RKAM)
                                                  
               05/06/2012 - Adaptaçao dos fontes para projeto Oracle. Alterado
                            busca na gnapses de CONTAINS para MATCHES (Guilherme Maba).
                            
               08/07/2012 - Tratamento de CLOB com CHAR (Guilherme).
               
               05/09/2012 - Desfeito tratamento no campo dsobserv clob (Tiago).           
               
               16/06/2014 - Ajustes na procedure local-delete-record para
                            gravar registros na temp-table do buffer Softdesk
                            165668 (Lucas R.)
                            
               05/08/2015 - Implementaçao de novas funcionalidades  referente ao projeto de melhorias
                            do progrid etapa rf01(Jean MICHEL).
														
               21/06/2016 - Ajustes para a RF05 (Jean Michel).
               
               19/08/2016 - Melhorias OQS - RF07 (Odirlei - AMcom).
							 
-------------------------------------------------------------------------------------------------------------->

<html>
	<head>
		<title>Avaliaçoes</title>
	</head>
	<body style="margin-left: 3px; overflow:auto;">
    <link href="/cecred/estilos/progrid.css" rel="stylesheet" type="text/css">
    <link href="/cecred/css/jquery.ui.datepicker.css" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="/cecred/css/base/jquery.ui.all.css">
	<script type="text/javascript" src="/cecred/scripts/scripts.js"></script>	
    <script type="text/javascript" src="/cecred/scripts/jquery.ui.core.js"></script>
    <script type="text/javascript" src="/cecred/scripts/jquery.ui.datepicker.js"></script>
    <script type="text/javascript" src="/cecred/scripts/i18n/jquery.ui.datepicker-pt-BR.js"></script>	
    <script type="text/javascript" src="/cecred/scripts/funcoes.js"></script>
    
    
		<script language="JavaScript">
			NomeDoProgramaPrincipal  = '/wpgd0029.w';
			NomeDoProgramaDeListagem = '/wpgd0029ls.w';
			NomeDoProgramaDeAjuda    = '/wpgd0029aj.w';
			NomeDoProgramaDeZoom     = '/zoom/zwpgd0029.w';
      function aguarde() {
            // abre a janela com a mesagem de aguarde
            showMsgAguardo("Carregando Dados...");
		}
    
		</script>
		<form action="#." method="POST" name="form">
			<input type="hidden" name="aux_dsendurl" value="">
            <input type="hidden" name="aux_dsurlphp" value="">            
            <input type="hidden" name="aux_idcokses" value="">
			<input type="hidden" name="pagina" value="">
			<input type="hidden" name="aux_idevento" value="">
			<input type="hidden" name="aux_cddopcao" value="">
			<input type="hidden" name="aux_nrdrowid" value="">
			<input type="hidden" name="aux_lspermis" value="">
			<input type="hidden" name="aux_dsretorn" value="">
			<input type="hidden" name="aux_stdopcao" value="">
			<input type="hidden" name="cdcooper"     value="">
			<input type="hidden" name="cdagenci"     value="">
            <input type="hidden" name="aux_cdcopope" value="">
            <input type="hidden" name="aux_cdoperad" value="">
			<input type="hidden" name="aux_cdevento" value="">
			<input type="hidden" name="nrseqeve" id="nrseqeve"     value="">
			<input type="hidden" name="aux_lsaltern" value="">
			<input type="hidden" name="aux_lsdescri" value="">
			<input type="hidden" name="aux_iditeava" value="">
			<input type="hidden" name="aux_lsiteava" value="">
			<input type="hidden" name="aux_lsavaoti" value="">
			<input type="hidden" name="aux_lsavabom" value="">
			<input type="hidden" name="aux_lsavareg" value="">
			<input type="hidden" name="aux_lsavains" value="">
			<input type="hidden" name="aux_lsiteav2" value="">
			<input type="hidden" name="aux_lsobserv" id"aux_lsobserv" value="">
            <input type="hidden" name="aux_lsavares" value="">
			<input type="hidden" name="arrQtsugeve" value="">
            <input type="hidden" name="idfimava" id="idfimava"     value="">
            <input type="hidden" name="dsdemail_fornec" id="dsdemail_fornec"     value="">
            
			<!-- Inicio do modelo com abas -->
      			
      <div style="width:100%;">
      
        <div style="position:absolute;padding-left:10px;">
          <img src="/cecred/images/icones/ico_fornecedor.gif">
        </div>
			
        <div style="margin-top: 5px;">
          <table width="100%" border="0" align="left" cellpadding="0" cellspacing="0" background="/cecred/images/geral/guia_fundo.gif">
            <tr>
              <td width="11"><img src="/cecred/images/geral/guia_esquerda.gif" width="11" height="21"></td>
              <td width="56"><img src="/cecred/images/geral/spacer.gif" width="10" height="10"></td>
              <td width="666" height="20" align="left" class="linkGuia">Avaliaçoes</td>
              <td width="280" height="20" align="right" class="linkGuia">wpgd0029</td>          
              <td width="11" align="right"><img src="/cecred/images/geral/guia_direita.gif" width="11" height="21"></td>
            </tr>
          </table>
        </div>
			</div>	
        
			<div style="background-color: white; float: left; width: 100%; padding-top: 5px;  z-index: 4;">
				<table width="100%" border="0" cellpadding="0" cellspacing="0" align="left">
					<tr>
						<td width="15%" align="right" class="NomeCampo"> Agenda:</td>
						<td width="15%" class="NomeCampo">
							<input name="aux_dtanoage" class="Campo" type="text"  size="4" onChange="document.form.submit();">
						</td>
						<td width="15%" class="NomeCampo" align="right">Cooperativa:</td>
						<td width="15%" class="NomeCampo" align="left">
							<select name="aux_cdcooper" class="Campo"  onChange="document.form.aux_dtanoage.value=''; document.form.aux_cddopcao.value=''; document.form.submit();"></select>
						</td>
						<td width="15%" align="right" class="NomeCampo">PA:</td>
						<td width="25%" align="left" class="NomeCampo"><select name="aux_cdagenci" class="Campo" onChange="$('#aux_nrseqeve').empty(); aguarde(); document.form.cdagenci.value = document.form.aux_cdagenci.value; document.form.submit();">
						</select></td>
					</tr>
					<tr>
						<td align="right" class="NomeCampo">Evento:</td>
						<td colspan="5" align="left" class="NomeCampo">
							<select name="aux_nrseqeve" id="aux_nrseqeve" class="Campo" onChange="aguarde(); document.form.nrseqeve.value = document.form.aux_nrseqeve.value; document.form.submit();"></select>
						</td>  
					</tr>
					<tr>                              
						<td align="right" class="NomeCampo">Participantes:</td>
						<td class="NomeCampo"><input name="aux_qtdparti" type="text" size="4" readOnly></td>
						<td class="NomeCampo"><div align="right">Respondidas:</div></td>
						<td colspan="1" class="NomeCampo"><input name="qtavares" id="qtavares" type="hidden" size="4" onChange="CalculaTodos()"></td>
                        <td colspan="2" align="LEFT"> 
                             <div id='divbtnReabrir'style="MARGIN-LEFT: 8px">
                                <a href="#" class="botao" id="btReabrir"  onclick="ReabrirAvaliacao(); return false;">Abrir Avaliação para Ajuste</a>
                             </div>
                        </td>
					</tr>
                    <tr>                              
						<td colspan="3" ></td>
						<td colspan="3" >
                            <div id="CamposQtavares"> 
                                <span align="right" class="NomeCampo">Cooperado:  </span>                          
                                <input name="qtavares_ass" id="qtavares_ass" class="Campo" style="TEXT-ALIGN: right; MARGIN-RIGHT: 10px" type="text" size="4" onChange="CalculaTodos()">
                               
                                <span align="right" class="NomeCampo">Cooperativa:</span>
                                <input name="qtavares_coop" id="qtavares_coop" class="Campo" style="TEXT-ALIGN: right; MARGIN-RIGHT: 10px" type="text" size="4" onChange="CalculaTodos()">
                                
                                <span align="right" class="NomeCampo">Fornecedor: </span>
                                <input name="qtavares_forn" id="qtavares_forn" class="Campo" style="TEXT-ALIGN: right; MARGIN-RIGHT: 10px" type="text" size="4" onChange="CalculaTodos()">
                                
                            </div> 
                        </td>
					</tr>
				</table>		
			</div>	
				
			<div style="background-color: white; float: left; width: 100%; padding-top: 10px;  z-index: 3;">
				<!-- Interrupcao do modelo - início das abas -->
				<table cellpadding="0" cellspacing="0" bgcolor="#FFFFFF" style="width:100%;>
					<tr align="center">
						<td width="105" height="15">
							<table width="100" id="AbaAlternativa" border="0" cellpadding="0" cellspacing="0">
								<tr style="cursor:hand">
									<td background="/cecred/images/menu/mnu_nle.gif" width="4" height="21"></td>
									<td width="92" align="center" class="txtTituloHid" onclick="mostraDiv('divAlternativa')">Alternativa</td>
									<td background="/cecred/images/menu/mnu_nld.gif" width="4" height="21"></td>
								</tr>
							</table>
						</td>
						<td width="105" height="15">
							<table width="100" id="AbaDescritiva" border="0" cellpadding="0" cellspacing="0">
								<tr style="cursor:hand">
									 <td background="/cecred/images/menu/mnu_nle.gif" width="4" height="21"></td>
									<td width="92" align="center" class="txtTituloHid" onclick="mostraDiv('divDescritiva')">Descritiva</td>
									<td background="/cecred/images/menu/mnu_nld.gif" width="4" height="21"></td>
								</tr>
							</table>
						</td>
						<td width="105" height="15">
							<table width="100" id="AbaSugestao" border="0" cellpadding="0" cellspacing="0">
								<tr style="cursor:hand">
									 <td background="/cecred/images/menu/mnu_nle.gif" width="4" height="21"></td>
									<td width="92" align="center" class="txtTituloHid" onclick="mostraDiv('divSugestao')">Sugestão</td>
									<td background="/cecred/images/menu/mnu_nld.gif" width="4" height="21"></td>
								</tr>
							</table>
						</td>
						<!-- Links de Adicionar -->
						<td width="950" align="right" class="txtTituloHid">
							<div id="adicionar">
										 <a href="#." id="btAdicionar" onclick="mudaAdicionar();">Adicionar</a>&nbsp;&nbsp;
							</div>
						</td>                         
					</tr>
					<tr>
						<td colspan="5" height="2" align="left" background="/cecred/images/menu/mnu_slc.gif"></td>
					</tr>
				</table>
			</div>
				
			<div style="float: left; width:100%; z-index: 2; height:380px; padding-top: 1px; ">
				<!-- ALTERNATIVA -->
				<div id="divAlternativa" style="height:380px; width:100%;" >
					<table id="tbalternativa" width="100%" border="0" cellpadding="0" cellspacing="0" align="left" class="dataTable" style="float: left;">
						<thead>
              <tr>                          
                <td width="80" background="/cecred/images/menu/fnd_title.jpg" height="25" class="txtMenuTitulos" id="tbalternativa_col0" >Relatório</td>
                <td width="2"   background="/cecred/images/menu/fnd_title.jpg" id="separador1"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                <td width="230" background="/cecred/images/menu/fnd_title.jpg" height="25" id="tbalternativa_col1" class="txtMenuTitulos">Grupo</td>
                <td width="2"   background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15" border="0"></td>
                <td width="210" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos" id="tbalternativa_col2" >Item</td>
                <td width="2"   background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                <td width="50"  background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos" id="tbalternativa_col3" >&Oacute;timo</td>
                <td width="2"   background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                <td width="5"  background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos" id="tbalternativa_col4">%</td>
                <td width="2"   background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                <td width="50"  background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos" id="tbalternativa_col5">Bom</td>
                <td width="2"   background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                <td width="5"  background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos" id="tbalternativa_col6">%</td>
                <td width="2"   background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                <td width="50"  background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos" id="tbalternativa_col7">Regular</td>
                <td width="2"   background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                <td width="5"  background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos" id="tbalternativa_col8">%</td>
                <td width="2"   background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                <td width="50"  background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos" id="tbalternativa_col9">Insuf</td>
                <td width="2"   background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                <td width="5"  background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos" id="tbalternativa_col10">%</td>
                <td width="2"   background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                <td width="50"  background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos" id="tbalternativa_col11">NR</td>
                <td width="2"   background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                <td width="5"  background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos" id="tbalternativa_col12">%</td>
                <td width="2"   background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                <td width="12"  background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos" id="tbalternativa_col13"></td>
              </tr>
            </head>
					</table>
				</div>
				<!-- FIM ALTERNATIVA -->
													
				<!-- DESCRITIVA -->
				<div id="divDescritiva" style="height:380px; width:100%;">
					<table width="100%" id="tbdescritiva" name="tbdescritiva" border="0" cellpadding="0" cellspacing="0" class="dataTable">
            <thead>
              <tr>
                <td id="tbdescritiva_col14" width="150" height="25" class="txtMenuTitulos" background="/cecred/images/menu/fnd_title.jpg">Relat&oacute;rio </td>
                <td width="5" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                <td id="tbdescritiva_col1" width="150" height="25" class="txtMenuTitulos" background="/cecred/images/menu/fnd_title.jpg">Item Geral </td>
                <td width="5" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                <td id="tbdescritiva_col2" width="150" class="txtMenuTitulos" background="/cecred/images/menu/fnd_title.jpg">Item espec&iacute;fico </td>
                <td width="5" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                <td id="tbdescritiva_col3" width="200" class="txtMenuTitulos" background="/cecred/images/menu/fnd_title.jpg">Descriçao</td>
                <td width="5" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                <td id="tbdescritiva_col4" width="20" class="txtMenuTitulos" background="/cecred/images/menu/fnd_title.jpg" >&nbsp;</td>
              </tr>	
						</thead>	
						<!--<tr>
							<td colspan="9">
								<div style="overflow: auto; height:380px; width: 100%;">
									<table  width="100%" border="0" cellpadding="0" cellspacing="0">
										
									</table>
								</div>
							</td>
						</TR>-->
					</table>
				</div>
				<!-- FIM DESCRITIVA -->
				
				<!-- SUGESTAO -->	
				<div id="divSugestao" style="height:380px; width:100%;">
					<table width="100%" border="0" cellpadding="0" cellspacing="0" class="dataTable">
						<tr>
							<td id="tbsugestao_col1" width="40" height="25" class="txtMenuTitulos" background="/cecred/images/menu/fnd_title.jpg">Código </td>
							<td width="5" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
							<td id="tbsugestao_col2" width="500" height="25" class="txtMenuTitulos" background="/cecred/images/menu/fnd_title.jpg">Avaliaçoes </td>
							<td width="5" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
							<td id="tbsugestao_col3" width="60" height="25" class="txtMenuTitulos" background="/cecred/images/menu/fnd_title.jpg">Quantidade</td>
							<td width="5" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
						</tr>
						<tr>
							<td colspan="6">
								<div style="overflow: auto; width: 100%; height:100%;">
									<table name="tbsugestao" id="tbsugestao" width="100%" border="0" cellpadding="0" cellspacing="0">
										<!-- INCLUI DADOS -->
									</table>
								</div>
							</td>
						</tr>
						<tr>
							<td colspan="6">
								<div id="divSugesTemas" name="divSugesTemas" >
									<table id="tbsugtem" name="tbsugtem" width="100%" border="0" cellpadding="0" cellspacing="0" >
										<tr>
											<td colspan="3" style="text-align:left; font-size:11px"><b>Sugestoes de Temas Pré-Categorizados</b></td>
										</tr>
									</table>
								</div>
							</td>
						</tr>
					</table>
				</div>
				<!-- FIM SUGESTAO -->
			</div>
			<!-- BOTAO SALVAR -->
			<div style="width:100%; z-index:2; text-align: center; padding-top: 5px;">
				<!--<img style="cursor:hand" src="/cecred/images/botoes/btn_salvar.gif" onClick="Salvar();"> -->
                <a href="#" class="botao" id="btSalvar"    onclick="Salvar();">Salvar</a>  
                <a href="#" class="botao" id="btEncerrar"  onclick="EncerrarAvaliacao(); return false;">Encerrar Avaliação</a>  
			</div>
			<!-- FIM BOTAO SALVAR -->
		</form>
		<script language="JavaScript">
			NomeDoProgramaPrincipal = document.form.aux_dsendurl.value + NomeDoProgramaPrincipal;
			document.form.action = NomeDoProgramaPrincipal;

			function MostraAlternativa(){  
				var row;
				var cell;
				var cor='#F7F7F7';
			 
				for (var i=document.all.tbalternativa.rows.length; i>1; i--){
					document.all.tbalternativa.deleteRow(i-1); 
				}  
  
  if(mava.length == 0){
  row = tbalternativa.insertRow(); 
    // Sem Registros
    row.bgColor = '#F7F7F7';
     cell = row.insertCell();   
     cell.className = 'txtPequeno';
     cell.align = 'center';
     cell.colSpan = 29;
     cell.innerHTML = '<b>Nenhum Registro Encontrado.</b>';
  }else{
   document.form.qtavares_ass.value = 0; 
   document.form.qtavares_coop.value = 0; 
   document.form.qtavares_forn.value = 0; 
   
   for(i=0;i<mava.length;i++){
      /* Alteraçao para ler eventos iguais, mas com sequencial diferente */
      if ((document.form.aux_nrseqeve.value == mava[i].nrseqeve) &&
          (mava[i].tpiteava == "1")){
         row = tbalternativa.insertRow(); 
         document.form.qtavares.value = mava[i].qtavares;
         document.form.aux_qtdparti.value = mava[i].qtpartic;
         document.form.nrseqeve.value = mava[i].nrseqeve;
         
         if (mava[i].tprelgru  == 'COOPERADO'){
            document.form.qtavares_ass.value = mava[i].qtavares;
         }else if (mava[i].tprelgru == 'COOPERATIVA') {
            document.form.qtavares_coop.value = mava[i].qtavares;
         }else if (mava[i].tprelgru == 'FORNECEDOR') {
            document.form.qtavares_forn.value = mava[i].qtavares;
         }        
        
         if (cor == '#FFFFFF')
            cor = '#F7F7F7';
         else
            cor = '#FFFFFF';
        
         row.bgColor = cor;
    
         // Relatorio
         cell=row.insertCell();   
         cell.className = 'txtPequeno';
         cell.align = 'left';
         cell.width = 80;
         cell.title = mava[i].tprelgru;
         linky=mava[i].tprelgru;
         linky += '<in' + 'put type="hidden" name="aux_tprelgru" value="' + mava[i].tprelgru + '">';
         cell.innerHTML=linky;
        
         // Separador 
         cell=row.insertCell();   
         cell.className = 'txtNormal';
         cell.width = 2;
         cell.align = 'left';
         cell.innerText='';
         
         // Item geral   Item específico  Ótimo  %  Bom  %  Regular  %  Insuficiente  %  
        
         // Item Geral
         cell=row.insertCell();   
         cell.className = 'txtPequeno';
         cell.align = 'left';
         cell.width = document.all.tbalternativa_col1.width;
         cell.title = mava[i].dsgruava;
         linky=mava[i].dsgruava;
         cell.innerHTML=linky;
        
         // Separador
         cell=row.insertCell();   
         cell.className = 'txtNormal';
         cell.width= document.all.separador1.width;
         cell.align = 'left';
         cell.innerText='';
        
         // Item específico
         cell=row.insertCell();   
         cell.className = 'txtPequeno';
         cell.align = 'left';
         cell.width = document.all.tbalternativa_col2.width;
         cell.title = mava[i].dsiteava;
         linky = mava[i].dsiteava + '<in' + 'put type="hidden" name="aux_cditeava" value="' + mava[i].cditeava + '">';
         cell.innerHTML=linky; 
        
         // Separador
         cell=row.insertCell();   
         cell.className = 'txtNormal';
         cell.width = 2;
         cell.align = 'left';
         cell.innerText='';

         if (document.form.aux_cditeava.length > 1)
            linha = document.form.aux_cditeava.length - 1;
         else
            linha = 0;

         // Qtde Ótimo
         cell=row.insertCell();   
         cell.className = 'txtPequeno';
         cell.align = 'center';
         cell.width = 50;
         linky = '<in' + 'put type="text" name="aux_qtavaoti" size="1" class="Campo" style="text-align:right;" onChange="CalculaLinha(' + "'" + linha + "'" + ')" value="' + mava[i].qtavaoti + '">';         
         cell.innerHTML=linky; 
        
         // Separador 
         cell=row.insertCell();
         cell.className = 'txtNormal';
         cell.width = 2;
         cell.align = 'left';
         cell.innerText='';
   
         // % Ótimo
         cell=row.insertCell();   
         cell.className = 'txtPequeno';
         cell.align = 'center';
         cell.width = document.all.tbalternativa_col4.width;
         linky= '<in' + 'put type="text" name="aux_peavaoti" disabled=true size="1" class="Campo" readOnly style="text-align:right; border:none;background-color:' + cor + ';" value="' + mava[i].peavaoti + '">';
         cell.innerHTML=linky; 

         cell=row.insertCell();   // Separador
         cell.className = 'txtNormal';
         cell.width= document.all.separador1.width;
         cell.align = 'left';
         cell.innerText='';

         // Qtde Bom
         cell=row.insertCell();   
         cell.className = 'txtPequeno';
         cell.align = 'center';
         cell.width = document.all.tbalternativa_col5.width;
         linky= '<in' + 'put type="text" name="aux_qtavabom" size="1" class="Campo" style="text-align:right;" onChange="CalculaLinha(' + "'" + linha + "'" + ')" value="' + mava[i].qtavabom + '">';
         cell.innerHTML=linky; 
        
         cell=row.insertCell();   // Separador
         cell.className = 'txtNormal';
         cell.width= document.all.separador1.width;
         cell.align = 'left';
         cell.innerText='';
   
         // % Bom
         cell=row.insertCell();   
         cell.className = 'txtPequeno';
         cell.align = 'center';
         cell.width = document.all.tbalternativa_col6.width;
         linky= '<in' + 'put type="text" name="aux_peavabom" disabled=true size="1" class="Campo" readOnly style="text-align:right; border:none;background-color:' + cor + ';" value="' + mava[i].peavabom + '">';
         //linky="";
         cell.innerHTML=linky; 

         cell=row.insertCell();   // Separador
         cell.className = 'txtNormal';
         cell.width= document.all.separador1.width;
         cell.align = 'left';
         cell.innerText='';

         // Qtde Regular
         cell=row.insertCell();   
         cell.className = 'txtPequeno';
         cell.align = 'center';
         cell.width = document.all.tbalternativa_col7.width;
         linky= '<in' + 'put type="text" name="aux_qtavareg" size="1" class="Campo" style="text-align:right;" onChange="CalculaLinha(' + "'" + linha + "'" + ')" value="' + mava[i].qtavareg + '">';
         cell.innerHTML=linky;  
        
         cell=row.insertCell();   // Separador
         cell.className = 'txtNormal';
         cell.width= document.all.separador1.width;
         cell.align = 'left';
         cell.innerText='';
   
         // % Regular
         cell=row.insertCell();   
         cell.className = 'txtPequeno';
         cell.align = 'center';
         cell.width = document.all.tbalternativa_col8.width;
         linky= '<in' + 'put type="text" name="aux_peavareg" disabled=true size="1" class="Campo" readOnly style="text-align:right; border:none;background-color:' + cor + ';" value="' + mava[i].peavareg + '">';
         cell.innerHTML=linky; 

         cell=row.insertCell();   // Separador
         cell.className = 'txtNormal';
         cell.width= document.all.separador1.width;
         cell.align = 'left';
         cell.innerText='';

         // Qtde Insuficiente
         cell=row.insertCell();   
         cell.className = 'txtPequeno';
         cell.align = 'center';
         cell.width = document.all.tbalternativa_col9.width;
         linky= '<in' + 'put type="text" name="aux_qtavains" class="Campo" size="1" style="text-align:right;" onChange="CalculaLinha(' + "'" + linha + "'" + ')" value="' + mava[i].qtavains + '">';
         cell.innerHTML=linky; 
        
         cell=row.insertCell();   // Separador
         cell.className = 'txtNormal';
         cell.width= document.all.separador1.width;
         cell.align = 'left';
         cell.innerText='';
   
         // % Insuficiente
         cell=row.insertCell();   
         cell.className = 'txtPequeno';
         cell.align = 'center';
         cell.width = document.all.tbalternativa_col10.width;
         linky= '<in' + 'put type="text" name="aux_peavains" disabled=true size="1" class="Campo" readOnly style="text-align:right; border:none;background-color:' + cor + ';" value="' + mava[i].peavains + '">';
         cell.innerHTML=linky; 

         cell=row.insertCell();   // Separador
         cell.className = 'txtNormal';
         cell.width= document.all.separador1.width;
         cell.align = 'left';
         cell.innerText='';

         // Nao respondido
         cell=row.insertCell();   
         cell.className = 'txtPequeno';
         cell.align = 'center';
         cell.width = document.all.tbalternativa_col11.width;
         linky= '<in' + 'put type="text" name="aux_qtavanre" disabled=true size="1" class="Campo" readOnly style="text-align:right; border:none; background-color:' + cor + ';" value="' + mava[i].qtavanre + '">';
         linky += '<in' + 'put type="hidden" name="aux_qtavares" value="' + mava[i].qtavares + '">';
         cell.innerHTML=linky; 

         // Separador 
         cell=row.insertCell();   
         cell.className = 'txtNormal';
         cell.width= document.all.separador1.width;
         cell.align = 'left';
         cell.innerText='';

         // % Nao respondido
         cell=row.insertCell();   
         cell.className = 'txtPequeno';
         cell.align = 'center';
         cell.width = document.all.tbalternativa_col12.width;
         linky= '<in' + 'put type="text" name="aux_peavanre" disabled=true size="1" class="Campo" readOnly style="text-align:right; border:none;background-color:' + cor + ';" value="' + mava[i].peavanre + '">';
         cell.innerHTML=linky; 

         // Separador
         cell=row.insertCell();
         cell.className = 'txtNormal';
         cell.width= document.all.separador1.width;
         cell.align = 'left';
         cell.innerText='';

         // Botao de Excluir
         cell=row.insertCell();   
         cell.className = 'txtNormal';
         cell.align = 'center';
         cell.height = 26;         
         cell.width = document.all.tbalternativa_col13.width;
         linky='<a href="#." class="BotaoExcluir" onClick=ExAva("' + mava[i].iditeava + '"); class="linkGuia"><img class="BotaoExcluir" src="/cecred/images/botoes/btn_excluir.gif" border="0" title="Excluir"></a>';
         cell.innerHTML=linky; 
                 
         }
       }   
   }
}


			function MostraDescritiva(){

				 var row;var cell;
				 
				 var cor='#F7F7F7';
				 
				 var aux_dsobserv;
				 
				 for(var i=document.all.tbdescritiva.rows.length; i>1; i--){
           document.all.tbdescritiva.deleteRow(i-1); 
         }
				 
         if(mava.length ==0){
           row = tbdescritiva.insertRow();
           row.bgColor = '#F7F7F7';           
           cell=row.insertCell();   
           cell.className = 'txtNormal';
           cell.align = 'center';
           cell.colSpan = 9;
           linky = '<b>Nenhum Registro Encontrado.</b>';
           cell.innerHTML = linky; 
         }else{
           document.form.qtavares.value     = mava[0].qtavares;
           document.form.aux_qtdparti.value = mava[0].qtpartic;
           for(i=0;i<mava.length;i++){

              /* Alteraçao para ler eventos iguais, mas com sequencial diferente */
                   
              if ((document.form.aux_nrseqeve.value == mava[i].nrseqeve)&&
                  (mava[i].tpiteava == "2")){

                 row=tbdescritiva.insertRow(); 
                
                 if (cor == '#FFFFFF')
                    cor = '#F7F7F7';
                 else
                    cor = '#FFFFFF';
                
                 row.bgColor = cor;
           
                 // Item geral   Item específico  Avaliaçao
                
                 // Relatorio
                 cell=row.insertCell();   
                 cell.className = 'txtPequeno';
                 cell.align = 'left';
                 cell.width = $("#tbdescritiva_col14").width();
                 cell.innerHTML=mava[i].tprelgru;
                
                 cell=row.insertCell();   // Separador
                 cell.className = 'txtNormal';
                 cell.width= document.all.separador1.width;
                 cell.align = 'left';
                 cell.innerText='';
                 
                 // Item Geral
                 cell=row.insertCell();   
                 cell.className = 'txtPequeno';
                 cell.align = 'left';
                 cell.width = document.all.tbdescritiva_col1.width;
                 linky=mava[i].dsgruava;
                 cell.innerHTML=linky;
                
                 cell=row.insertCell();   // Separador
                 cell.className = 'txtNormal';
                 cell.width= document.all.separador1.width;
                 cell.align = 'left';
                 cell.innerText='';
                
                 // Item específico
                 cell=row.insertCell();   
                 cell.className = 'txtPequeno';
                 cell.align = 'left';
                 cell.width = document.all.tbdescritiva_col2.width;
                 linky=mava[i].dsiteava + '<in' + 'put type="hidden" name="aux_cditeav2[' + i + ']" id="aux_cditeav2[' + i + ']" class="cditeav" value="' + mava[i].cditeava + '">';
                 cell.innerHTML=linky; 
                
                 cell=row.insertCell();   // Separador
                 cell.className = 'txtNormal';
                 cell.width= document.all.separador1.width;
                 cell.align = 'left';
                 cell.innerText='';
         
                 // substitui L por '
                 aux_dsobserv = mava[i].dsobserv; 
                 
                 /*while(aux_dsobserv.match('L') == 'L'){
                   aux_dsobserv = aux_dsobserv.replace('L',"'");        
                 }*/
                                          
                 // Avaliaçao
                 cell=row.insertCell();   
                 cell.className = 'txtPequeno';
                 cell.align = 'left';
                 cell.width = $("#tbdescritiva_col3").width();
                 linky='<te' + 'xtarea name="aux_dsobserv[' + i + ']" id="aux_dsobserv[' + i + ']" cols="60" rows="4" class="TextoFormulario" value="">' + aux_dsobserv + '</textarea>';
                 cell.innerHTML=linky; 
                
                 cell=row.insertCell();   // Separador
                 cell.className = 'txtNormal';
                 cell.width= document.all.separador1.width;
                 cell.align = 'left';
                 cell.innerText='';

                 // Botao de Excluir
                 cell=row.insertCell();   
                 cell.className = 'txtNormal';
                 cell.align = 'left';
                 cell.height = 26;         
                     cell.width = $("#tbdescritiva_col4").width();
                 linky='<a href="#." class="BotaoExcluir" onClick=ExAva("' + mava[i].iditeava + '"); class="linkGuia"><img class="BotaoExcluir" src="/cecred/images/botoes/btn_excluir.gif" border="0" title="Excluir"></a>';
                 cell.innerHTML=linky; 
              }
                  
           }
         }  
			}

			function MostraSugestao(){ 
				 
				 var row;
         var cell;
				 var cor = '#F7F7F7';
				 
         $("#divSugesTemas").hide();
         
				 for (var i=document.all.tbsugestao.rows.length; i>0; i--){
					 document.all.tbsugestao.deleteRow(i-1); 
				 }
         
         if(mava.length == 0){
           $("#divSugesTemas").hide();
           row = tbsugestao.insertRow();
           row.bgColor = '#F7F7F7';           
           cell=row.insertCell();   
           cell.className = 'txtNormal';
           cell.align = 'center';
           cell.colSpan = 6;
           linky = '<b>Nenhum Registro Encontrado.</b>';
           cell.innerHTML = linky; 
         
         }else{  
           $("#divSugesTemas").show();
           
           for(i=0;i<mava.length;i++){
                     
            if ((document.form.aux_nrseqeve.value == mava[i].nrseqeve) && (mava[i].tpiteava == "3")){ 

                 document.form.qtavares.value     = mava[i].qtavares;
                 document.form.aux_qtdparti.value = mava[i].qtpartic;

                 row = tbsugestao.insertRow(); 
                 
                 if (cor == '#FFFFFF')
                    cor = '#F7F7F7';
                 else
                    cor = '#FFFFFF';
                
                 row.bgColor = cor;				 
                 
                  // Código da sugestao
                 cell=row.insertCell();   
                 cell.className = 'txtPequeno';
                 cell.align = 'left';
                 cell.width = $("#tbsugestao_col1").width();
                 linky=mava[i].nrseqdig;
                 cell.innerHTML=linky;
             
                 cell=row.insertCell();   // Separador
                 cell.className = 'txtNormal';
                 cell.width= document.all.separador1.width;
                 cell.height = 26;
                 cell.align = 'right';
                 cell.innerText='';
                         
                 // Descriçao da avaliaçao
                 cell=row.insertCell();   
                 cell.className = 'txtPequeno';
                 cell.align = 'left';
                 cell.width = $("#tbsugestao_col2").width();
                 linky=mava[i].dssugeve;
                 cell.innerHTML=linky;
             
                 cell=row.insertCell();   // Separador
                 cell.className = 'txtNormal';
                 cell.width= document.all.separador1.width;
                 cell.height = 26;
                 cell.align = 'left';
                 cell.innerText='';
                         
                 // Quantidade de sugestao
                 cell=row.insertCell();   
                 cell.className = 'txtPequeno';
                 cell.align = 'left';
                 cell.width = $("#tbsugestao_col3").width();
                 linky=mava[i].qtsugeve;
                 cell.innerHTML=linky;
               }
           
            }
         }
			}

			function MostraTemasSugestao(){

				var row;var cell;   
				var cor='#F7F7F7';   
				var aux_dsobserv;
				
				for(var i = document.all.tbsugtem.rows.length; i>1; i--){
					document.all.tbsugtem.deleteRow(i-1); 
				}
				
				if(mtema.length == 0){
           $("#divSugesTemas").hide();
           row = tbsugestao.insertRow();
           row.bgColor = '#F7F7F7';           
           cell=row.insertCell();   
           cell.className = 'txtNormal';
           cell.align = 'center';
           cell.colSpan = 6;
           linky = '<b>Nenhum Registro Encontrado.</b>';
           cell.innerHTML = linky; 
         
         }else{  
						$("#divSugesTemas").show();
					 
						for(i=0;i<mtema.length;i++){
							row = tbsugtem.insertRow(); 
									
							if (cor == '#FFFFFF')
								cor = '#F7F7F7';
							else
								cor = '#FFFFFF';
									
							row.bgColor = cor; 
								 
							// Item específico
							cell=row.insertCell();   
							cell.className = 'txtPequeno';
							cell.align = 'left';
							cell.width = 200;
							linky = mtema[i].dstemeix + "<input type='hidden' name='nrseqtem[" + i + "]' id='nrseqtem[" + i + "]' value='" + mtema[i].nrseqtem + "'>" + "<input type='hidden' name='nrseqdig[" + i + "]' id='nrseqdig[" + i + "]' value='" + mtema[i].nrseqdig + "'>";
							cell.innerHTML=linky; 
									
							// Separador
							cell=row.insertCell();
							cell.className = 'txtNormal';
							cell.width= document.all.separador1.width;
							cell.align = 'left';
							cell.innerText='';

							// Campo Input
							cell=row.insertCell();   
							cell.className = 'txtPequeno';
							cell.align = 'center';
							cell.width = 50;
							linky = "<input type='text' id='aux_qtsugeve[" + i + "]' name='aux_qtsugeve' size='1' class='Campo' style='text-align:right; width: 50px;'  value='" + mtema[i].qtsugeve + "'>";
							cell.innerHTML=linky;

						}  
				}
			}

			function CarregaPrincipal () {
				 window.status = "";
			}

			function Recarrega(){
				 VarURL = NomeDoProgramaPrincipal + '?LinkRowid=' + document.form.aux_nrdrowid.value + '&pagina='  + document.form.pagina.value;
				 window.open(VarURL,'mainFrame','toolbar=no,location=no,diretories=no,status=no,menubar=no,scrollbars=no,resizable=yes,width=600,height=300');				 
			}
			
			function Refresh(){
				document.form.submit();
			}

			function mostraDiv(nomediv){   
				 var nomeaba = '';

				 if (nomediv=='') {nomediv='divAlternativa';}

				 if (nomediv=='divAlternativa') {nomeaba='AbaAlternativa';}
				 if (nomediv=='divDescritiva') {nomeaba='AbaDescritiva';}
				 if (nomediv=='divSugestao') {nomeaba='AbaSugestao';}

				 document.form.pagina.value=nomediv;
				 document.all.divAlternativa.style.display = 'none';
				 document.all.divDescritiva.style.display = 'none';
				 document.all.divSugestao.style.display = 'none';

				 document.all.AbaAlternativa.rows[0].cells[0].background="/cecred/images/menu/mnu_nle.gif";
				 document.all.AbaAlternativa.rows[0].cells[1].background="/cecred/images/menu/mnu_nlc.gif";
				 document.all.AbaAlternativa.rows[0].cells[2].background="/cecred/images/menu/mnu_nld.gif";
				 document.all.AbaAlternativa.rows[0].cells[1].className="txtTituloHid";
				 
				 document.all.AbaDescritiva.rows[0].cells[0].background="/cecred/images/menu/mnu_nle.gif";
				 document.all.AbaDescritiva.rows[0].cells[1].background="/cecred/images/menu/mnu_nlc.gif";
				 document.all.AbaDescritiva.rows[0].cells[2].background="/cecred/images/menu/mnu_nld.gif";
				 document.all.AbaDescritiva.rows[0].cells[1].className="txtTituloHid";

				 document.all.AbaSugestao.rows[0].cells[0].background="/cecred/images/menu/mnu_nle.gif";
				 document.all.AbaSugestao.rows[0].cells[1].background="/cecred/images/menu/mnu_nlc.gif";
				 document.all.AbaSugestao.rows[0].cells[2].background="/cecred/images/menu/mnu_nld.gif";
				 document.all.AbaSugestao.rows[0].cells[1].className="txtTituloHid";

				 document.all[nomeaba].rows[0].cells[0].background="/cecred/images/menu/mnu_sle.gif";
				 document.all[nomeaba].rows[0].cells[1].background="/cecred/images/menu/mnu_slc.gif";
				 document.all[nomeaba].rows[0].cells[2].background="/cecred/images/menu/mnu_sld.gif";
				 document.all[nomeaba].rows[0].cells[1].className="txtTituloVis";

				 document.all[nomediv].style.display = 'block';
                                  
                 if (nomediv == 'divAlternativa') {
                   $("#btEncerrar").show();
                 }else{
                   $("#btEncerrar").hide();
                 }                 
                 
			}

			function MostraPACs(){
				 for (var i=document.all.aux_cdagenci.options.length; i>=0; i--)
						document.all.aux_cdagenci.remove(i); 

				 var oOption;
				 
				 for(i=0;i<mpac.length;i++){
						if (mpac[i].cdcooper == document.form.aux_cdcooper.value){
							 oOption = document.createElement("OPTION");
							 document.all.aux_cdagenci.options.add(oOption);
							 oOption.innerText = mpac[i].nmresage.substring(0, 15);
							 oOption.value = mpac[i].cdagenci;
						}
				 }

				 document.form.aux_cdagenci.value = '';
				 document.form.aux_qtdparti.value = "";				 
			}

			function PosicionaPAC(){

				 if(document.form.cdagenci.value != ""){
						//document.form.aux_cdeixtem.value = document.form.cdeixtem.value;
						MostraPACs();
						document.form.aux_cdagenci.value = document.form.cdagenci.value;
				 }else{
						// posiciona a seleçao no primeiro registro de Cooperativas, se só tiver 1
						if(document.all.aux_cdcooper.options.length == 1)
							 document.form.aux_cdcooper.value = document.all.aux_cdcooper.options[0].value;

						// posiciona a seleçao no primeiro registro de PACs, se só tiver 1
						if(document.all.aux_cdagenci.options.length == 1)
							 document.form.aux_cdagenci.value = document.all.aux_cdagenci.options[0].value;
				 }
			}

			function MostraEventos(){

				 for (var i=document.all.aux_nrseqeve.options.length; i>=0; i--)
						document.all.aux_nrseqeve.remove(i); 

				 var oOption;

				 for(i=0;i<mevento.length;i++){
						if ((mevento[i].cdcooper == document.form.aux_cdcooper.value)&&
								(mevento[i].cdagenci == document.form.aux_cdagenci.value)){
							 oOption = document.createElement("OPTION");
							 document.all.aux_nrseqeve.options.add(oOption);
							 oOption.innerText = mevento[i].nmevento.substring(0, 75);
							 oOption.value = mevento[i].nrseqeve;
						    if (document.form.nrseqeve.value == mevento[i].nrseqeve){
                                document.form.idfimava.value = mevento[i].idfimava;
                                document.form.dsdemail_fornec.value = mevento[i].dsdemail_fornec;
                                document.form.aux_cdevento.value = mevento[i].cdevento;
                            } 
                        
                        }
				 }
				 document.form.aux_nrseqeve.value = '';
				 if (document.form.aux_cdagenci.value == ''){
						oOption = document.createElement("OPTION");
						document.all.aux_nrseqeve.options.add(oOption);
						oOption.innerText = "--Selecione PA--";
						oOption.value = '0';
						document.form.aux_nrseqeve.value = '0';
				 }

				 document.form.aux_nrseqeve.value = '';
				 document.form.aux_qtdparti.value = '';
				 document.form.qtavares.value = '0';   
				
				 MostraAva();
			}

			function PosicionaEventos(){
            
                document.all.divbtnReabrir.style.display = 'none'; 
                if(document.form.nrseqeve.value != ""){
                  MostraEventos();
                  document.form.aux_nrseqeve.value = document.form.nrseqeve.value;

                  //Se avaliações estiver encerrada apresentar botão para reabrir
                  if (document.form.idfimava.value == 1){
                    document.all.divbtnReabrir.style.display = 'block'; 
                    $('#btEncerrar').prop("disabled",true).addClass("botaoDesativado").attr("onClick","return false;");
                    Desabilitar();
                  }
                }	
			}

			function Incluir(){
				var vaux = document.form.aux_lspermis.value; 
				if(vaux.substring(0,1) == 'I'){ 
					if(document.form.aux_stdopcao.value == 'i'){ 
						alert('Voce já esta no modo de inclusao.'); 
						return false
					} 
					else{ 
						document.form.aux_cddopcao.value='in'; 
						document.form.aux_stdopcao.value='i'
						return true
					} 
				} 
				else{ 
					MostraResultado('1','Desculpe, mas voce nao tem permissao para executar esta funçao.'); 
					return false
				}
			}

			function Salvar(){
         var vaux = document.form.aux_lspermis.value;
         var nrseqtem = 0;
         var qtsugeve = 0;
         var i = 0;
         var iLen = document.getElementsByName('aux_qtsugeve').length;
         var arrQtsugeve = "";
         
         for (i = 0; i < iLen; i++) {
     
           nrseqtem = document.getElementById('nrseqtem[' + i + ']').value;
           qtsugeve = document.getElementById('aux_qtsugeve[' + i + ']').value;
           nrseqdig = document.getElementById('nrseqdig[' + i + ']').value;
           
           if(i == 0){
             arrQtsugeve = nrseqtem + ',' + qtsugeve + ',' + nrseqdig;   
           }else{
             arrQtsugeve += '#' + nrseqtem + ',' + qtsugeve + ',' + nrseqdig;
           }
           
         }
        
         document.form.arrQtsugeve.value = arrQtsugeve;
         
         if((vaux.substring(1,2) == 'A') || (document.form.aux_stdopcao.value == 'i')) { 
           if(document.form.aux_cddopcao.value!='sa')  {                         
             if(ArmazenaValores())
             {
               document.form.aux_cddopcao.value='sa'; 
               status = 'Salvando. Por favor, aguarde ...'; 
               document.form.submit(); 
               return true;
             } 
             else{ 
               return false;
             }  
           } 
         }
         else{ 
           MostraResultado('1','Desculpe, mas voce nao tem permissao para executar esta funçao.'); 
           return false;
         }

      }

			function Excluir(){
				ZeraModoExclusao();  
				var vaux = document.form.aux_lspermis.value;
				 
				if(vaux.substring(2,3) == 'E') { 
					if(document.form.aux_stdopcao.value=='i') { 
						MostraResultado('1','Voce esta no modo de inclusao.Selecione o registro apropriado e entao selecione a opçao exclusao.'); 
						return false
					} 
					else {
						if (!confirm('Confirma Exclusao do Facilitador?')){
							 return false;
						}
								else{          
							 document.form.aux_cddopcao.value = "ex";
							 document.form.submit();
								}
					} 
				} 
				else { 
					MostraResultado('1','Desculpe, mas voce nao tem permissao para executar esta funçao.'); 
					return false
				}        
			}
				 
			function ArmazenaValores(){
				 document.form.aux_lsiteava.value = '';
				 document.form.aux_lsavaoti.value = '';
				 document.form.aux_lsavabom.value = '';
				 document.form.aux_lsavareg.value = '';
				 document.form.aux_lsavains.value = '';
				 document.form.aux_lsiteav2.value = '';
				 document.form.aux_lsobserv.value = '';
                 document.form.aux_lsavares.value = '';

				 document.form.cdcooper.value = document.form.aux_cdcooper.value;
				 document.form.cdagenci.value = document.form.aux_cdagenci.value;
				 document.form.nrseqeve.value = document.form.aux_nrseqeve.value;
				 

				 if (document.form.aux_cdcooper.value == "")
						{ alert("Cooperativa nao selecionada."); return false; }

				 if (document.form.aux_cdagenci.value == "")
						{ alert("PA nao selecionado."); return false; }

				 if (document.form.aux_nrseqeve.value == "")
						{ alert("Evento nao selecionado."); return false; }

				 if (parseInt(document.form.aux_qtdparti.value) < parseInt(document.form.qtavares.value)){
						alert("Quantidade de avaliaçoes nao pode ser maior que a quantidade de participantes."); 
				 }

				 /* Alternativo */
         if(mava.length > 0){
           if (document.all.tbalternativa.rows.length > 0){
              if (document.form.aux_cditeava.length > 1){
                 for (i=0;i<document.form.aux_cditeava.length;i++){

                    if (parseInt(document.form.aux_qtavanre[i].value) < 0){
                       alert("Quantidade nao pode ser menor do que zero.");
                       return false;
                    }
                 
                    if (document.form.aux_lsiteava.value == ''){
                       document.form.aux_lsiteava.value = document.form.aux_cditeava[i].value;
                       document.form.aux_lsavaoti.value = document.form.aux_qtavaoti[i].value;
                       document.form.aux_lsavabom.value = document.form.aux_qtavabom[i].value;
                       document.form.aux_lsavareg.value = document.form.aux_qtavareg[i].value;
                       document.form.aux_lsavains.value = document.form.aux_qtavains[i].value;
                       document.form.aux_lsavares.value = document.form.aux_qtavares[i].value;
                    }else{
                       document.form.aux_lsiteava.value = document.form.aux_lsiteava.value + ',' + document.form.aux_cditeava[i].value;
                       document.form.aux_lsavaoti.value = document.form.aux_lsavaoti.value + ',' + document.form.aux_qtavaoti[i].value;
                       document.form.aux_lsavabom.value = document.form.aux_lsavabom.value + ',' + document.form.aux_qtavabom[i].value;
                       document.form.aux_lsavareg.value = document.form.aux_lsavareg.value + ',' + document.form.aux_qtavareg[i].value;
                       document.form.aux_lsavains.value = document.form.aux_lsavains.value + ',' + document.form.aux_qtavains[i].value;
                       document.form.aux_lsavares.value = document.form.aux_lsavares.value + ',' + document.form.aux_qtavares[i].value;
                    }
                 }
              }
              else
              {
                 if (parseInt(document.form.aux_qtavanre.value) < 0) 
                 {
                    alert("Quantidade nao pode ser menor do que zero.");
                    return false;
                 }

                 document.form.aux_lsiteava.value = document.form.aux_cditeava.value;
                 document.form.aux_lsavaoti.value = document.form.aux_qtavaoti.value;
                 document.form.aux_lsavabom.value = document.form.aux_qtavabom.value;
                 document.form.aux_lsavareg.value = document.form.aux_qtavareg.value;
                 document.form.aux_lsavains.value = document.form.aux_qtavains.value;
                 document.form.aux_lsavares.value = document.form.aux_qtavares.value;
              }
           }
         }
				 /* Fim - alternativo */
				
         if(mava.length > 0){ 
           /* Descritivo */
           if (document.all.tbdescritiva.rows.length > 0){
           
							if (mava.length > 1){
                 for (i = 0; i < mava.length; i++){
                   if ((document.form.aux_nrseqeve.value == mava[i].nrseqeve)&&
                    (mava[i].tpiteava == "2")){
                                   
                      if (document.form.aux_lsiteav2.value == ''){
                         document.form.aux_lsiteav2.value = document.getElementById('aux_cditeav2[' + i + ']').value; //document.form.aux_cditeav2[i].value;
                         document.form.aux_lsobserv.value = document.getElementById('aux_dsobserv[' + i + ']').value; //altera_simbolo(document.form.aux_dsobserv[i].value);
                      }else{
                        document.form.aux_lsiteav2.value = document.form.aux_lsiteav2.value + ',' + document.getElementById('aux_cditeav2[' + i + ']').value; //document.form.aux_cditeav2[i].value;
                        document.form.aux_lsobserv.value = document.form.aux_lsobserv.value + '|' + document.getElementById('aux_dsobserv[' + i + ']').value; //altera_simbolo(document.form.aux_dsobserv[i].value);
                      }
                    }
                 }
              }else{
                if(mava.length == 0){
									document.form.aux_lsiteav2.value = 0;
								}else{
									document.form.aux_lsiteav2.value = $('#aux_cditeav2[0]').val();
								}
                //document.form.aux_lsobserv.value = altera_simbolo(document.form.aux_dsobserv.value);
                $("#aux_lsobserv").val(altera_simbolo($("#aux_dsobserv[0]").val()));
              }
           }
         }
				 /* Fim - descritivo */ 
				 
				 return true;
			}

			// Altera o link da funçao de adicionar
			function mudaAdicionar(){

				 // Verifica se o usuário tem permissao de incluir
				 if (document.form.aux_lspermis.value.substring(0,1) != 'I'){ 
						alert('Desculpe, mas voce nao tem permissao para executar esta funçao.'); 
						return false;
				 }

				 if ((document.form.aux_cdagenci.value == '')||(document.form.aux_nrseqeve.value == '')){
						alert("Por favor, selecione PA e Evento.");
						return false;
				 }

				 if(document.all.divAlternativa.style.display == 'block')
						AdAlternativa();

				 if(document.all.divDescritiva.style.display == 'block')
					 AdDescritiva();

				 if(document.all.divSugestao.style.display == 'block')
					 AdSugestao();
			}

			function AdAlternativa(){
				 VarURL = document.form.aux_dsendurl.value  + '/wpgd0029a.htm?' +
						'aux_tpiteava='  + '1'                              +
						'&aux_idevento=' + document.form.aux_idevento.value +
						'&aux_cdcooper=' + document.form.aux_cdcooper.value +
						'&aux_cdagenci=' + document.form.aux_cdagenci.value +
						'&aux_dtanoage=' + document.form.aux_dtanoage.value +
						'&aux_nrseqeve=' + document.form.aux_nrseqeve.value +
						'&aux_qtavares=' + document.form.qtavares.value +
                        '&aux_qtavares_ass='  + document.form.qtavares_ass.value  +
                        '&aux_qtavares_coop=' + document.form.qtavares_coop.value +
                        '&aux_qtavares_forn=' + document.form.qtavares_forn.value ;
				 window.open(VarURL,'','toolbar=no,location=no,diretories=no,status=no,menubar=no,scrollbars=yes,resizable=yes,width=800,height=600,TOP=10,LEFT=10');   
			}

			function AdDescritiva(){
				 VarURL = document.form.aux_dsendurl.value  + '/wpgd0029a.htm?' +
						'aux_tpiteava='  + '2'                              +
						'&aux_idevento=' + document.form.aux_idevento.value +
						'&aux_cdcooper=' + document.form.aux_cdcooper.value +
						'&aux_cdagenci=' + document.form.aux_cdagenci.value +
						'&aux_dtanoage=' + document.form.aux_dtanoage.value +
						'&aux_nrseqeve=' + document.form.aux_nrseqeve.value +
						'&aux_qtavares=' + document.form.qtavares.value;
				 window.open(VarURL,'','toolbar=no,location=no,diretories=no,status=no,menubar=no,scrollbars=yes,resizable=yes,width=800,height=600,TOP=10,LEFT=10');   
			}

			function AdSugestao(){
				 VarURL = document.form.aux_dsendurl.value  + '/wpgd0011.htm?' +
						'aux_tpiteava='  + '3'                              +
						'&aux_idevento=' + document.form.aux_idevento.value +
						'&aux_cdcooper=' + document.form.aux_cdcooper.value +
						'&cdagenci='     + document.form.aux_cdagenci.value +
						'&aux_dtanoage=' + document.form.aux_dtanoage.value +
						'&aux_nrseqeve=' + document.form.aux_nrseqeve.value +
						'&origem='       + 'ava';
				 window.open(VarURL,'','toolbar=no,location=no,diretories=no,status=no,menubar=no,scrollbars=yes,resizable=yes,width=610,height=420,TOP=10,LEFT=10');   
			}

			function MostraAva(){
				
				 document.form.aux_qtdparti.value = "";
				 
				 MostraAlternativa();
				 MostraDescritiva();
				 MostraSugestao();
				 MostraTemasSugestao(); 

                 if (document.form.idfimava.value == 1){
                    Desabilitar(); 
                 }
			}

			function ExAva(rowid){
				 // Verifica se o usuário tem permissao de exclusao
				 if (document.form.aux_lspermis.value.substring(2,3) != 'E'){ 
						alert('Desculpe, mas voce nao tem permissao para executar esta funçao.'); 
						return false;
				 }
				 
				 if(!confirm("Este item será excluido para TODOS OS PA's, deseja continuar?"))
					 return false;

				 document.form.cdcooper.value = document.form.aux_cdcooper.value;
				 document.form.cdagenci.value = document.form.aux_cdagenci.value;
				 document.form.nrseqeve.value = document.form.aux_nrseqeve.value;

				 document.form.aux_iditeava.value = rowid;
				 document.form.aux_cddopcao.value = 'exa'; 
				 document.form.submit();
			}

			function CalculaLinha(indice){
				 var qtoti = 0;
				 var qtbom = 0;
				 var qtreg = 0;
				 var qtins = 0;
				 var qtnre = 0;
                 var qtres = 0;
				 //var qtres = parseFloat(document.form.qtavares.value);
                 var qtres_coop = parseFloat(document.form.qtavares_coop.value);
                 var qtres_ass  = parseFloat(document.form.qtavares_ass.value);
                 var qtres_forn = parseFloat(document.form.qtavares_forn.value);                                              

				 if (document.form.aux_cditeava.length > 1){
						qtoti = parseFloat(ConverteDec(document.form.aux_qtavaoti[indice].value, "1"));
						qtbom = parseFloat(ConverteDec(document.form.aux_qtavabom[indice].value, "1"));
						qtreg = parseFloat(ConverteDec(document.form.aux_qtavareg[indice].value, "1"));
						qtins = parseFloat(ConverteDec(document.form.aux_qtavains[indice].value, "1"));
						//qtnre = parseFloat(ConverteDec(document.form.aux_qtavanre[indice].value, "1"));

                        if (document.form.aux_tprelgru[indice].value  == 'COOPERADO'){
                            qtres = qtres_ass;
                        }else if (document.form.aux_tprelgru[indice].value == 'COOPERATIVA') {
                            qtres = qtres_coop;
                        }else if (document.form.aux_tprelgru[indice].value == 'FORNECEDOR') {
                            qtres = qtres_forn;
                        }
                        
                        document.form.aux_qtavares[indice].value = qtres;
						document.form.aux_peavaoti[indice].value = parseInt(qtoti / qtres * 100);
						document.form.aux_peavabom[indice].value = parseInt(qtbom / qtres * 100);
						document.form.aux_peavareg[indice].value = parseInt(qtreg / qtres * 100);
						document.form.aux_peavains[indice].value = parseInt(qtins / qtres * 100);
                           
						qtnre = qtres - (qtoti + qtbom + qtreg + qtins);

						document.form.aux_qtavanre[indice].value = qtnre;
						document.form.aux_peavanre[indice].value = parseInt(qtnre / qtres * 100);
				 }else{
						qtoti = parseFloat(ConverteDec(document.form.aux_qtavaoti.value, "1"));
						qtbom = parseFloat(ConverteDec(document.form.aux_qtavabom.value, "1"));
						qtreg = parseFloat(ConverteDec(document.form.aux_qtavareg.value, "1"));
						qtins = parseFloat(ConverteDec(document.form.aux_qtavains.value, "1"));
						//qtnre = parseFloat(ConverteDec(document.form.aux_qtavanre[indice].value, "1"));
                        
                        if (document.form.aux_tprelgru.value == 'COOPERADO'){
                            qtres = qtres_ass;
                        }else if (document.form.aux_tprelgru.value == 'COOPERATIVA') {
                            qtres = qtres_coop;
                        }else if (document.form.aux_tprelgru.value == 'FORNECEDOR') {
                            qtres = qtres_forn;
                        }    
                        document.form.aux_qtavares.value = qtres;
						document.form.aux_peavaoti.value = parseInt(qtoti / qtres * 100);
						document.form.aux_peavabom.value = parseInt(qtbom / qtres * 100);
						document.form.aux_peavareg.value = parseInt(qtreg / qtres * 100);
						document.form.aux_peavains.value = parseInt(qtins / qtres * 100);
                        
						qtnre = qtres - (qtoti + qtbom + qtreg + qtins);

						document.form.aux_qtavanre.value = qtnre;
						document.form.aux_peavanre.value = parseInt(qtnre / qtres * 100);

				 }
			}

			function CalculaTodos(){
				if (document.all.tbalternativa.rows.length == 0){ 
					 return false;
                }
				if (document.form.aux_cditeava.length > 1){
					for (i = 0; i < document.form.aux_cditeava.length; i++){
							 CalculaLinha(i);
				    }
				}else{
				    CalculaLinha('0');
				}
			}

			//formataçao dos campos
			function formatCurrency(num){
				 
				 num = num.toString().replace(/\$|\,/g,'');
				 if(isNaN(num))
						num = "0";
				 sign = (num == (num = Math.abs(num)));
				 num = Math.floor(num*100+0.50000000001);
				 cents = num%100;
				 num = Math.floor(num/100).toString();
				 if(cents<10)
						cents = "0" + cents;
				 for (var i = 0; i < Math.floor((num.length-(1+i))/3); i++)
						num = num.substring(0,num.length-(4*i+3))+'.'+
				 num.substring(num.length-(4*i+3));
				 return (((sign)?'':'-') + num + ',' + cents);
			}

			// Converte um valor com decimal separado por "," para separado por "."
			function ConverteDec(str, tipo){
				 if(tipo == "1"){
						str = str.replace(".","");
						str = str.replace(",",".");
						return str;
				 }else{
						str = str.replace(",","");
						str = str.replace(".",",");
						return str;
				 }
			}

			function altera_simbolo(str){
				//while(str.match("'") == "'"){
				  //str = str.replace("'","L");
        //}
				return str;
			}
      
      // Reabrir avaliações
      function ReabrirAvaliacao() {
        if (!confirm('Confirma Abertura da Avaliação para ajuste?')){
            return false;
		}  
        document.form.aux_cddopcao.value = 'rea'; 
		document.form.submit();
      }       
      
      // Encerrar avaliações
      function EncerrarAvaliacao() {
        if (!confirm('Confirma Encerramento da Avaliação?')){
            return false;
		} 
        
        if (document.form.dsdemail_fornec.value == ""){
            if (!confirm('Fornecedor deste evento não possue nenhum contato para envio das informações da avaliação. Deseja encerrar sem enviar as informações?')){
                return false;
            }         
        }
        
        document.form.aux_cddopcao.value = 'enc'; 
		document.form.submit();
      }  
      
      // Desabilitar campos para nao permitir ediçao
      function Desabilitar () {
        $('#btSalvar').prop("disabled",true).addClass("botaoDesativado").attr("onClick","return false;");
        $('#btAdicionar').prop("disabled",true).attr("onClick","return false;");
      
        $('.Campo','#CamposQtavares').desabilitaCampo();
        $('.Campo','#divAlternativa').desabilitaCampo();
        $('.Campo','#divDescritiva').desabilitaCampo();
        $('.TextoFormulario','#divDescritiva').prop('disabled',true);
        $('.Campo','#divSugestao').desabilitaCampo();       
      
        $('.BotaoExcluir').prop("disabled",true).attr("onClick","return false;");
        $('.BotaoExcluir').css("cursor","default");
        $('.BotaoExcluir').css("filter","progid:DXImageTransform.Microsoft.Alpha(opacity=20)");
        
      }
      
      // Enviar email da avaliação para o facilitador
      function EmailAvaliacao(){      
        var Params = "";
        
        Params = 'nmdatela=wpgd0029&tldatela=Avaliação' +           '&idcokses=' + document.form.aux_idcokses.value + 
                 '&idevento=' + document.form.aux_idevento.value  + '&cdcooper=' + document.form.aux_cdcopope.value + 
                 '&cdcoptel=' + document.form.aux_cdcooper.value  +
                 '&cdagenci=' + document.form.aux_cdagenci.value  + '&dtanoage=' + document.form.aux_dtanoage.value +
                 '&nrseqeve=' + document.form.aux_nrseqeve.value  + '&cdevento=' + document.form.aux_cdevento.value + 
                 '&dsdemail=' + document.form.dsdemail_fornec.value + '&cdoperad=' + document.form.aux_cdoperad.value  ;
        
        VarURL = document.form.aux_dsurlphp.value + '/telas/wpgd0029/envia_email_avaliacao.php?' + Params;
        window.open(VarURL,'','toolbar=no,location=no,diretories=no,status=no,menubar=no,scrollbars=yes,resizable=yes,width=450,height=250,TOP=300,LEFT=300');           
        
      }
      
      function LimparCampos(){}
      
			mostraDiv(document.form.pagina.value);

			MostraPACs();
			PosicionaPAC();
			MostraEventos();      
			PosicionaEventos();
			MostraAva();      
		</script>
	</body>