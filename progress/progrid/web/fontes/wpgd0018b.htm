<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta name="wsoptions" content="no-output">
<title>Eventos (wpgd0018b)</title>
<link href="/cecred/estilos/progrid.css" rel="stylesheet" type="text/css">
</head>
<body>
<script language="JavaScript">
NomeDoProgramaPrincipal  = '/wpgd0018b.w';
</script>
<form action="#." method="POST" name="form">
  <input type="hidden" name="aux_cddopcao" VALUE="">
  <input type="hidden" name="aux_lspermis" VALUE="">
  <input type="hidden" name="aux_nrdrowid" VALUE="">
  <input type="hidden" name="aux_dsretorn" VALUE="">
  <input type="hidden" name="aux_stdopcao" VALUE="">
  <input type="hidden" name="aux_dsendurl" VALUE="">
  <input type="hidden" name="aux_idevento" VALUE="">
  <input type="hidden" name="aux_cdcooper" VALUE="">
  <input type="hidden" name="dtanoage"     VALUE="">
  <input type="hidden" name="aux_dtanoage" value="">
  <input type="hidden" name="aux_cdevento" VALUE="">
  <input type="hidden" name="aux_vlrselec" value="">
  <input type="hidden" name="aux_vlrselec_termo" value="">    
  <input type="hidden" name="aux_flgselec" value="">
  <input type="hidden" name="aux_lscpfcgc" value="">
  <input type="hidden" name="aux_lspropos" value="">
  <input type="hidden" name="aux_nmpagina" value="">
  <input type="hidden" name="aux_flgtermo" value="">
  <input type="hidden" name="aux_qtmaxtur" value="">
  <table class="dataTable" width="100%" border="0" cellspacing="0" cellpadding="0">
  <tr>
    <td align="left" valign="bottom">
      <table align="left" border="0" cellpadding="0" cellspacing="0" background="/cecred/images/geral/guia_fundo.gif">
            <tr>
                  <td>
                    <table id="AbaCustos" align="left" border="0" cellpadding="0" cellspacing="0" onclick="mostraDiv('DivCustos');" style="cursor:hand;">
                          <tr>            
                            <td width="4" height="21" background="/cecred/images/menu/mnu_sle.gif"></td>
                <td align="center" nowrap width="150" class="txtTituloVis" background="/cecred/images/menu/mnu_slc.gif">Adicionar Custos </td>
                            <td width="4" height="21" background="/cecred/images/menu/mnu_sld.gif"></td>
                          <tr>
                        </table>
                  </td>
                  <td width="4" bgcolor="#dfe0d6"></td>
                  <td bgcolor="#dfe0d6">
                    <table id="AbaTermo" align="left" border="0" cellpadding="0" cellspacing="0" onclick="mostraDiv('DivTermo');" style="cursor:hand;">
                          <tr>            
                            <td width="4" height="21" background="/cecred/images/menu/mnu_nle.gif"></td>
                <td align="center" nowrap width="150" class="txtTituloHid" background="/cecred/images/menu/mnu_nlc.gif">Termos de Compromisso</td>
                            <td width="4" height="21" background="/cecred/images/menu/mnu_nld.gif"></td>
                          <tr>
                        </table>
                  </td>                  
        </tr>
      </table>
    </td>
  </tr>
  <tr>
    <td width="200" height="2" align="left" background="/cecred/images/menu/mnu_slc.gif"></td>
 </tr>                
  <tr>
    <td valign="top" bgcolor="#FFFFFF">
      <table width="100%" border="0" align="center" cellpadding="0" cellspacing="0" class="dataTable">
        <tr>
          <td width="47" align="right" class="NomeCampo"><div align="right">Evento:</div></td>
          <td width="240"><input name="nmevento" type="text" class="Campo" size="40" readonly></td>
          <td width="217"><input name="nmrescop" type="text" class="Campo" size="5" readonly></td>
        </tr>
      </table>
          
          <div id="DivCustos">
      <table class="dataTable" width="100%" height="100%"  border="0" cellpadding="0" cellspacing="0">
        <tr>
          <td height="15" align="right">
            <!-- Interrupção do modelo geral, início dos dados específicos da tela -->
            <table border="0" width="100%" class="dataTable" align="center">
              <tr>
                <td>
                  <table width="100%"  border="0" cellpadding="0" cellspacing="0" class="dataTable">
                      <tr>
                                    <td width="2" background="/cecred/images/menu/fnd_title.jpg">&nbsp;</td>
                        <td width="65" height="25" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos" id="tbevento_col1">PA</td>
                        <td width="2" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                        <td width="90" height="25" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos" id="tbevento_col2">Fornecedor</td>
                        <td width="2" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" id="some" width="2" height="15"></td>
                        <td width="80" height="25" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos" id="tbevento_col3">Proposta</td>
                        <td width="2" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" id="some" width="2" height="15"></td>
                        <td width="60" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos" id="tbevento_col4" title="Honor&aacute;rios">Honor&aacute;rios</td>
                        <td width="2" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" id="some" width="2" height="15"></td>
                        <td width="40" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos" id="tbevento_col5" title="Local">Local</td>
                        <td width="2" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                        <td width="60" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos" id="tbevento_col6" title="Alimenta&ccedil;&atilde;o">Alimenta&ccedil;&atilde;o</td>
                        <td width="2" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                        <td width="50" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos" id="tbevento_col7" title="Materiais">Materiais</td>
                        <td width="2" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                        <td width="55" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos" id="tbevento_col8" title="Transporte">Transporte</td>
                        <td width="2" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                        <td width="40" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos" id="tbevento_col8" title="Brindes">Brindes</td>
                        <td width="2" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                        <td width="60" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos" id="tbevento_col10" title="Divulga&ccedil;&atilde;o">Divulga&ccedil;&atilde;o</td>
                        <td width="2" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                        <td width="40" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos" id="tbevento_col11" title="Outros">Outros</td>
                        <td width="2" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                        <td width="50" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos" id="tbevento_col12" title="Total">Total</td>
                        <td width="2" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                        <td width="2" id="tbevento_col13" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos" >&nbsp;</td>
                        <td width="2" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                        <td width="40" id="tbevento_col14" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos" >Visto</td>
                      </tr>
                    </table>
                </td>
              </tr>
                          <tr>
                <td>
                  <div style="overflow: auto; height:'300';">
                    <table width="100%"  border="0" cellpadding="0" cellspacing="0" class="dataTable" id="tbevento">
                      <!-- INCLUI DADOS -->
                    </table>
                </div>
                                </td>
              </tr>
            </table>
          </td>
        </tr>  
      </table>
      <table width="200" align="center">
        <tr>
          <th scope="col"><img style="cursor:hand" src="/cecred/images/botoes/btn_salvar.gif"  onClick="Salvar()"></th>
        </tr>
      </table>
          </div>

          <div id="DivTermo">
      <table class="dataTable" width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
        <tr>
          <td height="15" align="right">
            <!-- Interrupção do modelo geral, início dos dados específicos da tela -->
            <table border="0" width="100%" class="dataTable" align="center">
              <tr>
                <td>
                  <table width="100%"  border="0" cellpadding="0" cellspacing="0" class="dataTable">
                      <tr>
                                            <td width="1%" background="/cecred/images/menu/fnd_title.jpg">&nbsp;</td>
                        <td width="54%" height="25" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos" id="tbtermo_col1">PA</td>
                        <td width="1%" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                        <td width="10%" height="25" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos" id="tbtermo_col2" title="Valor total de rateio do evento">Valor do Rateio</td>
                        <td width="1%" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" id="some" width="2" height="15"></td>
                        <td width="9%" height="25" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos" id="tbtermo_col3" title="Percentual a ser rateado entre os participantes">% do Rateio</td>
                        <td width="1%" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" id="some" width="2" height="15"></td>
                        <td width="9%" height="25" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos" id="tbtermo_col4" title="Número máximo de participantes por turma">Participantes</td>                                                
                        <td width="1%" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" id="some" width="2" height="15"></td>
                        <td width="13%" height="25" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos" id="tbtermo_col5" title="Valor a ser pago por cada participante">Valor a Pagar</td>                                                
                      </tr>
                    </table>
                </td>
              </tr>
                          <tr>
                <td>
                  <div style="overflow: auto; height:'285';">
                    <table width="100%"  border="0" cellpadding="0" cellspacing="0" class="dataTable" id="tbtermo">
                      <!-- INCLUI DADOS -->
                    </table>
                  </div>
                                </td>
              </tr>
            </table>
          </td>
        </tr>  
      </table>
      <table width="200" height="41" align="center">
        <tr valign="bottom">
          <th scope="col"><img style="cursor:hand" src="/cecred/images/botoes/btn_salvar.gif"  onClick="Salvar_Termo()"></th>
        </tr>
      </table>
          </div>          
    </td>
  </tr>
</table>
</form>
</body>
</html>
<SCRIPT LANGUAGE="JAVASCRIPT">
   NomeDoProgramaPrincipal  = '/wpgd0018b.w';
   NomeDoProgramaDeListagem = '/wpgd0018bs.w';
   NomeDoProgramaDeAjuda    = '/wpgd0018baj.w';
   NomeDoProgramaDeZoom     = '/zoom/zoei01.w';
   
   NomeDoProgramaPrincipal = document.form.aux_dsendurl.value + NomeDoProgramaPrincipal;
   document.form.action = NomeDoProgramaPrincipal;

function RetornoDoZoom(campo,valor,valor2,valor3)
{  
     
}
function Habilita()
{
  
}
function HabilitaSalvar()
{
  
}
function ValidaDados(form)
{
  var msg="";
  
  if(document.form.aux_cdagenci.length > 1)
   {
      for(i=0;i< document.form.aux_cdagenci.length ; i++)
      {
         msg = msg + VE("de",form.aux_vlhonora[i],"Custo de Honorários","sim","0","99999");
         msg = msg + VE("de",form.aux_vlrlocal[i],"Custo de Locais","sim","0","99999");
         msg = msg + VE("de",form.aux_vlalimen[i],"Custo de Alimentação","sim","0","99999");
         msg = msg + VE("de",form.aux_vlmateri[i],"Custo de Materiais","sim","0","99999");
         msg = msg + VE("de",form.aux_vltransp[i],"Custo de Transporte","sim","0","99999");
         msg = msg + VE("de",form.aux_vlbrinde[i],"Custo de Brindes","sim","0","99999");
         msg = msg + VE("de",form.aux_vldivulg[i],"Custo de Divulgação","sim","0","99999");
         msg = msg + VE("de",form.aux_vloutros[i],"Custo de Outros","sim","0","99999");
         
      }

    }
    else
    {
       msg = msg + VE("de",form.aux_vlhonora,"Custo de Honorários","sim","0","99999");
       msg = msg + VE("de",form.aux_vlrlocal,"Custo de Locais","sim","0","99999");
       msg = msg + VE("de",form.aux_vlalimen,"Custo de Alimentação","sim","0","99999");
       msg = msg + VE("de",form.aux_vlmateri,"Custo de Materiais","sim","0","99999");
       msg = msg + VE("de",form.aux_vltransp,"Custo de Transporte","sim","0","99999");
       msg = msg + VE("de",form.aux_vlbrinde,"Custo de Brindes","sim","0","99999");
       msg = msg + VE("de",form.aux_vldivulg,"Custo de Divulgação","sim","0","99999");
       msg = msg + VE("de",form.aux_vloutros,"Custo de Outros","sim","0","99999");
    }
         

    if (msg == "")
       return true;
    else
    {
       alert(msg);
       return false;
    }
}

function LimparCampos()
{
}

function ExaminaCampo(Campo)
{

}
 
function CarregaPrincipal()
{  
}    

function Incluir()
{
   var vaux = document.form.aux_lspermis.value; 
   if (vaux.substring(0,1) == 'I') 
       { 
          if (document.form.aux_stdopcao.value == 'i') 
                { 
                   alert('Você já esta no modo de inclusão'); 
                   return false
                } 
             else 
                { 
                   document.form.aux_cddopcao.value ='in'; 
                   document.form.aux_stdopcao.value ='i';
                   LimparCampos(); 
                   return true
                } 
       } 
    else 
       { 
          alert('Desculpe, mas você não tem permissão para executar esta função.'); 
          return false
       }
}

function Salvar()
{
   //ZeraModoExclusao();
   document.form.aux_stdopcao.value = 'al';
   var vaux = document.form.aux_lspermis.value; 
   if ((vaux.substring(1,2) == 'A') || (document.form.aux_stdopcao.value == 'i')) { 
        if ( document.form.aux_cddopcao.value!='sa')  {
           if (ValidaDados(document.forms[0])) {
               Habilita(); 
               HabilitaSalvar(); 
               ArmazenaValores();
               document.form.aux_cddopcao.value='sa'; 
               status = 'Salvando. Por favor, aguarde ...'; 
               document.form.submit(); 
               return true;
               
            } 
            else { 
              return false;
            }  
        } 
   }
   else { 
         alert('Desculpe, mas você não tem permissão para executar esta função.'); 
         return false;
   }
}

// Testa se o fornecedor existe ou não afim de mostrar mensagem apropriada
function testaFornecedor(linha)

   {
      if (document.form.aux_idevento.value=="1") 
         {
            if (mevento[linha].nrcpfcgc==0 && document.form.aux_flgfecha[linha].checked)
               alert('Fornecedor não selecionado.\nO custo será assumido como visto, mas, os eventos sem fornecedores não poderão ser confirmados para formarem a agenda');
         }
   } // testaFornecedor(linha)

// Função que preenche a tabela de eventos, por PA
function mostraEventos(){

  var row; var cell;
  var aux_vlrdifere;
  var cor='#F7F7F7';
  
  // limpa a tabela de Eventos, menos a 1ª linha - linha do cabecalho
  for (var i=document.all.tbevento.rows.length; i>1; i--)
      document.all.tbevento.deleteRow(i-1);
          
  for(i=0;i<mevento.length;i++)      // insere linhas na tabela de eventos
  {
      
      aux_vlrdifere = '0';
      
      row=tbevento.insertRow();  
      row.id=mevento[i].cdagenci;
      if (cor == '#FFFFFF')
         cor = '#F7F7F7';
      else
         cor = '#FFFFFF';
      
      row.bgColor = cor;
      
      /*ATENÇÃO:
      
      Foi feita a separação de 'in' e 'put' na palavra input porque o progress estava
      mapeando incorretamente estes campos no AppBuilder
      */
          
          cell=row.insertCell();   // Separador
      cell.className = 'txtNormal';
      cell.width= 2;
      cell.height = 26;
      cell.align = 'left';
      cell.innerText='';
      
      // PA
      cell=row.insertCell();         
      cell.className = 'txtNormal';
      cell.width = document.all.tbevento_col1.width;
      cell.height = 20;
      cell.align = 'left';
      cell.title = mevento[i].nmresage;
      linky='<in' + 'put type="hidden" name="aux_cdagenci" value="' + mevento[i].cdagenci + '">' + mevento[i].nmresage.substring(0,10);
      cell.innerHTML=linky;

      cell=row.insertCell();   // Separador
      cell.className = 'txtNormal';
      cell.width= 2;
      cell.height = 26;
      cell.align = 'left';
      cell.innerText='';

      // Fornecedor
      cell=row.insertCell();         
      cell.className = 'txtNormal';
      cell.width = document.all.tbevento_col2.width;
      cell.height = 20;
      cell.align = 'left';
      if (document.form.aux_idevento.value == '2') 
         cell.id = 'some';
      else
         cell.id=mevento[i].cdagenci;

      linky="";
      if (document.form.aux_idevento.value=="1") 
         {
            cell.title = 'Clique para selecionar Fornecedor e Proposta';
            cell.style.cursor = 'hand';
            cell.onclick = Fornecedor;
            linky='<a href="#.">';
            if (mevento[i].nmfornec == "")
                   linky = linky + "Selecione";
               else
                   linky = linky + mevento[i].nmfornec;
            linky = linky + '</a>';
         }
      linky = linky + '<in' + 'put type="hidden" name="aux_nrcpfcgc" size="15" class="Campo" value="' + mevento[i].nrcpfcgc + '">' +
                      '<in' + 'put type="hidden" name="aux_nrpropos" size="15" class="Campo" value="' + mevento[i].nrpropos + '">';

      cell.innerHTML=linky;

      cell=row.insertCell();   // Separador
      cell.className = 'txtNormal';
      cell.width= 2;
      cell.height = 26;
      cell.align = 'left';
      cell.id = 'some';
      cell.innerText='';

      // Proposta
      cell=row.insertCell();         
      cell.className = 'txtNormal';
      cell.width = document.all.tbevento_col3.width;
      cell.height = 20;
      cell.align = 'left';
      cell.id = 'some';
      cell.title = mevento[i].nrpropos;
      linky=mevento[i].nrpropos;
      cell.innerHTML=linky;

      cell=row.insertCell();   // Separador
      cell.className = 'txtNormal';
      cell.width= 2;
      cell.height = 26;
      cell.id = 'some';
      cell.align = 'left';
      cell.innerText='';
      
      // 1 - Honorários
      cell=row.insertCell();         
      cell.className = 'txtNormal';
      cell.width = 2;
      cell.height = 20;
      cell.align = 'right';
      cell.style.textAlign='right';
      if (document.form.aux_idevento.value == '2') 
         cell.id = 'some';
      else
         cell.id='1';
      linky='<in' + 'put type="text" name="aux_vlhonora" size="4" class="Campo" onChange="Calcula(' + i + ')" style="text-align:right;" value="' + mevento[i].vlhonora + '">';
      cell.innerHTML=linky; 
      // se o valor for diferente do valor-base, troca a cor
      if((i != 0)&&(document.form.aux_vlhonora[i].value != document.form.aux_vlhonora[0].value))
         aux_vlrdifere = '1';

      cell=row.insertCell();   // Separador
      cell.className = 'txtNormal';
      cell.width= 2;
      cell.height = 26;
      cell.id = 'some';
      cell.align = 'left';
      cell.innerText='';

      // 2 - Local
      cell=row.insertCell();         
      cell.className = 'txtNormal';
      cell.width = 2;
      cell.height = 20;
      cell.align = 'right';
      cell.style.textAlign='right';
      cell.id='2';
      linky='<in' + 'put ' +  'type="text" name="aux_vlrlocal" size="4" class="Campo" onChange="Calcula(' + i + ')" style="text-align:right;" value="' + mevento[i].vlrlocal + '">';
      cell.innerHTML=linky;
      // se o valor for diferente do valor-base, troca a cor
      if((i != 0)&&(document.form.aux_vlrlocal[i].value != document.form.aux_vlrlocal[0].value))
         aux_vlrdifere = '1';

      cell=row.insertCell();   // Separador
      cell.className = 'txtNormal';
      cell.width= 2;
      cell.height = 26;
      cell.align = 'left';
      cell.innerText='';
      
      // 3 - Alimentação
      cell=row.insertCell();         
      cell.className = 'txtNormal';
      cell.width = 2;
      cell.height = 20;
      cell.align = 'right';
      cell.style.textAlign='right';
      cell.id='3';
      linky='<in' + 'put ' + 'type="text" name="aux_vlalimen" size="4" class="Campo" onChange="Calcula(' + i + ')" style="text-align:right;" value="' + mevento[i].vlalimen + '">';
      cell.innerHTML=linky;
      // se o valor for diferente do valor-base, troca a cor
      if((i != 0)&&(document.form.aux_vlalimen[i].value != document.form.aux_vlalimen[0].value))
         aux_vlrdifere = '1';

      cell=row.insertCell();   // Separador
      cell.className = 'txtNormal';
      cell.width= 2;
      cell.height = 26;
      cell.align = 'left';
      cell.innerText='';
      
      // 4 - Material
      cell=row.insertCell();         
      cell.className = 'txtNormal';
      cell.width = 2;
      cell.height = 20;
      cell.align = 'right';
      cell.style.textAlign='right';
      cell.id='4';
      linky='<in' + 'put type="text" name="aux_vlmateri" size="4" class="Campo" onChange="Calcula(' + i + ')" style="text-align:right;" value="' + mevento[i].vlmateri + '">';
      cell.innerHTML=linky; 
      // se o valor for diferente do valor-base, troca a cor
      if((i != 0)&&(document.form.aux_vlmateri[i].value != document.form.aux_vlmateri[0].value))
         aux_vlrdifere = '1';

      cell=row.insertCell();   // Separador
      cell.className = 'txtNormal';
      cell.width= 2;
      cell.height = 26;
      cell.align = 'left';
      cell.innerText='';
      
      // 5 - Transportes
      cell=row.insertCell();         
      cell.className = 'txtNormal';
      cell.width = 2;
      cell.height = 20;
      cell.align = 'right';
      cell.style.textAlign='right';
      cell.id='5';
      linky='<in' + 'put type="text" name="aux_vltransp" size="4" class="Campo" onChange="Calcula(' + i + ')" style="text-align:right;" value="' + mevento[i].vltransp + '">';
      cell.innerHTML=linky; 
      // se o valor for diferente do valor-base, troca a cor
      if((i != 0)&&(document.form.aux_vltransp[i].value != document.form.aux_vltransp[0].value))
         aux_vlrdifere = '1';

      cell=row.insertCell();   // Separador
      cell.className = 'txtNormal';
      cell.width= 2;
      cell.height = 26;
      cell.align = 'left';
      cell.innerText='';
      
      // 6 - Brindes
      cell=row.insertCell();         
      cell.className = 'txtNormal';
      cell.width = 2;
      cell.height = 20;
      cell.align = 'right';
      cell.style.textAlign='right';
      cell.id='6';
      linky='<in' + 'put type="text" name="aux_vlbrinde" size="4" class="Campo" onChange="Calcula(' + i + ')" style="text-align:right;" value="' + mevento[i].vlbrinde + '">';
      cell.innerHTML=linky;
      // se o valor for diferente do valor-base, troca a cor
      if((i != 0)&&(document.form.aux_vlbrinde[i].value != document.form.aux_vlbrinde[0].value))
         aux_vlrdifere = '1';

      cell=row.insertCell();   // Separador
      cell.className = 'txtNormal';
      cell.width= 2;
      cell.height = 26;
      cell.align = 'left';
      cell.innerText='';
      
      // 7 - Divulgação
      cell=row.insertCell();         
      cell.className = 'txtNormal';
      cell.width = 2;
      cell.height = 20;
      cell.align = 'right';
      cell.style.textAlign='right';
      cell.id='7';
      linky='<in' + 'put type="text" name="aux_vldivulg" size="4" class="Campo" onChange="Calcula(' + i + ')" style="text-align:right;" value="' + mevento[i].vldivulg + '">';
      cell.innerHTML=linky;
      // se o valor for diferente do valor-base, troca a cor
      if((i != 0)&&(document.form.aux_vldivulg[i].value != document.form.aux_vldivulg[0].value))
         aux_vlrdifere = '1';

      cell=row.insertCell();   // Separador
      cell.className = 'txtNormal';
      cell.width= 2;
      cell.height = 26;
      cell.align = 'left';
      cell.innerText='';
      
      // 8 - Outros
      cell=row.insertCell();         
      cell.className = 'txtNormal';
      cell.width = 2;
      cell.height = 20;
      cell.align = 'right';
      cell.style.textAlign='right';
      cell.id='8';
      linky='<in' + 'put type="text" name="aux_vloutros" size="4" class="Campo" onChange="Calcula(' + i + ')" style="text-align:right;" value="' + mevento[i].vloutros + '">';
      cell.innerHTML=linky; 
      // se o valor for diferente do valor-base, troca a cor
      if((i != 0)&&(document.form.aux_vloutros[i].value != document.form.aux_vloutros[0].value))
         aux_vlrdifere = '1';

      cell=row.insertCell();   // Separador
      cell.className = 'txtNormal';
      cell.width= 2;
      cell.height = 26;
      cell.align = 'left';
      cell.innerText='';

      // Total
      cell=row.insertCell();         
      cell.className = 'txtNormal';
      cell.width = 2;
      cell.height = 20;
      cell.align = 'right';
      cell.style.textAlign='right';
      linky='<in' + 'put type="text" name="aux_vlrtotal" size="5" class="Campo" style="text-align:right;" value="' + mevento[i].vlrtotal + '" disabled>';
      cell.innerHTML=linky; 
      // se o valor for diferente do valor-base, troca a cor
      if((i != 0)&&(document.form.aux_vlrtotal[i].value != document.form.aux_vlrtotal[0].value))
         aux_vlrdifere = '1';

      cell=row.insertCell();   // Separador
      cell.className = 'txtNormal';
      cell.width= 2;
      cell.height = 26;
      cell.align = 'left';
      cell.innerText='';

       
      // Botão de propagação dos valores para os PAs
      if(row.id==0)
      {
         cell=row.insertCell();   
         cell.className = 'txtNormal';
         cell.align = 'left';
         cell.width = 2;
         cell.height = 20;         
         linky='<a href="#." onClick=Propaga(); class="linkGuia"><img src="/cecred/images/icones/financeiro.gif" border="0" title="Propagar valores para os PAs"></a>';
         cell.innerHTML=linky; 
      } // if(row.id==0)
      // Flag que indica se o PA vai receber os valores de propagação ou não
      else 
      {
         cell=row.insertCell();   
         cell.className = 'txtNormal';
         cell.align = 'left';
         cell.width = 2;
         cell.height = 20; 
         cell.title='Selecione para que esta linha receba a propagação de valores';
         linky='<in' + 'put type="checkbox" name="aux_flpropag" checked>';
         cell.innerHTML=linky; 
      }

      cell=row.insertCell();   // Separador
      cell.className = 'txtNormal';
      cell.width= 2;
      cell.height = 26;
      cell.align = 'left';
      cell.innerText='';

      // Fecha
      if(row.id==0)
      {
         cell=row.insertCell();         
         cell.className = 'txtNormal';
         cell.width = 2;
         cell.height = 20;
         cell.align = 'center';
         linky='<in' + 'put type="checkbox" name="aux_flgfecha" ' + mevento[i].envfecha + ' class="Campo" ' + mevento[i].flgfecha + ' style="visibility:hidden">';
         cell.innerHTML=linky;
      }
      else
      {   
         cell=row.insertCell();         
         cell.className = 'txtNormal';
         cell.width = 2;
         cell.height = 20;
         cell.align = 'center';
         if(mevento[i].envfecha != '')
            cell.title = 'A agenda já foi enviada ao PA.';
         linky='<in' + 'put type="checkbox" name="aux_flgfecha" ' + mevento[i].envfecha + ' class="Campo" ' + mevento[i].flgfecha + ' onClick="testaFornecedor(' + i + ')">';
         cell.innerHTML=linky;
      }
      
      // A primeira linha é a base de custo, deve ter um destaque
      if(row.id==0)
         row.bgColor='#CCCC66';
     /* else
         // se foi verificado algum valor diferente entre a linha atual e a linha de valor-base, muda a cor
         if(aux_vlrdifere == '1')
            row.bgColor='red';*/

  } // for(i=0;i<mevento.length;i++)
  
  //completa a tabela, caso necessário
  //PreencheBrancos(tbevento, 0, (7 - mevento.length), 9);

}

// função que preenche tabelas com linhas em branco
function PreencheBrancos(tabela,limpa,numlinhas,numcolunas)
{

   if (limpa == 1) {
      for (var i=tabela.rows.length; i>1; i--)
         tabela.deleteRow(i-1); 
   }

   for(i=0;i<numlinhas;i++){
      row=tabela.insertRow();
      for(j=0;j<numcolunas;j++)
      {
         cell=row.insertCell();
         cell.height = 20;
         cell.width = 20;
      }
   }
}

function Recarrega()
{
   document.form.submit();
}

function CarregaPrincipal()
{
}

// Para os campos com a flag marcada, copiará o valor que estiver na primeira linha
function Propaga()
{
  var row; var cell;

  var checado = "";

  // Para todas as linhas de PA
  for(i=1;i<mevento.length;i++)      
  {
     // Se tem mais de um PA
     if(document.form.aux_flpropag.length > 1)
     {
        // Se o campo de checkbox estiver marcado
        if(document.form.aux_flpropag[i-1].checked)
        {
           if(document.form.aux_flgfecha[0].checked) checado = "checked"; else checado = "";
           // Substitui os valores antigos pelos valores que estão na primeira linha
           document.all.tbevento.rows[i].cells[3].innerHTML= document.all.tbevento.rows[0].cells[3].innerHTML; //'<in' + 'put type="text" name="aux_nrcpfcgc" size="15" class="Campo"                           value="' + document.form.aux_nrcpfcgc[0].value + '">';
           document.all.tbevento.rows[i].cells[5].innerHTML= document.all.tbevento.rows[0].cells[5].innerHTML; //'<in' + 'put type="text" name="aux_nrpropos" size="15" class="Campo"                           value="' + document.form.aux_nrpropos[0].value + '">';
           document.all.tbevento.rows[i].cells[7].innerHTML='<in' + 'put type="text" name="aux_vlhonora" size="4" class="Campo" style="text-align:right;" value="' + document.form.aux_vlhonora[0].value + '">';
           document.all.tbevento.rows[i].cells[9].innerHTML='<in' + 'put type="text" name="aux_vlrlocal" size="4" class="Campo" style="text-align:right;" value="' + document.form.aux_vlrlocal[0].value + '">';
           document.all.tbevento.rows[i].cells[11].innerHTML='<in' + 'put type="text" name="aux_vlalimen" size="4" class="Campo" style="text-align:right;" value="' + document.form.aux_vlalimen[0].value + '">';
           document.all.tbevento.rows[i].cells[13].innerHTML='<in' + 'put type="text" name="aux_vlmateri" size="4" class="Campo" style="text-align:right;" value="' + document.form.aux_vlmateri[0].value + '">';
           document.all.tbevento.rows[i].cells[15].innerHTML='<in' + 'put type="text" name="aux_vltransp" size="4" class="Campo" style="text-align:right;" value="' + document.form.aux_vltransp[0].value + '">';
           document.all.tbevento.rows[i].cells[17].innerHTML='<in' + 'put type="text" name="aux_vlbrinde" size="4" class="Campo" style="text-align:right;" value="' + document.form.aux_vlbrinde[0].value + '">';
           document.all.tbevento.rows[i].cells[19].innerHTML='<in' + 'put type="text" name="aux_vldivulg" size="4" class="Campo" style="text-align:right;" value="' + document.form.aux_vldivulg[0].value + '">';
           document.all.tbevento.rows[i].cells[21].innerHTML='<in' + 'put type="text" name="aux_vloutros" size="4" class="Campo" style="text-align:right;" value="' + document.form.aux_vloutros[0].value + '">';
           document.all.tbevento.rows[i].cells[23].innerHTML='<in' + 'put type="text" name="aux_vlrtotal" size="5" class="Campo" style="text-align:right;" value="' + document.form.aux_vlrtotal[0].value + '" disabled>';
           document.form.aux_nrcpfcgc[i].value = document.form.aux_nrcpfcgc[0].value;
           document.form.aux_nrpropos[i].value = document.form.aux_nrpropos[0].value;

           //document.all.tbevento.rows[i+1].cells[22].innerHTML='<in' + 'put type="checkbox" name="aux_flgfecha" size="4" class="Campo" style="text-align:right;" ' + checado + '>';
        }
     }
     // Se tem um PA apenas
     else
     {
        // Se o campo de checkbox estiver marcado
        if(document.form.aux_flpropag.checked)
        {
           if(document.form.aux_flgfecha[0].checked) checado = "checked"; else checado = "";
           document.all.tbevento.rows[i].cells[3].innerHTML= document.all.tbevento.rows[0].cells[3].innerHTML; //document.all.tbevento.rows[i+1].cells[2].innerHTML='<in' + 'put type="text" name="aux_nrcpfcgc" size="15" class="Campo"                           value="' + document.form.aux_nrcpfcgc[0].value + '">';
           document.all.tbevento.rows[i].cells[5].innerHTML= document.all.tbevento.rows[0].cells[5].innerHTML; //document.all.tbevento.rows[i+1].cells[2].innerHTML='<in' + 'put type="text" name="aux_nrpropos" size="15" class="Campo"                           value="' + document.form.aux_nrpropos[0].value + '">';
           document.all.tbevento.rows[i].cells[7].innerHTML='<in' + 'put type="text" name="aux_vlhonora" size="4" class="Campo" style="text-align:right;" value="' + document.form.aux_vlhonora[0].value + '">';
           document.all.tbevento.rows[i].cells[9].innerHTML='<in' + 'put type="text" name="aux_vlrlocal" size="4" class="Campo" style="text-align:right;" value="' + document.form.aux_vlrlocal[0].value + '">';
           document.all.tbevento.rows[i].cells[11].innerHTML='<in' + 'put type="text" name="aux_vlalimen" size="4" class="Campo" style="text-align:right;" value="' + document.form.aux_vlalimen[0].value + '">';
           document.all.tbevento.rows[i].cells[13].innerHTML='<in' + 'put type="text" name="aux_vlmateri" size="4" class="Campo" style="text-align:right;" value="' + document.form.aux_vlmateri[0].value + '">';
           document.all.tbevento.rows[i].cells[15].innerHTML='<in' + 'put type="text" name="aux_vltransp" size="4" class="Campo" style="text-align:right;" value="' + document.form.aux_vltransp[0].value + '">';
           document.all.tbevento.rows[i].cells[17].innerHTML='<in' + 'put type="text" name="aux_vlbrinde" size="4" class="Campo" style="text-align:right;" value="' + document.form.aux_vlbrinde[0].value + '">';
           document.all.tbevento.rows[i].cells[19].innerHTML='<in' + 'put type="text" name="aux_vldivulg" size="4" class="Campo" style="text-align:right;" value="' + document.form.aux_vldivulg[0].value + '">';
           document.all.tbevento.rows[i].cells[21].innerHTML='<in' + 'put type="text" name="aux_vloutros" size="4" class="Campo" style="text-align:right;" value="' + document.form.aux_vloutros[0].value + '">';
           document.all.tbevento.rows[i].cells[23].innerHTML='<in' + 'put type="text" name="aux_vlrtotal" size="5" class="Campo" style="text-align:right;" value="' + document.form.aux_vlrtotal[0].value + '" disabled>';
           document.form.aux_nrcpfcgc[i].value = document.form.aux_nrcpfcgc[0].value;
           document.form.aux_nrpropos[i].value = document.form.aux_nrpropos[0].value;
           //document.all.tbevento.rows[i+1].cells[22].innerHTML='<in' + 'put type="checkbox" name="aux_flgfecha" size="4" class="Campo" style="text-align:right;" ' + checado + '>';
        }

     }

    /* // Se algum dos valores desta linha não corresponde aos valores da linha de valor base, troca a cor.
     if((i != 0)&&
        ((document.form.aux_vlhonora[i].value != document.form.aux_vlhonora[0].value)||
         (document.form.aux_vlrlocal[i].value != document.form.aux_vlrlocal[0].value)||
         (document.form.aux_vlalimen[i].value != document.form.aux_vlalimen[0].value)||
         (document.form.aux_vlmateri[i].value != document.form.aux_vlmateri[0].value)||
         (document.form.aux_vltransp[i].value != document.form.aux_vltransp[0].value)||
         (document.form.aux_vlbrinde[i].value != document.form.aux_vlbrinde[0].value)||
         (document.form.aux_vldivulg[i].value != document.form.aux_vldivulg[0].value)||
         (document.form.aux_vloutros[i].value != document.form.aux_vloutros[0].value)
         ))
        document.all.tbevento.rows[i+1].bgColor='red';*/
     
  }

  //completa a tabela, caso necessário
  //PreencheBrancos(tbevento, 0, (7 - tbevento.rows.length), 9);

}

// Guardar os valores da tabela para que sejam salvos no banco de dados
function ArmazenaValores()
{
   document.form.aux_vlrselec.value = '';
   document.form.aux_flgselec.value = '';
   document.form.aux_lscpfcgc.value = '';
   document.form.aux_lspropos.value = '';
   // Se tem mais de um PA
   if(document.form.aux_cdagenci.length > 1)
   {
      for(i=0;i<document.form.aux_cdagenci.length;i++)
         // Grava os valores em forma de lista, separados por ";", para que seja lido pelo progress
         if (document.form.aux_vlrselec.value == '') 
         {
            document.form.aux_flgselec.value = document.form.aux_flgfecha[i].checked;
            document.form.aux_lscpfcgc.value = document.form.aux_nrcpfcgc[i].value;
            document.form.aux_lspropos.value = document.form.aux_nrpropos[i].value;
            document.form.aux_vlrselec.value = document.form.aux_cdagenci[i].value + ';'
                                             + document.form.aux_vlhonora[i].value + ';'
                                             + document.form.aux_vlrlocal[i].value + ';'
                                             + document.form.aux_vlalimen[i].value + ';'
                                             + document.form.aux_vlmateri[i].value + ';'
                                             + document.form.aux_vltransp[i].value + ';'
                                             + document.form.aux_vlbrinde[i].value + ';'
                                             + document.form.aux_vldivulg[i].value + ';'
                                             + document.form.aux_vloutros[i].value ;
         }
         else
         {
            document.form.aux_flgselec.value = document.form.aux_flgselec.value + ';' + 
                                               document.form.aux_flgfecha[i].checked;
            document.form.aux_lscpfcgc.value = document.form.aux_lscpfcgc.value + ';' + 
                                               document.form.aux_nrcpfcgc[i].value;
            document.form.aux_lspropos.value = document.form.aux_lspropos.value + ';' + 
                                               document.form.aux_nrpropos[i].value;
            document.form.aux_vlrselec.value = document.form.aux_vlrselec.value    + ';'
                                             + document.form.aux_cdagenci[i].value + ';'
                                             + document.form.aux_vlhonora[i].value + ';'
                                             + document.form.aux_vlrlocal[i].value + ';'
                                             + document.form.aux_vlalimen[i].value + ';'
                                             + document.form.aux_vlmateri[i].value + ';'
                                             + document.form.aux_vltransp[i].value + ';'
                                             + document.form.aux_vlbrinde[i].value + ';'
                                             + document.form.aux_vldivulg[i].value + ';'
                                             + document.form.aux_vloutros[i].value ;
         }
    }
    else
    {
       document.form.aux_flgselec.value = document.form.aux_flgfecha.checked;
       document.form.aux_lscpfcgc.value = document.form.aux_nrcpfcgc.value;
       document.form.aux_lspropos.value = document.form.aux_nrpropos.value;
       document.form.aux_vlrselec.value = document.form.aux_cdagenci.value + ';'
                                        + document.form.aux_vlhonora.value + ';'
                                        + document.form.aux_vlrlocal.value + ';'
                                        + document.form.aux_vlalimen.value + ';'
                                        + document.form.aux_vlmateri.value + ';'
                                        + document.form.aux_vltransp.value + ';'
                                        + document.form.aux_vlbrinde.value + ';'
                                        + document.form.aux_vldivulg.value + ';'
                                        + document.form.aux_vloutros.value ;
    }
}

// Funcao: VE(Valida Elemento)
// Objetivo: verificar se um elemento(componente) está no formato adequado (caracter, inteiro, data, decimal)
// Parametros de entrada:
//    tc = tipo do componente. "ca":caracter, "da":data, "de":decimal, "in":inteiro
//    nc = nome do componente.
//    lc = label do componente.
//    pn = componente pode ser nulo? "sim"/"nao"
//    mi = valor mínimo do componente
//    ma = valor máximo do componente
// Parametros de saída:
//    msg = Mensagem de Erro da validação
function VE(tc,nc,lc,pn,mi,ma)
{  
  var msg = "";
  var p = "xx";
  var z = 1;
  var x = 0; 
  var cv = 0;
  var dia = 0;
  var mes = 0;
  var ano = 0;
  var aux = "";
  var aux2 = nc.value;
  pn.toLowerCase();
  tc.toLowerCase();

  if (tc == "de") {
    for (var x = 0; x < aux2.length; x++) {
      if (aux2.substring(x,x+1) != " ")
        aux = aux + aux2.substring(x,x+1);
    } 
    nc.value = aux;
  }
  if (tc == "ca") {
    if (pn == "sim")
      {}
    else {
      if (nc.value == "")
        msg = lc + " não pode ser nulo.";
    }
    if (nc.value.substring(0,1) == " ")
      msg = msg + lc + " não pode começar com branco.";
  }
  else
  if (tc == "in") {
    p = "0123456789";
    if (pn == "sim") {  
      if (nc.value == "")
        nc.value = "0";
      else {
        for (var x = 0; x < nc.value.length; x++)  {
          if (p.indexOf(nc.value.substring(x,x+1)) == -1)
            z = 0;
        } 
        if (z == 0)
          msg = msg + lc + " possui caracteres que não são validos.";  
        if (msg == "") {
          if (nc.value < mi)
            msg = msg + lc + " deve ser maior que " + mi.toString() + ".";
          if (nc.value > ma)
            msg = msg + lc + " deve ser menor que " + ma.toString() + ".";
        }
      }
    }
    else {
      if (nc.value == "")
        msg = msg + lc + " não pode ser nulo.";
        for (var x = 0; x < nc.value.length; x++) {
        if (p.indexOf(nc.value.substring(x,x+1)) == -1)
                      z = 0;
               } 
               if (z == 0)
                  msg = msg + lc + " possui caracteres que não são validos.";  
               if (msg == "") {
                  if (nc.value < mi)
                     msg = msg + lc + " deve ser maior que " + mi.toString() + ".";
                  if (nc.value > ma)
                     msg = msg + lc + " deve ser menor que " + ma.toString() + ".";
               }
         }
      }
      else
      if (tc == "de") {
         p = ",0123456789";
         if (pn == "sim") {  
            if (nc.value == "")
               nc.value = "0";
            else {
                 for (var x = 0; x < nc.value.length; x++) {
                     if (p.indexOf(nc.value.substring(x,x+1)) == -1 & nc.value.substring(x,x+1) != ".") {
                        z = 0;
                     }
                     if (nc.value.substring(x,x+1) == ".")
                        cv = cv + 1;
                 } 
                 if (cv > 1)
                    z = 0;
                 if (z == 0) {
                    msg = msg + lc + " possui caracteres que não são validos.";  
                 }
                 if (msg == "") {
                    if (nc.value < mi) 
                       msg = msg + lc + " deve ser maior que " + mi.toString() + ".";  
                    if (nc.value > ma)
                       msg = msg + lc + " deve ser menor que " + ma.toString() + ".";
                 }
            }
         }
         else {
              if (nc.value == "")
                 msg = msg + lc + " não pode ser nulo.";
              for (var x = 0; x < nc.value.length; x++) {
                  if (p.indexOf(nc.value.substring(x,x+1)) == -1  & nc.value.substring(x,x+1) != ".")
                     z = 0;
                  if (nc.value.substring(x,x+1) == ".")
                     cv = cv + 1;
              } 
              if (cv > 1)
                 z = 0;
              if (z == 0) {
                 msg = msg + lc + " possui caracteres que não são validos.";  
              }
              if (msg == "") {
                 if (nc.value < mi)
                    msg = msg + lc + " deve ser maior que " + mi.toString() + ".";
                 if (nc.value > ma)
                    msg = msg + lc + " deve ser menor que " + ma.toString() + ".";
              }
         }
      }
      else
      if (tc == "da") {
         p = "0123456789/";
         if (pn == "sim") {  
            if (nc.value == "")
               {}
            else {
                 for (var x = 0; x < nc.value.length; x++) {
                     if (p.indexOf(nc.value.substring(x,x+1)) == -1)
                        z = 0;
                     if (nc.value.substring(x,x+1) == "/")
                        cv = cv + 1;
                 } 
                 if (cv != 2)
                    z = 0;
                 if (z == 0)
                    msg = msg + lc + " possui caracteres que não são validos.";  
                 if (msg == "") {
                    p1 = nc.value.indexOf("/") ;
                    p2 = nc.value.lastIndexOf("/") ;
                    if ((p2 == (p1 + 1)) || (nc.value.substring(0,p1).length == 0) || (nc.value.substring(p1+1,p2).length == 0) || (nc.value.substring(p2+1,nc.value.length).length == 0))
                       msg = msg + lc + " possui os separadores fora de lugar.";
                    else {
                          dia = parseInt(nc.value.substring(0,p1),10);
                          mes = parseInt(nc.value.substring(p1+1,p2),10);
                          ano = parseInt(nc.value.substring(p2+1,nc.value.length),10);
                          if ((mes < 1) || (mes > 12))
                             msg = msg + lc + " deve possuir o mês entre 1 e 12.";
                          if ((mes==1) || (mes==3) || (mes==5) || (mes==7) || (mes==8) || (mes==10) || (mes==12))  {
                             if ((dia < 1) || (dia > 31))
                                msg = msg + lc + " deve possuir o dia entre 1 e 31.";
                             }
                             else {        
                                  if (mes!=2) {
                                     if ((dia < 1) || (dia > 30))
                                        msg = msg + lc + " deve possuir o dia entre 1 e 30.";
                                  }
                                  else {
                                       if (mes==2) {
                                          if ((ano % 4) == 0) { 
                                             if ((dia < 1) || (dia > 29))
                                                msg = msg + lc + " deve possuir o dia entre 1 e 29.";
                                          }
                                          else  {
                                                if ((dia < 1) || (dia > 28))
                                                msg = msg + lc + " deve possuir o dia entre 1 e 28.";
                                          }
                                       }
                                  }
                             }
                         }
                     }
                 }
              }
          }
          else
            msg = "Validação não pode ser realizada.<br> Tipo de dado do campo não identificado.";                                
          return msg;
   } 

function Fornecedor()
{
   VarURL = document.form.aux_dsendurl.value  + '/wpgd0018c.htm'
      + '?aux_idevento=' + document.form.aux_idevento.value
      + '&aux_cdcooper=' + document.form.aux_cdcooper.value
      + '&aux_dtanoage=' + document.form.aux_dtanoage.value
      + '&aux_cdagenci=' + this.id
      + '&aux_cdevento=' + document.form.aux_cdevento.value
   window.open(VarURL,'','toolbar=no,location=no,diretories=no,status=no,menubar=no,scrollbars=yes,resizable=no,width=620,height=340,top=10,left=10');          
   
}

function Calcula(linha)
{
   aux_total=0;
   aux_total = parseFloat(ConverteDec(document.form.aux_vlhonora[linha].value,"1")) +
                                             parseFloat(ConverteDec(document.form.aux_vlrlocal[linha].value,"1")) +
                                             parseFloat(ConverteDec(document.form.aux_vlalimen[linha].value,"1")) +
                                             parseFloat(ConverteDec(document.form.aux_vlmateri[linha].value,"1")) +
                                             parseFloat(ConverteDec(document.form.aux_vltransp[linha].value,"1")) +
                                             parseFloat(ConverteDec(document.form.aux_vlbrinde[linha].value,"1")) +
                                             parseFloat(ConverteDec(document.form.aux_vldivulg[linha].value,"1")) +
                                             parseFloat(ConverteDec(document.form.aux_vloutros[linha].value,"1"));
   document.form.aux_vlrtotal[linha].value = ConverteDec(aux_total.toFixed(2),"2");
}

// Converte um valor com decimal separado por "," para separado por "."

function ConverteDec(str, tipo)
{
   if(tipo == "1")
   {
      str = str.replace(".","");
      str = str.replace(",",".");
      return str;
   }
   else
   {
      str = str.replace(",","");
      str = str.replace(".",",");
      return str;
   }
}




function Calcula_Termo(linha)
{
   var aux_total = 0;
   aux_total = ((parseFloat(ConverteDec(document.form.aux_vlcuseve_termo[linha].value,"1")) * parseFloat(document.form.aux_prdescon_termo[linha].value)) / 100).toFixed(2) / document.form.aux_qtmaxtur.value;
   aux_total = ConverteDec(aux_total.toFixed(2),"2");      
   document.form.aux_vlrtotal_termo[linha].value = aux_total;
}

function mostraTermos(){

  var row; var cell;
  var cor='#F7F7F7';
  
  // limpa a tabela de Termos, menos a 1ª linha - linha do cabecalho
  for (var i=document.all.tbtermo.rows.length; i>1; i--)
      document.all.tbtermo.deleteRow(i-1);
          
  for(i=0;i<mtermo.length;i++)      // insere linhas na tabela de termos
  {      
      row=tbtermo.insertRow();  
      row.id=mtermo[i].cdagenci;
      if (cor == '#FFFFFF')
         cor = '#F7F7F7';
      else
         cor = '#FFFFFF';
      
      row.bgColor = cor;
      
      /*ATENÇÃO:
      
      Foi feita a separação de 'in' e 'put' na palavra input porque o progress estava
      mapeando incorretamente estes campos no AppBuilder
      */
          
          cell=row.insertCell();   // Separador
      cell.className = 'txtNormal';
      cell.width= '1%';
      cell.height = 26;
      cell.align = 'left';
      cell.innerText='';
      
      // PA
      cell=row.insertCell();         
      cell.className = 'txtNormal';
      cell.width = '58%';
      cell.height = 20;
      cell.align = 'left';
      cell.title = mtermo[i].nmresage;
      linky='<in' + 'put type="hidden" name="aux_cdagenci_termo" value="' + mtermo[i].cdagenci + '">' + mtermo[i].nmresage;
      cell.innerHTML=linky;

      cell=row.insertCell();   // Separador
      cell.className = 'txtNormal';
      cell.width= '1%';
      cell.height = 26;
      cell.align = 'left';
      cell.innerText='';

      // Valor do rateio
      cell=row.insertCell();         
      cell.className = 'txtNormal';
      cell.width = '10%';
      cell.height = 20;
      cell.align = 'left';
          linky = '<in' + 'put type="text" name="aux_vlcuseve_termo" size="7" maxlength="10" class="Campo" style="text-align:right;" onChange="Calcula_Termo(' + i + ');" value="' + mtermo[i].vlcuseve + '">';
      cell.innerHTML=linky;

      cell=row.insertCell();   // Separador
      cell.className = 'txtNormal';
      cell.width= '1%';
      cell.height = 26;
      cell.align = 'left';
      cell.innerText = '';

      // % de rateio
      cell=row.insertCell();         
      cell.className = 'txtNormal';
      cell.width = '10%';
      cell.height = 20;
      cell.align = 'left';
          linky = '<in' + 'put type="text" name="aux_prdescon_termo" size="7" maxlength="3" class="Campo" style="text-align:right;" onChange="Calcula_Termo(' + i + ');" value="' + mtermo[i].prdescon + '">';
      cell.innerHTML = linky;
                    
      cell=row.insertCell();   // Separador
      cell.className = 'txtNormal';
      cell.width= '1%';
      cell.height = 26;
      cell.align = 'left';
      cell.innerText = '';
          
      // Participantes
      cell=row.insertCell();         
      cell.className = 'txtNormal';
      cell.width = '7%';
      cell.height = 20;
      cell.align = 'left';
          linky = '<in' + 'put type="text" name="aux_qtmaxtur_termo" size="3" maxlength="3" class="Campo" style="text-align:right;" disabled value="' + document.form.aux_qtmaxtur.value + '">';
      cell.innerHTML = linky;
                    
      cell=row.insertCell();   // Separador
      cell.className = 'txtNormal';
      cell.width= '1%';
      cell.height = 26;
      cell.align = 'left';
      cell.innerText = '';

      // Valor total do desconto
      cell=row.insertCell();         
      cell.className = 'txtNormal';
      cell.width = '10%';
      cell.height = 20;
      cell.align = 'left';
          linky = '<in' + 'put type="text" name="aux_vlrtotal_termo" size="7" maxlength="10" class="Campo" style="text-align:right;" disabled value="' + ((parseFloat(ConverteDec(mtermo[i].vlcuseve,"1")) * parseFloat(mtermo[i].prdescon)) / 100).toFixed(2) / document.form.aux_qtmaxtur.value + '">';
      cell.innerHTML = linky;

      // Botão de propagação dos valores para os PAs
      if(row.id==0)
      {
         cell=row.insertCell();   
         cell.className = 'txtNormal';
         cell.align = 'left';
         cell.width = 2;
         cell.height = 20;         
         linky='<a href="#." onClick=Propaga_Termo(); class="linkGuia"><img src="/cecred/images/icones/financeiro.gif" border="0" title="Propagar valores para os PAs"></a>';
         cell.innerHTML=linky; 
      } 
      else 
      {
         cell=row.insertCell();   
         cell.className = 'txtNormal';
         cell.align = 'left';
         cell.width = 2;
         cell.height = 20; 
         cell.title='Selecione para que esta linha receba a propagação de valores';
         linky='<in' + 'put type="checkbox" name="aux_flpropag_termo" checked>';
         cell.innerHTML=linky; 
      }

      // A primeira linha é a base de custo, deve ter um destaque
      if(row.id==0)
         row.bgColor='#CCCC66';
  }
  
  // arruma o format dos valores totais
  for(i=0;i<document.form.aux_vlrtotal_termo.length;i++){
     document.form.aux_vlrtotal_termo[i].value = ConverteDec(parseFloat(document.form.aux_vlrtotal_termo[i].value).toFixed(2),"2");
  }
}

// Para os campos com a flag marcada, copiará o valor que estiver na primeira linha
function Propaga_Termo(){

  var row; var cell;

  // Para todas as linhas do termo
  for(i=1;i<mtermo.length;i++){
     // Se tem mais de um PA
     if(document.form.aux_flpropag_termo.length > 1){
        // Se o campo de checkbox estiver marcado
        if(document.form.aux_flpropag_termo[i-1].checked){                
           // Substitui os valores antigos pelos valores que estão na primeira linha
           document.all.aux_vlcuseve_termo[i].value = document.all.aux_vlcuseve_termo[0].value;
           document.all.aux_prdescon_termo[i].value = document.all.aux_prdescon_termo[0].value;
           document.all.aux_vlrtotal_termo[i].value = document.all.aux_vlrtotal_termo[0].value;                                        
        }
     }
     // Se tem um PA apenas
     else{
        // Se o campo de checkbox estiver marcado
        if(document.form.aux_flpropag_termo.checked){
           // Substitui os valores antigos pelos valores que estão na primeira linha
           document.all.aux_vlcuseve_termo[i].value = document.all.aux_vlcuseve_termo[0].value;
           document.all.aux_prdescon_termo[i].value = document.all.aux_prdescon_termo[0].value;
           document.all.aux_vlrtotal_termo[i].value = document.all.aux_vlrtotal_termo[0].value;                                      
        }
     }
  }
}

function Salvar_Termo()
{
   document.form.aux_stdopcao.value = 'al_termo';
   var vaux = document.form.aux_lspermis.value; 
   if ((vaux.substring(1,2) == 'A') || (document.form.aux_stdopcao.value == 'i')) { 
        if ( document.form.aux_cddopcao.value!='sa')  {
           if (ValidaDados_Termo(document.forms[0])) {
               Habilita(); 
               HabilitaSalvar(); 
               ArmazenaValores_Termo();
               document.form.aux_cddopcao.value='sa'; 
               status = 'Salvando. Por favor, aguarde ...'; 
               document.form.submit(); 
               return true;               
            } 
            else { 
              return false;
            }  
        } 
   }
   else { 
         alert('Desculpe, mas você não tem permissão para executar esta função.'); 
         return false;
   }
}

function ValidaDados_Termo(form)
{
  var msg="";

  if(document.form.aux_cdagenci_termo.length > 1)
   {
      for(i=0;i< document.form.aux_cdagenci_termo.length ; i++)
      {
         msg = msg + VE("de",form.aux_vlcuseve_termo[i],"Custo de Rateio","sim","0","99999");
         msg = msg + VE("in",form.aux_prdescon_termo[i],"% de Rateio","sim","0","99999");
                 
                 if(parseInt(form.aux_prdescon_termo[i].value) > 100)
                    msg = msg + 'Percentual não pode ser maior que 100.';
      }
    }
    else
    {
         msg = msg + VE("de",form.aux_vlcuseve_termo,"Custo de Rateio","sim","0","99999");
         msg = msg + VE("in",form.aux_prdescon_termo,"% de Rateio","sim","0","99999");
                 
                 if(parseInt(form.aux_prdescon_termo.value) > 100)
                    msg = msg + 'Percentual não pode ser maior que 100.';
    }
         

    if (msg == "")
       return true;
    else
    {
       alert(msg);
       return false;
    }
}

// Guardar os valores da tabela para que sejam salvos no banco de dados
function ArmazenaValores_Termo(){

   document.form.aux_vlrselec_termo.value='';
   
   // Se tem mais de um PA
   if(document.form.aux_cdagenci_termo.length > 1){
      for(i=0;i<document.form.aux_cdagenci_termo.length;i++){
          
             // Grava os valores em forma de lista, separados por ";", para que seja lido pelo progress
         if (document.form.aux_vlrselec_termo.value == ''){
            document.form.aux_vlrselec_termo.value = document.form.aux_cdagenci_termo[i].value + ';' +
                                                                                                 document.form.aux_vlcuseve_termo[i].value + ';' +
                                                                                                 document.form.aux_prdescon_termo[i].value;
         }
         else{
            document.form.aux_vlrselec_termo.value = document.form.aux_vlrselec_termo.value    + ';' +
                                                                                                 document.form.aux_cdagenci_termo[i].value + ';' +
                                                                                                 document.form.aux_vlcuseve_termo[i].value + ';' +
                                                                                                 document.form.aux_prdescon_termo[i].value;
         }
    }
   }
   else{
         document.form.aux_vlrselec_termo.value = document.form.aux_cdagenci_termo.value + ';' +
                                                                                             document.form.aux_vlcuseve_termo.value + ';' +
                                                                                              document.form.aux_prdescon_termo.value;
   }
}

function mostraDiv(nomediv)
{
   var nomeaba = '';

   if (nomediv=='') {nomediv='DivCustos';}

   if (nomediv=='DivCustos') {nomeaba='AbaCustos';}
   if (nomediv=='DivTermo')  {nomeaba='AbaTermo';}   
   
   document.form.aux_nmpagina.value=nomediv;
   document.all.DivCustos.style.display = 'none';
   document.all.DivTermo.style.display  = 'none';   

   document.all.AbaCustos.rows[0].cells[0].background="/cecred/images/menu/mnu_nle.gif";
   document.all.AbaCustos.rows[0].cells[1].background="/cecred/images/menu/mnu_nlc.gif";
   document.all.AbaCustos.rows[0].cells[2].background="/cecred/images/menu/mnu_nld.gif";
   document.all.AbaCustos.rows[0].cells[1].className="txtTituloHid";
   
   document.all.AbaTermo.rows[0].cells[0].background="/cecred/images/menu/mnu_nle.gif";
   document.all.AbaTermo.rows[0].cells[1].background="/cecred/images/menu/mnu_nlc.gif";
   document.all.AbaTermo.rows[0].cells[2].background="/cecred/images/menu/mnu_nld.gif";
   document.all.AbaTermo.rows[0].cells[1].className="txtTituloHid";

   document.all[nomeaba].rows[0].cells[0].background="/cecred/images/menu/mnu_sle.gif";
   document.all[nomeaba].rows[0].cells[1].background="/cecred/images/menu/mnu_slc.gif";
   document.all[nomeaba].rows[0].cells[2].background="/cecred/images/menu/mnu_sld.gif";
   document.all[nomeaba].rows[0].cells[1].className="txtTituloVis";

   document.all[nomediv].style.display = 'block';      
}







mostraEventos();

if(document.form.aux_flgtermo.value=="yes"){
   mostraTermos();
   document.all.AbaTermo.style.visibility='visible';   
}
else{
   document.form.aux_nmpagina.value='';
   document.all.AbaTermo.style.visibility='hidden';
}

mostraDiv(document.form.aux_nmpagina.value);

document.form.nmrescop.style.display = "none";
document.form.nmevento.style.border='none';  

// Se for assembléia, esconde algumas colunas
if (document.form.aux_idevento.value == '2') 
{
   document.all.tbevento_col2.style.display = 'none';
   document.all.tbevento_col3.style.display = 'none';
   document.all.tbevento_col4.style.display = 'none';
   for (i = 0; i < document.all.some.length; i++) 
   {
      document.all.some[i].style.display = 'none';
   }
}

</SCRIPT>
