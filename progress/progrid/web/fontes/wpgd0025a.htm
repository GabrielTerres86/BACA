<!--
	Alteracoes: 18/10/2012 - Limitar nome do solicitante para 50 caracteres (Gabriel).
-->
<html>
<head>
<title>Controle de Kits/Brindes (wpgd0025a)</title>
</head>
<body>
<link href="/cecred/estilos/progrid.css" rel="stylesheet" type="text/css">
<script SRC="/cecred/jsbiblio/biblio.js"></script>
<script SRC="/cecred/jsbiblio/frcod.js"></script>
<form action="#." method="POST" name="form">
  <input name="aux_cddopcao" type="hidden" value="">    
  <input name="aux_lspermis" type="hidden" value="">    
  <input name="aux_nrdrowid" type="hidden" value="">
  <input name="aux_dsretorn" type="hidden" value="">    
  <input name="aux_stdopcao" type="hidden" value="">
  <input name="aux_dsendurl" type="hidden" value="">    
  <input name="aux_idevento" type="hidden" value="">  
  <input name="aux_idregist" type="hidden" value="">
  <input name="aux_tpdeitem" type="hidden" value="">
  <input name="aux_cdcooper" type="hidden" value="">
  <input name="aux_cdagenci" type="hidden" value="">
  <input name="aux_dtanoage" type="hidden" value="">
  <!-- Início do modelo geral -->
  <table width="100%" border="0" align="left" cellpadding="0" cellspacing="0">
    <tr valign="botton">
      <td>
	<table width="100%" border="0" cellpadding="0" cellspacing="0" >
	  <tr>
	    <td width="11" background="/cecred/images/geral/guia_fundo.gif"><img src="/cecred/images/geral/guia_esquerda.gif" width="11" height="21"></td>
	    <td width="147" nowrap background="/cecred/images/geral/guia_fundo.gif" class="linkGuia"><div align="center">Controle de Kits/Brindes </div></td>
	    <td width="8" background="/cecred/images/geral/guia_fundo.gif" align="right"><img src="/cecred/images/geral/guia_direita.gif" width="8" height="21"></td>
	    <td>&nbsp;</td>
	  </tr>
	  <tr>
	    <td colspan="4" height="2" align="left" background="/cecred/images/menu/mnu_slc.gif"></td>
	  </tr>					  
      </table>
      </td>
    </tr>
    <tr valign="top" bgcolor="#FFFFFF">
      <td>
        <table width="100%" height="100%"  border="0" align="left" cellpadding="0" cellspacing="1" bgcolor="#999999">
          <tr>
            <td valign="top" bgcolor="#FFFFFF">
              <table width="100%" height="100%"  border="0" align="left" cellpadding="0" cellspacing="0">
                <tr bgcolor="#FFFFFF">
                  <td width="7">&nbsp;
                    
                  </td>
                </tr>
                <tr>
                  <td height="15" align="left">&nbsp;</td>
                  <td width="100%" height="15" align="left">
                    <!-- Interrupção do modelo geral, início dos dados específicos da tela -->
                      <table width="100%" border="0" align="left" cellspacing="0">
                        <tr id="tabela1">
                          <td width="25" align="right" class="NomeCampo" ><img src="/cecred/images/icones/ico_cooperativa.gif" width="19" height="19" align="left"></td>
                          <td colspan="6" align="left" class="NomeCampo"><strong>Solicitados</strong></td>
                        </tr>
                        <tr id="tabela1">
                          <td width="25"  align="right" class="NomeCampo">&nbsp;</td>
                          <td width="131" align="right" class="NomeCampo">Data:</td>
                          <td width="50" align="right" class="NomeCampo"><input name="dtsolici" type="text" class="Campo" size="10" maxlength="10" onkeypress="FormataData(this.name, this.value)"></td>
                          <td width="77" align="right" class="NomeCampo">Quantidade:</td>
                          <td width="35" align="left"><input name="qtsolici" type="text" class="Campo" size="7" value=""></td>
                          <td width="65" align="right" class="NomeCampo">Solicitante:</td>
                          <td width="202" align="left"><input name="nmsolici" type="text" class="Campo" size="20" maxlength="50">
                          </td>
                        </tr>
                        <tr id="tabela1">
                          <td align="right" class="NomeCampo">&nbsp;</td>
                          <td align="right" class="NomeCampo">&nbsp;</td>
                          <td align="right" class="NomeCampo">&nbsp;</td>
                          <td align="right" class="NomeCampo">&nbsp;</td>
                          <td align="left">&nbsp;</td>
                          <td align="left">&nbsp;</td>
                          <td align="left" height="20">&nbsp;</td>
                        </tr>
			<tr id="enviados">
			  <td width="25" align="right" class="NomeCampo"><img src="/cecred/images/icones/ico_cooperativa.gif" width="19" height="19" align="left"></td>
			  <td colspan="6" align="left" class="NomeCampo"><strong>Enviados</strong></td>
			</tr>
                        <tr id="recebidos">
			  <td width="25" align="right" class="NomeCampo"><img src="/cecred/images/icones/ico_cooperativa.gif" width="19" height="19" align="left"></td>
			  <td colspan="6" align="left" class="NomeCampo"><strong>Recebidos</strong></td>
			</tr>
		        <tr id="tabela1">
                          <td width="25" align="right" class="NomeCampo">&nbsp;</td>
                          <td width="131" align="right" class="NomeCampo">Valor Referência: </td>
                          <td width="50" align="left" class="NomeCampo"><input name="vlrrefer" type="text" class="Campo" size="10" onChange="CalculaTotal();"></td>
                          <td width="77" align="right" class="NomeCampo">&nbsp;</td>
                          <td width="35" align="left">&nbsp;</td>
                          <td width="65" align="right" class="NomeCampo">&nbsp;</td>
                          <td width="202" align="left">&nbsp;</td>
                      </tr>
                      <tr>
                        <td align="right" class="NomeCampo">&nbsp;</td>
                        <td width="131" align="right" class="NomeCampo">Data:</td>
                        <td width="50" align="left" class="NomeCampo"><input name="dtdenvio" type="text" class="Campo" size="10" maxlength="10" onkeypress="FormataData(this.name, this.value)"></td>
                        <td width="77" align="right" class="NomeCampo">Quantidade:</td>
                        <td width="35" align="left"><input name="qtdenvio" type="text" class="Campo" size="7" onChange="CalculaTotal();"></td>
                        <td width="65" align="right" class="NomeCampo"><div id="tabela2">Valor:</div></td>
                        <td width="202" align="left"><div id="tabela2"><input name="vlrenvio" type="text" class="Campo" size="10" readOnly></div>
                        </td>    
                      </tr>     
                      <tr>
			<td colspan="3">&nbsp;</td>
                      </tr>               
                      <tr>
			<td colspan="3"></td>
                        <td><div align="center"><img style="cursor:hand;" src="/cecred/images/botoes/btn_salvar.gif" width="60" height="20" onClick="return Salvar()"></div></td>
                      </tr>
		    </table>				
                    <!-- Fim dos dados específicos da tela, reinício do modelo geral -->
                  </td>
                </tr>
              </table>
            </td>
          </tr>
        </table>
      </td>
    </tr>
  </table>
  <!-- Fim do modelo geral -->
</form>
<script language="JavaScript">
   NomeDoProgramaPrincipal  = '/wpgd0025a.w';
   NomeDoProgramaDeListagem = '/wpgd0025als.w';
   NomeDoProgramaDeAjuda    = '/wpgd0025aaj.w';
   NomeDoProgramaDeZoom     = '/zoom/zwpgd0025a.w';
   
   NomeDoProgramaPrincipal = document.form.aux_dsendurl.value + NomeDoProgramaPrincipal;
   document.form.action = NomeDoProgramaPrincipal;
   
function Incluir(){
  ZeraModoExclusao()
  var vaux = document.form.aux_lspermis.value; 
  if(vaux.substring(0,1) == 'I'){ 
    if(document.form.aux_stdopcao.value == 'i'){ 
      MostraResultado('1','Você já esta no modo de inclusão.'); 
      return false
    } 
    else{ 
      document.form.aux_cddopcao.value='in'; 
      document.form.aux_stdopcao.value='i'
      LimparCampos(); 
      return true
    } 
  } 
  else{ 
    MostraResultado('1','Desculpe, mas você não tem permissão para executar esta função.'); 
    return false
  }
}

function Salvar(){
  ZeraModoExclusao();
  
  var vaux = document.form.aux_lspermis.value; 
  if((vaux.substring(1,2) == 'A') || (document.form.aux_stdopcao.value == 'i')) 
  {
     if(ValidaDados(document.forms[0]))
     {
        document.form.aux_cddopcao.value='sa'; 
        status = 'Salvando. Por favor, aguarde ...';  
        document.form.submit(); 
        return true;
     } 
     else
     {
        return false;
     }  

  }
  else{ 
    MostraResultado('1','Desculpe, mas você não tem permissão para executar esta função.'); 
    return false;
  }
}

function Excluir(){
  ZeraModoExclusao();  
  var vaux = document.form.aux_lspermis.value;
   
  if(vaux.substring(2,3) == 'E') { 
    if(document.form.aux_stdopcao.value=='i') { 
      MostraResultado('1','Você esta no modo de inclusão.Selecione o registro apropriado e então selecione a opção exclusão.'); 
      return false
    } 
    else {
      if (!confirm('Confirma Exclusão do Facilitador?')){
         return false;
      }
	  else{
         document.form.aux_cddopcao.value = "ex";
         document.form.submit();
	  }
    } 
  } 
  else { 
    MostraResultado('1','Desculpe, mas você não tem permissão para executar esta função.'); 
    return false
  }	
}

function AbreZoom(ProgramaDeZoom,ProgramaPrincipal,NomeDoCampo,TipoDeZoom,ValorCampo,ValorCampo2,ValorCampo3,ValorCampo4,ValorCampo5,ValorCampo6)
   {
      ZeraModoExclusao()   
      status = 'Processando pesquisa. Por favor, aguarde ...'; 
      if (ValorCampo == null)  ValorCampo = "";
      if (ValorCampo2 == null) ValorCampo2 = "";
      if (ValorCampo3 == null) ValorCampo3 = "";
      if (ValorCampo4 == null) ValorCampo4 = "";
      if (ValorCampo5 == null) ValorCampo5 = "";
      if (ValorCampo6 == null) ValorCampo6 = "";
      if (ValorCampo != "" )  ValorCampo = Substituir(ValorCampo);  
      if (ValorCampo2 != "" ) ValorCampo2 = Substituir(ValorCampo2);  
      if (ValorCampo3 != "" ) ValorCampo3 = Substituir(ValorCampo3);  
      if (ValorCampo4 != "" ) ValorCampo4 = Substituir(ValorCampo4);  
      if (ValorCampo5 != "" ) ValorCampo5 = Substituir(ValorCampo5);  
      if (ValorCampo6 != "" ) ValorCampo6 = Substituir(ValorCampo6);  
      ProgramaPrincipal = Substituir(ProgramaPrincipal);   
      ProgramaDeZoom = document.form.aux_dsendurl.value + ProgramaDeZoom;   
      varurl = ProgramaDeZoom + '?Pesquisa='    + TipoDeZoom  + 
                                '&vprograma='   + ProgramaPrincipal + 
                                '&NomeDoCampo=' + NomeDoCampo + 
                                '&ValorCampo='  + ValorCampo  + 
                                '&ValorCampo2=' + ValorCampo2 + 
                                '&ValorCampo3=' + ValorCampo3 + 
                                '&ValorCampo4=' + ValorCampo4 + 
                                '&ValorCampo5=' + ValorCampo5 + 
                                '&ValorCampo6=' + ValorCampo6;
      WZoom = window.open(varurl,'WZoom','toolbar=no,location=no,diretories=no,status=no,menubar=no,scrollbars=no,resizable=yes,width=580,height=350,screenX=0,screenY=0,top=10,left=10');
      WZoom.focus();	  
   }
   
function FechaZoom(campo,valor,valor2,valor3,valor4,valor5,valor6,valor7,valor8)
{
   ZeraModoExclusao()   
   if (window.WZoom != null)
         {	
            if (WZoom.closed != true)
                  {
                     if (valor != null)
                           top.mainFrame.RetornoDoZoom(campo,valor,valor2,valor3,valor4,valor5,valor6,valor7,valor8);
                     WZoom.close();
                  }
         }
}    
   
function ValidaDados(form){ 
   var msg="";

   /*msg = msg + VE("ca",form.nmfacili,"O Nome do facilitador","nao");*/
         
   if (msg == "")
      return true
   else{
      MostraResultado('1',msg);
      return false
   }
}

function LimparCampos(){
    document.form.dtsolici.value = "";
    document.form.qtsolici.value = "";
    document.form.nmsolici.value = "";
    document.form.dtdenvio.value = "";
    document.form.qtdenvio.value = "";
    document.form.vlrenvio.value = "";
}

function CarregaPrincipal()
{
}

function FormataData(campo,teclapress)  {
   
   var tecla = teclapress.keycode;
   vr = teclapress;
  
   vr = vr.replace(".",""); 
   vr = vr.replace("/",""); 
   tam = vr.length ;
           
   if ( tecla != 9 && tecla != 8 )   
   {
      if ( tam > 2 && tam < 5 )
         document.form[campo].value = vr.substr(0, tam - 2) + '/' + vr.substr( tam - 2, tam );
      if ( tam > 5 && tam < 8 )  
         document.form[campo].value = vr.substr(0, 2) + '/' +
            vr.substr( 2, 2) + '/' + vr.substr( 4, 4);
   }	  
}

function CalculaTotal()
{
   var var1 = parseFloat(ConverteDec(document.form.vlrrefer.value,"1"));
   var var2 = parseFloat(ConverteDec(document.form.qtdenvio.value,"1"));

   document.form.vlrrefer.value = formatCurrency(var1);
   
   var1 = var1 * var2;

   document.form.vlrenvio.value = formatCurrency(var1);
}

//formatação dos campos
function formatCurrency(num) 
{
   //alert(num);
   num = num.toString().replace(/\$|\,/g,'');
   if(isNaN(num))
      num = "0";
   sign = (num == (num = Math.abs(num)));
   num = Math.floor(num*100+0.50000000001);
   cents = num%100;
   num = Math.floor(num/100).toString();
   if(cents<10)
      cents = "0" + cents;
   for (var i = 0; i < Math.floor((num.length-(1+i))/3); i++)
      num = num.substring(0,num.length-(4*i+3))+'.'+
   num.substring(num.length-(4*i+3));
   return (((sign)?'':'-') + num + ',' + cents);
}

// Converte um valor com decimal separado por "," para separado por "."
function ConverteDec(str, tipo)
{
   if(tipo == "1")
   {
      str = str.replace(".","");
      str = str.replace(",",".");
      return str;
   }
   else
   {
      str = str.replace(",","");
      str = str.replace(".",",");
      return str;
   }
}

// Esconde os campos que não são usados pelo questionário
if (document.form.aux_tpdeitem.value == "3")
{
   document.all.enviados.style.display = 'none';
   document.all.recebidos.style.display = 'block';
   for (i = 0; i < document.all.tabela1.length; i++)
   {
      document.all.tabela1[i].style.display = 'none';
   }
   for (i = 0; i < document.all.tabela2.length; i++)
   {
      document.all.tabela2[i].style.visibility = 'hidden';
   }
}
else
{
   document.all.enviados.style.display = 'block';
   document.all.recebidos.style.display = 'none';
}
</SCRIPT>
</body>
</html>
