<!--
	Alteracoes: 19/07/2017 - Criação da tela PRJ 322 (Jean Michel)
-->
<html>
  <head>
    <title>Mesa de Autoridades (wpgd0060g)</title>
  </head>
  <body>
    <link href="/cecred/estilos/progrid.css" rel="stylesheet" type="text/css">
    <script language="JavaScript">
      NomeDoProgramaPrincipal  = '/wpgd0060g.w';                                
    </script>
    <form action="#." method="POST" name="form" id="form">
      <input type="hidden" name="aux_cddopcao" id="aux_cddopcao" value="">
      <input type="hidden" name="aux_lspermis" id="aux_lspermis" value="">
      <input type="hidden" name="aux_dsretorn" id="aux_dsretorn" value="">
      <input type="hidden" name="aux_dsendurl" id="aux_dsendurl" value="">
      <input type="hidden" name="aux_idevento" id="aux_idevento" value="">
      <input type="hidden" name="aux_cdcooper" id="aux_cdcooper" value="">
      <input type="hidden" name="aux_nrseqcma" id="aux_nrseqcma" value="">  
      <input type="hidden" name="aux_dtanoage" id="aux_dtanoage" value="">
      <input type="hidden" name="aux_cdagenci" id="aux_cdagenci" value="">
      <input type="hidden" name="aux_cdevento" id="aux_cdevento" value="">
      <input type="hidden" name="aux_nrseqdig" id="aux_nrseqdig" value="">
      <input type="hidden" name="aux_cdoperad" id="aux_cdoperad" value="">
      <input type="hidden" name="aux_cdcopope" id="aux_cdcopope" value="">

      <input type="hidden" class="NomeCampo" name="aux_nmfornec" readOnly size=40>
      <table width="600" border="0" align="center" cellspacing="0">
        <tr valign="botton">
          <td>
            <table width="310" border="0" cellpadding="0" cellspacing="0" background="/cecred/images/geral/guia_fundo.gif">
              <tr>
                <td width="11"><img src="/cecred/images/geral/guia_esquerda.gif" width="11" height="21"></td>
                <td align="center" nowrap width="290" class="linkGuia">Selecionar Componentes da Mesa de Autoridades</td>
                <td width="10" align="right"><img src="/cecred/images/geral/guia_direita.gif" width="8" height="21"></td>
              </tr>
            </table>
          </td>
        </tr>
        <tr>	
          <td align="center">
            <table width="100%" border="0" cellpadding="0" cellspacing="0">
              <tr align="left">
                  <td id="tbmesa_col0" width="5" height="26" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos">&nbsp;</td>
                  <td id="tbmesa_col1" width="300" height="26" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos">Nome</td>
                  <td id="separador" width="2" height="26" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                  <td id="tbmesa_col2" width="293" height="26" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos">Cargo</td>
              </tr>
          </table>
          <div style="overflow: auto; height:280;">
            <table width="100%" id="tbmesa" name="tbmesa" border="0" cellpadding="0" cellspacing="0">
              <!-- INCLUI DADOS -->
            </table>
          </div>
          </td>
        </tr>
        <tr>	
          <td height="10"></td>
        </tr>
        <tr>	
          <td align="center">
            <img src="/cecred/images/botoes/btn_salvar.gif" onClick="Salvar()" style="cursor: hand; ">
          </td>
        </tr>
      </table>
    </form>
  </body>

  <script LANGUAGE="JAVASCRIPT">
  
    NomeDoProgramaPrincipal  = '/wpgd0060g.w';
    NomeDoProgramaDeListagem = '/wpgd0060gs.w';
    NomeDoProgramaDeAjuda    = '/wpgd0060gaj.w';
    NomeDoProgramaDeZoom     = '/zoom/zoei01.w';

    NomeDoProgramaPrincipal = document.form.aux_dsendurl.value + NomeDoProgramaPrincipal;
    document.form.action = NomeDoProgramaPrincipal;

    function ValidaDados(form){
      var msg="";
               
      if (msg == ""){
        return true;
      }else{
        alert(msg);
        return false;
      }
    }

    function Incluir(){
      var vaux = document.form.aux_lspermis.value; 
      
      if (!vaux.substring(0,1) == 'I'){
        alert('Desculpe, mas você não tem permissão para executar esta função.'); 
        return false
      }
    }

    function Salvar(){
    
      //ZeraModoExclusao();
      var vaux = document.form.aux_lspermis.value;
      
      if ((vaux.substring(1,2) == 'A')) { 
        if ( document.form.aux_cddopcao.value != 'sa')  {
          if(ValidaDados(document.forms[0])) {
            armazenaMesa();
            document.form.aux_cddopcao.value='sa'; 
            document.form.submit(); 
            return true;                   
          }else { 
            return false;
          }  
        }
      }else{ 
        alert('Desculpe, mas você não tem permissão para executar esta função.'); 
        return false;
      }
    }

    function mostraMesa(){

      var row; 
      var cell;
      var cor;
      
      for(var i=document.all.tbmesa.rows.length; i > 1; i--){
        document.all.tbmesa.deleteRow(i-1);
      }  
      
      if(arrMesa.length > 0){
        for(i=0;i<arrMesa.length;i++){      // insere linhas na tabela de eixos
          row = tbmesa.insertRow();  // nova linha
          row.id = i;
          row.onclick = mudaCor;
          
          if(arrMesaEve.length > 0){
            
            for(j=0;j<arrMesaEve.length;j++){ 
            
              if(cor == '#FFFFFF'){
                cor = '#F7F7F7';
              }else{
                cor = '#FFFFFF';
              }
              
              if(arrMesaEve[j].nrseqcma == arrMesa[i].nrseqcma){
                cor = '#CCCCCC';
                row.checked = true;
                break;
              }
            }
          }else{
            if(cor == '#FFFFFF'){
              cor = '#F7F7F7';
            }else{
              cor = '#FFFFFF';
            }
          }
                    
          row.bgColor = cor;
          row.value = arrMesa[i].nrseqcma;
          
          // Separador
          cell = row.insertCell();
          cell.className = 'txtNormal';
          cell.width = document.all.tbmesa_col0.width;
          cell.height = 26;
          cell.align = 'left';
          cell.innerHTML = '';
          
          // Nome
          cell = row.insertCell();
          cell.className = 'txtPequeno';
          cell.width = document.all.tbmesa_col1.width;
          cell.height = 10;
          cell.align = 'left';
          cell.id = document.all.tbmesa.rows.length - 1;
          cell.innerHTML = arrMesa[i].nmcompon
          
          // Separador
          cell = row.insertCell();
          cell.className = 'txtNormal';
          cell.width = document.all.separador.width;
          cell.height = 26;
          cell.align = 'left';
          cell.innerHTML = '';
          
          // Cargo
          cell = row.insertCell();
          cell.className = 'txtPequeno';
          cell.width = document.all.tbmesa_col2.width;
          cell.height = 10;
          cell.align = 'left';
          cell.id = document.all.tbmesa.rows.length - 1;
          cell.innerHTML = arrMesa[i].dscarcom;
        }
      }else{
        cor = '#FFFFFF';
				//Sem Autoridades cadastradas
				row = tbmesa.insertRow();
				row.bgColor = cor;
				row.style.cursor = 'hand';
				
				cell = row.insertCell();      
				cell.className = 'txtTituloHid';
				cell.align = 'center';
				cell.colspan = 4;
				cell.height = 30;
				linky = 'Sem Autoridades Cadastradas';
				cell.innerHTML = linky;
      }
    }

    function mudaCor(){
     
      if (this.checked==false){
        this.bgColor = '#CCCCCC';
        this.checked = true;
      }else{
        this.bgColor = '#FFFFFF';
        this.checked = false;
      }   
    }

    function armazenaMesa(){
    
      var i;
            
      for(var i= 0 ;i < tbmesa.rows.length; i++){
        if(tbmesa.rows[i].checked){
          if(document.form.aux_nrseqcma.value == ''){
            document.form.aux_nrseqcma.value = arrMesa[i].nrseqcma;
          }else{
            document.form.aux_nrseqcma.value = document.form.aux_nrseqcma.value  + ',' + arrMesa[i].nrseqcma;
          }
        }
      }
      
    }

    mostraMesa();
    
  </script>
</html>