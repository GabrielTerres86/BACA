<!--

  10/08/2015 - Ajustes para projeto 229 - Melhorias OQS (Jean Michel).             
  
-->
<html>
<head>
<title>Sele&ccedil;&atilde;o de Sugest&otilde;es (wpgd0014a)</title>
<link href="/cecred/estilos/progrid.css" rel="stylesheet" type="text/css">
</head>
<body>
<script SRC="/cecred/jsbiblio/sorttable.js"></script>
<script language="JavaScript">
NomeDoProgramaPrincipal  = '/wpgd0014a.w';
</script>
<!--<form action="#." method="POST" name="form">-->
<form method="POST" name="form">
  <input type="hidden" name="aux_dsendurl" value="">
  <input type="hidden" name="aux_cddopcao" value="">           
  <input type="hidden" name="aux_nrdrowid" value="">
  <input type="hidden" name="aux_lspermis" value="">
  <input type="hidden" name="aux_stdopcao" value="">
  <input type="hidden" name="aux_lsevento" value="">
  <input type="hidden" name="aux_cdevento" value="">
  <input type="hidden" name="aux_idevento" value="">  
  <input type="hidden" name="glb_cdcooper" value="">
  <input type="hidden" name="aux_cdcooper" value="1">
  <input type="hidden" name="aux_dtanoage" value=""> 
  <table width="100%"  border="0" cellspacing="0" cellpadding="0">
    <tr>
      <td>
	    <table border="0" cellpadding="0" cellspacing="0" background="/cecred/images/geral/guia_fundo.gif">
          <tr>
		    <td width="11"><img src="/cecred/images/geral/guia_esquerda.gif" width="11" height="21"></td>
            <td nowrap class="linkGuia"><div align="center">Seleção de Eventos</div></td>
            <td width="11" align="right"><img src="/cecred/images/geral/guia_direita.gif" width="8" height="21"></td>
          </tr>
	    </table>
	   </td>       
    </tr>
	</tr>
    <tr>
      <td height="2" bgcolor="#999999"></td>
    </tr>
    <tr>
      <td>
	    <table class="tableBranca" id="tbeventos" border="0" cellpadding="0" cellspacing="0" bgColor="#FFFFFF">
		</table>
	  </td>
    </tr>
	<tr>
	  <td>&nbsp;
	    	    
	  </td>	  
	</tr>
    <tr>
	  <td align="center">
	    <!-- <a href="#." style="cursor: hand; " onClick="Salvar();"><input name="imageField" type="image"  src="/cecred/images/botoes/btn_salvar.gif" width="60" height="20"></A>-->
      <a style="cursor: hand; " onClick="Salvar();"><input name="imageField" type="image"  src="/cecred/images/botoes/btn_salvar.gif" width="60" height="20"></a>
	  </td>
	</tr>	
  </table>
</form>
</body>
<script language="JavaScript">
   NomeDoProgramaPrincipal  = '/wpgd0014a.w';
   NomeDoProgramaDeListagem = '/wpgd0014as.w';
   NomeDoProgramaDeAjuda    = '/wpgd0014aaj.w';
   NomeDoProgramaDeZoom     = '';
   
   NomeDoProgramaPrincipal = document.form.aux_dsendurl.value + NomeDoProgramaPrincipal;
   document.form.action = NomeDoProgramaPrincipal;


function Salvar(){
   //ZeraModoExclusao();
   var vaux = document.form.aux_lspermis.value; 
   if ((vaux.substring(1,2) == 'A') || (document.form.aux_stdopcao.value == 'i')){ 
        if (document.form.aux_cddopcao.value!='sa')  {
            document.form.aux_cddopcao.value='sa';
			// "força" a opção para i = Inclusão											
			document.form.aux_stdopcao.value='i'; 
            status = 'Salvando. Por favor, aguarde ...';	
         
			armazenaEventos();
      
			//document.form.submit();
            return true;
        } 
        else{ 
            return false;
        }  
   }else { 
      alert('Desculpe, mas você não tem permissão para executar esta função.'); 
      return false;
   }
}

function mudaCor(){

  if (this.checked==false){
      this.bgColor = '#CCCCCC';
      this.checked = true;
  }
  else{
      this.bgColor = '#FFFFFF';
      this.checked = false;
  }
}

function mostraEventos(){

  var row; var cell;  
  
  //Limpa a tabela de Eventos
  for(var i=document.all.tbeventos.rows.length; i>0; i--)
    document.all.tbeventos.deleteRow(i-1);
	  
  // cria as linhas com as células...
  for(var j=0;j<meventos.length;j++){
     row=tbeventos.insertRow();
     row.id=j;
     row.checked = false; 
     if (j>0){
        row.onclick=mudaCor;
        row.style.cursor='hand';
        row.value=meventos[j].cdevento;
     }	 	 
	 
     // Eixo Temático
     cell=row.insertCell();
     cell.className = 'txtPequeno ';
     cell.height = 40;
     linky=meventos[j].dseixtem;  
     cell.innerHTML=linky;
     if (j>0)
        cell.align="left";
     else{
      cell.align="center";
     	cell.background="/cecred/images/menu/fnd_title.jpg ";
      cell.height = 15;}
	 
     // Separador
     cell=row.insertCell();
     cell.className = 'txtPequeno ';
     cell.width= 5;
     cell.height = 40;
     cell.align = 'left';     
     if (j==0){
	     cell.background="/cecred/images/menu/fnd_title.jpg";
       cell.innerHTML='<img src="/cecred/images/geral/div.gif" width="2" height="15">';
       cell.height = 15;
     }	 	 
     
     /************/
     // Tema
     cell=row.insertCell();
     cell.className = 'txtPequeno ';
     cell.height = 40;
     linky=meventos[j].dstemeix;  
     cell.innerHTML=linky;
     if (j>0)
        cell.align="left";
     else{
      cell.align="center";
     	cell.background="/cecred/images/menu/fnd_title.jpg ";
      cell.height = 15;}
     /************/
     
     // Separador
     cell=row.insertCell();
     cell.className = 'txtPequeno ';
     cell.width= 5;
     cell.height = 40;
     cell.align = 'left';     
     if (j==0){
	     cell.background="/cecred/images/menu/fnd_title.jpg";
       cell.innerHTML='<img src="/cecred/images/geral/div.gif" width="2" height="15">';
       cell.height = 15;
     }
     
     // Nome do Evento
     cell=row.insertCell();
     cell.className = 'txtPequeno ';
	   cell.height = 40;
     linky=meventos[j].nmevento;  
     cell.innerHTML=linky;
     if (j>0)
        cell.align="left";
     else{
       cell.align="center";
       cell.background="/cecred/images/menu/fnd_title.jpg";
       cell.height = 15;}
	 
     // Separador
     cell=row.insertCell();
     cell.className = 'txtNormal';
     cell.width= 5;
     cell.height = 40;
     cell.align = 'left'; 
      
     if (j==0){
       cell.background="/cecred/images/menu/fnd_title.jpg";
       cell.innerHTML='<img src="/cecred/images/geral/div.gif" width="2" height="15">';
       cell.height = 15;
     }

     // Obrigatório
     cell = row.insertCell();
     cell.className = 'txtNormal';
     cell.height = 40;
     linky = meventos[j].flgtdpac;
     if(j>0){
        linky='<in' + 'put type=checkbox name="chk_' + j + '"';
        if(meventos[j].flgtdpac=='Sim')
           linky=linky + ' checked';
        linky=linky + ' disabled>';
     }
     
     cell.innerHTML=linky;
     
     if (j>0)
        cell.align="left";
     else{
       cell.align="center";
       cell.background="/cecred/images/menu/fnd_title.jpg";
		   cell.height = 15;
     }  
  }  
}

function armazenaEventos()
{
   for(var i=1;i<tbeventos.rows.length;i++)
      if (tbeventos.rows[i].checked)
      {
         if(document.form.aux_lsevento.value=='')
            document.form.aux_lsevento.value = tbeventos.rows[i].value;
	 else
	    document.form.aux_lsevento.value = document.form.aux_lsevento.value + ',' + tbeventos.rows[i].value; 
      }
}
   
mostraEventos();

</script>
</html>

