<!--
	Alterações: 
-->

<html>
<head>
<title>Termo de Compromisso</title>
</head>
<body style="margin-left: 3px; ">
<form action="#." method="POST" name="form">
  <script language="SpeedScript">
  DEF VAR par_nrdrowid AS ROWID                                NO-UNDO.  
  
  DEF VAR aux_dsdtexto AS CHAR                                 NO-UNDO.
  DEF VAR aux_vldebito AS DECIMAL                              NO-UNDO.
  DEF VAR aux_dsdebito AS CHAR      EXTENT 2                   NO-UNDO.
  DEF VAR aux_dsdmeses AS CHAR      EXTENT 12
                          INIT ["Janeiro","Fevereiro","Março","Abril","Maio","Junho",
						        "Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"]
								                               NO-UNDO.  
  
  ASSIGN par_nrdrowid = TO-ROWID(GET-VALUE("aux_nrdrowid")).
  
  FIND crapidp WHERE ROWID(crapidp) = par_nrdrowid NO-LOCK NO-ERROR.
  
  IF    NOT AVAILABLE crapidp   THEN
        QUIT.
		
  FIND crapcop WHERE crapcop.cdcooper = crapidp.cdcooper NO-LOCK NO-ERROR.
  
  IF    NOT AVAILABLE crapcop   THEN
        QUIT.
		
  /* Nome do evento */
  FIND FIRST crapedp WHERE crapedp.idevento = crapidp.idevento   AND
                           crapedp.cdcooper = crapidp.cdcooper   AND
						   crapedp.dtanoage = crapidp.dtanoage   AND
					       crapedp.cdevento = crapidp.cdevento   NO-LOCK NO-ERROR.
						   
  /* Busca o custo do termo de compromisso */
  FIND crapcdp WHERE crapcdp.idevento = crapidp.idevento   AND
                     crapcdp.cdcooper = crapidp.cdcooper   AND
					 crapcdp.cdagenci = crapidp.cdageins   AND
					 crapcdp.dtanoage = crapidp.dtanoage   AND
					 crapcdp.tpcuseve = 4                  AND
					 crapcdp.cdevento = crapidp.cdevento   AND
					 crapcdp.cdcuseve = 1                  NO-LOCK NO-ERROR.
					 
  /* Nome do PA */
  FIND crapage WHERE crapage.cdcooper = crapidp.cdcooper   AND
                     crapage.cdagenci = crapidp.cdageins   NO-LOCK NO-ERROR.
					 
  IF   NOT AVAILABLE crapedp   OR
       NOT AVAILABLE crapcdp   OR
	   NOT AVAILABLE crapage   THEN
       QUIT.
	   
  aux_vldebito = ((crapcdp.prdescon * crapcdp.vlcuseve) / 100) / crapedp.qtmaxtur.
  
  RUN fontes/extenso.p (INPUT  aux_vldebito, INPUT 70, INPUT 0, INPUT "M",
                        OUTPUT aux_dsdebito[1], OUTPUT aux_dsdebito[2]). 
		

  FIND crapttl WHERE crapttl.cdcooper = crapidp.cdcooper   AND
                     crapttl.nrdconta = crapidp.nrdconta   AND
   				     crapttl.idseqttl = crapidp.idseqttl   NO-LOCK NO-ERROR.
							  
  IF   NOT AVAILABLE crapttl   THEN
       QUIT.
	   
  /* Inscrição própria */
  IF   crapidp.tpinseve = 1   THEN  
       aux_dsdtexto = "Eu, " + CAPS(TRIM(crapttl.nmextttl)) + " inscrito(a) no curso " +
		              CAPS(TRIM(crapedp.nmevento)) + " promovido pela " + CAPS(TRIM(crapcop.nmrescop)) +
			          ", assino este termo, comprometendo-me a participar do curso com frequëncia mínima de " +
				      STRING(crapedp.prfreque,"zz9") + "%, caso contrário, autorizo o débito de R$ " +
				      TRIM(STRING(aux_vldebito,"zzz,zz9.99")) + " (" + TRIM(aux_dsdebito[1]) + "), correspondente a " +
				      STRING(crapcdp.prdescon,"zz9") + "% do valor do curso, na minha conta corrente nº " +
				      STRING(crapttl.nrdconta,"zzzz,zzz,9") + ".".
  ELSE
       /* Inscrição de outra pessoa */
	   aux_dsdtexto = "Eu, " + CAPS(TRIM(crapttl.nmextttl)) + " assino este termo, firmando o compromisso de que " +
	                  TRIM(CAPS(crapidp.nminseve)) + " inscrito(a) no curso " +
		              CAPS(TRIM(crapedp.nmevento)) + " promovido pela " + CAPS(TRIM(crapcop.nmrescop)) +
					  ", participará do curso com frequëncia mínima de " +
				      STRING(crapedp.prfreque,"zz9") + "%, caso contrário, autorizo o débito de R$ " +
				      TRIM(STRING(aux_vldebito,"zzz,zz9.99")) + " (" + TRIM(aux_dsdebito[1]) + "), correspondente a " +
				      STRING(crapcdp.prdescon,"zz9") + "% do valor do curso, na minha conta corrente nº " +
				      STRING(crapttl.nrdconta,"zzzz,zzz,9") + ".".
  </script>  
  <table width="90%" align="center" border="0">
    <tr>
	  <td align="left" height="130">
	    <img src="/cecred/images/admin/logo_`TRIM(LC(crapcop.nmrescop))`.gif">
	  </td>
	</tr>
    <tr>
	  <td align="center" valign="bottom" height="80">
	     <b><font size="5">TERMO DE COMPROMISSO</font></b>
	  </td>
	</tr>
    <tr>
	  <td height="80">
	     &nbsp;
	  </td>
	</tr>
	<tr>
	  <td>
	    <div id="div_texto" align="justify">`aux_dsdtexto`</div>
	  </td>
	</tr>
	<tr>
	  <td align="center" valign="bottom" height="120">
	     `FILL("_",50)`
		 <br>
	     `CAPS(crapttl.nmextttl)`	    
	  </td>
	</tr>	
	<tr>
	  <td align="right" valign="bottom" height="100">
	     `TRIM(CAPS(crapage.nmresage))`, `STRING(DAY(TODAY),"99")` de `aux_dsdmeses[MONTH(TODAY)]` de `STRING(YEAR(TODAY),"9999")`.		 
	  </td>
	</tr>
  </table>  
</form>
<script language="JavaScript">
  document.all.div_texto.style.lineHeight=2;
</script>
</body>
</html>
