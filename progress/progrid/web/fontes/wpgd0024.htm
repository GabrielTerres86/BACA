<!--   

         Alteracoes: 12/05/2009 - Incluir campo Cargo (Gabriel). 
         
                     29/06/2009 - Incluído campo aux_flgconvi - "Assina carta convite" (Diego).  
                                 
                                 17/10/2012 - Limitar campo de cargo com 30 caracteres, observacao a 500 e nome a 30 (Gabriel)
                                 
                                 22/10/2012 - Incluso chamada para biblioteca de funções funcoes.js , incluso validação tamanho
                                                          maximo campo Observação usando função ValidaTamanho (Daniel)
         
-->

<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta name="wsoptions" content="no-output">
<title>Facilitadores</title>
<base target="mainFrame">
<link href="/cecred/estilos/progrid.css" rel="stylesheet" type="text/css">
</head>
<body style="margin-left: 3px; ">
<form action="#." method="POST" name="form">
    <input name="aux_cddopcao" type="hidden" value="">    
    <input name="aux_lspermis" type="hidden" value="">    
    <input name="aux_nrdrowid" type="hidden" value="">
    <input name="aux_dsretorn" type="hidden" value="">    
    <input name="aux_stdopcao" type="hidden" value="">    
    <input name="aux_dsendurl" type="hidden" value="">    
    <input name="aux_idevento" type="hidden" value="">          
<script language="JavaScript">
NomeDoProgramaPrincipal  = '/wpgd0024.w';
NomeDoProgramaDeZoom     = '/zwpgd0024.w';
</script>
<script SRC="/cecred/js/funcoes.js"></script>
<!-- Início do modelo geral -->
<div id="Layer1" style="position:absolute; border:0px; width:35px; height:35; z-index:1; left: 25px; top: 2px; visibility: ;"><img src="/cecred/images/icones/ico_fornecedor.gif" width="28" height="32" align="bottom">        </div>
  <table width="575" height="360"  border="0" align="left" cellpadding="0" cellspacing="0" background="/cecred/images/geral/guia_fundo.gif">
    <tr>
      <td width="12"><img src="/cecred/images/geral/guia_esquerda.gif" width="11" height="21"></td>
      <td width="55"><img src="/cecred/images/geral/spacer.gif" width="48" height="10"></td>
      <td width="414" height="20" class="linkGuia">Cadastro de Pessoas para Abertura </td>
      <td width="82" class="linkGuia"><div align="right">wpgd0024</div></td>
      <td width="12" align="right" valign="middle" class="linkGuia"><img src="/cecred/images/geral/guia_direita.gif" width="11" height="21"></td>
    </tr>
    <tr valign="top" bgcolor="#FFFFFF">
      <td colspan="5">
        <table width="100%" height="100%"  border="0" align="left" cellpadding="0" cellspacing="1" bgcolor="#999999">
          <tr>
            <td height="200" valign="top" bgcolor="#FFFFFF">
              <table width="100%" height="100%"  border="0" cellpadding="0" cellspacing="0">
                <tr>
                  <td height="15" align="left">&nbsp;</td>
                  <td height="15" align="left">
                  <!-- Interrupção do modelo geral, início dos dados específicos da tela -->
                    <table width="100%" height="100%"  border="0" align="center" cellspacing="0">
                      <tr>
                        <td colspan="5" align="right" class="NomeCampo">
                          <table width="100%" border="0" cellpadding="0" cellspacing="1">
                            <tr>
                                  <td width="24%" align="right" class="NomeCampo">Cooperativa:</td>
                                  <td width="19%"><select name="aux_cdcooper" class="Campo" id="select2" onChange="document.form.cdcooper.value = document.form.aux_cdcooper.value; document.form.submit();"></select></td>
                                          
                                <td width="9%" align="right" class="NomeCampo">PA:</td>
                                  <td width="27%" align="left"><select name="aux_cdagenci" class="Campo" id="select" onclick="document.form.cdagenci.value = document.form.aux_cdagenci.value;">
                                          </select></td> 
                                  <td width="21%" align="left" class="NomeCampo">Ativo <input type="checkbox" value="on" name="flgativo" onFocus="window.status = 'Permite Incluir.'"></td>
                            </tr>
                            <tr>  
                                  <td align="right" class="NomeCampo">Nome:</td>
                                  <td colspan="8" align="left"><input name="nmabreve" type="text" class="Campo" size="61" maxlength="30" onFocus="window.status = 'Nome do Facilitador.'"></td>
                            </tr>
                            <tr>        
                                <td align="right" class="NomeCampo">Cargo:</td>
                                <td colspan="6" align= "left"><input name="aux_dscrgabr" type="text" class="Campo" size="61" maxlength="30" onFocus="window.status = 'Nome do cargo.'"></td>         
                                </tr>
                                <tr>
                <td align="right" class="NomeCampo">Assina carta convite:</td>
                                <td><select name="aux_flgconvi" class="NomeCampo" onchange="document.form.flgconvi.value = document.form.aux_flgconvi.value;"></select></td>
                                </tr>
                                <tr>                                
                                  <td align="right" class="NomeCampo">Observa&ccedil;&otilde;es:</td>
                                  <td colspan="4" align="left"><textarea name="dsobserv" cols="39" rows="5" class="campoListagemAdmin" id="dsobserv" onKeyUp="ValidaTamanho(this.form.dsobserv,500)" onKeyDown="ValidaTamanho(this.form.dsobserv,500)"></textarea></td>
                            </tr>
                          </table>
                        <td>
                      </tr>
                      <tr>
                        <td height="10" colspan="5" align="center" valign="bottom" class="NomeCampo">
                                                  <table border="0" align="center" cellpadding="1" cellspacing="1">
                          <tr>
                            <th scope="col"><img style="cursor: hand; " src="/cecred/images/botoes/btn_limpar.gif" onClick="return top.frcod.Incluir()"></th>
                            <th scope="col"><img style="cursor: hand; "src="/cecred/images/botoes/btn_salvar.gif" onClick="return top.frcod.Salvar()"></th>
                            <th scope="col"><img style="cursor: hand; "src="/cecred/images/botoes/btn_excluir_botao.gif" onClick="return top.frcod.Excluir()"></th>
                            <th scope="col"><img style="cursor: hand; "src="/cecred/images/botoes/btn_procurar.gif" onClick="return top.frcod.AbreZoom(parent.mainFrame.NomeDoProgramaDeZoom,parent.mainFrame.NomeDoProgramaPrincipal,'','P',document.form.aux_idevento.value,document.form.aux_cdcooper.options[document.form.aux_cdcooper.options.selectedIndex].value)"></th>
                          </tr>
                        </table>
                                                </td>
                      </tr>
                    </table>
                    <!-- Fim dos dados específicos da tela, reinício do modelo geral -->
                  </td>
                </tr>
              </table>
            </td>
          </tr>
        </table>
      </td>
    </tr>
  </table>
</div>
<input name="cdagenci"     type="hidden" value="">
<input name="cdcooper"     type="hidden" value="">
<input name="aux_nrseqdig" type="hidden" value="">
<input name="flgconvi"     type="hidden" value="">   
<!-- Fim do modelo geral -->
</form>
</body>
</html>
<SCRIPT LANGUAGE="JAVASCRIPT">
   NomeDoProgramaPrincipal  = '/wpgd0024.w';
   NomeDoProgramaDeListagem = '/wpgd0024ls.w';
   NomeDoProgramaDeAjuda    = '/wpgd0024aj.w';
   NomeDoProgramaDeZoom     = '/zoom/zwpgd0024.w';
   
   NomeDoProgramaPrincipal = document.form.aux_dsendurl.value + NomeDoProgramaPrincipal;
   document.form.action = NomeDoProgramaPrincipal;

function Habilita()
{
  
}
function HabilitaSalvar()
{
   // habilita os campo para ter os valores no PROGRESS
   document.form.aux_cdcooper.disabled = false;
   document.form.aux_cdagenci.disabled = false;
  
}
function ValidaDados(form)
    { 
        var msg="";
                                         
            msg = msg + top.frcod.VE("ca",form.nmabreve,"Nome do responsável pela abertura","nao");
                
                if (document.form.aux_cdagenci.value == '') {
                   msg = 'O PA deve ser escolhido';
                }
                else
                if (document.form.dsobserv.value.length > 500) {
                        msg = 'A quantidade maxima de caracteres na observação deve ser 500.';
                }
         
        if (msg == "") {
           return true;
                }        
        else {
           top.frcod.MostraResultado('1',msg);
           return false
        }
    }

function LimparCampos()
{   
   document.form.cdagenci.value = '';
   document.form.aux_cdagenci.value = '';
   document.form.nmabreve.value = '';
   document.form.aux_dscrgabr.value = '';
   document.form.aux_flgconvi.value = 1;
   document.form.flgconvi.value = 1;
     
   document.form.dsobserv.value = '';  
   document.form.flgativo.checked = true;
   
   // habilita os campos
   document.form.aux_cdcooper.disabled = false;
   document.form.aux_cdagenci.disabled = false;   
}

function CarregaPrincipal()
    {  
      //top.topFrame.document.all.titulo.innerHTML = 'Cadastro de Locais para Eventos';
    }   

function MostraPACs()
{
   if (document.form.cdcooper.value != '')
      document.form.aux_cdcooper.value = document.form.cdcooper.value;
   else
      document.form.cdcooper.value = document.form.aux_cdcooper.value;
 
   for (var i=document.all.aux_cdagenci.options.length; i>=0; i--)
      document.all.aux_cdagenci.remove(i); 

   var oOption;
   
   for(i=0;i<mpac.length;i++)
   {
      if (mpac[i].cdcooper == document.form.aux_cdcooper.value)
      {
         oOption = document.createElement("OPTION");
         document.all.aux_cdagenci.options.add(oOption);
         oOption.innerText = mpac[i].nmresage.substring(0, 15);
         oOption.value = mpac[i].cdagenci;
      }
   }
   
   // Cria o elemento "TODOS"
   oOption = document.createElement("OPTION");
   document.all.aux_cdagenci.options.add(oOption);
   oOption.innerText = '--- TODOS ---';
   oOption.value = 0;
   
}

function PosicionaPAC()
{
   if(document.form.cdagenci.value != "")
   {
      //document.form.aux_cdeixtem.value = document.form.cdeixtem.value;
      MostraPACs();
      document.form.aux_cdagenci.value = document.form.cdagenci.value;
   }
   else
   {
      // posiciona a seleção no primeiro registro de Cooperativas, se só tiver 1
      if(document.all.aux_cdcooper.options.length == 1)
         document.form.aux_cdcooper.value = document.all.aux_cdcooper.options[0].value;

      // posiciona a seleção no primeiro registro de PACs, se só tiver 1
      if(document.all.aux_cdagenci.options.length == 1)
         document.form.aux_cdagenci.value = document.all.aux_cdagenci.options[0].value;
      else
         document.form.aux_cdagenci.value = '';
   }
}

MostraPACs();
PosicionaPAC();

function MostraOpcao()
{
   if (document.form.flgconvi.value != '') 
      document.form.aux_flgconvi.value = document.form.flgconvi.value;
   else
      document.form.flgconvi.value = 1; 
}

MostraOpcao();

// Desabilita os campos chaves, se estiver posicionado em algum registro
if(document.form.aux_nrdrowid.value != "?")
{

   document.form.aux_cdcooper.disabled = true;
   document.form.aux_cdagenci.disabled = true;
  
}
</SCRIPT>
