<!-----------------------------------------------------------------------------------------------------------
  Alterações: 28/07/2017 - Criaçao da tela, Prj. 322. (Jean Michel) 
              08/02/2018 - PJ 322 - SM 8 - Mateus(Mouts)
			               Permitir incluir participante mesmo com o evento encerrado (desde que não esteja fechada a conatbilização)  
----------------------------------------------------------------------------------------------------------->

<html>
  <head>
    <title>Inscri&ccedil;&otilde;es</title>
    <link href="/cecred/estilos/progrid.css" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="/cecred/css/base/jquery.ui.all.css">    
    <script type="text/javascript" src="/cecred/scripts/scripts.js"></script>	
		<script type="text/javascript" src="/cecred/scripts/jquery.ui.core.js"></script>
    <script type="text/javascript" src="/cecred/scripts/funcoes.js"></script>
    <script src="/cecred/jsbiblio/biblio.js"></script>
    <script src="/cecred/jsbiblio/frcod.js"></script>
    <script src="/cecred/js/funcoes.js"></script>
  </head>
  <body onunload="FechaMens(); " style="margin-left: 3px;">
    <form action="#." method="POST" name="form">
      <input type="hidden" name="aux_dsendurl" value="">
      <input type="hidden" name="pagina" value="">
      <input type="hidden" name="aux_idevento" id="aux_idevento" value="">
      <input type="hidden" name="aux_cddopcao" value="">  
      <input type="hidden" name="aux_nrdrowid" value="">
      <input type="hidden" name="aux_excrowid" value="">
      <input type="hidden" name="aux_lspermis" value="">
      <input type="hidden" name="aux_dsretorn" value="">
      <input type="hidden" name="aux_stdopcao" value="">
      <input type="hidden" name="cdcooper" value="">
      <input type="hidden" name="cdageins" value="">
      <input type="hidden" name="nrseqeve" value="">
      <input type="hidden" name="aux_lsconfir" value="">
      <input type="hidden" name="aux_lscoment" value="">
      <input type="hidden" name="aux_lsfaleve" value="">
      <input type="hidden" name="aux_lsseqdig" id="aux_lsseqdig" value="">
      <input type="hidden" name="cdgraupr" value="">
      <input type="hidden" name="origem" value="">
      <input type="hidden" name="aba" value="">
      <input type="hidden" name="aux_idstaeve" value="">
      <input type="hidden" name="aux_tpinseve" value="">
      <input type="hidden" name="aux_nminseve" value="">
      <input type="hidden" name="aux_flgalter" value="no">
      <input type="hidden" name="aux_flginscr" value="">
      <input type="hidden" name="aux_dsinscri" value="">
      <input type="hidden" name="aux_fechamen" value="">
      <!-- Para o carregamento dos registros em partes -->
      <input type="hidden" name="aux_carregar" value="">
      <input type="hidden" name="aux_reginils" value="">
      <input type="hidden" name="aux_regfimls" value="">
      <input type="hidden" name="aux_nrcpfcgc" value="">
      <input type="hidden" name="aux_nriniseq" id="aux_nriniseq" value="">
      <input type="hidden" name="aux_qtdregis" id="aux_qtdregis" value="">
			<input type="hidden" name="aux_dsurlphp" value="">
      <input type="hidden" name="aux_indicdiv" id="aux_indicdiv" value="">
      <input type="hidden" name="aux_idcookie" id="aux_idcookie" value="">      
      <input type="hidden" name="aux_cdoperad" id="aux_cdoperad" value="">
      <input type="hidden" name="aux_indficin" id="aux_indficin" value="">
			<input type="hidden" name="aux_encerrar" id="aux_encerrar" value="">
            
      <div id="divAguardo"></div>
      
      <script language="JavaScript">
      
        NomeDoProgramaPrincipal = '/wpgd0061.w';
        NomeDoProgramaDeListagem = '/wpgd0061ls.w';
        NomeDoProgramaDeAjuda = '/wpgd0061aj.w';
        NomeDoProgramaDeZoom = '/zoom/zwpgd0061.w';
                
        function aguarde(){
          // abre a janela com a mesagem de aguarde
          showMsgAguardo("Carregando Dados..."); 
        } 
        
        if(minscri.length > 0){
          aguarde();
        }
        
      </script>

      <!-- Inicio do modelo com abas -->
      <div id="Layer1" style="position:absolute; border:0px; width:35px; height:35; z-index:1; left: 25px; top: 2px; visibility: ;"><img src="/cecred/images/icones/ico_fornecedor.gif" width="28" height="32" align="bottom"></div>
        <table width="950" border="0" align="left" cellpadding="0" cellspacing="0" background="/cecred/images/geral/guia_fundo.gif">
          <tr>
            <td width="2%"><img src="/cecred/images/geral/guia_esquerda.gif" width="11" height="21"></td>
            <td width="9%"><img src="/cecred/images/geral/spacer.gif" width="10" height="10"></td>
            <td width="48%" height="20" align="left" class="linkGuia">Inscri&ccedil;&otilde;es</td>
            <td width="39%" height="20" align="right" class="linkGuia">wpgd0061</td>
            <td width="2%" align="right" valign="middle" class="linkGuia"><img src="/cecred/images/geral/guia_direita.gif" width="11" height="21"></td>
          </tr>
          <tr valign="top" bgcolor="#FFFFFF">
            <td colspan="5">
              <table width="99.9%" height="300" border="0" align="left" cellpadding="0" cellspacing="1" bgcolor="#999999">
                <tr>
                  <td height="200" valign="top" bgcolor="#FFFFFF">
                    <table width="99.9%" height="550" border="0" cellpadding="0" cellspacing="0">
                      <tr>
                        <td>&nbsp;</td>
                        <td height="50" align="left" valign="top"> 
                          <table width="100%" height="100%" style="border: 0px solid red;" cellpadding="0" cellspacing="0">
                            <tr>
                              <td class="NomeCampo">&nbsp;</td>
                              <td align="right" class="NomeCampo"> Agenda: </td>
                              <td class="NomeCampo" align="left">
                                <input name="aux_dtanoage" id="aux_dtanoage" type="text" size="5" tabindex="1" onchange=" document.form.submit();">
                              </td>
                              <td colspan="2" class="NomeCampo" align="right">Cooperativa: </td>
                              <td colspan="2" class="NomeCampo" align="left">
                                <select name="aux_cdcooper" id="aux_cdcooper" tabindex="2" class="Campo" onchange="$('#aux_nriniseq').val(1); document.form.aux_dtanoage.value=''; document.form.aux_cddopcao.value=''; document.form.aux_cdagenci.value=''; document.form.submit();"></select>
                              </td>
                              <td colspan="3" align="center" class="NomeCampo">
                                &nbsp;PA:
                                <select name="aux_cdagenci" id="aux_cdagenci" tabindex="3" class="Campo" onchange="$('#aux_nriniseq').val(1); document.form.cdageins.value = document.form.aux_cdagenci.value; if(document.form.origem.value=='') document.form.nrseqeve.value=''; Habilita(); document.form.submit();"></select>
                              </td>                                             
                              <td>&nbsp;</td>
                            </tr>
                            
                            <tr>
                              <td class="NomeCampo">&nbsp;</td> 
                              <td align="right" class="NomeCampo">&nbsp;Evento:</td>
                              <td colspan="9" align="left" class="NomeCampo">
                                <select id="aux_nrseqeve" name="aux_nrseqeve" class="NomeCampo" tabindex="4" onchange="document.form.aux_nrficpre.value = ''; aguarde(); $('#aux_nriniseq').val('1'); carregaInscritos(); "></select>
                              </td>
                            </tr>  
                            
                            <tr>
                              <td align="right" colspan="2" class="NomeCampo" id="FichaPresencaConfirm">
                                Ficha de Presen&ccedil;a:
                              </td>
                              <td colspan="9" align="left" class="NomeCampo" id="FichaPresencaConfirm">
                                <input name="aux_nrficpre" name="aux_nrficpre" maxlength="6" type="text" onKeyUp="formataNum(this,event,'');" class="Campo" size="5">                      
                              </td>
                            </tr>
                            
                            <tr>
                              <td class="NomeCampo">&nbsp;</td>
                              <td align="right" class="NomeCampo" id="ProcuraNome">
                                Pesquisa: 
                              </td>
                              <td colspan="9" align="left" class="NomeCampo" id="ProcuraNome">
                                <select type="text" tabindex="5" class="NomeCampo" name="aux_tpfiltro" onchange="document.form.aux_nminscri.value=''"></select>
                                <input type="text" tabindex="6" name="aux_nminscri" class="NomeCampo" onkeypress="return formataFiltro(event)" style="width:300px">
                              </td>
                            </tr>  
                            
                            <tr>
                              <td align="right" colspan="2" class="NomeCampo" id="OrdenaConsulta">
                                Ordenar Por:
                              </td>
                              <td colspan="9" align="left" class="NomeCampo" id="OrdenaConsulta">
                                <select class="NomeCampo" tabindex="7" id="aux_pesqorde" name="aux_pesqorde" onchange="$('#aux_nriniseq').val('1'); carregaInscritos();"></select>
                              </td>
                            </tr>
                                                        
                            <tr style="text-align: center;">
                              <td colspan="11" id="Procurar">
                                <img style="cursor:hand" tabindex="8" src="/cecred/images/botoes/btn_procurar.gif" name="imgProcurar" id="imgProcurar" onclick="$('#aux_nriniseq').val('1'); carregaInscritos();">
                              </td>
                            </tr>
                            
                            <tr>
                              <td width="10%" align="right" class="NomeCampo">Part. Turma:</td>
                              <td width="10%" class="txtPequeno" align="left">
                                <span class="NomeCampo">
                                  <input name="aux_qtmaxtur" style=" border-width:0px; " type="text" disabled="true" class="txtPequeno" size="6">
                                </span>
                              </td>
                              <td width="10%" align="right" class="txtPequeno">
                                <span class="NomeCampo">Pr&eacute;-Insc.:</span>
                              </td>
                              <td width="10%" align="left" class="txtPequeno">
                                <span class="NomeCampo">
                                  <input name="aux_nrinscri" style=" border-width:0px; " type="text" disabled="true" class="txtPequeno" size="5">
                                </span>
                              </td>
                              <td width="10%" align="right" class="txtPequeno">
                                <div align="right">
                                  <span class="NomeCampo">Confirmados: </span>
                                </div>
                              </td>
                              <td width="10%" align="left" class="txtPequeno">
                                <span class="NomeCampo">
                                  <input name="aux_nrconfir" style=" border-width:0px; " type="text" disabled="true" class="txtPequeno" size="6">
                                </span>
                              </td>
                              <td width="10%" align="right" class="txtPequeno">
                                <div align="right">
                                  <span class="NomeCampo">Compareceram:</span>
                                </div>
                              </td>
                              <td width="10%" align="left" class="txtPequeno">
                                <span class="NomeCampo" style="padding-left:2px;" >
                                  <input name="aux_nrcompar" style=" border-width:0px;padding-left:1px;" type="text" disabled="false" class="txtPequeno" size="6">
                                </span>
                              </td>
															
															<td colspan="2" width="7%" align="right" class="txtPequeno">
																&nbsp;
															</td>
															<td width="13%" align="left" class="txtPequeno" >
																&nbsp;
															</td> 
															
                            </tr>
                                                        
                            <tr style="border: 0px solid black;">
                              <td width="10%" colspan="2" align="right" class="NomeCampo">&nbsp;</td>
                              <td width="10%" colspan="1" align="right" class="NomeCampo">
                                <input name="aux_idademin" type="text" readonly class="txtPequeno" style="border-width:0px; color:#FF0000;padding-left:11px;" size="40">
                              </td>
                              <td width="10%" colspan="1" align="right" class="NomeCampo">&nbsp;</td>
                              <td width="10%" colspan="1" align="right" class="NomeCampo">
                                <input name="aux_flgcompr" type="text" readonly class="txtPequeno" style="border-width:0px; color:#0000FF;padding-left:11px;" size="30">
                              </td>
                              <td width="10%" colspan="1" align="right" class="NomeCampo">&nbsp;</td>
                              <td width="10%" colspan="1" align="right" class="NomeCampo">
                                <input name="aux_tppartic" type="text" readonly class="txtPequeno" style="border-width:0px; color:#0000FF;padding-left:11px;" size="30">
                              </td>
                              <td width="30%" colspan="4" align="left" class="txtPequeno"></td>
                            </tr>                            
                            <tr>
                              <td align="right" colspan="11" class="txtPequeno">&nbsp;</td>
                            </tr>                            
                          </table>
                        </td>
                      </tr>
                    <tr>
                      <td height="10" align="left">&nbsp;</td>
                      <td height="10" align="left" valign="top" bgcolor="#F5F5F5">
                        <!-- Interrupcao do modelo - início das abas -->
                        <table width="100%" border="0" align="left" cellpadding="0" cellspacing="0" bgcolor="#FFFFFF">
                          <tr align="center">
                            <td width="100" height="15" align="left">
                              <table width="100" id="AbaInscrito" border="0" cellpadding="0" cellspacing="0">
                                <tr style="cursor:hand">
                                  <td background="/cecred/images/menu/mnu_nle.gif" width="4" height="21"></td>
                                  <td width="92" align="center" class="txtTituloHid" onclick="document.form.aux_stdopcao.value='i'; mostraDiv('divInscrito')">Pr&eacute;-Inscri&ccedil;&otilde;es</td>
                                  <td background="/cecred/images/menu/mnu_nld.gif" width="4" height="21"></td>
                                </tr>
                              </table>
                            </td>
                            <td width="5">&nbsp;</td>
                            <td width="102" height="15" align="left">
                              <table width="100" id="AbaConfirma" border="0" cellpadding="0" cellspacing="0">
                                <tr style="cursor:hand">
                                  <td background="/cecred/images/menu/mnu_nle.gif" width="4" height="21"></td>
                                  <td width="92" align="center" class="txtTituloHid" onclick="mostraDiv('divConfirma')">Confirma&ccedil;&otilde;es</td>
                                  <td background="/cecred/images/menu/mnu_nld.gif" width="4" height="21"></td>
                                </tr>
                              </table>
                            </td>
                            <td height="15" align="left" style="padding-left:155px;">
															<span class="txtPequeno">
																<input name="aux_flgrest" type="text" readonly class="txtPequeno" style="text-align:left; border-width:0px; color:#990000;" size="60">
															</span>
                            </td>
                            <td width="8">&nbsp;</td>
                          </tr>
                          <tr>
                            <td colspan="5" height="2" align="left" background="/cecred/images/menu/mnu_slc.gif"></td>
                          </tr>
                        </table>
                      </td>
                    <tr>
                      <td height="15" align="left">&nbsp;</td>
                      <td height="100%" align="left" valign="top" bgcolor="#F5F5F5">
                   
                    <div id="divInscrito" align="left">
                      <table width="91%" border="0" align="center" cellspacing="1">
                         <tr>
                           <td width="25" align="right" class="NomeCampo"><img src="/cecred/images/icones/ico_cooperativa.gif" width="19" height="19" align="left"></td>
                            <td colspan="3" align="right" class="NomeCampo"><div align="left"><strong>Cooperado Respons&aacute;vel</strong></div></td>
                         </tr>
                         <tr>
                            <td colspan="4" height="2" align="left" background="/cecred/images/menu/mnu_slc.gif"></td>
                          </tr>
                         <tr>
                           <td align="right" class="NomeCampo">&nbsp;</td>
                          <td align="right" class="NomeCampo">CPF/CNPJ:</td>
                          <td align="left" colspan="2">
                              <div style="float:left;">
                                  <input name="aux_nrcpfcgc_fil" type="text" class="Campo" size="15" maxlength="14" onkeypress="enter(0,event.keyCode);" onkeyup="formataNum(this,event,'');" onblur="BuscaCooperadoCPFCGC();">
                              </div>
                          </td>
                          </tr>                                                    
                          <tr>
														<td align="right" class="NomeCampo">&nbsp;</td>
														<td align="right" class="NomeCampo">Conta:</td>
														<td align="left" colspan="2">
															<div id="divNrdconta" style="float:left;display:block;">
																<input name="nrdconta" type="text" class="Campo" size="10" onblur="Cooperado();" onkeypress="enter(1,event.keyCode);" onkeyup="formataNum(this,event,'.');">
															</div>
															<div id="divNrdconta_Cpfcgc" style="float:left;display:none;">
																<select name="aux_nrdconta_cpfcgc" id="aux_nrdconta_cpfcgc" class="Campo" onchange="SelecionaContaCpfcgc(this.value);" style="width:300"></select>                                                             
															</div>
															<div id="nmprimtl" class="NomeCampo" name="nmprimtl" style="padding-top: 4px;display:block;"></div>
														</td>
													</tr>
													<tr>
														<td align="right" class="NomeCampo">&nbsp;</td>
														<td align="right" class="NomeCampo">Nome:</td>
														<td colspan="2">
															<select name="aux_nmcooper" id="aux_nmcooper" class="Campo" onchange="dadosInscricao(this.value);" style="width:350px"></select>
														</td>
                         </tr>
                         <tr>
														<td align="right" class="NomeCampo">&nbsp;</td>
                            <td align="right" class="NomeCampo">PA:</td>
                            <td colspan="2">
                                <input name="nmresage" type="text" class="Campo" disabled style="width:350px;">
                                <input name="idseqttl" type="hidden" class="Campo" size="3" maxlength="3">
                           </td>
                        </tr>
                        <tr>
                          <td class="NomeCampo" align="right"><img src="/cecred/images/icones/ico_cooperativa.gif" width="19" height="19" align="left"></td>
                          <td colspan="3" align="right" class="NomeCampo"><div align="left"><strong>Dados para a Pr&eacute;-Inscri&ccedil;&atilde;o </strong></div></td>
                        </tr>
                        <tr>
                          <td colspan="4" height="2" align="left" background="/cecred/images/menu/mnu_slc.gif"></td>
                        </tr>
                        <tr>
                          <td class="NomeCampo" align="right">&nbsp;</td>
                          <td class="NomeCampo" align="right">Inscri&ccedil;&atilde;o:</td>
                          <td class="NomeCampo" >
                            <input type="radio" name="tpinseve" onclick="NomeInscricao();" value=2>Outra pessoa
                            <input type="radio" name="tpinseve" onclick="NomeInscricao();" value=1>Pr&oacute;pria
                          </td>                                                        
                          <td colspan="1" align="left" nowrap class="NomeCampo">
                             V&iacute;nculo com o cooperado: <select name="aux_cdgraupr" class="txtPequeno"></select>
                          </td>
                        </tr>
                        <tr>
                          <td class="NomeCampo" align="right">&nbsp;</td>
                          <td class="NomeCampo" align="right">Nome:</td>
                          <td class="NomeCampo" colspan="2" >
                            <input name="nminseve" maxlength="50" type="text" onkeyup="validaString(this,event,'.',true);" class="Campo" size="50">
                          </td>
                        </tr>
                        <tr>
                          <td class="NomeCampo" align="right">&nbsp;</td>
                          <td class="NomeCampo" align="right">E-mail:</td>
						  <td class="NomeCampo" colspan="2" width="100%">
							<input name="dsdemail" maxlength="50" type="text" onkeyup="validaString(this,event,'@.-_',false);" class="Campo" size="45">                                                           
							<span class="NomeCampo" style="padding-left:20px;" >DDD/Fone:</span><input name="nrdddins" type="text" onkeyup="formataNum(this,event,'');" class="Campo" size="3" maxlength="3">
							<input name="nrtelins" type="text" onkeyup="formataNum(this,event,'-');" class="Campo" size="10" maxlength="10">
                          </td>
                      </tr>
                      <tr>
                        <td class="NomeCampo" align="right">&nbsp;</td>
                        <td class="NomeCampo" align="right">Observa&ccedil;&otilde;es:</td>
                        <td class="NomeCampo" colspan="2">
                          <input name="dsobsins" maxlength="4000" type="text" onkeyup="validaString(this,event,',.',true);" class="Campo" size="45">                      
                          <span style="padding-left:20px;"><strong>Dispensar a confirma&ccedil;&atilde;o:</strong>
                          <span>
                          <input type="checkbox" name="flgdispe">
                        </td>                                                         
                      </tr>                               
                      
                      <tr>
                        <td class="NomeCampo" align="right">&nbsp;</td>
                        <td class="NomeCampo" align="right"><div id="fichaPresencaLabel" name="fichaPresencaLabel">Ficha de Presen&ccedil;a:</div></td>
                        <td class="NomeCampo" colspan="2">
                          <div id="fichaPresencaCampo" name="fichaPresencaCampo">
                            <input name="nrficpre" name="nrficpre" maxlength="6" type="text" onKeyUp="formataNum(this,event,'');" class="Campo" size="5">                      
                          </div>
                        </td>                        
                      </tr>                               
                      
                      </table> 
                      <br/><br/><br/><br/><br/>
                      <table border="0" align="center" cellpadding="1" cellspacing="1">
                        <tr height="30" valign="bottom">
                          <th scope="col"><img id="incluir" style="cursor:hand" src="/cecred/images/botoes/btn_limpar.gif" onclick="Incluir();"></th>
                          <th scope="col"><img id="salvar" style="cursor:hand" src="/cecred/images/botoes/btn_salvar.gif" onclick="document.form.aux_carregar.value=''; document.form.aux_regfimls.value=''; document.form.aux_reginils.value=''; return Salvar();"></th>
                        </tr>
                      </table>
                    </div>
                    <div id="divConfirma" align="left">
                      <table border="0" width="100%" height="380">
                        <tr valign="top">
                          <td>
                            <table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
                              <tr>
                                <td height="1" colspan="3"><img src="/cecred/images/geral/spacer.gif" width="21" height="1"></td>
                              </tr>
                              <tr>
                                <td height="27" align="left" colspan="3">
                                  <div style="overflow: auto; height: 340px;">
                                    <table id="tbinscritos" name="tbinscritos" width="100%" border="0" cellpadding="0" cellspacing="0" class="dataTable">
                                      <tr>
                                        <td id="separador1" height="25" width="10" background="/cecred/images/menu/fnd_title.jpg">&nbsp;</td>
                                        <td id="tbinscritos_col1" width="130" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos">Pr&eacute;-Inscrito</td>
                                        <td width="5" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                                        <td id="tbinscritos_col2" width="55" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos">Conta</td>
                                        <td width="5" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                                        <td id="tbinscritos_col3" width="70" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos" >Contato</td>
                                        <td width="5" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                                        <td id="tbinscritos_col4" width="100" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos">PA</td>
                                        <td width="5" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                                        <td id="tbinscritos_col5" width="100" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos">Coment&aacute;rios</td>
                                        <td width="5" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                                        <td id="tbinscritos_col6" width="10" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos" >Situa&ccedil;&atilde;o</td>
                                        <td width="5" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                                        <td id="tbinscritos_col7" width="40" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos" >Excluir</td>
                                        <td width="5" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                                        <td id="tbinscritos_col8" width="60" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos" >Dt.Confirm</td>
                                        <td width="5" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                                        <td id="tbinscritos_col9" width="40" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos" >Ficha</td>
                                        <td width="5" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                                        <td id="tbinscritos_col10" width="40" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos" >Faltas</td>
                                        <td width="5" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                                        <td id="tbinscritos_col11" width="15" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos" >Internet&nbsp;&nbsp;&nbsp;</td>
                                      </tr>
                                    </table>      
                                  </div>
                                </td>
                              </tr>
                              <tr>
                                <td colspan="3" align="right" valign="bottom" scope="col">
                                  <div id="divBotoesReg">                                   
                                    <img id="btnAnterior" name="btnAnterior" style="cursor:hand" src="/cecred/images/botoes/btn_anterior.gif" onclick="carregaRegistros('A');" title="Anterior">
                                    <img id="btnProximo"  name="btnProximo" style="cursor:hand" src="/cecred/images/botoes/btn_posterior.gif" onclick="carregaRegistros('P');" title="Próximo">
                                  </div>
                                </td>
                              </tr>  
                              <tr>
                                <td colspan="3" align="center" valign="bottom" scope="col">
                                  <a href="#" class="botao" id="salvaconfirm" onclick="document.form.aux_carregar.value='proximos'; if(minscri.length>0) document.form.aux_regfimls.value=minscri[0].nrdrowid;return SalvarConfirm()" >Salvar</a>
                                  <a href="#" class="botao" id="encerrar" onclick="document.form.aux_carregar.value='proximos'; if(minscri.length>0) document.form.aux_regfimls.value=minscri[0].nrdrowid; return Encerrar()" >Encerrar Inscri&ccedil;&otilde;es</a>
                                  <a href="#" class="botao" id="indficin"  onclick="geraRelatorioFichaNaoLancada()" >Vizualizar Relat&oacute;rio</a>
                                </td>
                              </tr>
                            </table>
                          </td>
                        </tr>
                      </table>
                    </div>
                  </td>
              </table>
              </div>
            </td>
          </tr>
        </table>
      <!-- Fim dos dados do programa - retorno ao modelo -->
      </td>
    </tr>                                
  </table>
<!-- fim do modelo -->
    </form>
    <script language="JavaScript">

      NomeDoProgramaPrincipal = document.form.aux_dsendurl.value + NomeDoProgramaPrincipal;
      document.form.action = NomeDoProgramaPrincipal;
	  var nomeaba = 'AbaInscrito';
	  
      function semAspas(obj) {
        var txt = new String(obj.value);
        var res = new String('');
                for (var i = 0; i < txt.length; i++) {
                    if (txt.charAt(i) != '"' && txt.charAt(i) != "'") {
                        res += txt.charAt(i);
                }
        }
        obj.value = res;
        return true;
      }

      function formataFiltro(e) {
        if (document.form.aux_tpfiltro.value == 2) {
        var tecla = (window.event) ? event.keyCode : e.which;
        if ((tecla > 47 && tecla < 58)) return true;
        else {
          if (tecla == 8 || tecla == 0) return true;
          else return false;
        }
      }
    }

      function MostraInscritos() {

        var row; var cell;
        var cor = '#F7F7F7';

        for (var i = document.all.tbinscritos.rows.length; i > 1; i--){
          document.all.tbinscritos.deleteRow(i - 1);
        }
        
        if (minscri.length <= 0) {

          $("#salvaconfirm").hide();
          $("#encerrar").hide();
          $("#btnAnterior").hide();
          $("#btnProximo").hide();
        }else{
          if($("#aux_nriniseq").val() == 1){
            $("#btnAnterior").hide();
          }else{
            $("#btnAnterior").show();
          }
                  
          if(parseInt($("#aux_qtdregis").val()) < parseInt($("#aux_nriniseq").val()) + 100){
            $("#btnProximo").hide();
          }else{
            $("#btnProximo").show();
          }              
        }
              
        for (i = 0; i < minscri.length; i++) {
          
          if ((document.form.aux_cdcooper.value == minscri[i].cdcooper) &&
             (document.form.aux_cdagenci.value == minscri[i].cdageins) &&
              (document.form.aux_nrseqeve.value == minscri[i].nrseqeve)) {
                
            row = tbinscritos.insertRow();
        
            if (cor == '#FFFFFF'){
                cor = '#D1CFCF';
            }else{
                cor = '#FFFFFF';
            }
            
            row.bgColor = cor;
        
            //Inscrito   Cooperado   Vínculo   Contato   Comentários   Confirmar   Data Confirmação   
             
            cell = row.insertCell();   // Separador
            cell.className = 'txtNormal';
            cell.width = document.all.separador1.width;
            cell.height = 26;
            cell.align = 'left';
            cell.innerText = '';

            // Inscrito
            cell = row.insertCell();
            cell.className = 'txtPequeno';
            cell.height = 26;
            cell.align = 'left';
            cell.width = document.all.tbinscritos_col1.width;
            linky = '&nbsp;' + minscri[i].nminseve + '<in' + 'put type="hidden" class="nrseqdig" name="aux_nrseqdig" value="' + minscri[i].nrseqdig + '">';
                          
            cell.innerHTML = linky;

            //separador          
            cell = row.insertCell();
            cell.className = 'txtNormal';
            cell.width = "5";
            cell.height = 26;
            cell.align = 'left';
            cell.innerText = '';

            // Cooperado
            cell = row.insertCell();
            cell.className = 'txtPequeno';
            cell.height = 26;
            cell.align = 'left';
            cell.width = document.all.tbinscritos_col2.width;
            cell.title = minscri[i].nmextttl; 
            cell.innerText = minscri[i].nrdconta;
            
            //separador     
            cell = row.insertCell();
            cell.className = 'txtNormal';
            cell.width = "5";
            cell.height = 26;
            cell.align = 'left';
            cell.innerText = '';

            // Contato
            cell = row.insertCell();
            cell.className = 'txtPequeno';
            cell.align = 'left';
            cell.width = document.all.tbinscritos_col3.width;
            cell.innerText = '(' + minscri[i].nrdddins + ')' + minscri[i].nrtelins;

            cell = row.insertCell();   // Separador
            cell.className = 'txtNormal';
            cell.width = "5";
            cell.height = 26;
            cell.align = 'left';
            cell.innerText = '';
        
            // PA
            cell = row.insertCell();
            cell.className = 'txtPequeno';
            cell.align = 'left';
            cell.width = document.all.tbinscritos_col4.width;
            cell.innerText = minscri[i].nmresage;

            cell = row.insertCell();   // Separador
            cell.className = 'txtPequeno';
            cell.width = "5";
            cell.height = 26;
            cell.align = 'left';
            cell.innerText = '';
             
            // Comentários
            cell = row.insertCell();
            cell.className = 'txtPequeno';
            cell.align = 'left';
            cell.width = document.all.tbinscritos_col5.width;
            linky = '<in' + 'put type="text" name="dsobsconf" size="15" onKeyUp="validaString(this,event,\'.,\',true);" class="Campo" onChange="document.form.aux_flgalter.value=' + "'yes'" + '" value="' + minscri[i].dsobsins + '">';
            cell.innerHTML = linky;

            cell = row.insertCell();   // Separador
            cell.className = 'txtPequeno';
            cell.width = "5";
            cell.height = 26;
            cell.align = 'left';
            cell.innerText = '';
                  
            // Confirmar
            cell = row.insertCell();
            cell.className = 'txtPequeno';
            cell.align = 'left';
            cell.width = document.all.tbinscritos_col6.width;
                     
            linky = '<se' + 'lect name="confirma" class="Campo seleciona" onChange="ValidaAlterSituac(this,' + minscri[i].idstains + ');document.form.aux_flgalter.value=' + "'yes'" + '">';
            for (j = 0; j < mstatus.length; j++) {
               
              linky = linky + '<option value="' + mstatus[j].cdstatus + '"  ';
              if (minscri[i].idstains == mstatus[j].cdstatus){
                linky = linky + 'selected';
              }
              linky = linky + '>' + mstatus[j].dsstatus + '</option>';
            }
            cell.innerHTML = linky;
        
            // Separador
            cell = row.insertCell();
            cell.className = 'txtNormal';
            cell.width = "5";
            cell.height = 26;
            cell.align = 'left';
            cell.innerText = '';
                                         
            // Botão de Excluir                    
            cell=row.insertCell();   
            cell.className = 'txtNormal';
            cell.align = 'center';
            cell.height = 26;         
            cell.width = document.all.tbinscritos_col7.width;
            linky='<a href="#." onClick="ExcluirInscricao(\'' + minscri[i].nrdrowid +'\' , \''+ minscri[i].nminseve +'\');" class="linkGuia"><img src="/cecred/images/botoes/btn_excluir.gif" border="0" title="Excluir"></a>';                    
            cell.innerHTML=linky;                                                                                 

            // Separador
            cell = row.insertCell();
            cell.className = 'txtNormal';
            cell.width = "5";
            cell.height = 26;
            cell.align = 'left';
            cell.innerText = '';

            // Data Confirmação
            cell = row.insertCell();
            cell.className = 'txtPequeno';
            cell.width = document.all.tbinscritos_col8.width;
            cell.align = 'left';
            cell.innerText = minscri[i].dtconins;

            // Separador
            cell = row.insertCell();
            cell.className = 'txtNormal';
            cell.width = "5";
            cell.height = 26;
            cell.align = 'left';
            cell.innerText = '';

            // Ficha de Presenca
            cell = row.insertCell();
            cell.className = 'txtPequeno';
            cell.width = document.all.tbinscritos_col9.width;
            cell.align = 'left'; 
			if(minscri[i].nrficpre == 0){
				cell.innerHTML = "";
			}else{
				cell.innerHTML = minscri[i].nrficpre;
			}
                        
            // Separador
            cell = row.insertCell();
            cell.className = 'txtNormal';
            cell.width = "5";
            cell.height = 26;
            cell.align = 'left';
            cell.innerText = '';

            // Qtde. Faltas
            cell = row.insertCell();
            cell.className = 'txtPequeno';
            cell.width = document.all.tbinscritos_col10.width;
            cell.align = 'left';                    
            linky = '<in' + 'put type="text" name="qtfaleve" size="2" maxlength="2" style="text-align:right" onblur="ValidaAlterfalta(this,' + minscri[i].qtfaleve + ');" onKeyUp="formataNum(this,event,\'\');" class="Campo"  value="' + minscri[i].qtfaleve + '">';
            cell.innerHTML = linky;

            cell = row.insertCell();   // Separador
            cell.className = 'txtPequeno';
            cell.width = "5";
            cell.height = 26;
            cell.align = 'left';
            cell.innerText = '';

            // Inscrição vinda pela internet
            cell = row.insertCell();
            cell.className = 'txtPequeno';
            cell.height = 26;
            cell.align = 'center';
            cell.width = document.all.tbinscritos_col11.width;
            
            if (minscri[i].flginsin == 'Sim'){
              cell.title = "Inscrição efetuada pela Internet em " + minscri[i].dtpreins; 
            }else{
              cell.title = "Inscrição efetuada pelo Atendente em " + minscri[i].dtpreins;           
            }
						
            cell.innerText = minscri[i].flginsin;
                      
            // guarda o ROWID do 1s da lista
            if (i == 0){
              document.form.aux_reginils.value = minscri[i].nrdrowid;
            }
            
            // guarda o ROWID do último da lista
            if (i == minscri.length - 1){
              document.form.aux_regfimls.value = minscri[i].nrdrowid;                  
            }
            
          }
        } // fim do for
                
        // linha de final da listagem se nao tiver 101 linhas
        // 100 registros e 1 da Linha de Cabeçalho
        if (document.all.tbinscritos.rows.length  != 101) {
          row = tbinscritos.insertRow();
        
          if (cor == '#FFFFFF'){
            cor = '#F7F7F7';
          }else{
            cor = '#FFFFFF';
          }
          
          row.bgColor = cor;
          
          cell = row.insertCell();
          cell.className = 'txtPequeno';
          cell.height = 26;
          cell.align = 'center';
          cell.width = '100%';
          cell.colSpan = 20;
          cell.innerText = 'Fim da listagem';
        
        }
    }

    function CarregaPrincipal() {
      window.status = "";
    }

    function LimparCampos() {
      document.form.nrdconta.value = '0';
      document.form.idseqttl.value = '0';
      document.form.aux_nmcooper.value = '';
      document.form.aux_nrdconta_cpfcgc.value = '';
      document.form.nmresage.value = '';
      document.form.aux_nrdrowid.value = '?';
      document.form.tpinseve[1].checked = true;
      document.form.aux_tpinseve.value = '1'; 
      document.form.nminseve.value = '';
      document.form.nminseve.readOnly = false;
      document.form.aux_cdgraupr.value = "9";
      document.form.aux_cdgraupr.disabled = true;
      document.form.dsdemail.value = '';
      document.form.nrdddins.value = '';
      document.form.nrtelins.value = '';
      document.form.aux_nminseve.value = '';
      document.form.dsobsins.value = '';
      document.form.aux_nrcpfcgc_fil.value = '';
      document.form.aux_nrcpfcgc_fil.disabled = false;  
				
			//document.form.aux_nrficpre.value = '';
      document.form.nrficpre.value = '';
    }

    function Habilita() {
      document.form.aux_dtanoage.disabled = false;
      document.form.aux_cdagenci.disabled = false;
      document.form.aux_cdcooper.disabled = false;
      document.form.aux_nrseqeve.disabled = false;
      document.form.aux_nminseve.value = document.form.nminseve.value;
    }

    function ValidaDados(form) { 

      var msg = "";
	  
      if (document.form.aux_fechamen.value == 'Sim') {
          alert("Mês do evento fechado para contabilização.")
          return false;
      }    
	  
      // verifica se as inscrições já estão encerradas.
	  
	  //Início PJ322 - SM 8
	    // O código abaixo foi comentado
	  
        //if (document.form.aux_idstaeve.value == "4"){
        //  alert("Evento com inscrições encerradas. Inclusão de novas inscrições não permitida!")
        //  return false;
        //}	  
	  
	    //E substituído por este
	  
        if (document.form.aux_idstaeve.value == "4") {
          if (!confirm("Evento com inscrições encerradas. Deseja prosseguir com a pré-inscrição?")) 
            return false; 
        }      
	    //Fim PJ322 - SM 8	  
		
       // já possui inscrição
      if (document.form.aux_flginscr.value == "S") {
        alert("O cooperado já possui inscrições nesse evento sob sua responsabilidade. São elas : " + document.form.aux_dsinscri.value + "\nInclusão duplicada não permitida!")
          return false; 
      }

        // Rosangela - Fim  
       // Se evento estiver cancelado, não pode fazer nada.
       if (document.form.aux_idstaeve.value == "2") {
          alert("Evento está cancelado. Inscrições não são permitidas.");
          return false;
       }

       // Se o evento é exclusivo para cooperados e está sendo inscrito um não cooperado, tem que confirmar
       if ((document.form.aux_tppartic.value == "EXCLUSIVO A COOPERADOS") &&
           (document.form.tpinseve[0].checked)){
        if (confirm("Evento é exclusivo para cooperados. Confirma inscrição de um não cooperado?") == false){
          return false;
        }
       }

       if (document.form.aux_cdcooper.value == "")
           msg = "Cooperativa deve ser selecionada.";

       if (document.form.aux_cdagenci.value == "")
           msg = "PA deve ser selecionado.";

       if (document.form.aux_nrseqeve.value == "") { 
          alert("Evento não selecionado"); 
          LimparCampos()
          document.form.aux_nrseqeve.focus();
          return false; 
        }
          
        if ((document.form.aux_nmcooper.value == "") && (document.form.tpinseve[1].checked))
            msg = "Cooperado deve ser informado.";

        if (document.form.nminseve.value == "") 
           msg = "Nome do inscrito deve ser informado.";
        
        if(document.form.dsdemail.value != "" && !validaEmail(document.form.dsdemail.value)){
          msg = "Informe um email válido.";
        }
            
        if(document.form.nrtelins.value.length < 8 && document.form.dsdemail.value == "" ){
          msg = "Email ou Telefone devem ser informados.";
        }
       
        if(document.form.nrdddins.value.length < 2 && document.form.nrdddins.value != ""){
          msg = msg + "Informe um DDD válido.\r";
        }
        
        if(document.form.nrtelins.value.length <= 7  && document.form.nrtelins.value != ""){
          msg = msg + "Informe um Telefone válido.\r";
        }
        
        msg = msg + VE("in", form.nrdddins, "O DDD do telefone", "sim", "0", "99");
        msg = msg + VE("in", form.nrtelins, "O Telefone", "sim", "0", "9999999999");

        if (msg == ""){
          return true
        }else {
          alert(msg);          
          return false
       }
    }

    function Recarrega() {
       
       VarURL = NomeDoProgramaPrincipal + '?LinkRowid=' + document.form.aux_nrdrowid.value + '&pagina=' + document.form.pagina.value;
                window.open(VarURL, 'mainFrame', 'toolbar=no,location=no,diretories=no,status=no,menubar=no,scrollbars=no,resizable=yes,width=600,height=300');
       LimparCampos();
    }

    function mostraDiv(nomediv) {   
      
      verificaTipoEvento();
      
      if (nomediv == 'divConfirma') {
        $("#aux_indicdiv").val("1");
        document.all.ProcuraNome[0].style.visibility = "visible";
        document.all.ProcuraNome[1].style.visibility = "visible";
        document.all.OrdenaConsulta[0].style.visibility = "visible";
        document.all.OrdenaConsulta[1].style.visibility = "visible";
        document.all.Procurar.style.visibility = "visible";
		if($("#aux_nrseqeve").children(":selected").attr("tpevento") == 7 ||
           $("#aux_nrseqeve").children(":selected").attr("tpevento") == 12){
			document.all.FichaPresencaConfirm[0].style.visibility = "visible";
			document.all.FichaPresencaConfirm[1].style.visibility = "visible";
		}
      }else {
        $("#aux_indicdiv").val("0");
        document.all.ProcuraNome[0].style.visibility = "hidden";
        document.all.ProcuraNome[1].style.visibility = "hidden";
        document.all.OrdenaConsulta[0].style.visibility = "hidden";
        document.all.OrdenaConsulta[1].style.visibility = "hidden";
        document.all.Procurar.style.visibility = "hidden";
        document.all.FichaPresencaConfirm[0].style.visibility = "hidden";
        document.all.FichaPresencaConfirm[1].style.visibility = "hidden";
      }
      
      if (nomediv == '') { nomediv = 'divInscrito'; }
      if (nomediv == 'divInscrito') { nomeaba = 'AbaInscrito'; }
      if (nomediv == 'divConfirma') { nomeaba = 'AbaConfirma'; }
       
      document.form.pagina.value = nomediv;
      document.all.divInscrito.style.display = 'none';
      document.all.divConfirma.style.display = 'none';   

      document.all.AbaInscrito.rows[0].cells[0].background = "/cecred/images/menu/mnu_nle.gif";
      document.all.AbaInscrito.rows[0].cells[1].background = "/cecred/images/menu/mnu_nlc.gif";
      document.all.AbaInscrito.rows[0].cells[2].background = "/cecred/images/menu/mnu_nld.gif";
      document.all.AbaInscrito.rows[0].cells[1].className = "txtTituloHid";

      document.all.AbaConfirma.rows[0].cells[0].background = "/cecred/images/menu/mnu_nle.gif";
      document.all.AbaConfirma.rows[0].cells[1].background = "/cecred/images/menu/mnu_nlc.gif";
      document.all.AbaConfirma.rows[0].cells[2].background = "/cecred/images/menu/mnu_nld.gif";
      document.all.AbaConfirma.rows[0].cells[1].className = "txtTituloHid";

      document.all[nomeaba].rows[0].cells[0].background = "/cecred/images/menu/mnu_sle.gif";
      document.all[nomeaba].rows[0].cells[1].background = "/cecred/images/menu/mnu_slc.gif";
      document.all[nomeaba].rows[0].cells[2].background = "/cecred/images/menu/mnu_sld.gif";
      document.all[nomeaba].rows[0].cells[1].className = "txtTituloVis";

      document.all[nomediv].style.display = 'block';   
      
    }

    function MostraPACs() {
      for (var i = document.all.aux_cdagenci.options.length; i >= 0; i--){
        document.all.aux_cdagenci.remove(i); 
      }

      var oOption;
       
      for (i = 0; i < mpac.length; i++) {
        if (mpac[i].cdcooper == document.form.aux_cdcooper.value) {
          oOption = document.createElement("OPTION");
          document.all.aux_cdagenci.options.add(oOption);
          oOption.innerText = mpac[i].nmresage.substring(0, 15);
          oOption.value = mpac[i].cdagenci;
        }
      }
      document.form.aux_cdagenci.value = '';
    }

    function PosicionaPAC(){
      MostraPACs();
      document.form.aux_cdagenci.value = document.form.cdageins.value;       
    }

    function MostraEventos() {   
        
      /* Mensagem quando não há eventos */
      if ((mevento.length == 0) && (document.form.aux_cdagenci.value != '')) {
        alert('Não há eventos agendados para fazer inscrições!');
        return false;
      } 
        
			for (var i = document.all.aux_nrseqeve.options.length; i >= 0; i--){
				document.all.aux_nrseqeve.remove(i);  
			}
			
			var oOption;
       
      for (i = 0; i < mevento.length; i++) {
               
        if ((mevento[i].cdcooper == document.form.aux_cdcooper.value) &&
            (mevento[i].cdagenci == document.form.aux_cdagenci.value)) {
              
          oOption = document.createElement("OPTION");
          document.all.aux_nrseqeve.options.add(oOption);
          oOption.innerText = mevento[i].nmevento;
          oOption.value = mevento[i].nrseqeve;
          oOption.tpevento = mevento[i].tpevento;
        }

        // ASSMEBLEIA
        if ((mevento[i].cdcooper == document.form.aux_cdcooper.value) &&
            (mevento[i].cdagenci == 0)){

          oOption = document.createElement("OPTION");
          document.all.aux_nrseqeve.options.add(oOption);
          oOption.innerText = mevento[i].nmevento;
          oOption.tpevento = mevento[i].tpevento;
          oOption.value = mevento[i].nrseqeve;
        }
      }

      document.form.aux_nrseqeve.value = '';

      if (document.form.aux_cdagenci.value == '') {

        oOption = document.createElement("OPTION");
        document.all.aux_nrseqeve.options.add(oOption);
        oOption.innerText = "-Selecione PA-";
        oOption.value = '0';
        document.form.aux_nrseqeve.value = '0';
      }

      document.form.aux_nrseqeve.value = '';
      MostraPartic();
       
    }

    function PosicionaEventos() {
      
       MostraEventos();
       document.form.aux_nrseqeve.value = document.form.nrseqeve.value;
       MostraPartic();      
       
       /* Verifica se o evento selecionado encontra-se fechado */ 
                for (i = 0; i < mevento.length; i++) {
          
          if (mevento[i].nrseqeve == document.form.aux_nrseqeve.value) {
             document.form.aux_fechamen.value = mevento[i].fechamen;  
             
             /* converte data para string e depois converte para data novamente, pois o 
             javascript nao entende se usar direto a data que retorna do outro programa */
             var auxl1 = mevento[i].dtfineve.split("/");
             var auxl2 = mevento[i].dtmvtolt.split("/");
                        var dtfin = new Date(auxl1[2], auxl1[1], auxl1[0]);
                        var dthoj = new Date(auxl2[2], auxl2[1], auxl2[0]);
             
             /* se evento ja tiver ocorrido deixa checkbox como true. lucas r*/
                        if (dtfin < dthoj) {
                checked(document.form.flgdispe); /* evento ja aconteceu */
                        } else {
                unchecked(document.form.flgdispe);  /* evento nao aconteceu  */
             }  
          }
       }
    }

    function MostraPartic() {

      for (i = 0; i < mevento.length; i++) {

        if (((mevento[i].cdcooper == document.form.aux_cdcooper.value) &&
             (mevento[i].cdagenci == document.form.aux_cdagenci.value) &&
             (mevento[i].nrseqeve == document.form.aux_nrseqeve.value)) ||
             ((mevento[i].cdcooper == document.form.aux_cdcooper.value) &&
             (mevento[i].cdagenci == "0") &&
             (mevento[i].nrseqeve == document.form.aux_nrseqeve.value))) {
               document.form.aux_tppartic.value = mevento[i].tppartic;
               document.form.aux_flgcompr.value = mevento[i].flgcompr;
               document.form.aux_flgrest.value = mevento[i].flgrest;
               document.form.aux_idstaeve.value = mevento[i].idstaeve;
               document.form.aux_qtmaxtur.value = mevento[i].qtmaxtur;
               document.form.aux_nrinscri.value = mevento[i].nrinscri;
               document.form.aux_nrconfir.value = mevento[i].nrconfir;
               document.form.aux_nrcompar.value = mevento[i].nrcompar;
               document.form.aux_idademin.value = mevento[i].idademin;
               document.form.cdcooper.value = document.form.aux_cdcooper.value;
               document.form.cdageins.value = document.form.aux_cdagenci.value;
               document.form.nrseqeve.value = document.form.aux_nrseqeve.value;	 
               
               MostraInscritos();
               
          }
       }
    }

    function FocaCampo() {       
      document.form.aux_cddopcao.value = 'in';
      document.form.aux_stdopcao.value = 'i'

      LimparCampos();

      document.form.submit(); 
      document.form.nrdconta.focus();
      mostraDiv(document.form.pagina.value);
    }

    function Incluir() {
        
			var vaux = document.form.aux_lspermis.value; 
      
			if (vaux.substring(0, 1) == 'I') {
				document.form.nrdconta.focus();
        document.form.aux_cddopcao.value = 'in';
        document.form.aux_stdopcao.value = 'i'
				LimparCampos();
				document.form.submit(); 
				mostraDiv(document.form.pagina.value);
				return true;
			}else {
				MostraResultado('1', 'Desculpe, mas você não tem permissão para executar esta função.');
        return false;
			}
    }

		function Salvar(){
         
			var vaux = document.form.aux_lspermis.value; 
      document.form.aux_cddopcao.value = "";
			
      /* Se preencher Conta ou Titularidade, preencher obrigatoriamente os dois campos */ 
      if ((document.form.nrdconta.value == '0' || document.form.nrdconta.value == '') && (document.form.idseqttl.value != '') ||
          (document.form.nrdconta.value != '0' && document.form.nrdconta.value != '') && (document.form.idseqttl.value == '') ||
          (document.form.nrdconta.value != '0' && document.form.nrdconta.value != '') && (document.form.idseqttl.value == '0')) {

        if(document.form.aux_tpinseve.value != '2'){
          alert('Conta e Titularidade devem ser informadas.');
          return false;
        }
      }
       
      /* Se for conta inválida */ 
      if (document.form.nrdconta.value != '0' && document.form.nrdconta.value != '' && document.form.aux_nmcooper.value == '') {
          document.form.submit(); 
          return false; 
      }
       
      if(((document.form.nrficpre.value == '0' || document.form.nrficpre.value == '') && $("#aux_indicdiv").val() == 0 && document.getElementById("flgdispe").checked)){
        if($("#aux_nrseqeve").children(":selected").attr("tpevento") == 7 ||
           $("#aux_nrseqeve").children(":selected").attr("tpevento") == 12){
          alert('Número da Ficha de Presença deve ser informado.');
          return false;
        }
      }
					
      if ((vaux.substring(1, 2) == 'A') || (document.form.aux_stdopcao.value == 'i')) {
        if (document.form.aux_cddopcao.value != 'sa') {
          if (ValidaDados(document.forms[0])) {
            Habilita();
            document.form.aux_cddopcao.value = 'sa';
            status = 'Salvando. Por favor, aguarde ...';  
            document.form.submit(); 
            return true;
          } else {
            return false;
          }
        } 
      } else {
        MostraResultado('1', 'Desculpe, mas você não tem permissão para executar esta função.');
        return false;
      }
      
      LimparCampos(); 
      document.form.submit(); 
      mostraDiv(document.form.pagina.value);
    }

    function AbreZoom(ProgramaDeZoom, ProgramaPrincipal, NomeDoCampo, TipoDeZoom, ValorCampo, ValorCampo2, ValorCampo3, ValorCampo4, ValorCampo5, ValorCampo6) {

          status = 'Processando pesquisa. Por favor, aguarde ...'; 
                if (ValorCampo == null) ValorCampo = "";
          if (ValorCampo2 == null) ValorCampo2 = "";
          if (ValorCampo3 == null) ValorCampo3 = "";
          if (ValorCampo4 == null) ValorCampo4 = "";
          if (ValorCampo5 == null) ValorCampo5 = "";
          if (ValorCampo6 == null) ValorCampo6 = "";
                if (ValorCampo != "") ValorCampo = Substituir(ValorCampo);
                if (ValorCampo2 != "") ValorCampo2 = Substituir(ValorCampo2);
                if (ValorCampo3 != "") ValorCampo3 = Substituir(ValorCampo3);
                if (ValorCampo4 != "") ValorCampo4 = Substituir(ValorCampo4);
                if (ValorCampo5 != "") ValorCampo5 = Substituir(ValorCampo5);
                if (ValorCampo6 != "") ValorCampo6 = Substituir(ValorCampo6);
          ProgramaPrincipal = Substituir(ProgramaPrincipal);   
          ProgramaDeZoom = document.form.aux_dsendurl.value + ProgramaDeZoom;   
                varurl = ProgramaDeZoom + '?Pesquisa=' + TipoDeZoom +
                                          '&vprograma=' + ProgramaPrincipal +
                                    '&NomeDoCampo=' + NomeDoCampo + 
                                          '&ValorCampo=' + ValorCampo +
                                    '&ValorCampo2=' + ValorCampo2 + 
                                    '&ValorCampo3=' + ValorCampo3 + 
                                    '&ValorCampo4=' + ValorCampo4 + 
                                    '&ValorCampo5=' + ValorCampo5 + 
                                    '&ValorCampo6=' + ValorCampo6;
                WZoom = window.open(varurl, 'WZoom', 'toolbar=no,location=no,diretories=no,status=no,menubar=no,scrollbars=no,resizable=yes,width=580,height=350,screenX=0,screenY=0,top=10,left=10');
          WZoom.focus();          
       }
       
        function Cooperado(){
        
          if (document.form.nrdconta.value != '0' && document.form.nrdconta.value != '') {
            if (document.form.aux_nrseqeve.value == "") { 
              alert("Evento não selecionado"); 
              LimparCampos()
              document.form.aux_nrseqeve.focus();
              return false; 
            }
            document.form.aux_cdcooper.disabled = false;
            document.form.submit();
          }
        }


    function NomeInscricao() {
                var aux_idseqttl = document.form.aux_nmcooper.value;
       
                /* Próprio */
       if (document.form.tpinseve[1].checked == true) {

                    document.form.nminseve.value = document.form.aux_nmcooper.value;
          document.form.nminseve.readOnly = true;
                    /* Nenhum */
          document.form.aux_cdgraupr.value = "9";
          document.form.aux_cdgraupr.disabled = true;
          document.form.flgdispe.disabled = false;
          document.form.aux_tpinseve.value = '1';

                    if (aux_idseqttl != "") {
                        dadosInscricao(aux_idseqttl);
                    }

                } else { /* Outra pessoa */
          document.form.nminseve.value = document.form.aux_nminseve.value;
          document.form.nminseve.readOnly = false;
          document.form.aux_cdgraupr.value = document.form.cdgraupr.value;
                    if(document.form.nrdconta.value == '0' || document.form.nrdconta.value == ''){
                      document.form.aux_cdgraupr.disabled = true;
                    }else{
          document.form.aux_cdgraupr.disabled = false;
                    }
          document.form.flgdispe.disabled = false;
          document.form.aux_tpinseve.value = '2';
          document.form.aux_flginscr.value = 'N'; 
       }
    }

    function SalvarConfirm() {

			// Verifica se o usuário tem permissão de salvar
			if (document.form.aux_lspermis.value.substring(1, 2) != 'A') {
				alert('Desculpe, mas você não tem permissão para executar esta função.'); 
				return false;
			}

			if (document.form.aux_idstaeve.value == "4") {
				if (!confirm("Evento com inscrições encerradas. Deseja prosseguir com as alterações?")) 
					return false; 
			}

			if (document.form.aux_idstaeve.value == "5") {
				if (!confirm("Evento já realizado. Deseja prosseguir com as alterações?"))
					return false; 
			}


			document.form.aux_cddopcao.value = 'conf';
			document.form.aux_stdopcao.value = '';

			ArmazenaConfirm(); //nao tirar esta chamada deste lugar se nao da pau
			document.form.submit();
			Habilita();
			LimparCampos();
		}

    function ArmazenaConfirm() {
       
       var registros = 0;
       var confirma = 0;
       
       document.form.aux_lsconfir.value = '';
       document.form.aux_lsseqdig.value = '';
       document.form.aux_lscoment.value = '';
       document.form.aux_lsfaleve.value = '';
       
       confirma = $(".seleciona").length;
       registros = $(".nrseqdig").length;
          
       if (document.all.tbinscritos.rows.length < 1) {
         alert("Não há inscritos"); 
         return false; 
       }

       if (document.form.aux_cdcooper.value == "") { 
         alert("Cooperativa não selecionada"); 
         return false; 
       }

       if (document.form.aux_cdagenci.value == "") { 
         alert("PA não selecionado"); 
         return false; 
       }

       if (document.form.aux_nrseqeve.value == "") { 
          alert("Evento não selecionado"); 
          LimparCampos()
          document.form.aux_nrseqeve.focus();
          return false; 
        }
         
       if (registros > 0) {
              
         for (i = 0; i < registros; i++) {

           if (confirma >= 1){	 
             
             if (document.form.aux_lsconfir.value != '') {
               document.form.aux_lsseqdig.value += ",";
               document.form.aux_lsconfir.value += ",";
               document.form.aux_lscoment.value += "§";
               document.form.aux_lsfaleve.value += "§";                        
             }   
             
             if(registros > 1){
             
               document.form.aux_lsseqdig.value += document.form.aux_nrseqdig[i].value;
               document.form.aux_lsconfir.value += document.form.confirma[i].value;
               document.form.aux_lscoment.value += document.form.dsobsconf[i].value;
               document.form.aux_lsfaleve.value += document.form.qtfaleve[i].value;
             }else{
               document.form.aux_lsseqdig.value = document.form.aux_nrseqdig.value;
               document.form.aux_lsconfir.value = document.form.confirma.value;
               document.form.aux_lscoment.value = document.form.dsobsconf.value;   	   
               document.form.aux_lsfaleve.value = document.form.qtfaleve.value;
             }         
           }
         }
       }
       
       // Caso somente haja 1 registro
       if (document.all.tbinscritos.rows.length == 2) {
         document.form.aux_lsseqdig.value = document.form.aux_nrseqdig.value;
         document.form.aux_lsconfir.value = document.form.confirma.value;
         document.form.aux_lscoment.value = document.form.dsobsconf.value;   	   
         document.form.aux_lsfaleve.value = document.form.qtfaleve.value;
       }
        
       return true;
    }

		// Funcao: VE(Valida Elemento)
    // Objetivo: verificar se um elemento(componente) está no formato adequado (caracter, inteiro, data, decimal)
    // Parametros de entrada:
    //    tc = tipo do componente. "ca":caracter, "da":data, "de":decimal, "in":inteiro
    //    nc = nome do componente.
    //    lc = label do componente.
    //    pn = componente pode ser nulo? "sim"/"nao"
    //    mi = valor mínimo do componente
    //    ma = valor máximo do componente
    // Parametros de saída:
    //    msg = Mensagem de Erro da validação
		function VE(tc, nc, lc, pn, mi, ma) {
			var msg = "";
			var p = "xx";
			var z = 1;
			var x = 0; 
			var cv = 0;
			var dia = 0;
			var mes = 0;
			var ano = 0;
			var aux = "";
			var aux2 = nc.value;
			pn.toLowerCase();
			tc.toLowerCase();

			if (tc == "de") {
				for (var x = 0; x < aux2.length; x++) {
					if (aux2.substring(x, x + 1) != " "){
						aux = aux + aux2.substring(x, x + 1);
					}
				} 
				nc.value = aux;
			}
			
			if (tc == "ca") {
				if (pn == "sim"){ }
				else {
					if (nc.value == "")
						msg = lc + " não pode ser nulo.";
				}
				
				if (nc.value.substring(0, 1) == " ")
					msg = msg + lc + " não pode começar com branco.";
			}else
				if (tc == "in") {
					p = "0123456789";
					if (pn == "sim") {  
						if (nc.value == "")
							nc.value = "0";
						else {
							for (var x = 0; x < nc.value.length; x++) {
								if (p.indexOf(nc.value.substring(x, x + 1)) == -1)
									z = 0;
							} 
							if (z == 0)
								msg = msg + lc + " possui caracteres que não são validos.";  
							if (msg == "") {
								if (nc.value < mi)
									msg = msg + lc + " deve ser maior que " + mi.toString() + ".";
								if (nc.value > ma)
									msg = msg + lc + " deve ser menor que " + ma.toString() + ".";
							}
						}
					}else {
						if (nc.value == "")
						msg = msg + lc + " não pode ser nulo.";
						for (var x = 0; x < nc.value.length; x++) {
																if (p.indexOf(nc.value.substring(x, x + 1)) == -1)
													z = 0;
									 } 
									 if (z == 0)
											msg = msg + lc + " possui caracteres que não são validos.";  
									 if (msg == "") {
											if (nc.value < mi)
												 msg = msg + lc + " deve ser maior que " + mi.toString() + ".";
											if (nc.value > ma)
												 msg = msg + lc + " deve ser menor que " + ma.toString() + ".";
									 }
					}
				}else
					if (tc == "de") {
					 p = ",0123456789";
					 if (pn == "sim") {  
							if (nc.value == "")
								 nc.value = "0";
							else {
									 for (var x = 0; x < nc.value.length; x++) {
																			if (p.indexOf(nc.value.substring(x, x + 1)) == -1 & nc.value.substring(x, x + 1) != ".") {
													z = 0;
											 }
																			if (nc.value.substring(x, x + 1) == ".")
													cv = cv + 1;
									 } 
									 if (cv > 1)
											z = 0;
									 if (z == 0) {
											msg = msg + lc + " possui caracteres que não são validos.";  
									 }
									 if (msg == "") {
											if (nc.value < mi) 
												 msg = msg + lc + " deve ser maior que " + mi.toString() + ".";  
											if (nc.value > ma)
												 msg = msg + lc + " deve ser menor que " + ma.toString() + ".";
									 }
							}
					 }
					 else {
								if (nc.value == "")
									 msg = msg + lc + " não pode ser nulo.";
								for (var x = 0; x < nc.value.length; x++) {
																	if (p.indexOf(nc.value.substring(x, x + 1)) == -1 & nc.value.substring(x, x + 1) != ".")
											 z = 0;
																	if (nc.value.substring(x, x + 1) == ".")
											 cv = cv + 1;
								} 
								if (cv > 1)
									 z = 0;
								if (z == 0) {
									 msg = msg + lc + " possui caracteres que não são validos.";  
								}
								if (msg == "") {
									 if (nc.value < mi)
											msg = msg + lc + " deve ser maior que " + mi.toString() + ".";
									 if (nc.value > ma)
											msg = msg + lc + " deve ser menor que " + ma.toString() + ".";
								}
					 }
					}else
						if (tc == "da") {
						 p = "0123456789/";
						 if (pn == "sim") {  
								if (nc.value == "")
																		{ }
								else {
										 for (var x = 0; x < nc.value.length; x++) {
																						if (p.indexOf(nc.value.substring(x, x + 1)) == -1)
														z = 0;
																						if (nc.value.substring(x, x + 1) == "/")
														cv = cv + 1;
										 } 
										 if (cv != 2)
												z = 0;
										 if (z == 0)
												msg = msg + lc + " possui caracteres que não são validos.";  
										 if (msg == "") {
																						p1 = nc.value.indexOf("/");
																						p2 = nc.value.lastIndexOf("/");
																						if ((p2 == (p1 + 1)) || (nc.value.substring(0, p1).length == 0) || (nc.value.substring(p1 + 1, p2).length == 0) || (nc.value.substring(p2 + 1, nc.value.length).length == 0))
													 msg = msg + lc + " possui os separadores fora de lugar.";
												else {
																								dia = parseInt(nc.value.substring(0, p1), 10);
																								mes = parseInt(nc.value.substring(p1 + 1, p2), 10);
																								ano = parseInt(nc.value.substring(p2 + 1, nc.value.length), 10);
															if ((mes < 1) || (mes > 12))
																 msg = msg + lc + " deve possuir o mês entre 1 e 12.";
																								if ((mes == 1) || (mes == 3) || (mes == 5) || (mes == 7) || (mes == 8) || (mes == 10) || (mes == 12)) {
																 if ((dia < 1) || (dia > 31))
																		msg = msg + lc + " deve possuir o dia entre 1 e 31.";
																 }
																 else {        
																										if (mes != 2) {
																				 if ((dia < 1) || (dia > 30))
																						msg = msg + lc + " deve possuir o dia entre 1 e 30.";
																			}
																			else {
																												if (mes == 2) {
																							if ((ano % 4) == 0) { 
																								 if ((dia < 1) || (dia > 29))
																										msg = msg + lc + " deve possuir o dia entre 1 e 29.";
																							}
																														else {
																										if ((dia < 1) || (dia > 28))
																										msg = msg + lc + " deve possuir o dia entre 1 e 28.";
																							}
																					 }
																			}
																 }
														 }
												 }
										 }
									}
						}else{
							msg = "Validação não pode ser realizada.<br> Tipo de dado do campo não identificado.";                                
						}
			
			return msg;
		}	
    // Trava os campos que vieram de parâmetro
    function TravaTudo() {

       document.form.aux_dtanoage.disabled = true;
       document.form.aux_cdcooper.disabled = true;
       
       if ((document.form.aux_idevento.value != 2) ||
           (document.form.cdageins.value != ''))
           document.form.aux_cdagenci.disabled = true;
              
       document.form.aux_nrseqeve.disabled = true;
       document.all.incluir.style.visibility = 'hidden';
       document.all.pesquisar.style.visibility = 'hidden'; 
       
                if (document.form.origem.value == "1") {
                    document.all.AbaConfirma.style.filter = 'progid:DXImageTransform.Microsoft.Alpha(opacity=30)';
                    document.all.AbaConfirma.rows(0).style.cursor = 'default';
                    document.all.AbaConfirma.cells(1).onclick = '';
              
                    if (document.form.aba.value == 'evento')
                        document.form.flgdispe.disabled = true;
           else
                        document.form.flgdispe.disabled = false;
                } else {
                    document.all.AbaInscrito.style.filter = 'progid:DXImageTransform.Microsoft.Alpha(opacity=30)';
                    document.all.AbaInscrito.rows(0).style.cursor = 'default';
                    document.all.AbaInscrito.cells(1).onclick = '';
       }          
    }

            function FechaZoom(campo, valor, valor2, valor3, valor4, valor5, valor6, valor7, valor8) {

       if (window.WZoom != null) {        
           if (WZoom.closed != true) {
               WZoom.close();
           }
       }
    }

		function Encerrar() {

			// Verifica se o usuário tem permissão de salvar
      if (document.form.aux_lspermis.value.substring(1, 2) != 'A') {
				alert('Desculpe, mas você não tem permissão para executar esta função.'); 
				return false;
			}   

			if (document.all.tbinscritos.rows.length < 1){
				alert("Não há inscritos"); return false;
			}
              
			if (document.form.aux_idstaeve.value == "2") {
				alert("Evento está cancelado. Não é permitido encerrar.");
				return false;
			} 	
       
			if (document.form.aux_flgalter.value == 'yes') {
				if (confirm("Há alterações nesta página, deseja salvá-las antes de continuar?")){
					SalvarConfirm();           
				}
			} 

      if (confirm("As inscrições para esse evento estão sendo encerradas. \nAs inscrições pendentes passarão para excedente\\interessado. Deseja continuar?") == false){
				return false;  	
			}
         
			Habilita();
      document.form.aux_cddopcao.value = 'enc';

      if (ArmazenaConfirm()){
				document.form.submit();
			}
    }

    function TipoInscricao() {

       // Inscricao propria
                if (document.form.aux_tpinseve.value != '2') {
           // document.form.tpinseve[1].checked = true;
                    checked(document.form.tpinseve[1]);
                } else { // Outra pessoa
           //document.form.tpinseve[0].checked = true;
                    checked(document.form.tpinseve[0]);
       }

       // Atualiza a tela com as informações do inscrito
       NomeInscricao();
    }

            function carrega_registros(direcao) {

                document.form.aux_cddopcao.value = '';
                document.form.aux_stdopcao.value = '';
       
                if (minscri.length == 0) {
          alert('Não há registros de inscrições!');
          return false;
       } 

                if (document.form.aux_flgalter.value == 'yes') {
                    if ((document.form.aux_lspermis.value.search('U') != '-1') ||
             (document.form.aux_fechamen.value != 'Sim')) {
                    
              if (confirm("Há alterações nesta página, deseja salvá-las antes de continuar?"))
                  SalvarConfirm();
          }           
       }                
                    
       Habilita();
       document.form.aux_carregar.value = direcao;
                
       document.form.submit();
    }

        function carregaNome() {

			var aux_idcont;
			var aux_idseqttl;
			var aux_prititul = 9999;

			document.getElementById("nmprimtl").innerHTML = "";

			if (document.form.nrdconta.value != '0' && document.form.nrdconta.value != '') {
				if (vetNome.length > 0) {

					oOption = document.createElement("OPTION");
					document.all.aux_nmcooper.options.add(oOption);
					oOption.innerText = "-- SELECIONE --";
					oOption.value = 99;
					oOption.selected = true;

					//for (i in vetNome) {
					for (i = 0; i < vetNome.length; i++) { 
						
						aux_idcont = i;
						
						if (aux_prititul == 9999) {
							aux_prititul = aux_idcont;
						}

						oOption = document.createElement("OPTION");
						document.all.aux_nmcooper.options.add(oOption);
						oOption.innerText = vetNome[i].nmextttl;
						oOption.value = aux_idcont + 1;
						
						aux_idseqttl = vetNome[aux_idcont].idseqttl;
					}

					document.getElementById("nmprimtl").innerHTML = vetNome[aux_idcont].nmprimtl;

					if (vetNome.length == 1) {
						aux_idcont = aux_idcont + 1;

						document.all.aux_nmcooper.value = aux_idcont;
						dadosInscricao(aux_idcont);
					} else {
						//document.all.aux_nmcooper.value = 99;
						document.all.aux_nmcooper.value = aux_prititul;
					}
				}
			}
				
			$("#aux_nmcooper").val(99);
		}
            
            function carregaContaNrcpccgc(idseq) {            
                
                if (vetCoopCpfCgc.length > 0) {
                    
                    oOption = document.createElement("OPTION");
                    document.all.aux_nrdconta_cpfcgc.options.add(oOption);
                    oOption.innerText = "-- SELECIONE --";
                    oOption.value = 99;
                    oOption.selected = true;

                    for (i = 0; i < vetCoopCpfCgc.length; i++) { 
                        
                        aux_idcont = i;                    

                        oOption = document.createElement("OPTION");
                        document.all.aux_nrdconta_cpfcgc.options.add(oOption);
                        oOption.innerText = vetCoopCpfCgc[i].nrdconta +' - '+ vetCoopCpfCgc[i].nmprimtl;
                        oOption.value = aux_idcont + 1;
                        
                    }
                    
                    document.getElementById("divNrdconta_Cpfcgc").style.display = "block";
                    document.getElementById("divNrdconta").style.display = "none";
                    document.getElementById("nmprimtl").style.display = "none";
                    
                    if (idseq > 0){
                      document.all.aux_nrdconta_cpfcgc.value = idseq;
                    }
                    
                } else {
                    
                    alert('CPF/CNPJ informado não possui conta ativa na cooperativa.');
                    document.all.aux_nrcpfcgc_fil.value = "";                
                
                    document.getElementById("divNrdconta_Cpfcgc").style.display = "none";
                    document.getElementById("divNrdconta").style.display = "block";
                    document.getElementById("nmprimtl").style.display = "block";
                }
                
            }

            function dadosInscricao(idseqttl) {
                
                document.all.nrdddins.value = "";
                document.all.nrtelins.value = "";
                document.all.idseqttl.value = "";
                document.all.dsdemail.value = "";
                document.all.nminseve.value = "";
                document.all.dsobsins.value = "";
                document.all.aux_nrcpfcgc.value = "";
				document.all.aux_nrficpre.value = '';
				document.all.nrficpre.value = '';
				
                if (idseqttl != 99) {

                    idseqttl = idseqttl - 1;
                    
                    document.all.nrdddins.value = vetNome[idseqttl].nrdddtfc;
                    document.all.nrtelins.value = vetNome[idseqttl].nrtelefo;
                    document.all.idseqttl.value = vetNome[idseqttl].idseqttl;
                    document.all.dsdemail.value = vetNome[idseqttl].dsdemail;
                    document.all.nminseve.value = vetNome[idseqttl].nmextttl;
                    document.all.nmresage.value = vetNome[idseqttl].nmresage;
                    document.all.aux_nrcpfcgc.value = vetNome[idseqttl].nrcpfcgc;
                    document.all.aux_flginscr.value = vetNome[idseqttl].flginscr;
                    document.all.aux_dsinscri.value = vetNome[idseqttl].dsinscri;
                    
                    if (document.getElementById("divNrdconta_Cpfcgc").style.display == "none") {
                      document.all.aux_nrcpfcgc_fil.value = vetNome[idseqttl].nrcpfcgc;
                    }
                    
                }

            }

            //carregaNome();
    mostraDiv(document.form.pagina.value);

    // valida os parâmetros da agenda
        if (document.form.aux_dtanoage.value == '') {
       
         alert('Parâmetro da Agenda Não Encontrado!!!');
         
         document.form.aux_dtanoage.value = '';
         document.form.aux_cdagenci.value = '';
         document.form.aux_cdcooper.value = '';
         document.form.aux_nrseqeve.value = '';      
        } else {
                     
          MostraPACs();      
          PosicionaPAC(); 
          PosicionaEventos();
          
          //NomeInscricao();
          TipoInscricao();
          
          if (document.form.nrdconta.value != 0) {
            carregaNome();
          } else {
            document.form.nrdconta.focus();
          }            

          if ((document.form.aux_nrdrowid.value == '?') &&
          (document.form.aux_stdopcao.value != 'i'))
            LimparCampos();

          if (document.form.aux_nrseqeve.value == '')
            LimparCampos();           

        }
        
      if (document.form.aux_fechamen.value == 'Sim') {           

         // Verifica se o usuário tem permissão 
          if (document.form.aux_lspermis.value.search('U') == '-1') {
              document.form.incluir.style.filter = 'progid:DXImageTransform.Microsoft.Alpha(opacity=20)';
              document.form.incluir.style.cursor = 'default';
              document.form.incluir.disabled = true;

              document.form.salvar.style.filter = 'progid:DXImageTransform.Microsoft.Alpha(opacity=20)';
              document.form.salvar.style.cursor = 'default';
              document.form.salvar.disabled = true;

              document.form.salvaconfirm.style.filter = 'progid:DXImageTransform.Microsoft.Alpha(opacity=20)';
              document.form.salvaconfirm.style.cursor = 'default';
              document.form.salvaconfirm.disabled = true;

							$("#encerrar").hide();
                       
							alert('Usuário sem permissão para incluir inscrição em eventos já fechados para contabilização.');
         
         }
        }
            
      // Se já esstiver encerrado desabilitar o botão 
	  
      if (document.form.aux_idstaeve.value == "4"){
        $("#encerrar").hide();
      }

      //função generica para checked
      function checked(campo) {
        campo.checked = true;
      }

      //função generica para unchecked
      function unchecked(campo) {
        campo.checked = false;
      }

      if (document.form.aux_nmcooper.value != "" && vetNome.length > 0) {
          dadosInscricao(document.form.aux_nmcooper.value);
      }
        
      function BuscaCooperadoCPFCGC() {
         
         if (document.form.aux_nrseqeve.value == "") { 
           alert("Evento não selecionado"); 
           document.form.aux_nrseqeve.focus();
           return false; 
         }
         
         if (document.form.aux_nrcpfcgc_fil.value != "" && document.form.aux_nrcpfcgc_fil.value != 0 ){
             document.form.aux_cddopcao.value = "bcc";
             document.form.submit();
        }else {               
             document.getElementById("divNrdconta_Cpfcgc").style.display = "none";
             document.getElementById("divNrdconta").style.display = "block";   
             document.getElementById("nmprimtl").style.display = "block";               
        }
        Cooperado();	
      }
            
      function SelecionaContaCpfcgc(idseq) {            

        if (document.form.aux_nrseqeve.value == "") { 
           alert("Evento não selecionado"); 
           document.form.aux_nrseqeve.focus();
           return false; 
         }
          if (idseq != 99) {

              idseq = idseq - 1;                
              document.all.nrdconta.value = vetCoopCpfCgc[idseq].nrdconta;
              BuscaCooperadoCPFCGC();
          }
      }
            
      // validar se pode alterar o campo 
      function ValidaAlterfalta(qtdfalta,qtfalori) {
      
      
          if (document.form.aux_fechamen.value == 'Sim') {
              alert("Mês do evento fechado para contabilização. Alteração não permitida.");
              qtdfalta.value = qtfalori;
              return false;
          }    
      
          for (i = 0; i < mevento.length; i++) {
              
              if (((mevento[i].cdcooper == document.form.aux_cdcooper.value) &&
                  (mevento[i].cdagenci == document.form.aux_cdagenci.value) &&
                  (mevento[i].nrseqeve == document.form.aux_nrseqeve.value)) ||
                 ((mevento[i].cdcooper == document.form.aux_cdcooper.value) &&
                  (mevento[i].cdagenci == "0") &&
                  (mevento[i].nrseqeve == document.form.aux_nrseqeve.value))) {
                  
                  if (mevento[i].dsfineve == "S" && qtdfalta.value > 0) {
                    alert("Aguarde o término do evento para lançar as faltas.");
                    qtdfalta.value = 0;
                  }								
              }
          } 		
      }
            
      function ExcluirInscricao(rowid,nminseve){
      
         if (document.form.aux_fechamen.value == 'Sim') {
              alert("Mês do evento fechado para contabilização. Exclusão não permitida.");
         }else {
              if (!confirm("Confirma exclusão da inscrição de " + nminseve + "?"))
                  return false;
              
              document.form.aux_cddopcao.value = 'exi';
              document.form.aux_excrowid.value = rowid;
              
              document.form.aux_carregar.value = 'proximos';
              
              if (rowid == minscri[0].nrdrowid ){
                if(minscri.length > 1) {
                  document.form.aux_regfimls.value = minscri[1].nrdrowid;
                }
              }else{
                document.form.aux_regfimls.value = minscri[0].nrdrowid;
              }
              
              document.form.submit();
         
         }
      }
            
      // validar se pode alterar situacao
      function ValidaAlterSituac(confirma,confiori) {          
            
        if (confirma.value == 4 ) {  
            alert('Situação não permitida.');  
            confirma.value = confiori;
            return false;
        }

        if (document.form.aux_idstaeve.value == "4"){ /*encerrado*/
        
            if (document.form.aux_fechamen.value == 'Sim' ) { /* mes fechado */   
                alert("Mês do evento fechado para contabilização. Alteração não permitida.");
                confirma.value = confiori;
                return false;
            }
        }

        if (document.form.aux_nmcooper.value != "" && vetNome.length > 0) {
            dadosInscricao(document.form.aux_nmcooper.value);
        }
      }
          
      function carregaRegistros(opcao){
        if(opcao == 'A'){
          $("#aux_nriniseq").val(parseInt($("#aux_nriniseq").val()) - 100);
        }else{
          $("#aux_nriniseq").val(parseInt($("#aux_nriniseq").val()) + 100);
        }    
        carregaInscritos();
      }
      
      function enter(campo,tecla) {
        if(tecla == 13){
          if(campo == 0){
            BuscaCooperadoCPFCGC();
          }else if(campo == 1){
            Cooperado();
          }
        }
        return false;
      }
          
      $("#aux_pesqorde").bind({
        change: function() {
          carregaInscritos();
        },
        blur: function() {
          carregaInscritos();
        }
      });

      function carregaInscritos(){
			  document.form.aux_cddopcao.value='i';
        document.form.nrseqeve.value = document.form.aux_nrseqeve.value;
        document.form.aux_carregar.value='';
        document.form.aux_reginils.value='';
        document.form.aux_regfimls.value='';
				$("#aux_indficin").val("N");
				$("#aux_encerrar").val("N");				
        verificaTipoEvento();
        document.form.submit();
      }
      
      function validaEmail(emailAddress) {
        var re = /^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
        return re.test(emailAddress);
      }
        
      function verificaTipoEvento(){
        if($("#aux_nrseqeve").children(":selected").attr("tpevento") == 7 ||
           $("#aux_nrseqeve").children(":selected").attr("tpevento") == 12){
					$("#aux_encerrar").val("N");
					$("#fichaPresencaLabel").show();
					$("#fichaPresencaCampo").show();
					$("#aux_nrficpre").val('');
					
					if(nomeaba == 'AbaConfirma'){
						document.all.FichaPresencaConfirm[0].style.visibility = "visible";
						document.all.FichaPresencaConfirm[1].style.visibility = "visible";		  
					}
        }else{
					$("#aux_encerrar").val("S");
          $("#fichaPresencaLabel").hide();
          $("#fichaPresencaCampo").hide();
          document.all.FichaPresencaConfirm[0].style.visibility = "hidden";
          document.all.FichaPresencaConfirm[1].style.visibility = "hidden";
        }
      }  
      
      function geraRelatorio(){
        //gera relatorio de eventos
        var cdoperad = $("#aux_cdoperad").val();
        var idevento = $("#aux_idevento").val();
        var nmdatela = 'wpgd0140';
        var idcokses = $("#aux_idcookie").val();
        var arrCaminho = document.form.aux_dsurlphp.value.split('-');
        var url = "";
        //campos de tela
        var dtanoage     = $("#aux_dtanoage").val();
        //cooperativas
        var cdcooper_aux = $("#aux_cdcooper  option:selected").val();
        var nmrescop = $("#aux_cdcooper  option:selected").val() + ' - ' + $("#aux_cdcooper  option:selected").text();
        //agencias
        var cdagenci_aux = $("#aux_cdagenci  option:selected").val();
        var nmextage = $("#aux_cdagenci  option:selected").val() + ' - ' + $("#aux_cdagenci  option:selected").text();
        //eventos
        var cdeventos = $("#aux_nrseqeve option:selected").val();
        var nmeventos = $("#aux_nrseqeve option:selected").val() + ' - ' + $("#aux_nrseqeve option:selected").text();

        if(dtanoage == 0 || dtanoage == ""){
          alert("Informe o ano de agenda!");
          $("#aux_dtanoage").focus()
          return false;
        }

        if($("#aux_cdcooper").val() == 0){
          alert("Selecione uma Cooperativa valida!");
          $("#aux_cdcooper").focus()
          return false;
        }

        if($("#aux_cdagenci").val() == 0){
          alert("Selecione um PA valido, diferente da opcao \"TODOS\"!");
          $("#aux_cdagenci").focus()
          return false;
        }

        if (  cdcooper_aux != '' ) {
      
          //Endereco da pagina de relatorio
          url  = arrCaminho[0] + '/telas/wpgd0140/wpgd0140a.php?dtanoage='+dtanoage+'&cdcooper_aux='+cdcooper_aux+'&nmrescop='+nmrescop; //filtros de tela
          url += '&cdagenci_aux='+cdagenci_aux+'&nmextage='+nmextage+'&cdevento='+cdeventos+'&nmevento='+nmeventos; //filtros de tela
          url += '&cdcooper='+cdcooper_aux+'&cdagenci='+cdagenci_aux+'&cdoperad='+cdoperad+'&idevento='+idevento+'&nmdatela='+nmdatela+'&idcokses='+idcokses; //parametros da sessao
          
          window.open(url, '', 'toolbar=no,location=no,diretories=no,status=no,menubar=no,scrollbars=yes,resizable=yes,width=600,height=450,top=10,left=10');
        } else {
          alert('Selecione ao menos uma opção do filtro de cooperativa');
        }
      }
      
      function geraRelatorioFichaNaoLancada(){
        //gera relatorio de eventos
        var cdoperad = $("#aux_cdoperad").val();
        var idevento = $("#idevento").val();
        var nmdatela = 'wpgd0143';
        var idcokses = $("#aux_idcookie").val();
        var arrCaminho = document.form.aux_dsurlphp.value.split('-');
        var url = "";
        //campos de tela
        var dtanoage     = $("#aux_dtanoage").val();
        //cooperativas
        var cdcooper_aux = $("#aux_cdcooper  option:selected").val();
        var nmrescop = $("#aux_cdcooper  option:selected").val() + ' - ' + $("#aux_cdcooper  option:selected").text();
        //agencias
        var cdagenci_aux = $("#aux_cdagenci  option:selected").val();
        var nmextage = $("#aux_cdagenci  option:selected").val() + ' - ' + $("#aux_cdagenci  option:selected").text();
        //eventos
        var cdeventos = $("#aux_nrseqeve option:selected").val();
        var nmeventos = $("#aux_nrseqeve option:selected").val() + ' - ' + $("#aux_nrseqeve option:selected").text();
        
        //Endereco da pagina de relatorio
        url  = arrCaminho[0] + '/telas/wpgd0143/wpgd0143a.php?dtanoage='+dtanoage+'&cdcooper_aux='+cdcooper_aux+'&nmrescop='+nmrescop; //filtros de tela
        url += '&cdagenci_aux='+cdagenci_aux+'&nmextage='+nmextage+'&nrseqdig='+cdeventos+'&nmevento='+nmeventos; //filtros de tela
        url += '&cdcooper='+cdcooper_aux+'&cdagenci='+cdagenci_aux+'&cdoperad='+cdoperad+'&idevento='+idevento+'&nmdatela='+nmdatela+'&idcokses='+idcokses; //parametros da sessao
        window.open(url, '', 'toolbar=no,location=no,diretories=no,status=no,menubar=no,scrollbars=yes,resizable=yes,width=800,height=600,top=10,left=10');
      }
      
      if($("#aux_nriniseq").val() == '' || ($("#aux_nriniseq").val() == 1 && ($("#aux_nrseqeve").val() == undefined || $("#aux_nrseqeve").val() == "" || $("#aux_nrseqeve").val() == 0))){
        $("#aux_nriniseq").val(1);
        $("#btnAnterior").hide();
        $("#btnProximo").hide();
      }
      
      if($("#nmprimtl").html() == "" || $("#nmprimtl").html() == null || $("#nmprimtl").html() == undefined){
				LimparCampos();
      }
      
      verificaTipoEvento();
			$("#aux_nrficpre").val('');
			$("#indficin").hide();
			
			if($("#aux_indficin").val() == ""){
			  $("#aux_indficin").val("N");
			}
			
			if($("#aux_encerrar").val() == ""){
			  $("#aux_encerrar").val("N");
			}
			
      hideMsgAguardo();
	    
    </script>
  </body>
</html>