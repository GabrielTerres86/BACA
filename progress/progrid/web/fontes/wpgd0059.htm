<!--------------------------------------------------------------------------------------------------------------

   Alteraçoes: 
							 
-------------------------------------------------------------------------------------------------------------->

<html>
	<head>
		<title>Avalia&ccedil;&otilde;es</title>
	</head>
	<body style="margin-left: 3px; overflow:auto;">
    <link href="/cecred/estilos/progrid.css" rel="stylesheet" type="text/css">
    <link href="/cecred/css/jquery.ui.datepicker.css" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="/cecred/css/base/jquery.ui.all.css">
	<script type="text/javascript" src="/cecred/scripts/scripts.js"></script>	
    <script type="text/javascript" src="/cecred/scripts/jquery.ui.core.js"></script>
    <script type="text/javascript" src="/cecred/scripts/jquery.ui.datepicker.js"></script>
    <script type="text/javascript" src="/cecred/scripts/i18n/jquery.ui.datepicker-pt-BR.js"></script>	
    <script type="text/javascript" src="/cecred/scripts/funcoes.js"></script>
    
    
		<script language="JavaScript">
			NomeDoProgramaPrincipal  = '/wpgd0059.w';
			NomeDoProgramaDeListagem = '/wpgd0059ls.w';
			NomeDoProgramaDeAjuda    = '/wpgd0059aj.w';
			NomeDoProgramaDeZoom     = '/zoom/zwpgd0059.w';
      function aguarde() {
            // abre a janela com a mesagem de aguarde
            showMsgAguardo("Carregando Dados...");
		}
    
		</script>
		<form action="#." method="POST" name="form">
			<input type="hidden" name="aux_dsendurl" value="">
			<input type="hidden" name="aux_idcokses" value="">
			<input type="hidden" name="pagina" value="">
			<input type="hidden" name="aux_idevento" value="">
			<input type="hidden" name="aux_cddopcao" value="">
			<input type="hidden" name="aux_nrdrowid" value="">
			<input type="hidden" name="aux_lspermis" value="">
			<input type="hidden" name="aux_dsretorn" value="">
			<input type="hidden" name="aux_stdopcao" value="">
			<input type="hidden" name="cdcooper"     value="">
			<input type="hidden" name="cdagenci"     value="">
			<input type="hidden" name="aux_cdcopope" value="">
			<input type="hidden" name="aux_cdoperad" value="">
			<input type="hidden" name="aux_cdevento" value="">
			<input type="hidden" name="nrseqeve" id="nrseqeve"     value="">
			<input type="hidden" name="aux_lsaltern" value="">
			<input type="hidden" name="aux_lsdescri" value="">
			<input type="hidden" name="aux_iditeava" value="">
			<input type="hidden" name="aux_lsiteava" value="">
			<input type="hidden" name="aux_lsavaoti" value="">
			<input type="hidden" name="aux_lsavabom" value="">
			<input type="hidden" name="aux_lsavareg" value="">
			<input type="hidden" name="aux_lsavains" value="">
			<input type="hidden" name="aux_lsiteav2" value="">
			<input type="hidden" name="aux_lsobserv" id"aux_lsobserv" value="">
			<input type="hidden" name="aux_lsavares" value="">
			<input type="hidden" name="arrQtsugeve" value="">
			<input type="hidden" name="idfimava" id="idfimava"     value="">
			<input type="hidden" name="dsdemail_fornec" id="dsdemail_fornec"     value="">
            
			<!-- Inicio do modelo com abas -->
      			
      <div style="width:100%;">
      
        <div style="position:absolute;padding-left:10px;">
          <img src="/cecred/images/icones/ico_fornecedor.gif">
        </div>
			
        <div style="margin-top: 5px;">
          <table width="100%" border="0" align="left" cellpadding="0" cellspacing="0" background="/cecred/images/geral/guia_fundo.gif">
            <tr>
              <td width="11"><img src="/cecred/images/geral/guia_esquerda.gif" width="11" height="21"></td>
              <td width="56"><img src="/cecred/images/geral/spacer.gif" width="10" height="10"></td>
              <td width="666" height="20" align="left" class="linkGuia">Avalia&ccedil;&otilde;es</td>
              <td width="280" height="20" align="right" class="linkGuia">wpgd0059</td>          
              <td width="11" align="right"><img src="/cecred/images/geral/guia_direita.gif" width="11" height="21"></td>
            </tr>
          </table>
        </div>
			</div>	
        
			<div style="background-color: white; float: left; width: 100%; padding-top: 5px;  z-index: 4;">
				<table width="100%" border="0" cellpadding="0" cellspacing="0" align="left">
					<tr>
						<td width="15%" align="right" class="NomeCampo"> Agenda:</td>
						<td width="15%" class="NomeCampo">
							<input name="aux_dtanoage" class="Campo" type="text"  size="4" onChange="document.form.submit();">
						</td>
						<td width="15%" class="NomeCampo" align="right">Cooperativa:</td>
						<td width="15%" class="NomeCampo" align="left">
							<select name="aux_cdcooper" class="Campo"  onChange="document.form.aux_dtanoage.value=''; document.form.aux_cddopcao.value=''; document.form.submit();"></select>
						</td>
						<td width="15%" align="right" class="NomeCampo">PA:</td>
						<td width="25%" align="left" class="NomeCampo"><select name="aux_cdagenci" class="Campo" onChange="$('#aux_nrseqeve').empty(); aguarde(); document.form.cdagenci.value = document.form.aux_cdagenci.value; document.form.submit();">
						</select></td>
					</tr>
					<tr>
						<td align="right" class="NomeCampo">Evento:</td>
						<td colspan="5" align="left" class="NomeCampo">
							<select name="aux_nrseqeve" id="aux_nrseqeve" class="Campo" onChange="aguarde(); document.form.nrseqeve.value = document.form.aux_nrseqeve.value; document.form.submit();"></select>
						</td>  
					</tr>
					<tr>                              
						<td align="right" class="NomeCampo">Participantes:</td>
						<td class="NomeCampo"><input name="aux_qtdparti" type="text" size="4" readOnly></td>
						<td class="NomeCampo"></td>
						<td colspan="1" class="NomeCampo"></td>
						<td colspan="2" align="LEFT"> 
							 <div id='divbtnReabrir'style="MARGIN-LEFT: 8px">
									<a href="#" class="botao" id="btReabrir"  onclick="ReabrirAvaliacao(); return false;">Abrir Avaliação para Ajuste</a>
							 </div>
						</td>
					</tr>
                    <tr>                              
						<td colspan="3" ></td>
						<td colspan="3" ></td>
					</tr>
				</table>		
			</div>	
				
			<div style="background-color: white; float: left; width: 100%; padding-top: 10px;  z-index: 3;">
				<!-- Interrupcao do modelo - início das abas -->
				<table cellpadding="0" cellspacing="0" bgcolor="#FFFFFF" style="width:100%;>
					<tr align="center">
						<td width="10" height="15"></td>
						<td width="105" height="15">
							<table width="100" id="AbaDescritiva" border="0" cellpadding="0" cellspacing="0">
								<tr style="cursor:hand">
									 <td background="/cecred/images/menu/mnu_nle.gif" width="4" height="21"></td>
									<td width="92" align="center" class="txtTituloHid" onclick="mostraDiv('divDescritiva')">Descritiva</td>
									<td background="/cecred/images/menu/mnu_nld.gif" width="4" height="21"></td>
								</tr>
							</table>
						</td>						
						<!-- Links de Adicionar -->
						<td width="950" align="right" class="txtTituloHid">
							<div id="adicionar">
								<a href="#." id="btAdicionar" onclick="mudaAdicionar();">Adicionar</a>&nbsp;&nbsp;
							</div>
						</td>                         
					</tr>
					<tr>
						<td colspan="5" height="2" align="left" background="/cecred/images/menu/mnu_slc.gif"></td>
					</tr>
				</table>
			</div>
				
			<div style="float: left; width:100%; z-index: 2; height:380px; padding-top: 1px; ">
				<!-- DESCRITIVA -->
				<div id="divDescritiva" style="height:380px; width:100%;">
					<table width="100%" id="tbdescritiva" name="tbdescritiva" border="0" cellpadding="0" cellspacing="0" class="dataTable">
            <thead>
              <tr>
                <td id="tbdescritiva_col14" width="150" height="25" class="txtMenuTitulos" background="/cecred/images/menu/fnd_title.jpg">Relat&oacute;rio </td>
                <td id="separador1" name="separador1" width="5" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                <td id="tbdescritiva_col1" width="150" height="25" class="txtMenuTitulos" background="/cecred/images/menu/fnd_title.jpg">Item Geral </td>
                <td width="5" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                <td id="tbdescritiva_col2" width="150" class="txtMenuTitulos" background="/cecred/images/menu/fnd_title.jpg">Item espec&iacute;fico </td>
                <td width="5" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                <td id="tbdescritiva_col3" width="200" class="txtMenuTitulos" background="/cecred/images/menu/fnd_title.jpg">Descriçao</td>
                <td width="5" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                <td id="tbdescritiva_col4" width="20" class="txtMenuTitulos" background="/cecred/images/menu/fnd_title.jpg" >&nbsp;</td>
              </tr>	
						</thead>	
					</table>
				</div>
				<!-- FIM DESCRITIVA -->
				
			</div>
			<!-- BOTAO SALVAR -->
			<div style="width:100%; z-index:2; text-align: center; padding-top: 5px;">
				<a href="#" class="botao" id="btSalvar"    onclick="Salvar();">Salvar</a>  
			</div>
			<!-- FIM BOTAO SALVAR -->
		</form>
	</body>
		<script language="JavaScript">
			NomeDoProgramaPrincipal = document.form.aux_dsendurl.value + NomeDoProgramaPrincipal;
			document.form.action = NomeDoProgramaPrincipal;

			function MostraDescritiva(){

				 var row;var cell;
				 
				 var cor='#F7F7F7';
				 
				 var aux_dsobserv;
				 
				 for(var i=document.all.tbdescritiva.rows.length; i>1; i--){
           document.all.tbdescritiva.deleteRow(i-1); 
         }
				 
         if(mava.length ==0){
           row = tbdescritiva.insertRow();
           row.bgColor = '#F7F7F7';           
           cell=row.insertCell();   
           cell.className = 'txtNormal';
           cell.align = 'center';
           cell.colSpan = 9;
           linky = '<b>Nenhum Registro Encontrado.</b>';
           cell.innerHTML = linky; 
         }else{
           document.form.aux_qtdparti.value = mava[0].qtpartic;
           for(i=0;i<mava.length;i++){

              /* Alteraçao para ler eventos iguais, mas com sequencial diferente */
                   
              if ((document.form.aux_nrseqeve.value == mava[i].nrseqeve)&&
                  (mava[i].tpiteava == "2")){

                 row=tbdescritiva.insertRow(); 
                
                 if (cor == '#FFFFFF')
                    cor = '#F7F7F7';
                 else
                    cor = '#FFFFFF';
                
                 row.bgColor = cor;
           
                 // Item geral   Item específico  Avaliaçao
                
                 // Relatorio
                 cell=row.insertCell();   
                 cell.className = 'txtPequeno';
                 cell.align = 'left';
                 cell.width = $("#tbdescritiva_col14").width();
                 cell.innerHTML=mava[i].tprelgru;
                
                 cell=row.insertCell();   // Separador
                 cell.className = 'txtNormal';
                 cell.width= document.all.separador1.width;
                 cell.align = 'left';
                 cell.innerText='';
                 
                 // Item Geral
                 cell=row.insertCell();   
                 cell.className = 'txtPequeno';
                 cell.align = 'left';
                 cell.width = document.all.tbdescritiva_col1.width;
                 linky=mava[i].dsgruava;
                 cell.innerHTML=linky;
                
                 cell=row.insertCell();   // Separador
                 cell.className = 'txtNormal';
                 cell.width= document.all.separador1.width;
                 cell.align = 'left';
                 cell.innerText='';
                
                 // Item específico
                 cell=row.insertCell();   
                 cell.className = 'txtPequeno';
                 cell.align = 'left';
                 cell.width = document.all.tbdescritiva_col2.width;
                 linky=mava[i].dsiteava + '<in' + 'put type="hidden" name="aux_cditeav2[' + i + ']" id="aux_cditeav2[' + i + ']" class="cditeav" value="' + mava[i].cditeava + '">';
                 cell.innerHTML=linky; 
                
                 cell=row.insertCell();   // Separador
                 cell.className = 'txtNormal';
                 cell.width= document.all.separador1.width;
                 cell.align = 'left';
                 cell.innerText='';
         
                 // substitui L por '
                 aux_dsobserv = mava[i].dsobserv; 
                 
                 /*while(aux_dsobserv.match('L') == 'L'){
                   aux_dsobserv = aux_dsobserv.replace('L',"'");        
                 }*/
                                          
                 // Avaliaçao
                 cell=row.insertCell();   
                 cell.className = 'txtPequeno';
                 cell.align = 'left';
                 cell.width = $("#tbdescritiva_col3").width();
                 linky='<te' + 'xtarea name="aux_dsobserv[' + i + ']" id="aux_dsobserv[' + i + ']" cols="60" rows="4" class="TextoFormulario" value="">' + aux_dsobserv + '</textarea>';
                 cell.innerHTML=linky; 
                
                 cell=row.insertCell();   // Separador
                 cell.className = 'txtNormal';
                 cell.width= document.all.separador1.width;
                 cell.align = 'left';
                 cell.innerText='';

                 // Botao de Excluir
                 cell=row.insertCell();   
                 cell.className = 'txtNormal';
                 cell.align = 'left';
                 cell.height = 26;         
                     cell.width = $("#tbdescritiva_col4").width();
                 linky='<a href="#." class="BotaoExcluir" onClick=ExAva("' + mava[i].iditeava + '"); class="linkGuia"><img class="BotaoExcluir" src="/cecred/images/botoes/btn_excluir.gif" border="0" title="Excluir"></a>';
                 cell.innerHTML=linky; 
              }
                  
           }
         }  
			}

			function CarregaPrincipal () {
				 window.status = "";
			}

			function Recarrega(){
				 VarURL = NomeDoProgramaPrincipal + '?LinkRowid=' + document.form.aux_nrdrowid.value + '&pagina='  + document.form.pagina.value;
				 window.open(VarURL,'mainFrame','toolbar=no,location=no,diretories=no,status=no,menubar=no,scrollbars=no,resizable=yes,width=600,height=300');				 
			}
			
			function Refresh(){
				document.form.submit();
			}

			function mostraDiv(nomediv){   
				 var nomeaba = '';

				 if (nomediv == '') {nomediv='divDescritiva';}

				 if (nomediv == 'divDescritiva') {nomeaba='AbaDescritiva';}
				 
				 document.form.pagina.value = nomediv;
				 document.all.divDescritiva.style.display = 'none';
				 
				 document.all[nomeaba].rows[0].cells[0].background="/cecred/images/menu/mnu_sle.gif";
				 document.all[nomeaba].rows[0].cells[1].background="/cecred/images/menu/mnu_slc.gif";
				 document.all[nomeaba].rows[0].cells[2].background="/cecred/images/menu/mnu_sld.gif";
				 document.all[nomeaba].rows[0].cells[1].className="txtTituloVis";

				 document.all[nomediv].style.display = 'block';
                 
			}

			function MostraPACs(){
				 for (var i=document.all.aux_cdagenci.options.length; i>=0; i--)
						document.all.aux_cdagenci.remove(i); 

				 var oOption;
				 
				 for(i=0;i<mpac.length;i++){
						if (mpac[i].cdcooper == document.form.aux_cdcooper.value){
							 oOption = document.createElement("OPTION");
							 document.all.aux_cdagenci.options.add(oOption);
							 oOption.innerText = mpac[i].nmresage.substring(0, 15);
							 oOption.value = mpac[i].cdagenci;
						}
				 }

				 document.form.aux_cdagenci.value = '';
				 document.form.aux_qtdparti.value = "";				 
			}

			function PosicionaPAC(){

				 if(document.form.cdagenci.value != ""){
						//document.form.aux_cdeixtem.value = document.form.cdeixtem.value;
						MostraPACs();
						document.form.aux_cdagenci.value = document.form.cdagenci.value;
				 }else{
						// posiciona a seleçao no primeiro registro de Cooperativas, se só tiver 1
						if(document.all.aux_cdcooper.options.length == 1)
							 document.form.aux_cdcooper.value = document.all.aux_cdcooper.options[0].value;

						// posiciona a seleçao no primeiro registro de PACs, se só tiver 1
						if(document.all.aux_cdagenci.options.length == 1)
							 document.form.aux_cdagenci.value = document.all.aux_cdagenci.options[0].value;
				 }
			}

			function MostraEventos(){

				 for (var i=document.all.aux_nrseqeve.options.length; i>=0; i--)
						document.all.aux_nrseqeve.remove(i); 

				 var oOption;

				 for(i=0;i<mevento.length;i++){
						if ((mevento[i].cdcooper == document.form.aux_cdcooper.value) /*&&
								(mevento[i].cdagenci == document.form.aux_cdagenci.value)*/){
							 oOption = document.createElement("OPTION");
							 document.all.aux_nrseqeve.options.add(oOption);
							 oOption.innerText = mevento[i].nmevento.substring(0, 75);
							 oOption.value = mevento[i].nrseqeve;
						    if (document.form.nrseqeve.value == mevento[i].nrseqeve){
                                document.form.idfimava.value = mevento[i].idfimava;
                                document.form.dsdemail_fornec.value = mevento[i].dsdemail_fornec;
                                document.form.aux_cdevento.value = mevento[i].cdevento;
                            } 
                        
                        }
				 }
				 document.form.aux_nrseqeve.value = '';
				 if (document.form.aux_cdagenci.value == ''){
						oOption = document.createElement("OPTION");
						document.all.aux_nrseqeve.options.add(oOption);
						oOption.innerText = "--Selecione PA--";
						oOption.value = '0';
						document.form.aux_nrseqeve.value = '0';
				 }

				 document.form.aux_nrseqeve.value = '';
				 document.form.aux_qtdparti.value = '';
				 				
				 MostraAva();
			}

			function PosicionaEventos(){
            
                document.all.divbtnReabrir.style.display = 'none'; 
                if(document.form.nrseqeve.value != ""){
                  MostraEventos();
                  document.form.aux_nrseqeve.value = document.form.nrseqeve.value;

                  //Se avaliações estiver encerrada apresentar botão para reabrir
                  if (document.form.idfimava.value == 1){
                    document.all.divbtnReabrir.style.display = 'block'; 
                    $('#btEncerrar').prop("disabled",true).addClass("botaoDesativado").attr("onClick","return false;");
                    Desabilitar();
                  }
                }	
			}

			function Incluir(){
				var vaux = document.form.aux_lspermis.value; 
				if(vaux.substring(0,1) == 'I'){ 
					if(document.form.aux_stdopcao.value == 'i'){ 
						alert('Voce já esta no modo de inclusao.'); 
						return false
					} 
					else{ 
						document.form.aux_cddopcao.value='in'; 
						document.form.aux_stdopcao.value='i'
						return true
					} 
				} 
				else{ 
					MostraResultado('1','Desculpe, mas voce nao tem permissao para executar esta funçao.'); 
					return false
				}
			}

			function Salvar(){
         var vaux = document.form.aux_lspermis.value;
         var nrseqtem = 0;
         var qtsugeve = 0;
         var i = 0;
         var iLen = document.getElementsByName('aux_qtsugeve').length;
         var arrQtsugeve = "";
         
         for (i = 0; i < iLen; i++) {
     
           nrseqtem = document.getElementById('nrseqtem[' + i + ']').value;
           qtsugeve = document.getElementById('aux_qtsugeve[' + i + ']').value;
           nrseqdig = document.getElementById('nrseqdig[' + i + ']').value;
           
           if(i == 0){
             arrQtsugeve = nrseqtem + ',' + qtsugeve + ',' + nrseqdig;   
           }else{
             arrQtsugeve += '#' + nrseqtem + ',' + qtsugeve + ',' + nrseqdig;
           }           
         }
        
         document.form.arrQtsugeve.value = arrQtsugeve;
         
         if((vaux.substring(1,2) == 'A') || (document.form.aux_stdopcao.value == 'i')) { 
           if(document.form.aux_cddopcao.value!='sa')  {                         
             if(ArmazenaValores()){
               document.form.aux_cddopcao.value='sa'; 
               status = 'Salvando. Por favor, aguarde ...'; 
               document.form.submit(); 
               return true;
             }else{ 
               return false;
             }  
           } 
         }
         else{ 
           MostraResultado('1','Desculpe, mas voce nao tem permissao para executar esta funçao.'); 
           return false;
         }

      }

			function Excluir(){
				ZeraModoExclusao();  
				var vaux = document.form.aux_lspermis.value;
				 
				if(vaux.substring(2,3) == 'E') { 
					if(document.form.aux_stdopcao.value=='i') { 
						MostraResultado('1','Voce esta no modo de inclusao.Selecione o registro apropriado e entao selecione a opçao exclusao.'); 
						return false
					} 
					else {
						if (!confirm('Confirma Exclusao do Facilitador?')){
							 return false;
						}
								else{          
							 document.form.aux_cddopcao.value = "ex";
							 document.form.submit();
								}
					} 
				} 
				else { 
					MostraResultado('1','Desculpe, mas voce nao tem permissao para executar esta funçao.'); 
					return false
				}        
			}
				 
			function ArmazenaValores(){
				 document.form.aux_lsiteava.value = '';
				 document.form.aux_lsavaoti.value = '';
				 document.form.aux_lsavabom.value = '';
				 document.form.aux_lsavareg.value = '';
				 document.form.aux_lsavains.value = '';
				 document.form.aux_lsiteav2.value = '';
				 document.form.aux_lsobserv.value = '';
         document.form.aux_lsavares.value = '';

				 document.form.cdcooper.value = document.form.aux_cdcooper.value;
				 document.form.cdagenci.value = document.form.aux_cdagenci.value;
				 document.form.nrseqeve.value = document.form.aux_nrseqeve.value;
				 

				 if (document.form.aux_cdcooper.value == "")
						{ alert("Cooperativa nao selecionada."); return false; }

				 if (document.form.aux_cdagenci.value == "")
						{ alert("PA nao selecionado."); return false; }

				 if (document.form.aux_nrseqeve.value == "")
						{ alert("Evento nao selecionado."); return false; }
				
         if(mava.length > 0){ 
           /* Descritivo */
           if (document.all.tbdescritiva.rows.length > 0){
           
							if (mava.length > 1){
                 for (i = 0; i < mava.length; i++){
                   if ((document.form.aux_nrseqeve.value == mava[i].nrseqeve)&&
                    (mava[i].tpiteava == "2")){
                                   
                      if (document.form.aux_lsiteav2.value == ''){
                         document.form.aux_lsiteav2.value = document.getElementById('aux_cditeav2[' + i + ']').value; //document.form.aux_cditeav2[i].value;
                         document.form.aux_lsobserv.value = document.getElementById('aux_dsobserv[' + i + ']').value; //altera_simbolo(document.form.aux_dsobserv[i].value);
                      }else{
                        document.form.aux_lsiteav2.value = document.form.aux_lsiteav2.value + ',' + document.getElementById('aux_cditeav2[' + i + ']').value; //document.form.aux_cditeav2[i].value;
                        document.form.aux_lsobserv.value = document.form.aux_lsobserv.value + '|' + document.getElementById('aux_dsobserv[' + i + ']').value; //altera_simbolo(document.form.aux_dsobserv[i].value);
                      }
                    }
                 }
              }else{
                
                if(mava.length == 0){
                  document.form.aux_lsiteav2.value = 0;
								}else{
                  document.form.aux_lsiteav2.value = document.getElementById('aux_cditeav2[0]').value;
								}
                //document.form.aux_lsobserv.value = altera_simbolo(document.form.aux_dsobserv.value);
                document.form.aux_lsobserv.value = altera_simbolo(document.getElementById('aux_dsobserv[0]').value);
              }
           }
         }
				 /* Fim - descritivo */ 
				 
				 return true;
			}

			// Altera o link da funçao de adicionar
			function mudaAdicionar(){

				 // Verifica se o usuário tem permissao de incluir
				 if (document.form.aux_lspermis.value.substring(0,1) != 'I'){ 
						alert('Desculpe, mas voce nao tem permissao para executar esta funçao.'); 
						return false;
				 }

				 if ((document.form.aux_cdagenci.value == '')||(document.form.aux_nrseqeve.value == '')){
						alert("Por favor, selecione PA e Evento.");
						return false;
				 }

				 if(document.all.divDescritiva.style.display == 'block')
					 AdDescritiva();

			}

			function AdDescritiva(){
				 VarURL = document.form.aux_dsendurl.value  + '/wpgd0059a.htm?' +
          	'aux_tpiteava='  + '2'                              +
						'&aux_idevento=' + document.form.aux_idevento.value +
						'&aux_cdcooper=' + document.form.aux_cdcooper.value +
						'&aux_cdagenci=' + document.form.aux_cdagenci.value +
						'&aux_dtanoage=' + document.form.aux_dtanoage.value +
						'&aux_nrseqeve=' + document.form.aux_nrseqeve.value;
				 window.open(VarURL,'','toolbar=no,location=no,diretories=no,status=no,menubar=no,scrollbars=yes,resizable=yes,width=800,height=600,TOP=10,LEFT=10');   
			}

			function MostraAva(){
				
				 document.form.aux_qtdparti.value = "";				 
				 MostraDescritiva();
				 
				 if (document.form.idfimava.value == 1){
						Desabilitar(); 
				 }
			}

			function ExAva(rowid){
				 // Verifica se o usuário tem permissao de exclusao
				 if (document.form.aux_lspermis.value.substring(2,3) != 'E'){ 
						alert('Desculpe, mas voce nao tem permissao para executar esta funçao.'); 
						return false;
				 }
				 
				 if(!confirm("Este item será excluido para TODOS OS PA's, deseja continuar?"))
					 return false;

				 document.form.cdcooper.value = document.form.aux_cdcooper.value;
				 document.form.cdagenci.value = document.form.aux_cdagenci.value;
				 document.form.nrseqeve.value = document.form.aux_nrseqeve.value;

				 document.form.aux_iditeava.value = rowid;
				 document.form.aux_cddopcao.value = 'exa'; 
				 document.form.submit();
			}

			function CalculaLinha(indice){
				 var qtoti = 0;
				 var qtbom = 0;
				 var qtreg = 0;
				 var qtins = 0;
				 var qtnre = 0;
         var qtres = 0;
				 
				 if (document.form.aux_cditeava.length > 1){
						qtoti = parseFloat(ConverteDec(document.form.aux_qtavaoti[indice].value, "1"));
						qtbom = parseFloat(ConverteDec(document.form.aux_qtavabom[indice].value, "1"));
						qtreg = parseFloat(ConverteDec(document.form.aux_qtavareg[indice].value, "1"));
						qtins = parseFloat(ConverteDec(document.form.aux_qtavains[indice].value, "1"));
						//qtnre = parseFloat(ConverteDec(document.form.aux_qtavanre[indice].value, "1"));

                        if (document.form.aux_tprelgru[indice].value  == 'COOPERADO'){
                            qtres = qtres_ass;
                        }else if (document.form.aux_tprelgru[indice].value == 'COOPERATIVA') {
                            qtres = qtres_coop;
                        }else if (document.form.aux_tprelgru[indice].value == 'FORNECEDOR') {
                            qtres = qtres_forn;
                        }
                        
                        document.form.aux_qtavares[indice].value = qtres;
						document.form.aux_peavaoti[indice].value = parseInt(qtoti / qtres * 100);
						document.form.aux_peavabom[indice].value = parseInt(qtbom / qtres * 100);
						document.form.aux_peavareg[indice].value = parseInt(qtreg / qtres * 100);
						document.form.aux_peavains[indice].value = parseInt(qtins / qtres * 100);
                           
						qtnre = qtres - (qtoti + qtbom + qtreg + qtins);

						document.form.aux_qtavanre[indice].value = qtnre;
						document.form.aux_peavanre[indice].value = parseInt(qtnre / qtres * 100);
				 }else{
						qtoti = parseFloat(ConverteDec(document.form.aux_qtavaoti.value, "1"));
						qtbom = parseFloat(ConverteDec(document.form.aux_qtavabom.value, "1"));
						qtreg = parseFloat(ConverteDec(document.form.aux_qtavareg.value, "1"));
						qtins = parseFloat(ConverteDec(document.form.aux_qtavains.value, "1"));
						//qtnre = parseFloat(ConverteDec(document.form.aux_qtavanre[indice].value, "1"));
                        
						if (document.form.aux_tprelgru.value == 'COOPERADO'){
								qtres = qtres_ass;
						}else if (document.form.aux_tprelgru.value == 'COOPERATIVA') {
								qtres = qtres_coop;
						}else if (document.form.aux_tprelgru.value == 'FORNECEDOR') {
								qtres = qtres_forn;
						}    
						
						document.form.aux_peavaoti.value = parseInt(qtoti / qtres * 100);
						document.form.aux_peavabom.value = parseInt(qtbom / qtres * 100);
						document.form.aux_peavareg.value = parseInt(qtreg / qtres * 100);
						document.form.aux_peavains.value = parseInt(qtins / qtres * 100);
                        
						qtnre = qtres - (qtoti + qtbom + qtreg + qtins);

						document.form.aux_qtavanre.value = qtnre;
						document.form.aux_peavanre.value = parseInt(qtnre / qtres * 100);

				 }
			}

			function CalculaTodos(){
				if (document.all.tbalternativa.rows.length == 0){ 
					 return false;
                }
				if (document.form.aux_cditeava.length > 1){
					for (i = 0; i < document.form.aux_cditeava.length; i++){
							 CalculaLinha(i);
				    }
				}else{
				    CalculaLinha('0');
				}
			}

			//formataçao dos campos
			function formatCurrency(num){
				 
				 num = num.toString().replace(/\$|\,/g,'');
				 if(isNaN(num))
						num = "0";
				 sign = (num == (num = Math.abs(num)));
				 num = Math.floor(num*100+0.50000000001);
				 cents = num%100;
				 num = Math.floor(num/100).toString();
				 if(cents<10)
						cents = "0" + cents;
				 for (var i = 0; i < Math.floor((num.length-(1+i))/3); i++)
						num = num.substring(0,num.length-(4*i+3))+'.'+
				 num.substring(num.length-(4*i+3));
				 return (((sign)?'':'-') + num + ',' + cents);
			}

			// Converte um valor com decimal separado por "," para separado por "."
			function ConverteDec(str, tipo){
				 if(tipo == "1"){
						str = str.replace(".","");
						str = str.replace(",",".");
						return str;
				 }else{
						str = str.replace(",","");
						str = str.replace(".",",");
						return str;
				 }
			}

			function altera_simbolo(str){
				//while(str.match("'") == "'"){
				  //str = str.replace("'","L");
        //}
				return str;
			}
      
      // Reabrir avaliações
      function ReabrirAvaliacao() {
        if (!confirm('Confirma Abertura da Avaliação para ajuste?')){
            return false;
		}  
        document.form.aux_cddopcao.value = 'rea'; 
		document.form.submit();
      }       
           
      // Desabilitar campos para nao permitir ediçao
      function Desabilitar () {
        $('#btSalvar').prop("disabled",true).addClass("botaoDesativado").attr("onClick","return false;");
        $('#btAdicionar').prop("disabled",true).attr("onClick","return false;");
      
        $('.Campo','#CamposQtavares').desabilitaCampo();
        
        $('.Campo','#divDescritiva').desabilitaCampo();
        $('.TextoFormulario','#divDescritiva').prop('disabled',true);
              
        $('.BotaoExcluir').prop("disabled",true).attr("onClick","return false;");
        $('.BotaoExcluir').css("cursor","default");
        $('.BotaoExcluir').css("filter","progid:DXImageTransform.Microsoft.Alpha(opacity=20)");
        
      }
      
      function LimparCampos(){}
      
			mostraDiv(document.form.pagina.value);

			MostraPACs();
			PosicionaPAC();
			MostraEventos();      
			PosicionaEventos();
			MostraAva();      
		</script>

</html>