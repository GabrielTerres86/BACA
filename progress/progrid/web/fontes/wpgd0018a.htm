<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta name="wsoptions" content="no-output">
<title>Eventos (wpgd0018a)</title>
<link href="/cecred/estilos/progrid.css" rel="stylesheet" type="text/css">
</head>
<body>
<script SRC="/cecred/jsbiblio/sorttable.js"></script>
<script language="JavaScript">
NomeDoProgramaPrincipal  = '/wpgd0018a.w';
</script>
<form action="#." method="POST" name="form">
<input type="hidden" name="aux_cddopcao"  VALUE="">
<input type="hidden" name="aux_lspermis"  VALUE="">
<input type="hidden" name="aux_nrdrowid"  VALUE="">
<input type="hidden" name="aux_dsretorn"  VALUE="">
<input type="hidden" name="aux_stdopcao"  VALUE="">
<input type="hidden" name="aux_dsendurl"  VALUE="">
<input type="hidden" name="aux_idevento"  VALUE="">
<input type="hidden" name="aux_cdcooper"  VALUE="">
<input type="hidden" name="aux_cdevesel"  VALUE="">
<input type="hidden" name="dtanoage"      VALUE="">
<input type="hidden" name="aux_dtanoage"  value="">
<table width="600" border="0" cellspacing="0" cellpadding="3">
  <tr>
    <td align="left">
      <table width="100%" border="0" cellpadding="0" cellspacing="0" >
		<tr>
		  <td width="11" background="/cecred/images/geral/guia_fundo.gif"><img src="/cecred/images/geral/guia_esquerda.gif" width="11" height="21"></td>
		  <td width="147" nowrap background="/cecred/images/geral/guia_fundo.gif" class="linkGuia"><div align="center">Sugest&otilde;es Analisadas </div></td>
		  <td width="8" background="/cecred/images/geral/guia_fundo.gif" align="right"><img src="/cecred/images/geral/guia_direita.gif" width="8" height="21"></td>
		  <td>&nbsp;</td>
		</tr>
		<tr>
		  <td colspan="4" height="2" align="left" background="/cecred/images/menu/mnu_slc.gif"></td>
		</tr>					  
      </table>
      <table class="dataTable" width="100%" border="0" cellpadding="0" cellspacing="0">
        <tr>
	 	  <td id="separador1" width="5" background="/cecred/images/menu/fnd_title.jpg">&nbsp;</td>
          <td width="200" height="25" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos" id="tbevento_col1">Evento</td>
          <td width="5" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
          <td width="368" align="left" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos" id="tbevento_col2" title="Eixo Tematico">Eixo Tem&aacute;tico</td>
        </tr>
      </table>
      <div style="overflow: auto; height:'240';">
        <table id="tbevento" class="dataTable" width="100%" border="0" cellpadding="0" cellspacing="0">
          <!-- INCLUI DADOS -->
        </table>
      </div>
    </td>
  </tr>
  <tr>
    <td height="25" >&nbsp;</td>	  
  </tr>
  <tr>
    <td height="10" valign="bottom" align="center">
        <input name="imageField" type="image" style="cursor:hand; " onClick="Salvar();" src="/cecred/images/botoes/btn_salvar.gif" width="60" height="20">
	</td>
  </tr>	
</table>
</form>
</body>
</html>
<SCRIPT LANGUAGE="JAVASCRIPT">
   NomeDoProgramaPrincipal  = '/wpgd0018a.w';
   NomeDoProgramaDeListagem = '/wpgd0018as.w';
   NomeDoProgramaDeAjuda    = '/wpgd0018aaj.w';
   NomeDoProgramaDeZoom     = '/zoom/zoei01.w';
   
   NomeDoProgramaPrincipal = document.form.aux_dsendurl.value + NomeDoProgramaPrincipal;
   document.form.action = NomeDoProgramaPrincipal;

function RetornoDoZoom(campo,valor,valor2,valor3)
{  
         
}
function Habilita()
{
  
}
function HabilitaSalvar()
{
  
}
function ValidaDados(form)
        { 
                var msg="";
                 
                /*msg = msg + top.frcod.VE("in",form.cddddfor,"O DDD do Contato","sim","1","999");
                msg = msg + top.frcod.VE("in",form.cdfonfor,"O Telefone do Contato","sim","1","999999999");
        //msg = msg + top.frcod.VE("ca",form.auxnmevento,"O nome do evento","nao");

                if (document.form.auxnmevento.value == "") {
                   msg = msg + "O nome do evento não pode ser branco.".
                }*/
                 
                if (msg == "")
                                return true
                        else
                                {
                                        alert(msg);
                                        return false
                                }
        }

function LimparCampos()
{
   
}

function ExaminaCampo(Campo)
{

}
 
function CarregaPrincipal()
{  

}    

function Incluir()
{
   var vaux = document.form.aux_lspermis.value; 
   if (vaux.substring(0,1) == 'I') 
           { 
                  if (document.form.aux_stdopcao.value == 'i') 
                                { 
                                   alert('Você já esta no modo de inclusão'); 
                                   return false
                                } 
                         else 
                                { 
                                   document.form.aux_cddopcao.value ='in'; 
                                   document.form.aux_stdopcao.value ='i';
                                   LimparCampos(); 
                                   return true
                                } 
           } 
        else 
           { 
                  alert('Desculpe, mas você não tem permissão para executar esta função.'); 
                  return false
           }
}

function Salvar()
{
   //ZeraModoExclusao();
   document.form.aux_stdopcao.value = 'i';
   var vaux = document.form.aux_lspermis.value; 
   if ((vaux.substring(1,2) == 'A') || (document.form.aux_stdopcao.value == 'i')) { 
                if ( document.form.aux_cddopcao.value!='sa')  {
                   if (ValidaDados(document.forms[0])) {
                           Habilita(); 
                           HabilitaSalvar(); 
                           armazenaEventos();
                           document.form.aux_cddopcao.value='sa'; 
                           status = 'Salvando. Por favor, aguarde ...'; 
                           document.form.submit(); 
                           return true;
                           
                        } 
                        else { 
                          return false;
                        }  
                } 
   }
   else { 
                 alert('Desculpe, mas você não tem permissão para executar esta função.'); 
                 return false;
   }
}

function Recarregar()
{
   
}

function CarregaPrincipal()
{
}

function mostraEventos(){

  var row; var cell;
  
  // limpa a tabela de eixos, menos a 1ª linha - linha do cabecalho
  for (var i=document.all.tbevento.rows.length; i>3; i--)
          document.all.tbevento.deleteRow(i-1);
          
  for(i=0;i<mevento.length;i++){      
        
		row=tbevento.insertRow();  // nova linha
        row.id=i;
        row.onclick=mudaCor;
		row.style.cursor = 'hand';
        row.bgColor="#FFFFFF";

        cell=row.insertCell();   // Separador
        cell.className = 'txtNormal';
        cell.height = 26;
        cell.align = 'left';
		cell.width = document.all.separador1.width;
        cell.innerText='';
		 
        cell=row.insertCell();      
        cell.className = 'txtNormal';
		cell.height = 26;
		cell.width = document.all.tbevento_col1.width;
        linky=mevento[i].nmevento + '<input type="hidden" name="aux_cdevento" value="' + mevento[i].cdevento + '">';
        cell.innerHTML=linky;

        cell=row.insertCell();   // Separador
        cell.className = 'txtNormal';
        cell.height = 26;
        cell.align = 'left';
		cell.width = document.all.separador1.width;
        cell.innerText='';

        cell=row.insertCell();      
        cell.className = 'txtNormal';
		cell.height = 26;
		cell.width = document.all.tbevento_col2.width;
        cell.innerText=mevento[i].dseixtem;
		
		//**** LINHA SEPARADORA
		row=tbevento.insertRow();  
        row.bgColor="#999999";

        cell=row.insertCell();
        cell.height = 1;
		cell.width = document.all.separador1.width;
		cell.bgColor="#999999";
        cell.align = 'left';
        cell.innerText='';
		
		cell=row.insertCell();
        cell.height = 1;
		cell.bgColor="#999999";
        cell.align = 'left';
        cell.innerText='';
		
		cell=row.insertCell();
        cell.height = 1;
		cell.bgColor="#999999";
        cell.align = 'left';
        cell.innerText='';
		
		cell=row.insertCell();
        cell.height = 1;
		cell.bgColor="#999999";
        cell.align = 'left';
        cell.innerText='';
		//**** FIM DA LINHA SEPARADORA
  }
}

function mudaCor(){

  if(document.form.aux_cdevento.length > 1)
  {
         if (document.form.aux_cdevento[this.id].checked==false){
                this.bgColor = '#CCCCCC';
         document.form.aux_cdevento[this.id].checked=true;
         }
         else{
                this.bgColor = '#FFFFFF';
         document.form.aux_cdevento[this.id].checked=false;
         }
  }
  else
  {
         if (document.form.aux_cdevento.checked==false){
                this.bgColor = '#CCCCCC';
         document.form.aux_cdevento.checked=true;
         }
         else{
                this.bgColor = '#FFFFFF';
         document.form.aux_cdevento.checked=false;
         }

  }
}

function armazenaEventos(){
  var i;
  
  if(document.form.aux_cdevento.length > 1)
  {
         for(i=0;i<document.form.aux_cdevento.length;i++)
                if(document.form.aux_cdevento[i].checked)
                {
                  if(document.form.aux_cdevesel.value=='')
                         document.form.aux_cdevesel.value = document.form.aux_cdevento[i].value;
                  else
                         document.form.aux_cdevesel.value = document.form.aux_cdevesel.value + ',' + document.form.aux_cdevento[i].value;
                }
   }
   else
   {
          if(document.form.aux_cdevento.checked)
          {
                 if(document.form.aux_cdevesel.value=='')
                        document.form.aux_cdevesel.value = document.form.aux_cdevento.value;
                 else
                        document.form.aux_cdevesel.value = document.form.aux_cdevesel.value + ',' + document.form.aux_cdevento.value;
          } 
   }

}

mostraEventos();
</SCRIPT>
