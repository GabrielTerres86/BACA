<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta name="wsoptions" content="no-output">
<title>Seleção de Local (wpgd0026b)</title>
<link href="/cecred/estilos/progrid.css" rel="stylesheet" type="text/css">
</head>
<body bgcolor="#FFFFFF">
<form action="#." method="POST" name="form">
<input type="hidden" name="aux_cddopcao" value="">
<input type="hidden" name="aux_lspermis" value="">
<input type="hidden" name="aux_nrdrowid" value="">
<input type="hidden" name="aux_dsretorn" value="">
<input type="hidden" name="aux_stdopcao" value="">
<input type="hidden" name="aux_dsendurl" value="">
<input type="hidden" name="aux_idevento" value="">
<input type="hidden" name="aux_lslocali" value="">
<input type="hidden" name="aux_cdcooper" value="">
<input type="hidden" name="aux_cdagenci" value="">
<input type="hidden" name="aux_cdevento" value="">
<input type="hidden" name="aux_dtanoage" value="">
<input type="hidden" name="aux_nrseqeve" value="">
<input type="hidden" name="aux_cdoperad" value="">
<input type="hidden" name="aux_cdcopope" value="">
<input type="hidden" name="idevento"     value=""> <!-- pra poder mapear -->
<table width="99%" height="96%"  border="0" align="center" cellpadding="0" cellspacing="0">
  <tr valign="botton">
    <td height="20"><table width="189" border="0" cellpadding="0" cellspacing="0">
        <tr>
          <td>
	    <table border="0" cellpadding="0" cellspacing="0" background="/cecred/images/geral/guia_fundo.gif">
              <tr>
     		 <td width="11"><img src="/cecred/images/geral/guia_esquerda.gif" width="11" height="21"></td>
            	 <td align="center" nowrap width="150" class="linkGuia">Selecionar Local </td>
		 <td align="right"><img src="/cecred/images/geral/guia_direita.gif" width="11" height="21"></td>
              </tr>
            </table>
	  </td>
        </tr>
      </table></td>
  </tr>
  <tr valign="top" bgcolor="#FFFFFF">
    <td><table width="100%" height="100%"  border="0" align="left" cellpadding="0" cellspacing="1" bgcolor="#999999">
        <tr>
          <td height="200" valign="top" bgcolor="#FFFFFF"><table width="100%" height="100%"  border="0" cellpadding="0" cellspacing="0">
              <tr>
                <td height="27"><table width="100%"  border="0" cellpadding="0" cellspacing="0">
                    <tr>
                      <td height="1"><img src="/cecred/images/geral/spacer.gif" width="21" height="1"></td>
                    </tr>
                    <tr>
                      <td height="27" align="left" background="/cecred/images/menu/fnd_title.jpg">
                        <table width="100%" border="0" cellpadding="0" cellspacing="0" class="dataTable" id="tblocal">
                          <tr>
                            <td width="191" height="22" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos">&nbsp;&nbsp;Local</td>
                            <td width="2" height="22" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                            <td width="92" height="22" background="/cecred/images/menu/fnd_title.jpg"><span class="txtMenuTitulos">Valor</span></td>
                            <td width="2" height="22" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                            <td width="92" height="22" background="/cecred/images/menu/fnd_title.jpg"><span class="txtMenuTitulos">Capacidade</span></td>
                            <td width="2" height="22" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                            <td width="127" height="22" background="/cecred/images/menu/fnd_title.jpg"><span class="txtMenuTitulos">Endere&ccedil;o</span></td>
                            <td width="2" height="22" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                            <td width="127" height="22" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos">Estrutura</td>
                            <td width="80" height="22" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                            <td width="49" height="22" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos">Contato<span class="txtMenuTitulos"></span></td>
                            <td width="2" height="22" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                            <td width="94" height="22" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos">Fone</td>
                          </tr>
                        </table>
                      </td>
                    </tr>
                  </table></td>
                <td width="1%" valign="top">&nbsp;</td>
              </tr>
              <tr>
                <td valign="top"><table width="100%" height="100%"  border="0" cellpadding="0" cellspacing="0">
                    <tr>
                      <td height="1"><img src="/cecred/images/geral/spacer.gif" width="21" height="1"></td>
                    </tr>
                    <tr>
                      <td height="27">
					  <table  border="0" cellpadding="0" cellspacing="0">
                          <tr>
                            <td height="1" colspan="3"><img src="/cecred/images/geral/spacer.gif" width="21" height="1"></td>
                          </tr>
                          <tr>
                            <td width="10" height="27">&nbsp;</td>
                            <td width="30" align="center" class="txtNormal"></td>
                            <td width="400" class="txtNormal"></td>
                          </tr>
                        </table>
					  </td>
                    </tr>
                    <tr>
                      <td height="1" bgcolor="#EBEBEB"></td>
                    </tr>
                    <tr>
                      <td height="27" bgcolor="#F7F7F7"><table  border="0" cellpadding="0" cellspacing="0">
                          <tr>
                            <td height="1" colspan="3"><img src="/cecred/images/geral/spacer.gif" width="21" height="1"></td>
                          </tr>
                          <tr>
                            <td width="10" height="27">&nbsp;</td>
                            <td width="30" align="center" class="txtNormal">&nbsp;</td>
                            <td width="400" class="txtNormal"></td>
                          </tr>
                        </table></td>
                    </tr>
                    <tr>
                      <td valign="bottom">
                        <table border="0" cellspacing="0" cellpadding="0" align="center">
                          <tr>
                            <td><img src="/cecred/images/botoes/btn_salvar.gif" style="cursor: hand; " onClick="Salvar()"></td>
                          </tr>
                        </table>
                      </td>
                    </tr>
                    <tr>
                      <td valign="bottom" height="2"><img src="/cecred/images/geral/spacer.gif" width="21" height="1"></td>
                    </tr>
                  </table></td>
                <td width="1%" valign="top">
                </td>
              </tr>
            </table></td>
        </tr>
      </table></td>
  </tr>
</table>
</body>
</html>
<SCRIPT LANGUAGE="JAVASCRIPT">
   NomeDoProgramaPrincipal  = '/wpgd0026b.w';
   NomeDoProgramaDeListagem = '/wpgd0026bs.w';
   NomeDoProgramaDeAjuda    = '/wpgd0026baj.w';
   NomeDoProgramaDeZoom     = '/zoom/zwpgd0026b.w';
   
   NomeDoProgramaPrincipal = document.form.aux_dsendurl.value + NomeDoProgramaPrincipal;
   document.form.action = NomeDoProgramaPrincipal;

function Salvar()
{
   //ZeraModoExclusao();
   var vaux = document.form.aux_lspermis.value; 
   if ((vaux.substring(1,2) == 'A') || (document.form.aux_stdopcao.value == 'i'))
   { 
      document.form.aux_cddopcao.value='sa'; 
      document.form.aux_stdopcao.value='al';
      status = 'Salvando. Por favor, aguarde ...';			
      armazenaLocal();
      document.form.submit();
      return true;
   }
   else { 
         alert('Desculpe, mas você não tem permissão para executar esta função.'); 
         return false;
   }
}

function mudaCor(){

   var aux;

  // se houver mais de um registro de fornecedor
  if (mlocal.length > 1)
  {
     aux = document.form.aux_nrlocali[this.id].checked;
     // Zera todo mundo. Só pode selecionar 1
     for(i = 1; i < document.all.tblocal.rows.length; i++)
     {
        document.all.tblocal.rows[i].bgColor = '#FFFFFF';
        document.form.aux_nrlocali[i-1].checked=false;
     }

     if (aux==false)
     {
         this.bgColor = '#CCCCCC';
         document.form.aux_nrlocali[this.id].checked=true;
     }
     else
     {
         this.bgColor = '#FFFFFF';
         document.form.aux_nrlocali[this.id].checked=false;
     }
  }
  // se for somente um registro de fornecedor
  else
  {
     if (document.form.aux_nrlocali.checked==false){
         this.bgColor = '#CCCCCC';
         document.form.aux_nrlocali.checked=true;
     }
     else{
         this.bgColor = '#FFFFFF';
	 document.form.aux_nrlocali.checked=false;
     }
  } 
}

function mostraLocal(){

  var row; var cell;
  var cor='#F7F7F7';

  // limpa a tabela de Local, menos a 1ª linha - linha do cabecalho
  for (var i=document.all.tblocal.rows.length; i>2; i--)
      document.all.tblocal.deleteRow(i-1);

  for(i=0;i<mlocal.length;i++){      // insere linhas na tabela de locais
     row=tblocal.insertRow();  // nova linha
     row.id=i;

     if (cor == '#FFFFFF')
        cor = '#F7F7F7';
     else
        cor = '#FFFFFF';
     
     row.bgColor = cor;

     row.onclick=mudaCor;
	 row.style.cursor = 'hand';
     //row.bgColor=mlocal[i].regselec;

     // nome do local
     cell=row.insertCell();      
     cell.className = 'txtPequeno';

	 linky='&nbsp;&nbsp;'+mlocal[i].dslocali + '<in' + 'put type="hidden" name="aux_nrlocali" value="' + mlocal[i].nrseqdig + '">';
	 cell.innerHTML= linky;

     cell=row.insertCell();   // Separador
     cell.className = 'txtPequeno';
     cell.width= 2;
     cell.height = 30;
     cell.align = 'left';
     cell.innerText='';

     // Capacidade
     cell=row.insertCell();      
     cell.className = 'txtPequeno';
     cell.align = 'right';
     cell.innerText=mlocal[i].vldialoc; 

     cell=row.insertCell();   // Separador
     cell.className = 'txtPequeno';
     cell.width= 2;
     cell.height = 30;
     cell.align = 'left';
     cell.innerText='';

     // Capacidade
     cell=row.insertCell();      
     cell.className = 'txtPequeno';
     cell.innerText=mlocal[i].qtmaxpes; 

     cell=row.insertCell();   // Separador
     cell.className = 'txtPequeno';
     cell.width= 2;
     cell.height = 30;
     cell.align = 'left';
     cell.innerText='';

     //  Endereço
     cell=row.insertCell();      
     cell.className = 'txtPequeno';
     linky=mlocal[i].dsendloc;
     cell.innerHTML=linky; 

     cell=row.insertCell();   // Separador
     cell.className = 'txtPequeno';
     cell.width= 2;
     cell.height = 30;
     cell.align = 'left';
     cell.innerText='';

     // Estrutura
     cell=row.insertCell();      
     cell.className = 'txtPequeno';
     cell.align = 'right';
     linky=mlocal[i].dsestloc;
     cell.innerHTML=linky;

     cell=row.insertCell();   // Separador
     cell.className = 'txtPequeno';
     cell.width= 2;
     cell.height = 30;
     cell.align = 'left';
     cell.innerText='';

     // Contato
     cell=row.insertCell();      
     cell.className = 'txtPequeno';
     cell.align = 'right';
     linky=mlocal[i].nmconloc;
     cell.innerHTML=linky;

     cell=row.insertCell();   // Separador
     cell.className = 'txtPequeno';
     cell.width= 2;
     cell.height = 30;
     cell.align = 'left';
     cell.innerText='';

     // Telefone
     cell=row.insertCell();      
     cell.className = 'txtPequeno';
     cell.align = 'right';
     linky=mlocal[i].nrtelefo;
     cell.innerHTML=linky;
  }
}

function armazenaLocal(){
  var i;
  // se for mais de um registro de local
  if (mlocal.length > 1){
     for(i=0;i<document.form.aux_nrlocali.length;i++)
       if(document.form.aux_nrlocali[i].checked)
       {
          document.form.aux_lslocali.value = document.form.aux_nrlocali[i].value;
       } 
     }
  // se for somente um registro de local
  else{
     if(document.form.aux_nrlocali.checked)
	    document.form.aux_lslocali.value = document.form.aux_nrlocali.value;
  }

  if (document.form.aux_lslocali.value == '') {
     document.form.aux_lslocali.value = '0,';
  }

}

if (mlocal.length == 0){
    alert('Não há locais cadastrados para este PAC');
    self.close();
} 

mostraLocal();

</script>
