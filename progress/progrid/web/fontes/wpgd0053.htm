<!--
	Alterações:
-->
<html>
	<head>
		<title>Eventos para Sele&ccedil;&atilde;o - AGO/AGE</title>
	</head>
	<body style="margin-left: 3px; ">
		<link href="/cecred/estilos/progrid.css" rel="stylesheet" type="text/css">
		<script SRC="/cecred/jsbiblio/sorttable.js"></script>
		<script language="JavaScript">
			NomeDoProgramaPrincipal  = '/wpgd0053.w';
		</script>
		<form action="#." method="POST" name="form">  
			<input name="aux_nmpagina" type="hidden" value="">
			<input type="hidden" name="aux_dsendurl" value="">
			<input type="hidden" name="aux_cddopcao" value="">
			<input type="hidden" name="aux_nrdrowid" value="">
			<input type="hidden" name="aux_lspermis" value="">
			<input type="hidden" name="aux_stdopcao" value="">
			<input type="hidden" name="aux_cdevento" value="">
			<input type="hidden" name="aux_cdagenci" value="">
			<input type="hidden" name="aux_idevento" value="">
			<input type="hidden" name="glb_cdcooper" value="">
			<input type="hidden" name="aux_cdcooper" value="">
			<input type="hidden" name="aux_cdcopope" value="">
			<input type="hidden" name="aux_cdoperad" value="">

			<div id="Layer1" style="position:absolute; border:0px; width:35px; height:35; z-index:1; left: 25px; top: 2px; visibility: ;"><img src="/cecred/images/icones/ico_fornecedor.gif" width="28" height="32" align="bottom"></div>
			<table width="575" border="0" align="left" cellpadding="0" cellspacing="0" background="/cecred/images/geral/guia_fundo.gif">
				<tr>
					<td width="11"><img src="/cecred/images/geral/guia_esquerda.gif" width="11" height="21"></td>
					<td width="56"><img src="/cecred/images/geral/spacer.gif" width="10" height="10"></td>
					<td width="370" height="20" align="left" class="linkGuia">Eventos para Sele&ccedil;&atilde;o - AGO/AGE</td>
					<td width="127" height="20" align="right" class="linkGuia">wpgd0053</td>          
					<td width="11" align="right"><img src="/cecred/images/geral/guia_direita.gif" width="11" height="21"></td>
				</tr>
				<tr valign="top" bgcolor="#FFFFFF">
					<td colspan="5">
						<table width="575" height="335" border="0" align="left" cellpadding="0" cellspacing="1" bgcolor="#999999">
							<tr>
								<td height="200" valign="top" bgcolor="#FFFFFF">
									<table width="100%" border="0" cellpadding="0" cellspacing="0">
										<tr>                                
											<td width="1%" height="15" align="left">&nbsp;</td>
											<td align="left">&nbsp;</td>
											<td width="1%" align="left">&nbsp;</td>
										</tr>
										<tr valign="top">
											<td height="15" align="left">&nbsp;</td>
											<td height="15" align="left" bgcolor="#F5F5F5">
												<table width="565" border="0" align="left" cellpadding="0" cellspacing="0" bgcolor="#FFFFFF">
													<tr>
														<td colspan="3" align="left" class="NomeCampo">
															Cooperativa:
															<select name="aux_nmrescop" class="Campo" onChange="mudaCoop()">
															</select>
															Agenda:
															<input type="text" name="aux_dtanoage" size="8" onChange="document.form.submit();">
															<br>
															<br>
														</td>
													</tr>
													<tr align="center">
														<td width="90" height="15">
															<table width="88" id="AbaEventos" border="0" cellpadding="0" cellspacing="0">
																<tr style="cursor:hand">
																	<td background="/cecred/images/menu/mnu_nle.gif" width="4" height="21">&nbsp;</td>
																	<td width="80" align="center" class="txtTituloHid" onclick="mostraDiv('divEventos')">Eventos</td>
																	<td background="/cecred/images/menu/mnu_nld.gif" width="4" height="21"></td>
																</tr>
															</table>
														</td>
														<td width="90" height="15"></td>
														<td width="500" align="right" class="txtTituloHid">
															<div id="adicionar">
																<a href="#." onclick="AdEvento();">Selecionar Eventos</a>
															</div>
														</td>                                                                                                
													</tr>
													<tr>
														<td colspan="3" width="200" height="2" align="left" background="/cecred/images/menu/mnu_slc.gif"></td>
													</tr>                                          
													<tr bgColor="#F5F5F5">
														<td colspan="3">
															<div id="divEventos" align="center">
																<table width="100%" height="227" border="0" cellspacing="0" cellpadding="3">
																	<tr>
																		<td align="center" valign="top">
																			<table width="100%" class="dataTable" id="tbeventos" cellpadding="0" cellspacing="0" border="0">
																				<tr>
																					<td width="5" class="txtMenuTitulos" background="/cecred/images/menu/fnd_title.jpg">Eventos</td>
																					<td width="2" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
																					<td width="30" height="26" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos">&nbsp;</td>
																					<td width="2" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
																					<td class="txtMenuTitulos" background="/cecred/images/menu/fnd_title.jpg" style="text-align:center;">
																						<a href="#." onClick=EnviarPAC(0); class="linkGuia">
																							<div id="imgEnviar" name="imgEnviar">
																								<img src="/cecred/images/icones/ico_seta.gif" border="0" title="Enviar Eventos para Seleção – OQS Filiada">
																							</div>
																						</a>
																					</td>
																				</tr>
																			</table>
																		</td>
																	</tr>
																</table>                                                        
															</div>																									
														</td>
													</tr>
												</table>                                                            
											</td>
											<td>&nbsp;</td>
										</tr>                                                                
									</table>
								</td>
							</tr>
						</table>
					</td>
				</tr>
			</table>
		</form>
	</body>
	<script language="javascript">
		NomeDoProgramaPrincipal  = '/wpgd0053.w';
		NomeDoProgramaDeListagem = '/wpgd0053s.w';
		NomeDoProgramaDeAjuda    = '/wpgd0053aj.w';
		NomeDoProgramaDeZoom     = '';

		NomeDoProgramaPrincipal = document.form.aux_dsendurl.value + NomeDoProgramaPrincipal;
		document.form.action = NomeDoProgramaPrincipal;

		function AdEvento(){

			// Verifica se o usuário tem permissão de inclusao
			if (document.form.aux_lspermis.value.substring(0,1) != 'I'){ 
				alert('Desculpe, mas você não tem permissão para executar esta função.'); 
				return false;
			}

			// aux_cdcooper é a cooperativa que o usuário está trabalhando
			aux_cdcooper = document.form.aux_nmrescop.value;   

			VarURL = document.form.aux_dsendurl.value  + '/wpgd0053a.htm?aux_idevento=' + document.form.aux_idevento.value + '&glb_cdcooper=' + document.form.glb_cdcooper.value + '&aux_cdcooper=' + aux_cdcooper + '&aux_dtanoage=' + document.form.aux_dtanoage.value;  
			window.open(VarURL,'','toolbar=no,location=no,diretories=no,status=no,resizable=yes,menubar=no,scrollbars=yes,width=600,height=500,top=10,left=10');          
		}

		function CarregaPrincipal(){
		}

		function Recarrega(){
			document.form.submit();  
		}

		function mudaCoop(){
			 document.form.aux_cdcooper.value = document.form.aux_nmrescop.value;
			 document.form.aux_dtanoage.value = '';
			 document.form.submit();
		}

		function mostraEventos(){

			var row; 
			var cell;
			var cor = '#F7F7F7';
			var eventos = new Array();  
			var flgEnviar = false;
			
			// limpa a tabela de Eventos
			for (var i=document.all.tbeventos.rows.length; i>1; i--){
					document.all.tbeventos.deleteRow(i-1);
			}
      
			// cria as linhas com as células...
			for(var i=0;i<meventos.length;i++){    
				
				row=tbeventos.insertRow();
				 
				if(cor == '#FFFFFF')
					cor = '#F7F7F7';
				else
					cor = '#FFFFFF';

				row.bgColor = cor;
				 
				 // 1ª célula da linha
				 cell=row.insertCell();         
				 cell.className = 'txtNormal';                         
				 linky = meventos[i].nmevento;
				 cell.innerHTML=linky;
				 cell.align="left";
										 
				 // Separador
				 cell=row.insertCell();
				 cell.className = 'txtNormal';
				 cell.width= 5;
				 cell.height = 30;
				 cell.align = 'left';
				 cell.innerText='';
	 
				 // 2ª célula da linha
				 cell=row.insertCell();
				 cell.className = 'txtNormal';
				 if(meventos[i].flpacenv != 1){ 
					 if(!flgEnviar){
						 flgEnviar = true;
					 }	
					 linky='<a href="#." onClick=ExEvento(' + meventos[i].cdevento + '); class="linkGuia"><img src="/cecred/images/botoes/btn_excluir.gif" border="0" title="Excluir"></a>';  
				 }else{
				   linky='';
				 }
				 cell.innerHTML=linky;
				 cell.align="center";
				 cell.width="30";     
										 
				 // Separador
				 cell=row.insertCell();
				 cell.className = 'txtNormal';
				 cell.width= 5;
				 cell.height = 30;
				 cell.align = 'left';
				 cell.innerText='';
														
					// 3ª célula - Ícone para mandar ao PA
				 cell=row.insertCell();
				 cell.className = 'txtNormal';
				 cell.innerHTML = '&nbsp;';
				 cell.width="40"; 						 
			}
			
			if(meventos.length > 0 && flgEnviar){
				document.all.imgEnviar.style.visibility = 'visible';
			}else{
				document.all.imgEnviar.style.visibility = 'hidden';
			}
			
		}

		function ExEvento(evento){

			 // Verifica se o usuário tem permissão de exclusao
			 if (document.form.aux_lspermis.value.substring(2,3) != 'E'){ 
					alert('Desculpe, mas você não tem permissão para executar esta função.'); 
					return false;
			 }

			 if(evento != 0)   {
					if (!confirm('Confirma Exclusão do Evento para a Cooperativa?')){
						 return false;
					}

					document.form.aux_cdevento.value = evento;
					document.form.aux_cddopcao.value = "exe";
					document.form.submit();
			 }
		}

		function mostraDiv(nomediv){
			var nomeaba = '';

			if (nomediv=='')
				nomediv='divEventos';
 
			if (nomediv=='divEventos')
				nomeaba='AbaEventos';

			document.form.aux_nmpagina.value=nomediv;
			document.all.divEventos.style.display = 'none';
			document.all.adicionar.style.visibility = 'hidden';

			document.all.AbaEventos.rows[0].cells[0].background="/cecred/images/menu/mnu_nle.gif";
			document.all.AbaEventos.rows[0].cells[1].background="/cecred/images/menu/mnu_nlc.gif";
			document.all.AbaEventos.rows[0].cells[2].background="/cecred/images/menu/mnu_nld.gif";
			document.all.AbaEventos.rows[0].cells[1].className="txtTituloHid";
					 
			document.all[nomeaba].rows[0].cells[0].background="/cecred/images/menu/mnu_sle.gif";
			document.all[nomeaba].rows[0].cells[1].background="/cecred/images/menu/mnu_slc.gif";
			document.all[nomeaba].rows[0].cells[2].background="/cecred/images/menu/mnu_sld.gif";
			document.all[nomeaba].rows[0].cells[1].className="txtTituloVis";

			if(nomeaba == 'AbaEventos')
				document.all.adicionar.style.visibility = 'visible';

			document.all[nomediv].style.display = 'block';
		}

		function EnviarPAC(pac){

			 // Verifica se o usuário tem permissão de inclusão
			 if (document.form.aux_lspermis.value.substring(0,1) != 'I'){ 
					alert('Desculpe, mas você não tem permissão para executar esta função.'); 
					return false;
			 }
			 if(pac == 0){
				 if (!confirm('Confirma o ENVIO dos Eventos?')){
						return false;
				 }
			 }
							
			 // Força a opção para enviar
			 document.form.aux_cdagenci.value = pac;
			 document.form.aux_cddopcao.value = "env";
			 document.form.submit();   
		}

		function PosicionaCoop(){

			 // posiciona a seleção no primeiro registro de Cooperativas, se só tiver 1
			 if(document.all.aux_nmrescop.options.length == 1)
			 {
					document.form.aux_nmrescop.value = document.all.aux_nmrescop.options[0].value;
					mudaCoop();
			 }
			 else
					document.form.aux_nmrescop.value = '';
		}

		// Descarta as sugestoes que não foram utilizadas
		function Descartar(){

			 // Verifica se o usuário tem permissão de exclusao
			 if (document.form.aux_lspermis.value.substring(2,3) != 'E'){ 
					alert('Desculpe, mas você não tem permissão para executar esta função.'); 
					return false;
			 }

			 if (confirm("Todas as sugestões não selecionadas serão descartadas, não podendo mais participar dessa agenda. A reativação de uma sugestão só poderá ser efetuada através da tela de Analise de Sugestões. Deseja continuar?") == false)
					return false;

			 document.form.aux_cddopcao.value = "des";
			 document.form.submit(); 
		}

		mostraDiv(document.form.aux_nmpagina.value);

		// valida os parâmetros da agenda
		if(document.form.aux_dtanoage.value == ''){
			 alert('Parâmetro da Agenda Não Encontrado!!!');
			 
			 document.form.aux_dtanoage.value = '';
			 document.form.aux_cdcooper.value = '';   
		}
		else{
			if(document.form.aux_cdcooper.value != ''){
				mostraEventos();
			}else{
				PosicionaCoop();
			}
		}
	</script>
</html>