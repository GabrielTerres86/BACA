<!-- Generated by WebSpeed - http://www.webspeed.com/ 

Alterações: 20/01/2012 - Não mostrar validação para PAC, cuja seleção foi 
                                                 encerrada sem evento (integração) selecionado 
                                                 (Isara - RKAM)
                                                 
                        23/01/2012 - Permitir "Liberar para a Agenda" o PAC, cuja seleção 
                                                 foi encerrada sem evento (integração) selecionado
                                                 (Isara - RKAM)
                                                 
                        24/01/2012 - Inclusão do campo aux_resposta para armazenar o retorno 
                                                 da mensagem e enviar para o wpgd0027.w
                         (Isara - RKAM)
                                                 
                        15/02/2012 - Não permitir adicionar eventos se o status da agenda for
                                                 igual a 1 (Isara - RKAM)
                                                 
                        08/01/2013 - Correção function Salvar() para permitir liberar apenas
                                                 um evento (Daniel - CECRED).
-->

<html>
<head>
<meta name="AUTHOR" content="Solusoft/Bt - wpgd0027 - C.18">
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta name="wsoptions" content="no-output">
<meta name="GENERATOR" content="Microsoft FrontPage 4.0">
<meta http-equiv="Cache-Control" content="No-Cache">
<meta http-equiv="Pragma"        content="No-Cache">
<meta http-equiv="Expires"       content="0">
<title>Confirmação dos Eventos</title>
<link href="/cecred/estilos/progrid.css" rel="stylesheet" type="text/css">
<!--script SRC="/cecred/jsbiblio/sorttable.js"></script-->
</head>
<body style="margin-left: 3px; ">

<script language="JavaScript">
   NomeDoProgramaPrincipal  = '/wpgd0027.w';
   NomeDoProgramaDeListagem = '/wpgd0027ls.w';
   NomeDoProgramaDeAjuda    = '/wpgd0027aj.w';
</script>

<form action="#." method="POST" name="form">
        
    <input type="hidden" name="aux_dsendurl" value="">
    <input type="hidden" name="aux_idevento" value="">
    <input type="hidden" name="aux_cddopcao" value="">
    <input type="hidden" name="aux_nrdrowid" value="">
    <input type="hidden" name="aux_lspermis" value="">
    <input type="hidden" name="aux_dsretorn" value="">
    <input type="hidden" name="aux_stdopcao" value="">  
    <input type="hidden" name="cdagenci"     value=""> 
    <input type="hidden" name="dtanoage"     value="">
    <input type="hidden" name="aux_lsevesel" value="">
    <input type="hidden" name="aux_lsconsel" value=""> 
        <input type="hidden" name="aux_resposta" value="">        
  
  <!-- Inicio do modelo com abas -->

  <div id="Layer1" style="position:absolute; border:0px; width:35px; height:35; z-index:1; left: 25px; top: 2px; visibility: ;"><img src="/cecred/images/icones/ico_fornecedor.gif" width="28" height="32" align="bottom">        </div>
  <table width="575" height="360"  border="0" align="left" cellpadding="0" cellspacing="0" background="/cecred/images/geral/guia_fundo.gif">
          <tr>
            <td height="20" colspan="5"><table width="100%"  border="0" cellspacing="0" cellpadding="0">
          <tr>
                  <td width="11"><img src="/cecred/images/geral/guia_esquerda.gif" width="11" height="21"></td>
                  <td width="56"><img src="/cecred/images/geral/spacer.gif" width="48" height="10"></td>
                  <td width="258" height="20" class="linkGuia">Confirma&ccedil;&atilde;o dos Eventos </td>
                  <td width="257" class="linkGuia"><div align="right">wpgd0027</div></td>
                  <td width="11" align="right" valign="middle" class="linkGuia"><img src="/cecred/images/geral/guia_direita.gif" width="11" height="21"></td>
          </tr>
        </table></td>
    </tr>
          <tr valign="top" bgcolor="#FFFFFF">
                  <td colspan="5">
                          <table width="100%" height="100%"  border="0" align="left" cellpadding="0" cellspacing="1" bgcolor="#999999">
                                  <tr>
                                          <td height="200" valign="top" bgcolor="#FFFFFF">
                                                  <table width="100%" height="100%"  border="0" cellpadding="0" cellspacing="0">
                                                          <tr>
                                                                  <td height="15" rowspan="3" align="left">&nbsp;</td>
                                                                  <td height="20"  align="left" valign="top">
<!-- Interrupcao do modelo - início das abas -->
                                                                          <table width="99%"  border="0" align="center" cellspacing="1">
                                                                                  <tr align="left">
                                                                                    <td colspan="7" class="NomeCampo"><img src="/cecred/images/geral/spacer.gif" width="48" height="10"></td>
                                                                            </tr>
                                                                                  <tr>
                                                                                          <td width="10%" align="right" class="NomeCampo"> Agenda: </td>
                                                                                          <td width="9%" class="NomeCampo">
                                                                                                          <input name="aux_dtanoage" type="text" size="4" onChange="document.form.submit();">
                                                                                          </td>
                                                                                          <td width="19%" align="right" class="NomeCampo"> Cooperativa: </td>
                                                                                          <td width="13%" class="NomeCampo">
                                                                                                  <select name="aux_cdcooper" class="Campo" id="cdcooper" onChange="document.form.aux_dtanoage.value = ''; document.form.aux_cddopcao.value=''; document.form.aux_cdagenci.value=''; document.form.submit();">
                                                                                                  </select>
                                                                                          </td>
                                                                                          <td width="9%" class="NomeCampo"><div align="right">PA:</div></td>
                                                                                          <td width="30%" class="NomeCampo">
                                                                                                  <select name="aux_cdagenci" class="Campo" id="aux_cdagenci" onChange="document.form.cdagenci.value = document.form.aux_cdagenci.value; document.form.submit();"></select>
                                                                                          </td>                                                                                                        
                                                                                          <td width="22%" class="NomeCampo"><div align="right"><a href="#." onclick="adEvento();">Adicionar<br>Eventos</a>&nbsp;</div></td>                                                                                                                                                                                    
                                                                                  </tr>
                                                                                  <tr>
                                                                                          <td align="right" class="NomeCampo">Verba destinada: </td>
                                                                                          <td class="NomeCampo"><input name="aux_vlprogri" type="text" disabled="true" class="CampoNumerico" id="aux_vlprogri" size="8" readonly></td>
                                                                                          <td align="right" class="NomeCampo">Custo estimado: </td>
                                                                                          <td class="NomeCampo"><input name="aux_vlcuseve" type="text" disabled="true" class="CampoNumerico" id="aux_vlcuseve" size="8" readonly></td>
                                                                                          <td class="NomeCampo"><div align="right">Saldo:</div></td>
                                                                                          <td colspan="3" class="NomeCampo"><input name="aux_salcusto" type="text" class="CampoNumerico" id="aux_salcusto" size="8" readonly></td>
                                                                                  </tr>
                                          <tr>
                                             <td align="right" class="NomeCampo" nowrap>Qtde Integrações: </td>
                                                                                         <td width="13%" align="right" class="NomeCampo"><div align="left">
                                                                                          <input name="aux_qtintegr" type="text" disabled="true" class="CampoNumerico" size="8" readonly>
                                                                                         </div></td>
                                                                                         <td class="NomeCampo" nowrap><div align="right">Valor Integrações: </div></td>
                                                                                         <td width="9%" class="NomeCampo"><input name="aux_vlintegr" type="text" disabled="true" class="CampoNumerico" size="8" readonly></td>
                                                                                   </tr>
                                                                           </table>
                                                                    <!-- Fim dos dados do programa - retorno ao modelo -->
                                                                  </td>
                                                          </tr>
                                                          <tr>
                                                            <td height="8"  align="left" valign="top">
                                                                
                                                                                <div id="divVerba" align="left">
                                                                                  <table width="100%" border="0" align="center">
                                                                                          <tr>
                                                                                                  <td>
                                                                                                                  <table width="100%" border="0" cellpadding="0" cellspacing="0" class="dataTable">
                                                                                                                          <tr>
                                                                                                                                    <td id="separador1" width="5" height="25" align="center" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                                                                                                                                  <td id="tbevento_col1" width="170" height="25" align="left" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos">Evento</td>
                                                                                                                                  <td width="5" height="25" align="center" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                                                                                                                                  <td id="tbevento_col2" width="150" height="25" align="left" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos"> Eixo tem&aacute;tico </td>
                                                                                                                                  <td width="5" height="25" align="center" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                                                                                                                                  <td id="tbevento_col3" width="70" height="25" align="left" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos">Carga horária</td>
                                                                                                                                  <td width="5" height="25" align="center" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                                                                                                                                  <td id="tbevento_col4" width="70" height="25" align="right" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos">Custo</td>
                                                                                                                                  <td width="5" height="25" align="center" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                                                                                                                                  <td id="tbevento_col5" width="60" height="25" align="left" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos">Confirmado</td>
                                                                                                                                  <td width="5" height="25" align="center" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                                                                                                                                  <td id="tbevento_col6" width="15" height="25" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos">&nbsp;</td>
                                                                                                                          </tr>
                                                                                                    </table>      
                                                                                                  </td>
                                                                                          </tr>
                                                                                          <tr>
                                                                                                  <td>
                                                                                                          <div style="overflow: auto; height:'150';">
                                                                                                                  <table id="tbevento" width="100%" border="0" cellspacing="0" cellpadding="0" class="dataTable">
                                                                                                                          <!-- INCLUI DADOS -->
                                                                                                                  </table>      
                                                                                                          </div>
                                                                                                  </td>
                                                                                          </tr>
                                                                                  </table>
                                                                          </div>
                                                                
                                                                </td>
                                                    </tr>
                                                          <tr>
                                                            <td height="10"  align="left" valign="bottom">
                                                                <table width="175" align="center">
                                                                  <tr>
                                                                        <td align="center"><img src="/cecred/images/botoes/btn_liberar_para_agenda.gif" style="cursor:hand" onClick="Salvar()" name="btn_libera"></td>
                                                                  </tr>
                                                            </table>
                                                                </td>
                                                    </tr>
                                            </table>
                                          </td>
                                  </tr>
                    </table>
                  </td>
          </tr>
  </table>
  <!-- fim do modelo -->
  
</form>

<script language="JavaScript">        
NomeDoProgramaPrincipal = document.form.aux_dsendurl.value + NomeDoProgramaPrincipal;
document.form.action = NomeDoProgramaPrincipal;

var itemselec = false;

function mostraEventos(){
 var row;var cell;
 var liberar = true; 
 var cor='#F7F7F7';
 var status = false;

 document.form.aux_vlcuseve.value = 0;
 document.form.aux_vlprogri.value = 0;
 document.form.aux_salcusto.value = 0;

 // Apaga todas as linhas, menos a do cabeçalho
 for (var i=document.all.tbevento.rows.length; i>0; i--)
      document.all.tbevento.deleteRow(i-1); 

 for(i=0;i<mevento.length;i++){ 

   if((mevento[i].cdcooper == document.form.aux_cdcooper.value)&&
      (mevento[i].cdagenci == document.form.aux_cdagenci.value))
   {

      // Integrações
      if (mevento[i].ctevento == '2') 
      {
         document.form.aux_vlintegr.value = parseFloat(ConverteDec(mevento[i].vlcuseve, "1")) * parseFloat(mevento[i].qtintegr);                 
         document.form.aux_vlintegr.value = formatCurrency(document.form.aux_vlintegr.value);
         document.form.aux_qtintegr.value = mevento[i].qtintegr;
      }
      else
      {
      
         row=tbevento.insertRow(); 
         row.id=mevento[i].cdagenci;
      
         if (cor == '#FFFFFF')
            cor = '#F7F7F7';
         else
            cor = '#FFFFFF';
         
         row.bgColor = cor;
   
         // Valor de Verba do PAC
         document.form.aux_vlprogri.value = mevento[i].vlverbap;
             
         //document.form.aux_qtdevent.value = mevento[i].qtpreeve;
             cell=row.insertCell();   // Separador
         cell.className = 'txtNormal';
         cell.width= document.all.separador1.width;
         cell.height = 30;
         cell.align = 'left';
         cell.innerText='';
             
         // Evento
             cell=row.insertCell();    
         cell.className = 'txtPequeno';
         cell.width= document.all.tbevento_col1.width;;
         cell.height = 30;
         cell.align = 'left';
         linky=mevento[i].nmevento + '<in' + 'put type="hidden" name="aux_cdevento" value="' + mevento[i].cdevento + '">';
         cell.innerHTML=linky;
             
             cell=row.insertCell();   // Separador
         cell.className = 'txtNormal';
         cell.width= document.all.separador1.width;
         cell.height = 30;
         cell.align = 'left';
         cell.innerText='';
   
         // Eixo Temático
         cell=row.insertCell();    
         cell.className = 'txtPequeno';
         cell.width= document.all.tbevento_col2.width;
         cell.height = 30;
         cell.align = 'left';
         cell.innerText=mevento[i].dseixtem; 
      
         cell=row.insertCell();   // Separador
         cell.className = 'txtNormal';
         cell.width= document.all.separador1.width;
         cell.height = 30;
         cell.align = 'left';
         cell.innerText='';
      
         // Carga Horária
         cell=row.insertCell();    
         cell.className = 'txtNormal';
         cell.width= document.all.tbevento_col3.width;
         cell.height = 30;
         cell.align = 'right';
         cell.textAlign = 'right';
         cell.innerText=mevento[i].qtcarhor;
      
         cell=row.insertCell();   // Separador
         cell.className = 'txtNormal';
         cell.width= document.all.separador1.width;
         cell.height = 30;
         cell.align = 'left';
         cell.innerText='';
      
         // Custo
         cell=row.insertCell();    
         cell.className = 'txtNormal';
         cell.width= document.all.tbevento_col4.width;
         cell.height = 30;
         cell.align = 'right';
         cell.textAlign = 'right';
         linky=mevento[i].vlcuseve + '<in' + 'put type="hidden" name="aux_vlcusevi" value="' + ConverteDec(mevento[i].vlcuseve, "1") + '">'
         cell.innerHTML=linky;
             
             cell=row.insertCell();   // Separador
         cell.className = 'txtNormal';
         cell.width= document.all.separador1.width;
         cell.height = 30;
         cell.align = 'left';
         cell.innerText='';
             
         // Flag de Selecionado
         cell=row.insertCell();   
         cell.className = 'txtNormal';
         cell.width= document.all.tbevento_col5.width;
         cell.height = 30;
         cell.align = 'center';
         cell.title = '';
         linky='<in' + 'put type="checkbox" name="aux_flgselec" onclick="AtualizaSaldo();" ' + mevento[i].flgevsel + ' ' + mevento[i].flgevobr + '>';
             cell.innerHTML=linky;
             
             cell=row.insertCell();   // Separador
         cell.className = 'txtNormal';
         cell.width= document.all.tbevento_col6.width;
         cell.height = 30;
         cell.align = 'left';
         cell.innerText='';
      
         //document.form.aux_vlcuseve.value = parseFloat(document.form.aux_vlcuseve.value) + parseFloat(ConverteDec(mevento[i].vlcuseve, "1"));
                 
                 // se ja foram enviados os eventos, desabilita o botão de envio
                 if (liberar){                 
                      if (mevento[i].idstagen >= 3){
                        document.form.btn_libera.style.filter='progid:DXImageTransform.Microsoft.BasicImage(opacity=0.2)';
                              document.form.btn_libera.style.cursor='default';
                            document.form.btn_libera.disabled=true;
                }
                        else{
                                document.form.btn_libera.style.filter='';
                              document.form.btn_libera.style.cursor='hand';
                            document.form.btn_libera.disabled=false;                                                        
                            liberar = false;
                        }                        
                 }         
      }
   }
 } 

//document.form.aux_salcusto.value = parseFloat(document.form.aux_vlprogri.value) - parseFloat(document.form.aux_vlcuseve.value);

/* Não mostrar validação para PAC, cuja seleção foi encerrada sem evento (integração) selecionado */
for(i=0;i<mevento.length;i++){
    if (mevento[i].idstagen > 1)
            status = true;
}
 
if((document.all.tbevento.rows.length > 0) || (status == true))
    AtualizaSaldo();
else                
        if (document.form.aux_cdagenci.value != '') 
   alert("A seleção dos eventos ainda não foi concluída pelo PA.\nAguarde sua conclusão para prosseguir com a confirmação.");
   
}

function CarregaPrincipal () {
   //top.topFrame.document.all.titulo.innerHTML = 'Distribuição de Verbas - ' + document.form.aux_idevento.value;
   //jan3 = open('wpgd0027a.htm','fraux');
   jan3 = open('wpgd0027b.htm','fraux');
   window.status = "";
}

function LimparCampos() {}
function Habilita() {}
function HabilitaSalvar() {}

function ValidaDados(form)
    { 
       var msg="";
         
       /*  msg = msg + top.frcod.VE("ca",form.nmfornec,"O campo de nome do Fornecedor","nao");
        msg = msg + top.frcod.VE("ca",form.dsendfor,"O campo de endereço do Fornecedor","nao");
        msg = msg + top.frcod.VE("ca",form.nmcidfor,"O campo de cidade do Fornecedor","nao");
        msg = msg + top.frcod.VE("ca",form.nmbaifor,"O campo de bairro do Fornecedor","nao");
        msg = msg + top.frcod.VE("ca",form.nrcepfor,"O campo de CEP do Fornecedor","nao");
        msg = msg + top.frcod.VE("ca",form.cdufforn,"O campo de UF do Fornecedor","nao");
        msg = msg + top.frcod.VE("in",form.nrfonfor,"O telefone do Fornecedor","sim", "0", "99999999");
        msg = msg + top.frcod.VE("in",form.nrfaxfor,"O FAX do Fornecedor","sim", "0", "99999999");
        msg = msg + top.frcod.VE("in",form.cddddfor,"O DDD do telefone do Fornecedor","sim", "0", "99999999");
        msg = msg + top.frcod.VE("in",form.cddddfax,"O DDD do FAX do Fornecedor","sim", "0", "99999999");
*/
         
        if (msg == "")
            return true
        else
        {
           top.frcod.MostraResultado('1',msg);
           return false
        }
    }

function Recarrega()
{
   document.form.submit();
}

// Guardar os valores da tabela para que sejam salvos no banco de dados
function ArmazenaValores()
{
   document.form.aux_lsevesel.value = '';
   document.form.aux_lsconsel.value = '';

   if ((document.all.tbevento.rows.length == 0) && (itemselec == false))
       return false;    

   if ((parseFloat(document.form.aux_salcusto.value) < 0)&&(confirm("A soma do custo dos eventos dos PAs está superior à verba destinada aos PAs. O saldo atual é de " + document.form.aux_salcusto.value + ". Deseja prosseguir com a confirmação?") == false)) 
      return false;          

   // Se tem mais de um PAC
   if(document.all.tbevento.rows.length > 1)
   {
      for(i=0;i<document.form.aux_cdevento.length;i++)
         // Grava os valores em forma de lista, separados por ";", para que seja lido pelo progress
         if (document.form.aux_lsevesel.value == '') 
         {
            document.form.aux_lsevesel.value = document.form.aux_cdevento[i].value;
            document.form.aux_lsconsel.value = document.form.aux_flgselec[i].checked;
         }
         else
         {
            document.form.aux_lsevesel.value = document.form.aux_lsevesel.value + ';'
                                             + document.form.aux_cdevento[i].value;
            document.form.aux_lsconsel.value = document.form.aux_lsconsel.value + ";"
                                             + document.form.aux_flgselec[i].checked;
            
         }
    }
    else
    {            
           if (itemselec == false) {
              document.form.aux_lsevesel.value = document.form.aux_cdevento.value;
          document.form.aux_lsconsel.value = document.form.aux_flgselec.checked;           
           }
    }        
}

function Salvar()
{   
   /* Permitir "Liberar para a Agenda" o PA, cuja seleção foi encerrada sem evento (integração) selecionado */
   for(i=0;i<mevento.length;i++){
       itemselec = true;
   }
       
   //ZeraModoExclusao();
   if ((document.all.tbevento.rows.length < 1) && (itemselec == false)) {
      return false;
   }
   
   document.form.aux_stdopcao.value = 'al';
   var vaux = document.form.aux_lspermis.value;      
   
   if ((vaux.substring(1,2) == 'A') || (document.form.aux_stdopcao.value == 'i')) {              
        if ( document.form.aux_cddopcao.value!='sa')  {                    
           /*if (ValidaDados(document.forms[0])) {*/                    
               Habilita(); 
               HabilitaSalvar(); 
                           if (ArmazenaValores() == false) 
                               return false; 
                           if ((document.all.tbevento.rows.length >= 1) && (itemselec == true)) {
                   ConfirmaLiberacao();                                   
                                   document.form.aux_cddopcao.value='sa'; 
                                   status = 'Salvando. Por favor, aguarde ...';                            
                                   document.form.submit();                                                
                                   return true;         
                           }
          /*  } 
            else { 
              return false;
            }  */
        } 
   }
   else { 
         alert('Desculpe, mas você não tem permissão para executar esta função.'); 
         return false;
   }
}

// Converte um valor com decimal separado por "," para separado por "."
function ConverteDec(str, tipo)
{
   if(tipo == "1")
   {
      str = str.replace(".","");
      str = str.replace(",",".");
      return str;
   }
   else
   {
      str = str.replace(",","");
      str = str.replace(".",",");
      return str;
   }
}

function AtualizaSaldo()
{
   var aux_custo = 0;
   var aux_total = 0;
   var aux_saldo = 0;

   // Valor total é convertido para formato JavaScript
   document.form.aux_vlprogri.value = ConverteDec(document.form.aux_vlprogri.value,"1");

   // Total é gravado em sua variável
   aux_total = parseFloat(document.form.aux_vlprogri.value);

   for(i=0;i<document.all.tbevento.rows.length; i++)
   {
      if(document.form.aux_flgselec.length > 1)
      {
         if(document.form.aux_flgselec[i].checked)
         {
            // Soma todos os custos que estiverem com a flag de seleção marcada
            aux_custo = aux_custo + parseFloat(document.form.aux_vlcusevi[i].value);
         }
      }
      else
      {
         if(document.form.aux_flgselec.checked)
         {
            // Soma todos os custos que estiverem com a flag de seleção marcada
            aux_custo = aux_custo + parseFloat(document.form.aux_vlcusevi.value, "1");
         }
      }
          
   }
   
   // Variável de saldo recebe o total menos a soma dos custos
   aux_saldo = aux_total - aux_custo - parseFloat(ConverteDec(document.form.aux_vlintegr.value,"1"));

   // Se saldo < 0, exibe em vermelho
   if (aux_saldo < 0){
      document.form.aux_salcusto.style.color = 'red';          
   }
   else{
      document.form.aux_salcusto.style.color = '';
   }
   // Converte as varíaveis usando a função de conversão
   document.form.aux_vlcuseve.value = formatCurrency(aux_custo);
   document.form.aux_salcusto.value = formatCurrency(aux_saldo);
   document.form.aux_vlprogri.value = formatCurrency(aux_total);
}

function MostraPACs()
{
   
   for (var i=document.all.aux_cdagenci.options.length; i>=0; i--)
      document.all.aux_cdagenci.remove(i); 

   var oOption;
   
   for(i=0;i<mpac.length;i++)
   {
      if (mpac[i].cdcooper == document.form.aux_cdcooper.value)
      {
         oOption = document.createElement("OPTION");
         document.all.aux_cdagenci.options.add(oOption);
         oOption.innerText = mpac[i].nmresage.substring(0, 15);
         oOption.value = mpac[i].cdagenci;
      }
   }
}

function PosicionaPAC()
{    
   if(document.form.cdagenci.value != "")
   {
      //document.form.aux_cdeixtem.value = document.form.cdeixtem.value;
      MostraPACs();
      document.form.aux_cdagenci.value = document.form.cdagenci.value;          
   }
   else
   {      
      // posiciona a seleção no primeiro registro de Cooperativas, se só tiver 1
      if(document.all.aux_cdcooper.options.length == 1)
         document.form.aux_cdcooper.value = document.all.aux_cdcooper.options[0].value;

      // posiciona a seleção no primeiro registro de PACs, se só tiver 1
      if(document.all.aux_cdagenci.options.length == 1)
         document.form.aux_cdagenci.value = document.all.aux_cdagenci.options[0].value;
   }

   document.form.aux_cddopcao.value='';
      
   mostraEventos();
}

function adEvento(){

   if(mevento.length <= 0)
   {
          alert('Este PA não concluiu a Seleção dos Eventos! Impossível adicionar eventos!'); 
      return false;
   }

   // Verifica se o usuário tem permissão de inclusão
   if (document.form.aux_lspermis.value.substring(0,1) != 'I'){ 
      alert('Desculpe, mas você não tem permissão para executar esta função.'); 
      return false;
   }

   if (document.form.aux_cdagenci.value == '') {
      alert("PA deve ser selecionado");
   }
   else
   {                             
                VarURL = document.form.aux_dsendurl.value  + '/wpgd0027a.htm' + 
                 '?aux_cdagenci=' + document.form.aux_cdagenci.value +
                 '&aux_cdcooper=' + document.form.aux_cdcooper.value + 
                 '&aux_idevento=' + document.form.aux_idevento.value + 
                 '&aux_salcusto=' + document.form.aux_salcusto.value + 
                 '&aux_dtanoage=' + document.form.aux_dtanoage.value ;  
                window.open(VarURL,'','toolbar=no,location=no,diretories=no,status=no,menubar=no,scrollbars=yes,resizable=no,width=500,height=350,top=10,left=10');
   }
}

// Traz as informações atualizadas do banco de dados
function Recarrega(){
   document.form.aux_cddopcao.value = "rec";
   document.form.submit();  
}

//formatação dos campos
function formatCurrency(num) 
{
   //alert(num);
   num = num.toString().replace(/\$|\,/g,'');
   if(isNaN(num))
      num = "0";
   sign = (num == (num = Math.abs(num)));
   num = Math.floor(num*100+0.50000000001);
   cents = num%100;
   num = Math.floor(num/100).toString();
   if(cents<10)
      cents = "0" + cents;
   for (var i = 0; i < Math.floor((num.length-(1+i))/3); i++)
      num = num.substring(0,num.length-(4*i+3))+'.'+
   num.substring(num.length-(4*i+3));
   return (((sign)?'':'-') + num + ',' + cents);
}

function ConfirmaLiberacao()
{
    document.form.aux_resposta.value = 0;
        
    if (confirm("Não há eventos selecionados pelo PA. Deseja prosseguir com a liberação?") == true) 
            document.form.aux_resposta.value = 1;        
}

// valida os parâmetros da agenda
if(document.form.aux_dtanoage.value == ''){
   alert('Parâmetro da Agenda Não Encontrado!!!');
   
   document.form.aux_dtanoage.value = '';
   document.form.aux_cdagenci.value = '';
   document.form.aux_cdcooper.value = '';   
}
else
   MostraPACs();

</script>
</body>
