<html>
<head>
<title>Cadastro de Fornecedores</title>
<base target="mainFrame">
</head>
<body style="margin-left: 3px; ">
<link href="/cecred/estilos/progrid.css" rel="stylesheet" type="text/css">
<script SRC="/cecred/jsbiblio/sorttable.js"></script>
<script language="JavaScript">
function mostraContatos(){
 var row;var cell;

 var cor='#F7F7F7';

 for (var i=document.all.tbcontato.rows.length; i>0; i--)
      document.all.tbcontato.deleteRow(i-1); 

 for(i=0;i<mcontato.length;i++){      // insere linhas na tabela de contato
   row=tbcontato.insertRow(); 

   if (cor == '#FFFFFF')
      cor = '#F7F7F7';
   else
      cor = '#FFFFFF';

   row.bgColor = cor;

   cell=row.insertCell();   // primeira celula da linha (mail)
   cell.className = 'txtNormal';
   cell.width= 26;
   linky='<a href="mailto:' + mcontato[i].dsdemail + '"><img src="/cecred/images/icones/ico_email.gif" border="0"></a>';
   cell.innerHTML=linky; // fim primeira celula (mail)

   cell=row.insertCell();   // segunda celula da linha (nome)
   cell.className = 'txtNormal';
   cell.height = 26;
   cell.align = 'left';
   cell.width= document.all.tbcontato_col1.width;
   cell.innerText=mcontato[i].nmconfor; // fim segunda celula (nome)

   cell=row.insertCell();   // Separador
   cell.className = 'txtNormal';
   cell.height = 26;
   cell.align = 'left';
   cell.width= document.all.separador1.width;
   cell.innerText='';

   cell=row.insertCell();   // terceira celula da linha  (depto)
   cell.className = 'txtNormal';
   cell.height = 26;
   cell.align = 'left';
   cell.width= document.all.tbcontato_col2.width;
   cell.innerText=mcontato[i].dsdepart; // fim terceira celula (depto)

   cell=row.insertCell();   // Separador
   cell.className = 'txtNormal';
   cell.height = 26;
   cell.align = 'left';
   cell.width= document.all.separador1.width;
   cell.innerText='';

   cell=row.insertCell();   // quarta celula da linha (email)
   cell.className = 'txtNormal';
   cell.align = 'left';
   cell.width= document.all.tbcontato_col3.width;
   cell.title=mcontato[i].dsdemail;
   cell.innerText=mcontato[i].dsdemail.substring(0, 20); // fim quarta celula (email)

   cell=row.insertCell();   // Separador
   cell.className = 'txtNormal';
   cell.height = 26;
   cell.align = 'left';
   cell.width= document.all.separador1.width;
   cell.innerText='';

   cell=row.insertCell();   // quinta celula da linha (ddd)
   cell.className = 'txtNormal';
   cell.align = 'left';
	cell.width= document.all.tbcontato_col4.width;
   cell.innerText=mcontato[i].cddddfor; // fim quinta celula (ddd)

   cell=row.insertCell();   // Separador
   cell.className = 'txtNormal';
   cell.height = 26;
   cell.align = 'left';
   cell.width= document.all.separador1.width;
   cell.innerText='';

   cell=row.insertCell();   // sexta celula da linha (fone)
   cell.className = 'txtNormal';
   cell.align = 'left';
   cell.width= document.all.tbcontato_col5.width;
   cell.innerText=mcontato[i].nrfonfor; // fim sexta celula (fone)

   cell=row.insertCell();   // Separador
   cell.className = 'txtNormal';
   cell.height = 26;
   cell.align = 'left';
   cell.width= document.all.separador1.width;
   cell.innerText='';

   cell=row.insertCell();   // setima celula da linha (edita)
   cell.className = 'txtNormal';
   cell.align = 'center';
   cell.width= document.all.tbcontato_col6.width;
   linky='<a href="#." onClick=EdContato("' + mcontato[i].idconfor + '"); class="linkGuia"><img src="/cecred/images/botoes/btn_atualizar.gif" title="Atualizar" border="0"></a>';
   cell.innerHTML=linky; // fim sexta celula (edita)

   cell=row.insertCell();   // Separador
   cell.className = 'txtNormal';
   cell.height = 26;
   cell.align = 'left';
   cell.width= document.all.separador1.width;
   cell.innerText='';

   cell=row.insertCell();   // oitava celula da linha (apaga)
   cell.className = 'txtNormal';
   cell.align = 'center';
   cell.width= document.all.tbcontato_col7.width;
   linky='<a href="#." onClick=ExContato("' + mcontato[i].idconfor + '"); class="linkGuia"><img src="/cecred/images/botoes/btn_excluir.gif" border="0" title="Excluir"></a>';
   cell.innerHTML=linky; // fim oitava celula (apaga)
 }  
}

function mostraEixos(){
 var row;
 var cell;
 var cor = '#F7F7F7';

 for (var i=document.all.tbeixo.rows.length; i>0; i--)
      document.all.tbeixo.deleteRow(i-1);

 for(i=0;i<meixo.length;i++){      // insere linhas na tabela de eixo
   row=tbeixo.insertRow(); 

   if (cor == '#FFFFFF')
      cor = '#F7F7F7';
   else
      cor = '#FFFFFF';

   row.bgColor = cor;
	
   cell=row.insertCell();   // ESPAÇO ANTES DO TEXTO
   cell.className = 'txtNormal';
   cell.height = 26;
   cell.align = 'left';
   cell.width= document.all.separador1.width;
   cell.innerText='';
   
   cell=row.insertCell();   // segunda celula da linha (Descrição do Eixo)
   cell.className = 'txtNormal';
   cell.width= "95%";
   cell.height = 26;
   cell.align = 'left';
   cell.width= document.all.tbeixo_col1.width;
   cell.innerText=meixo[i].dseixtem; // fim segunda celula (Descrição do Eixo)

   cell=row.insertCell();   // Separador
   cell.className = 'txtNormal';
   cell.align = 'left';
   cell.width= document.all.separador1.width;
   cell.innerText='';

   cell=row.insertCell();   // oitava celula da linha (apaga)
   cell.className = 'txtNormal';
   cell.align = 'center';
   cell.width= document.all.tbeixo_col2.width;
   linky='<a href="#." onClick=ExEixo("' + meixo[i].ideixfor + '"); class="linkGuia"><img src="/cecred/images/botoes/btn_excluir.gif" border="0" title="Excluir"></a>';
   cell.innerHTML=linky; // fim oitava celula (apaga)
   } 
}

function mostraPropostas(){
 var row;var cell;
 var cor = '#F7F7F7';

 for (var i=document.all.tbproposta.rows.length; i>0; i--)
      document.all.tbproposta.deleteRow(i-1);

 for(i=0;i<mproposta.length;i++){      
   row=tbproposta.insertRow(); 

   if (cor == '#FFFFFF')
      cor = '#F7F7F7';
   else
      cor = '#FFFFFF';

   row.bgColor = cor;

   cell=row.insertCell();   // ESPAÇO ANTES DO TEXTO
   cell.className = 'txtNormal';
   cell.height = 26;
   cell.align = 'left';
   cell.width= document.all.separador1.width;
   cell.innerText='';
   
   cell=row.insertCell();   
   cell.className = 'txtNormal';
   cell.height = 6;
   cell.align = 'left';
   cell.width = document.all.tbproposta_col1.width;
   cell.innerText=mproposta[i].nrpropos; 

   cell=row.insertCell();   // Separador
   cell.className = 'txtNormal';
   cell.height = 26;
   cell.align = 'left';
   cell.width= document.all.separador1.width;
   cell.innerText='';

   cell=row.insertCell();   
   cell.className = 'txtNormal';
   cell.align = 'left';
   cell.width = document.all.tbproposta_col2.width;
   cell.innerText=mproposta[i].dtmvtolt;

   cell=row.insertCell();   // Separador
   cell.className = 'txtNormal';
   cell.height = 26;
   cell.align = 'left';
   cell.width= document.all.separador1.width;
   cell.innerText='';

   cell=row.insertCell();   
   cell.className = 'txtNormal';
   cell.align = 'left';
   cell.width = document.all.tbproposta_col3.width;
   cell.innerText=mproposta[i].dtvalpro;

   cell=row.insertCell();   // Separador
   cell.className = 'txtNormal';
   cell.height = 26;
   cell.align = 'left';
   cell.width= document.all.separador1.width;
   cell.innerText='';

   cell=row.insertCell();   
   cell.className = 'txtNormal';
   cell.align = 'left';
   cell.width = document.all.tbproposta_col4.width;
   cell.innerText=mproposta[i].nmevento;

   cell=row.insertCell();   // Separador
   cell.className = 'txtNormal';
   cell.height = 26;
   cell.align = 'left';
   cell.width= document.all.separador1.width;
   cell.innerText='';
   
/*   cell=row.insertCell();  
   cell.className = 'txtNormal';
   cell.align = 'left';
   cell.innerText=''; 
*/
   cell=row.insertCell();   // Separador
   cell.className = 'txtNormal';
   cell.height = 26;
   cell.align = 'left';
   cell.width= document.all.separador1.width;
   cell.innerText='';

   cell=row.insertCell();   
   cell.className = 'txtNormal';
   cell.align = 'center';
   cell.width = document.all.tbproposta_col5.width;
   linky='<a href="#." onClick=EdProposta("' + mproposta[i].idprofor + '"); class="linkGuia"><img src="/cecred/images/botoes/btn_atualizar.gif" title="Atualizar" border="0"></a>';
   cell.innerHTML=linky; 

   cell=row.insertCell();   // Separador
   cell.className = 'txtNormal';
   cell.height = 26;
   cell.align = 'left';
   cell.width= document.all.separador1.width;
   cell.innerText='';

   cell=row.insertCell();  
   cell.className = 'txtNormal';
   cell.align = 'center';
   cell.width = document.all.tbproposta_col6.width;
   linky='<a href="#." onClick=ExProposta("' + mproposta[i].idprofor + '"); class="linkGuia"><img src="/cecred/images/botoes/btn_excluir.gif" border="0" title="Excluir"></a>';
   cell.innerHTML=linky; 
   }
}
</script>
<script language="JavaScript">
   NomeDoProgramaPrincipal  = '/wpgd0012.w';
   NomeDoProgramaDeListagem = '/wpgd0012ls.w';
   NomeDoProgramaDeAjuda    = '/wpgd0012aj.w';
   NomeDoProgramaDeZoom     = '/zoom/zwpgd0012.w';

</script>
<form action="#." method="POST" name="form">
<input type="hidden" name="aux_dsendurl" value="">
<input type="hidden" name="pagina" value="">
<input type="hidden" name="aux_idevento" value="">
<input type="hidden" name="aux_cddopcao" value="">
<input type="hidden" name="aux_nrdrowid" value="">
<input type="hidden" name="aux_lspermis" value="">
<input type="hidden" name="aux_dsretorn" value="">
<input type="hidden" name="aux_stdopcao" value="">
<input type="hidden" name="aux_idexclui" value="">
<input type="hidden" name="aux_datahoje" value="">
<!-- Inicio do modelo com abas -->
<div id="Layer1" style="position:absolute; border:0px; width:35px; height:35; z-index:1; left: 25px; top: 2px; visibility: ;"><img src="/cecred/images/icones/ico_fornecedor.gif" width="28" height="32" align="bottom"></div>
  <table width="575" border="0" align="left" cellpadding="0" cellspacing="0" background="/cecred/images/geral/guia_fundo.gif">
    <tr>
      <td width="35"><img src="/cecred/images/geral/guia_esquerda.gif" width="11" height="21"></td>
      <td width="32"><img src="/cecred/images/geral/spacer.gif" width="10" height="10"></td>
      <td width="265" height="20" align="left" class="linkGuia">Cadastro de Fornecedores</td>
      <td width="232" height="20" align="right" class="linkGuia">wpgd0012</td>	  
      <td width="11" align="right"><img src="/cecred/images/geral/guia_direita.gif" width="11" height="21"></td>
    </tr>
    <tr valign="top" bgcolor="#FFFFFF">
      <td colspan="5">
        <table width="575" height="300"  border="0" align="left" cellpadding="0" cellspacing="1" bgcolor="#999999">
          <tr>
            <td height="200" valign="top" bgcolor="#FFFFFF">
              <table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
                <tr>				
                  <td width="1%" height="15" align="left">&nbsp;</td>
                  <td align="left">&nbsp;</td>
                  <td width="1%" align="left">&nbsp;</td>
                </tr>
                <tr>
                  <td height="15" align="left">&nbsp;</td>
                  <td align="left">
				  <!-- Interrupcao do modelo - início das abas -->
                    <table  border="0" align="left" cellpadding="0" cellspacing="0" bgcolor="#FFFFFF">
                      <tr align="center">
                        <td width="90" height="15">
                          <table width="88" id="AbaFornecedor" border="0" cellpadding="0" cellspacing="0">
                            <tr style="cursor:hand;">
                              <td background="/cecred/images/menu/mnu_nle.gif" width="4" height="21"></td>
                              <td width="80" align="center" class="txtTituloHid" onclick="mostraDiv('divFornecedor')">Fornecedor</td>
                              <td background="/cecred/images/menu/mnu_nld.gif" width="4" height="21"></td>
                            </tr>
                          </table>
                        </td>
                        <td width="90" height="15">
                          <table width="88" id="AbaContato" border="0" cellpadding="0" cellspacing="0">
                            <tr style="cursor:hand;">
                              <td background="/cecred/images/menu/mnu_nle.gif" width="4" height="21"></td>
                              <td width="80" align="center" class="txtTituloHid" onclick="mostraDiv('divContato')">Contatos</td>
                              <td background="/cecred/images/menu/mnu_nld.gif" width="4" height="21"></td>
                            </tr>
                          </table>
                        </td>
                        <td width="90" height="15">
                          <table width="88" id="AbaEixo" border="0" cellpadding="0" cellspacing="0">
                            <tr style="cursor:hand;">
                              <td background="/cecred/images/menu/mnu_nle.gif" width="4" height="21"></td>
                              <td width="80" align="center" class="txtTituloHid" onclick="mostraDiv('divEixo')">Eixo</td>
                              <td background="/cecred/images/menu/mnu_nld.gif" width="4" height="21"></td>
                            </tr>
                          </table>
                        </td>
                        <td width="90" height="15">
                          <table width="88" id="AbaProposta" border="0" cellpadding="0" cellspacing="0">
                            <tr style="cursor:hand;">
                              <td background="/cecred/images/menu/mnu_nle.gif" width="4" height="21"></td>
                              <td width="80" align="center" class="txtTituloHid" onclick="mostraDiv('divProposta')">Proposta</td>
                              <td background="/cecred/images/menu/mnu_nld.gif" width="4" height="21"></td>
                            </tr>
                          </table>
                        </td>
                        <!-- Links de Adicionar -->
                        <td width="210" align="right" class="txtTituloHid">
						  <div id="adicionar">
							 <a href="#." onclick="mudaAdicionar();">Adicionar</a>
						  </div>
						</td>                        
                      </tr>
					  <tr>
						<td colspan="5" width="200" height="2" align="left" background="/cecred/images/menu/mnu_slc.gif"></td>
					  </tr>
					</table>
                    <!-- Fim das abas - Início dos dados do programa -->
				  </td>
                  <td align="left">&nbsp;</td>
                </tr>
                <tr>
                  <td height="15" align="left">&nbsp;</td>
                  <td height="15" align="left" bgcolor="#F5F5F5">
                    <div id="divFornecedor" align="left">
                      <table width="91%" border="0" align="center" cellspacing="0">
                        <tr>
                          <td align="right" class="NomeCampo">Natureza: </td>
                          <td colspan="9" class="NomeCampo">
                            <input type=radio name="inpessoa" checked value="1">Física
                            <input type=radio name="inpessoa" value="2">Jurídica
                          </td>
                        </tr>
                        <tr>
                          <td align="right" class="NomeCampo">CNPJ/CPF:</td>
                          <td colspan="9" class="NomeCampo">
                            <input name="aux_nrcpfcgc" type="text" class="Campo" size="20" onkeypress="if(document.form.inpessoa[0].checked) FormataCPF(this.name, this.value); else FormataCNPJ(this.name, this.value);" value="">
                          </td>
                        </tr>
                        <tr>
                          <td align="right" class="NomeCampo">Nome:</td>
                          <td colspan="2">
                            <input name="nmfornec" type="text" class="Campo" size="40" value="">
                          </td>
                        </tr>
                        <tr>
                          <td align="right" class="NomeCampo">Endereço:</td>
                          <td colspan="2">
                            <input name="dsendfor" type="text" class="Campo" size="40" value="">
                          </td>
                          <td><div align="right" class="NomeCampo">Cidade:</div></td>
                          <td colspan="2"><input name="nmcidfor" type="text" class="Campo" size="15" maxlength="15" value=""></td>
                        </tr>
                        <tr>
                          <td align="right" class="NomeCampo">Bairro:</td>
                          <td colspan="2"><input name="nmbaifor" type="text" class="Campo" size="40" value="">
                          </td>
                        </tr>
                        <tr>
                          <td><div align="right" class="NomeCampo">UF:</div></td>
                          <td width="75" colspan="2"><input name="cdufforn" type="text" class="Campo" size="4" maxlength="4" value=""></td>
                          <td nowrap><div align="right" class="NomeCampo">CEP:</div></td>
                          <td><input name="nrcepfor" type="text" class="Campo" size="8" maxlength="10" value="">      </td>
                        </tr>
                        <tr>
                          <td height="19" align="right" class="NomeCampo">DDD/Fone:</td>
                          <td colspan="2"><input name="cddddfor" type="text" class="Campo" size="3" value="">
                            <input name="nrfonfor" type="text" class="Campo" size="10" value=""></td>
                          <td class="NomeCampo"><div align="right">DDD/Fax:</div></td>
                          <td colspan="4" align="right" class="NomeCampo">
                            <div align="left">
                            <input name="cddddfax" type="text" class="Campo" size="3" value="">
                            <input name="nrfaxfor" type="text" class="Campo" size="10" value="">
                            </div>
                          </td>
                        </tr>
                        <tr>
                          <td height="19" align="right" class="NomeCampo">Cooperado:</td>
                          <td><input name="flgcoope" type="checkbox" class="Campo" onClick="Cooperado();"></td>
                          <td><div id="NmCoop" align="right" class="NomeCampo">Cooperativa:
                            <input name="nmcoofor" type="text" size="10" class="Campo"></div>
                          </td>
                          <td>&nbsp;</td>
                          <td class="NomeCampo"></td>
                          <td colspan="3" >&nbsp;</td>
                        </tr>
                        <tr>
                          <td height="19" align="right" class="NomeCampo">Home Page: </td>
                          <td colspan="2" ><input name="nmhompag" type="text" class="Campo" size="40"></td>
                        </tr>
                        <tr>
                          <td height="19" align="right" class="NomeCampo">Referencias:</td>
                          <td colspan="9" class="CampoTextArea"><textarea name="dsreffor" cols="55" rows="2" class="CampoTextArea"></textarea></td>
                        </tr>
                        <tr>
                          <td height="19" align="right" class="NomeCampo">Considerações:</td>
                          <td colspan="9" class="CampoTextArea"><textarea name="dsobserv" cols="55" rows="2" class="CampoTextArea"></textarea></td>
                        </tr>
                        <tr>
                          <td height="19" align="right" class="NomeCampo">Cadastrado: </td>
                          <td width="52">
                            <input name="dtforati" type="text" class="Campo" size="10" onkeypress="top.frcod.FormataData(this.name, this.value)" value="">
                          </td>
                          <td width="195" class="NomeCampo" nowrap>Inativo desde:
                            <input name="dtforina" type="text" class="Campo" size="10" onkeypress="top.frcod.FormataData(this.name, this.value)" value=""> 
                          </td>
                          <td class="NomeCampo" colspan="2" nowrap><div align="right" class="NomeCampo">Última atualização:</div></td>
                          <td width="110" align="left">
                            <input name="dtultalt" type="text" disabled="true" class="Campo" size="10" readonly>
                          </td>
                        </tr>
                      </table>
                      <br>
                      <table border="0" align="center" cellpadding="1" cellspacing="1">
                        <tr>
                          <th scope="col"><img style="cursor:hand;" src="/cecred/images/botoes/btn_cadastrar.gif" onClick="return top.frcod.Incluir()"></th>
                          <th scope="col"><img style="cursor:hand;" src="/cecred/images/botoes/btn_salvar.gif" onClick="return top.frcod.Salvar()"></th>
                          <th scope="col"><img style="cursor:hand;" src="/cecred/images/botoes/btn_excluir_botao.gif" onClick="return top.frcod.Excluir()"></th>
                          <th scope="col"><img style="cursor:hand;" src="/cecred/images/botoes/btn_procurar.gif" onClick=";return top.frcod.AbreZoom(parent.mainFrame.NomeDoProgramaDeZoom,parent.mainFrame.NomeDoProgramaPrincipal,'','P')"></th>
                        </tr>
                      </table>
                    </div>
                    <div id="divContato" align="left">
                      <table border="0" width="100%" height="255">
			<tr >
			  <td>
			    <table width="100%" id="tbcon" border="0" cellpadding="0" cellspacing="0" class="dataTable">
                              <tr>
                                <td width="26" height="25" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos">&nbsp;</td>
                                <td width="110" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos" id="tbcontato_col1">Nome</td>
                                <td id="separador1" width="5" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                                <td width="95" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos" id="tbcontato_col2">Departamento</td>
                                <td width="5" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                                <td id="tbcontato_col3" width="165" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos">E-mail</td>
                                <td width="5" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                                <td id="tbcontato_col4" width="40" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos">DDD</td>
                                <td width="5" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                                <td id="tbcontato_col5" width="70" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos">Telefone</td>
                                <td width="5" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                                <td id="tbcontato_col6" width="20" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos">&nbsp;</td>
                                <td width="5" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                                <td id="tbcontato_col7" width="20" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos">&nbsp;</td>
                              </tr>
                            </table>

						 </td>
					   </tr>
                        <tr valign="top">
                          <td>
                            <table width="100%" border="0" cellpadding="0" cellspacing="0">
							  <tr>
                                <td align="left"height:"30";>
                                  <div style="overflow: auto; height:'263';">
                                    <table id="tbcontato" width="100%" border="0" cellpadding="0" cellspacing="0" class="dataTable">
                                      <!-- INCLUI CONTATOS -->
                                    </table>      
                                  </div>
                                </td>
                              </tr>
                            </table>
                          </td>
                        </tr>
                      </table>
                    </div>
					
                    <div id="divEixo" align="left">
                      <table border="0" width="100%" height="275">
                        <tr valign="top">
                          <td>
                            <table width="100%" border="0" cellpadding="0" cellspacing="0" class="dataTable">
                              <tr>
							    <td height="25" width="5" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos">&nbsp;</td>
								<td id="tbeixo_col1" width="545" height="25" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos">Eixos Relacionados</td>
								<td width="5" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
								<td id="tbeixo_col2" width="20" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos"></td>
                              </tr>
                            </table>      
                          </td>
						  <tr valign="top">
                          <td>
                            <div style="overflow: auto; height:'263';">
                              <table id="tbeixo" width="100%" border="0" cellpadding="0" cellspacing="0" class="dataTable">
                                <!-- INCLUI DADOS -->
                              </table>      
                        	</div>
                          </td>
                      </table>
                    </div>
					
                    <div id="divProposta" align="left">
                      <table border="0" width="100%" height="275">
                        <tr valign="top">
                          <td>
                            <table width="100%" border="0" cellpadding="0" cellspacing="0" class="dataTable">
                                <tr>
								  <td width="5" background="/cecred/images/menu/fnd_title.jpg">&nbsp;</td>
                                  <td id="tbproposta_col1" width="60" height="25" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos" align="left">Número</td>
                                  <td width="5" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                                  <td id="tbproposta_col2" width="90" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos"><div align="left">Recebimento</div></td>
                                  <td width="5" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                                  <td id="tbproposta_col3" width="85" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos"><div align="left">Validade</div></td>
                                  <td width="5" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                                  <td id="tbproposta_col4" width="260" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos"><div align="left">Evento</div></td>
                                  <td width="5" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                                  <td id="tbproposta_col5" width="20" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos"><div align="left">&nbsp;</div></td>
                                  <td width="5" background="/cecred/images/menu/fnd_title.jpg"><img src="/cecred/images/geral/div.gif" width="2" height="15"></td>
                                  <td id="tbproposta_col6" width="35" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos"><div align="left">&nbsp;</div></td>
                                </tr>
                            </table>      
                          </td>
                        </tr>
						<tr valign="top">
                          <td>
                            <div style="overflow: auto; height:'263';">
                              <table id="tbproposta" width="100%" border="0" cellpadding="0" cellspacing="0" class="dataTable">
                                <!-- INCLUI DADOS -->
                              </table>      
                            </div>
                          </td>
                        </tr>
                      </table>
                    </div>
                  <!-- Fim dos dados do programa - retorno ao modelo -->
                  </td>
				  <td>&nbsp;</td>
                </tr>				
              </table>
          </td>
          </tr>
        </table>
      </td>
    </tr>
  </table>
<!-- fim do modelo -->
</form>
<script language="JavaScript">
NomeDoProgramaPrincipal = document.form.aux_dsendurl.value + NomeDoProgramaPrincipal;
document.form.action = NomeDoProgramaPrincipal;

Cooperado();

function CarregaPrincipal () {
   //top.topFrame.document.all.titulo.innerHTML = 'Cadastro de Fornecedores - ' + document.form.aux_idevento.value;
   window.status = "";
}

function LimparCampos()
{
   //document.form.cdcooper.value = '';
   document.form.cddddfax.value = '';
   document.form.cddddfor.value = ''; 
   //document.form.cdoperad.value = ''; 
   document.form.cdufforn.value = ''; 
   document.form.dsendfor.value = ''; 
   document.form.dsobserv.value = ''; 
   document.form.dsreffor.value = ''; 
   document.form.dtforati.value = document.form.aux_datahoje.value; 
   document.form.dtforina.value = ''; 
   document.form.dtultalt.value = document.form.aux_datahoje.value; 
   document.form.flgcoope.value = ''; 
   //document.form.aux_idevento.value = ''; 
   document.form.inpessoa.value = ''; 
   document.form.nmbaifor.value = ''; 
   document.form.nmcidfor.value = ''; 
   document.form.nmcoofor.value = ''; 
   document.form.nmfornec.value = ''; 
   document.form.nmhompag.value = ''; 
   document.form.nrcepfor.value = ''; 
   document.form.aux_nrcpfcgc.value = ''; 
   document.form.nrfaxfor.value = ''; 
   document.form.nrfonfor.value = ''; 

   for(i = 0;i< document.form.inpessoa.length; i++)
      document.form.inpessoa[i].disabled = false;
   document.form.aux_nrcpfcgc.disabled = false;

   for (var i=document.all.tbcontato.rows.length; i>0; i--)
      document.all.tbcontato.deleteRow(i-1); 

   for (var i=document.all.tbeixo.rows.length; i>0; i--)
      document.all.tbeixo.deleteRow(i-1);

   for (var i=document.all.tbproposta.rows.length; i>0; i--)
      document.all.tbproposta.deleteRow(i-1);
}

function Habilita()
{

   // Habilita os campos chave pra poder salvar
   for(i = 0;i< document.form.inpessoa.length; i++)
      document.form.inpessoa[i].disabled = false;
   document.form.aux_nrcpfcgc.disabled = false;

}
function HabilitaSalvar(){}

function ValidaDados(form)
    { 
        var msg="";

        document.form.aux_nrcpfcgc.value =  TiraFormato(document.form.aux_nrcpfcgc.value);
        document.form.nrcepfor.value     =  TiraFormato(document.form.nrcepfor.value);
         
	msg = msg + top.frcod.VE("ca",form.nmfornec,"O campo de nome do Fornecedor","nao");
        msg = msg + top.frcod.VE("ca",form.dsendfor,"O campo de endereço do Fornecedor","nao");
        msg = msg + top.frcod.VE("ca",form.nmcidfor,"O campo de cidade do Fornecedor","nao");
        msg = msg + top.frcod.VE("ca",form.nmbaifor,"O campo de bairro do Fornecedor","nao");
        msg = msg + top.frcod.VE("in",form.nrcepfor,"O campo de CEP do Fornecedor","sim","0","99999999");
        msg = msg + top.frcod.VE("ca",form.cdufforn,"O campo de UF do Fornecedor","nao");
        msg = msg + top.frcod.VE("in",form.nrfonfor,"O telefone do Fornecedor","sim", "0", "99999999");
        msg = msg + top.frcod.VE("in",form.nrfaxfor,"O FAX do Fornecedor","sim", "0", "99999999");
        msg = msg + top.frcod.VE("in",form.cddddfor,"O DDD do telefone do Fornecedor","sim", "0", "99999999");
        msg = msg + top.frcod.VE("in",form.cddddfax,"O DDD do FAX do Fornecedor","sim", "0", "99999999");

         
        if (msg == "")
            return true
        else
        {
           top.frcod.MostraResultado('1',msg);
           return false
        }
    }

function Cooperado()
{
   if(document.form.flgcoope.checked == true)
   {
      document.all.NmCoop.style.visibility = "visible";
   }
   else
   {
      document.all.NmCoop.style.visibility = "hidden";
      document.form.nmcoofor.value = '';
   }
}


function Recarrega()
{
   VarURL = NomeDoProgramaPrincipal + '?LinkRowid=' + document.form.aux_nrdrowid.value + '&pagina='  + document.form.pagina.value;
   window.open(VarURL,'mainFrame','toolbar=no,location=no,diretories=no,status=no,menubar=no,scrollbars=no,resizable=yes,width=600,height=300,top=10,left=10');
}

function AdContato()
{
   var campo = '';
   if(document.form.aux_cddopcao.value == "in")
   {
      alert("O fornecedor deve ser gravado antes de inserir Contatos. ");
   }
   else
   {
      campo = TiraFormato(document.form.aux_nrcpfcgc.value);
      VarURL = document.form.aux_dsendurl.value  + '/wpgd0012a.htm?aux_nrcpfcgc=' + campo;
      window.open(VarURL,'','toolbar=no,location=no,diretories=no,status=no,menubar=no,scrollbars=no,resizable=no,width=425,height=255,top=10,left=10');
   }
}

function EdContato(rowid){

   // Verifica se o usuário tem permissão de salvar
   if (document.form.aux_lspermis.value.substring(1,2) != 'A'){ 
      alert('Desculpe, mas você não tem permissão para executar esta função.'); 
      return false;
   }

   var campo = '';
   if(rowid != "")
   {
      campo = TiraFormato(document.form.aux_nrcpfcgc.value);
      VarURL = document.form.aux_dsendurl.value  + '/wpgd0012a.htm?LinkRowid=' + rowid + 
         '&aux_nrcpfcgc=' + campo;
      window.open(VarURL,'','toolbar=no,location=no,diretories=no,status=no,menubar=no,scrollbars=no,resizable=yes,width=425,height=255,top=10,left=10');
   }
}

function ExContato(rowid){

   // Verifica se o usuário tem permissão de exclusao
   if (document.form.aux_lspermis.value.substring(2,3) != 'E'){ 
      alert('Desculpe, mas você não tem permissão para executar esta função.'); 
      return false;
   }

   if(rowid != "")
   {
      if (!confirm('Confirma Exclusão do Contato?'))
      {
         return false;
      }
   
      document.form.aux_idexclui.value = rowid;
      document.form.aux_cddopcao.value = "exc";
      document.form.submit();
   }
}

function AdEixo()
{
   if(document.form.aux_cddopcao.value == "in")
   {
      alert("O fornecedor deve ser gravado antes de relacioná-lo com eixos temáticos. ");
   }
   else
   {
      campo = TiraFormato(document.form.aux_nrcpfcgc.value);
      VarURL = document.form.aux_dsendurl.value  + '/wpgd0012b.htm?aux_nrcpfcgc=' + campo + 
         '&aux_idevento=' + document.form.aux_idevento.value;
      window.open(VarURL,'','toolbar=no,location=no,diretories=no,status=no,menubar=no,scrollbars=no,resizable=no,width=420,height=400,top=10,left=10');
   }
}

function ExEixo(rowid)
{
   // Verifica se o usuário tem permissão de exclusao
   if (document.form.aux_lspermis.value.substring(2,3) != 'E'){ 
      alert('Desculpe, mas você não tem permissão para executar esta função.'); 
      return false;
   }

   if(rowid != "")
   {
      if (!confirm('Confirma Exclusão da Relação Fornecedor/Eixo?'))
      {
         return false;
      }
   
      document.form.aux_idexclui.value = rowid;
      document.form.aux_cddopcao.value = "exe";
      document.form.submit();
   }
}

function AdProposta()
{
   var campo = '';
   if((document.form.dtforina.value != "/  /")&&(document.form.dtforina.value != ""))
   {
      alert("Fornecedor está inativo.");
      return false;
   }

   if(document.form.aux_cddopcao.value == "in")
   {
      alert("O fornecedor deve ser gravado antes de inserir propostas. ");
   }
   else
   {
	  campo = TiraFormato(document.form.aux_nrcpfcgc.value);
      VarURL = document.form.aux_dsendurl.value  + '/wpgd0012c.htm?aux_nrcpfcgc=' + campo + 
         '&aux_idevento=' + document.form.aux_idevento.value + 
		 '&aux_operacao=' + "incluir";
      window.open(VarURL,'','toolbar=no,location=no,diretories=no,status=no,menubar=no,scrollbars=no,resizable=no,width=550,height=515,top=10,left=10');
   }
}

function EdProposta(rowid){

   // Verifica se o usuário tem permissão de salvar
   if (document.form.aux_lspermis.value.substring(1,2) != 'A'){ 
      alert('Desculpe, mas você não tem permissão para executar esta função.'); 
      return false;
   }
   
   var campo = '';
   if(rowid != "")
   {
      campo = TiraFormato(document.form.aux_nrcpfcgc.value);
      VarURL = document.form.aux_dsendurl.value  + '/wpgd0012c.htm?LinkRowid=' + rowid + 
         '&aux_nrcpfcgc=' + campo + 
         '&aux_idevento=' + document.form.aux_idevento.value;
      window.open(VarURL,'','toolbar=no,location=no,diretories=no,status=no,menubar=no,scrollbars=no,resizable=no,width=550,height=505,top=10,left=10');
   }
}

function ExProposta(rowid)
{
   // Verifica se o usuário tem permissão de exclusao
   if (document.form.aux_lspermis.value.substring(2,3) != 'E'){ 
      alert('Desculpe, mas você não tem permissão para executar esta função.'); 
      return false;
   }

   if(rowid != "")
   {
      if (!confirm('Confirma Exclusão da Proposta?'))
      {
         return false;
      }
   
      document.form.aux_idexclui.value = rowid;
      document.form.aux_cddopcao.value = "exp";
      document.form.submit();
   }
}

function MudaPagina(sentido, indice, max)
{
   if((indice != max) && (indice != "?"))
   {
      document.form.aux_cddopcao.value = sentido;
      document.form.submit();
   }

}
function mostraDiv(nomediv)
{   
   var nomeaba = '';

   if (nomediv=='') {nomediv='divFornecedor';}

   if (nomediv=='divFornecedor') {nomeaba='AbaFornecedor';}
   if (nomediv=='divContato')    {nomeaba='AbaContato';}
   if (nomediv=='divEixo')       {nomeaba='AbaEixo';}
   if (nomediv=='divProposta')   {nomeaba='AbaProposta';}

   document.form.pagina.value=nomediv;
   document.all.divFornecedor.style.display = 'none';
   document.all.divContato.style.display = 'none';
   document.all.divEixo.style.display = 'none';
   document.all.divProposta.style.display = 'none';

   document.all.adicionar.style.visibility = 'hidden';

   document.all.AbaFornecedor.rows[0].cells[0].background="/cecred/images/menu/mnu_nle.gif";
   document.all.AbaFornecedor.rows[0].cells[1].background="/cecred/images/menu/mnu_nlc.gif";
   document.all.AbaFornecedor.rows[0].cells[2].background="/cecred/images/menu/mnu_nld.gif";
   document.all.AbaFornecedor.rows[0].cells[1].className="txtTituloHid";
   
   document.all.AbaContato.rows[0].cells[0].background="/cecred/images/menu/mnu_nle.gif";
   document.all.AbaContato.rows[0].cells[1].background="/cecred/images/menu/mnu_nlc.gif";
   document.all.AbaContato.rows[0].cells[2].background="/cecred/images/menu/mnu_nld.gif";
   document.all.AbaContato.rows[0].cells[1].className="txtTituloHid";

   document.all.AbaEixo.rows[0].cells[0].background="/cecred/images/menu/mnu_nle.gif";
   document.all.AbaEixo.rows[0].cells[1].background="/cecred/images/menu/mnu_nlc.gif";
   document.all.AbaEixo.rows[0].cells[2].background="/cecred/images/menu/mnu_nld.gif";
   document.all.AbaEixo.rows[0].cells[1].className="txtTituloHid";

   document.all.AbaProposta.rows[0].cells[0].background="/cecred/images/menu/mnu_nle.gif";
   document.all.AbaProposta.rows[0].cells[1].background="/cecred/images/menu/mnu_nlc.gif";
   document.all.AbaProposta.rows[0].cells[2].background="/cecred/images/menu/mnu_nld.gif";
   document.all.AbaProposta.rows[0].cells[1].className="txtTituloHid";

   document.all[nomeaba].rows[0].cells[0].background="/cecred/images/menu/mnu_sle.gif";
   document.all[nomeaba].rows[0].cells[1].background="/cecred/images/menu/mnu_slc.gif";
   document.all[nomeaba].rows[0].cells[2].background="/cecred/images/menu/mnu_sld.gif";
   document.all[nomeaba].rows[0].cells[1].className="txtTituloVis";

   if(nomeaba != 'AbaFornecedor')
      document.all.adicionar.style.visibility = 'visible';

   document.all[nomediv].style.display = 'block';
}


// Altera o link da função de adicionar
function mudaAdicionar()
{
	if (document.form.aux_lspermis.value.substring(0,1) != 'I')
         { 
            alert('Desculpe, mas você não tem permissão para executar esta função.'); 

         }
	else
     	{
	   if(document.all.divContato.style.display == 'block')
		  AdContato();
	
	   if(document.all.divEixo.style.display == 'block')
		  AdEixo();
	
	   if(document.all.divProposta.style.display == 'block')
		  AdProposta();
		 }
}

mostraDiv(document.form.pagina.value);
mostraContatos();
mostraEixos();
mostraPropostas();

function FormataCPF(campo,teclapress)  {
   
   var tecla = teclapress.keycode;
   vr = teclapress;
  
   vr = vr.replace(".",""); 
   vr = vr.replace(".","");
   vr = vr.replace(".","");
   vr = vr.replace("/","");
   vr = vr.replace("-","");
   tam = vr.length ;

   //alert(vr);
           
   //if ( tecla != 9 && tecla != 8 )   {
      if ( tam > 2 && tam < 5 )   
	     document.form[campo].value = vr.substr(0, 3) + '.' + vr.substr( 3, 3 );
      if ( tam > 5 && tam < 8 )  
	     document.form[campo].value = vr.substr(0, 3) + '.' + vr.substr( 3, 3) + '.' + vr.substr( 6, 3);
      if ( tam > 8 )  
	     document.form[campo].value = vr.substr(0, 3) + '.' + vr.substr( 3, 3) + '.' + vr.substr( 6, 3) + '-' + vr.substr(9,2);
   //}	  
}

function FormataCNPJ(campo,teclapress)  {
   
   var tecla = teclapress.keycode;
   vr = teclapress;
  
   vr = vr.replace(".",""); 
   vr = vr.replace(".","");
   vr = vr.replace(".","");
   vr = vr.replace("/","");
   vr = vr.replace("-","");
   tam = vr.length ;

   //alert(vr);
           
   if ( tecla != 9 && tecla != 8 )   {
      if ( tam > 1 && tam < 4 )   
	     document.form[campo].value = vr.substr(0, 2) + '.' + vr.substr( 2, 3 );
      if ( tam > 4 && tam < 7 )  
	     document.form[campo].value = vr.substr(0, 2) + '.' + vr.substr( 2, 3) + '.' + vr.substr( 5, 3);
      if ( tam > 7 && tam < 11 )  
	     document.form[campo].value = vr.substr(0, 2) + '.' + vr.substr( 2, 3) + '.' + vr.substr( 5, 3) + '/' + vr.substr( 8, 4);
      if ( tam > 11 )  
	     document.form[campo].value = vr.substr(0, 2) + '.' + vr.substr( 2, 3) + '.' + vr.substr( 5, 3) + '/' + vr.substr( 8, 4) + '-' + vr.substr( 12, 2);
   }	  
}

if(document.form.inpessoa[0].checked)
   FormataCPF(document.form.aux_nrcpfcgc.name,document.form.aux_nrcpfcgc.value);
else
   FormataCNPJ(document.form.aux_nrcpfcgc.name,document.form.aux_nrcpfcgc.value);

// Desabilita os campos chaves, se estiver posicionado em algum registro
if(document.form.aux_nrdrowid.value != "?")
{
   for(i = 0;i< document.form.inpessoa.length; i++)
      document.form.inpessoa[i].disabled = true;
   document.form.aux_nrcpfcgc.disabled = true;
}

// Tirar os formatos de CPF e CNPJ, deixando somente os numeros
function TiraFormato(campo)
{
   //Retirar a formatação de CPF e CNPJ
   campo = campo.replace(".",""); 
   campo = campo.replace(".","");
   campo = campo.replace(".","");
   campo = campo.replace("/","");
   campo = campo.replace("-","");

   return campo;
}



</script>
</body>
