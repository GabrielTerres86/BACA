<!--
		Alterações:
-->
<html>
  <head>
    <title>Eventos para Sele&ccedil;&atilde;o - Pr&eacute;-Assembleia(wpgd0052c)</title>
    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
    <link href="/cecred/estilos/progrid.css" rel="stylesheet" type="text/css">
  </head>
  <body>
    <script SRC="/cecred/jsbiblio/sorttable.js"></script>
    <script language="JavaScript">
      NomeDoProgramaPrincipal  = '/wpgd0052c.w';
    </script>
    <form method="POST" name="form">
      <input type="hidden" name="aux_dsendurl" value="">
      <input type="hidden" name="aux_cddopcao" value="">           
      <input type="hidden" name="aux_nrdrowid" value="">
      <input type="hidden" name="aux_lspermis" value="">
      <input type="hidden" name="aux_stdopcao" value="">
      <input type="hidden" name="aux_lsevento" value="">
      <input type="hidden" name="aux_cdagenci" value="">  
      <input type="hidden" name="aux_idevento" value="">  
      <input type="hidden" name="glb_cdcooper" value="">
      <input type="hidden" name="aux_cdcooper" value="1">
      <input type="hidden" name="aux_dtanoage" value="1">	
      <table width="100%"  border="0" cellspacing="0" cellpadding="0">
        <tr>
          <td>
          <table border="0" cellpadding="0" cellspacing="0" background="/cecred/images/geral/guia_fundo.gif">
              <tr>
            <td width="11"><img src="/cecred/images/geral/guia_esquerda.gif" width="11" height="21"></td>
                <td nowrap class="linkGuia">
            <div align="center">
              PA:
            <input type="text" name="nmresage" class="linkGuia" readonly="true" size="50" value="">
            </div>
          </td>
                <td width="11" align="right"><img src="/cecred/images/geral/guia_direita.gif" width="8" height="21"></td>
              </tr>
          </table>	   
        </td>
      </tr>
        <tr>
          <td height="2" bgcolor="#999999"></td>    
        </tr>
      <tr>
        <td>
          <table width="100%" border="0" cellspacing="0" cellpadding="0">
          <tr>
            <td>
            <table class="tableBranca" id="tbeventos" name="tbeventos" width="100%" border="0" cellpadding="0" cellspacing="0" bgColor="#FFFFFF">
            </table>
          </td>
          </tr>
            <tr>
            <td>&nbsp;</td>
          </tr>
          <tr>
            <td align="center">
            <a onClick="Salvar();" style="cursor: hand; " id="hrefSalvar" name="hrefSalvar" >
              <input name="imageField" type="image"  src="/cecred/images/botoes/btn_salvar.gif" width="60" height="20">
            </a>
          </td>
          </tr>
        </table>
          </td>
      </tr>	
      </table>
    </form>
  </body>
  <script language="JavaScript">
    NomeDoProgramaPrincipal  = '/wpgd0052c.w';
    NomeDoProgramaDeListagem = '/wpgd0052cs.w';
    NomeDoProgramaDeAjuda    = '/wpgd0052caj.w';
    NomeDoProgramaDeZoom     = '';

    NomeDoProgramaPrincipal = document.form.aux_dsendurl.value + NomeDoProgramaPrincipal;
    document.form.action = NomeDoProgramaPrincipal;

    function armazenaEventos(){
      
      for(var i = 1;i<tbeventos.rows.length;i++){
        
        if(tbeventos.rows[i].checked){
          
          if(document.form.aux_lsevento.value == ''){
            document.form.aux_lsevento.value = tbeventos.rows[i].value;
          }else{
            document.form.aux_lsevento.value = document.form.aux_lsevento.value + ';' + tbeventos.rows[i].value;
          }
        }
      }
    }
    
    function Salvar(){
      
      //ZeraModoExclusao();
      var vaux = document.form.aux_lspermis.value; 

      if((vaux.substring(1,2) == 'A') || (document.form.aux_stdopcao.value == 'i')){ 

        if (document.form.aux_cddopcao.value!='sa'){
          
          document.form.aux_cddopcao.value='sa';

          // "força" a opção para i = Inclusão											
          document.form.aux_stdopcao.value='i'; 
          status = 'Salvando. Por favor, aguarde ...';			
          armazenaEventos();
          document.form.submit();
          return true;
        }else{ 
          return false;
        }  
      }else { 
        alert('Desculpe, mas você não tem permissão para executar esta função.'); 
        return false;
      }
      return false;
    }

    function mudaCor(linha){

      if(document.activeElement.tagName != "INPUT"){
        if(linha != null && linha != ""){  
           if (linha.checked==false){
               linha.bgColor = '#CCCCCC';
               linha.checked = true;		 
           }
           else{
               linha.bgColor = '#FFFFFF';
               linha.checked = false;
           }
        }else{
           if (this.checked==false){
               this.bgColor = '#CCCCCC';
               this.checked = true;
           }
           else{
              this.bgColor = '#FFFFFF';
              this.checked = false;        
           }
        }
      }
    }

    function mostraEventos(){

      var row; 
      var cell;  
      
      // Coloca o nome do PA
      document.form.nmresage.value = document.form.aux_cdagenci.value + ' - ' + meventos[0].nmresage;
      document.form.nmresage.style.background = '';
      document.form.nmresage.style.border = 'none';   

      // limpa a tabela de Eventos
      for(var i = document.all.tbeventos.rows.length; i > 0; i--){
        document.all.tbeventos.deleteRow(i-1);
      }
        
      // cria as linhas com as células...
      for(var j = 0;j < meventos.length; j++){    
        row = tbeventos.insertRow();
        row.id = j;
        row.checked = false;
        
        if (j>0){
          row.onclick = mudaCor; //JMD
          row.style.cursor='hand';
          row.value=meventos[j].cdevento;
          
          // Se o EVENTO já foi escolhido aí muda a cor para selecionado
          if(meventos[j].flgativo == 'yes'){
            row.bgColor = '#CCCCCC';
            row.checked = true;
          }
        }		 	 
        
        // Nome do Evento
        cell = row.insertCell();
        cell.className = 'txtNormal';
        cell.width = "100%";
        linky = meventos[j].nmevento;  
        cell.innerHTML = linky;
        
        if (j>0)
          cell.align = "left";
        else{
          cell.align="center";      
          cell.background="/cecred/images/menu/fnd_title.jpg";
        }
       
        // Separador
        cell=row.insertCell();
        cell.className = 'txtNormal';
        cell.width= 5;
        cell.height = 25;
        cell.align = 'left';     
       
        if (j == 0){
          cell.background = "/cecred/images/menu/fnd_title.jpg";
          cell.innerHTML = '<img src="/cecred/images/geral/div.gif" width="2" height="15">';
        }		
        
      }
    }

    function seta_obrig(linha){
       var lin   = tbeventos.rows[linha];
       
       // se ativou
       if(check.checked){
          // se a linha estava ativa, permanece ativa
          if(lin.checked == true)
           mudaCor(lin);
       }
       // se desativou
       else{
          // se a linha estava ativa, permanece ativa
          if(lin.checked == true)
           mudaCor(lin);
       }
    }
       
    mostraEventos();

  </script>
</html>