<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta name="wsoptions" content="no-output">
<title>Custos (wpgd0018e)</title>
<link href="/cecred/estilos/progrid.css" rel="stylesheet" type="text/css">
</head>
<body>
<script SRC="/cecred/jsbiblio/sorttable.js"></script>
<script language="JavaScript">
NomeDoProgramaPrincipal  = '/wpgd0018e.w';
</script>
<form action="#." method="POST" name="form" >
  <input type="hidden" name="aux_cddopcao"  VALUE="">
  <input type="hidden" name="aux_lspermis"  VALUE="">
  <input type="hidden" name="aux_nrdrowid"  VALUE="">
  <input type="hidden" name="aux_dsretorn"  VALUE="">
  <input type="hidden" name="aux_stdopcao"  VALUE="">
  <input type="hidden" name="aux_dsendurl"  VALUE="">
  <input type="hidden" name="aux_idevento"  VALUE="">
  <input type="hidden" name="dscusind"      VALUE="">
  <input type="hidden" name="aux_nrdcusto"  VALUE="">
  <input type="hidden" name="aux_lstcusto"  VALUE="">
  <input type="hidden" name="aux_lstselec"  VALUE="">
  <input type="hidden" name="aux_cdcooper"  VALUE="">
  <input type="hidden" name="aux_dtanoage"  VALUE="">
  <table width="310"  border="0" cellspacing="0" cellpadding="3">
  <tr>
    <td>
      <table border="0" cellpadding="0" cellspacing="0">
        <tr>
                     <td width="11"><img src="/cecred/images/geral/guia_esquerda.gif" width="11" height="21"></td>
                     <td width="129" nowrap background="/cecred/images/geral/guia_fundo.gif" class="linkGuia"><div align="center">Selecionar Custos </div></td>
          <td width="11" align="right" background="/cecred/images/geral/guia_fundo.gif"><img src="/cecred/images/geral/guia_direita.gif" width="8" height="21"></td>
          <td width="588" align="right" class="txtTituloHid"><div id="adicionar"> <a href="#." onClick="AdCusto();">Adicionar</a> </div></td>
                       <td width="1"><div align="right"></div></td>    
              <!-- Links de Adicionar -->
        </tr>
                <tr>
                    <td colspan="6" height="2" align="left" background="/cecred/images/menu/mnu_slc.gif"></td>
        </tr>                
      </table>
          <table border="0" align="center" width="100%" cellpadding="0" cellspacing="0">
                <tr valign="top">
                  <td>
                        <table width="100%" border="0" align="center" cellspacing="0">
                          <tr>
                                <td id="separador1" height="25" width="5" class="txtMenuTitulos" background="/cecred/images/menu/fnd_title.jpg">&nbsp;</td>
                                <td width="290" height="25" background="/cecred/images/menu/fnd_title.jpg" class="txtMenuTitulos" id="tbcusto_col1">Custos</td>
                          </tr>
                        </table>
          </td>                                        
         </tr>
           </table>
        <table border="0" align="center" width="100%" cellpadding="0" cellspacing="0">
                  <tr valign="top">
                        <td>
                        <div style="overflow: auto; height:'280';">
                          <table width="300" id="tbcusto" border="0" align="center" cellspacing="0">
                                <!-- INCLUI DADOS -->
                          </table>
                        </div>
                        </td>                                        
          </tr>
        </table>
    </td>
  </tr>
  <tr>
    <td align="center" valign="bottom">
      <input name="imageField" type="image" style=" cursor:hand; " 
      onClick="Salvar();" 
        src="/cecred/images/botoes/btn_salvar.gif" width="60" height="20">
    </td>
  </tr>        
</table>
</form>
</body>

<SCRIPT LANGUAGE="JAVASCRIPT">
   NomeDoProgramaPrincipal  = '/wpgd0018e.w';
   NomeDoProgramaDeListagem = '/wpgd0018es.w';
   NomeDoProgramaDeAjuda    = '/wpgd0018eaj.w';
   NomeDoProgramaDeZoom     = '/zoom/zoei01.w';
   
   NomeDoProgramaPrincipal = document.form.aux_dsendurl.value + NomeDoProgramaPrincipal;
   document.form.action = NomeDoProgramaPrincipal;

function RetornoDoZoom(campo,valor,valor2,valor3)
{  
         
}
function Habilita()
{
  
}
function HabilitaSalvar()
{
  
}
function ValidaDados(form)
{
   var msg="";
         
   /*msg = msg + top.frcod.VE("in",form.cddddfor,"O DDD do Contato","sim","1","999");
   msg = msg + top.frcod.VE("in",form.cdfonfor,"O Telefone do Contato","sim","1","999999999");
   //msg = msg + top.frcod.VE("ca",form.auxnmevento,"O nome do evento","nao");

   if (document.form.auxnmevento.value == "") {
      msg = msg + "O nome do evento não pode ser branco.".
   }*/
         
   if (msg == "")
      return true;
   else
   {
      alert(msg);
      return false;
   }
}

function LimparCampos()
{
   
}

function CarregaPrincipal()
{  

}    

function Incluir()
{
   var vaux = document.form.aux_lspermis.value; 
   if (vaux.substring(0,1) == 'I') 
           { 
                  if (document.form.aux_stdopcao.value == 'i') 
                                { 
                                   alert('Você já esta no modo de inclusão'); 
                                   return false
                                } 
                         else 
                                { 
                                   document.form.aux_cddopcao.value ='in'; 
                                   document.form.aux_stdopcao.value ='i';
                                   LimparCampos(); 
                                   return true
                                } 
           } 
        else 
           { 
                  alert('Desculpe, mas você não tem permissão para executar esta função.'); 
                  return false
           }
}

function deletaLinhas() {

 for(var i=document.all.tbcusto.rows.length; i>1; i--)
      document.all.tbcusto.deleteRow(i-1);

 return true;

}


function Salvar()
{
   //ZeraModoExclusao();
   document.form.aux_stdopcao.value = 'i';
   var vaux = document.form.aux_lspermis.value; 
   if ((vaux.substring(1,2) == 'A') || (document.form.aux_stdopcao.value == 'i')) { 
                if ( document.form.aux_cddopcao.value!='sa')  {
                   if (ValidaDados(document.forms[0])) {
                           Habilita(); 
                           HabilitaSalvar(); 
                           ArmazenaCusto();
                           document.form.aux_cddopcao.value='sa'; 
                           status = 'Salvando. Por favor, aguarde ...'; 
                           return true;
                        } 
                        else { 
                          return false;
                        }  
                } 
   }
   else { 
                 alert('Desculpe, mas você não tem permissão para executar esta função.'); 
                 return false;
   }
}

function Recarrega()
{
   document.form.submit();
}

function AdCusto()
{
  document.form.aux_cddopcao.value='';
  
  VarURL = document.form.aux_dsendurl.value  + '/wpgd0018d.htm?aux_idevento=' + document.form.aux_idevento.value;
  window.open(VarURL,'Custos','toolbar=no,location=no,diretories=no,status=no,menubar=no,scrollbars=no,resizable=no,width=470,height=140,top=10,left=10');
}

function mostraCusto(){
  var row;var cell;

  deletaLinhas();

  for(i=0;i<mcusto.length;i++){
     
     row=tbcusto.insertRow();
     row.id=i;
     row.onclick=mudaCor;
     row.value=mcusto[i].nmcusto;
         row.style.cursor = 'hand';
     row.bgColor="#FFFFFF";
                
         cell=row.insertCell();   
     cell.className = 'txtNormal';
     cell.height = 20;
         cell.width = document.all.separador1.width;
     cell.innerHTML='';

         
     cell=row.insertCell();   
     cell.className = 'txtNormal';
     cell.height = 20;
     cell.align = 'left';
         cell.width = document.all.tbcusto_col1.width;
     linky=mcusto[i].nmcusto + 
     '<input type="hidden" name="custo" id="custo" value="' + 
            mcusto[i].idcusto + '">';

     cell.innerHTML=linky;

     if(mcusto[i].flgescol=='yes')
     {
        row.bgColor = '#CCCCCC';
        row.checked = true;
        if (i > 0) 
           document.form.custo[i].checked = true;
        else
           document.form.custo.checked = true;
     }
     else
     {
        row.checked = false;
        if (i > 0)
           document.form.custo[i].checked = false;
        else
           document.form.custo.checked = false;
     }
  }
  
}
function mudaCor(){

  // se houver mais de um registro de custos
  if (mcusto.length > 1){
     if (document.form.custo[this.id].checked==false){
         this.bgColor = '#CCCCCC';
         document.form.custo[this.id].checked=true;
     }
     else{
         this.bgColor = '#FFFFFF';
         document.form.custo[this.id].checked=false;
         }
  }
  // se for somente um registro de custos
  else{
     if (document.form.custo.checked==false){
         this.bgColor = '#CCCCCC';
         document.form.custo.checked=true;
     }
     else{
         this.bgColor = '#FFFFFF';
             document.form.custo.checked=false;
     }
  }  
}

function ArmazenaCusto()
{
   var i;

   document.form.aux_lstcusto.value = '';
   document.form.aux_lstselec.value = '';

   // se for mais de um registro de custo
   if (mcusto.length > 1)
   {
      for(i=0;i<document.form.custo.length;i++)
         if(document.form.aux_lstcusto.value=='')
         {
            document.form.aux_lstcusto.value = document.form.custo[i].value;
            document.form.aux_lstselec.value = document.form.custo[i].checked;
         }

         else
         {
            document.form.aux_lstcusto.value = document.form.aux_lstcusto.value + ',' + document.form.custo[i].value;
            document.form.aux_lstselec.value = document.form.aux_lstselec.value + ',' + document.form.custo[i].checked;
         }
   }
   // se for somente um registro de custos
   else
   {
      document.form.aux_lstcusto.value = document.form.custo.value;
      document.form.aux_lstselec.value = document.form.custo.checked;
   }
}

mostraCusto();
 
</SCRIPT>
</html>