<!--
        Alteracoes: 18/10/2012 - Limitar quantidade de caracateres a 500 no campo de observacao (Gabriel).
        
                                22/10/2012 - Incluso chamada para biblioteca de funções funcoes.js , incluso validação tamanho
                                                      maximo campo Observação usando função ValidaTamanho. Incluso validação inteiros
                                                         no campo data (Daniel).
-->

<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta name="wsoptions" content="no-output">

<base target="mainFrame">
<link href="/cecred/estilos/progrid.css" rel="stylesheet" type="text/css">
</head>
<body style="margin-left: 3px; ">
<form action="#." method="POST" name="form">
    <input type="hidden" name="aux_cddopcao" value="">
    <input type="hidden" name="aux_lspermis" value="">
    <input type="hidden" name="aux_nrdrowid" value="">    
    <input type="hidden" name="aux_dsretorn" value="">    
    <input type="hidden" name="aux_stdopcao" value="">    
    <input type="hidden" name="aux_dsendurl" value="">
    <input type="hidden" name="aux_nrseqdig" value="">
    <input type="hidden" name="aux_idevento" value="">    
    <input type="hidden" name="cdagenci"     value="">
    <input type="hidden" name="nrseqeve"     value="">
    <input type="hidden" name="dtanoage"     value="">
    <input type="hidden" name="tpcuseve"     value="">
    <input type="hidden" name="cdcuseve"     value="">
<script language="JavaScript">
   NomeDoProgramaPrincipal  = '/wpgd0022.w';
   NomeDoProgramaDeZoom     = '/zwpgd0022.w';
</script>
<script SRC="/cecred/js/funcoes.js"></script>
<!-- Início do modelo geral -->
<div id="Layer1" style="position:absolute; border:0px; width:35px; height:35; z-index:1; left: 25px; top: 2px; visibility: ;"><img src="/cecred/images/icones/ico_fornecedor.gif" width="28" height="32" align="bottom">        </div>
  <table width="575" height="360"  border="0" align="left" cellpadding="0" cellspacing="0" background="/cecred/images/geral/guia_fundo.gif">
    <tr>
      <td height="20" colspan="5">
          <table width="100%" border="0" cellspacing="0" cellpadding="0">
        <tr>
                  <td width="11"><img src="/cecred/images/geral/guia_esquerda.gif" width="11" height="21"></td>
                  <td width="56"><img src="/cecred/images/geral/spacer.gif" width="48" height="10"></td>
                  <td width="391" height="20" class="linkGuia">Custos Realizados </td>
                  <td width="106" class="linkGuia"> <div align="right">wpgd0022</div></td>
                  <td width="11" align="right" valign="middle" class="linkGuia"><img src="/cecred/images/geral/guia_direita.gif" width="11" height="21"></td>
                </tr>
      </table>
          </td>
    </tr>
    <tr valign="top" bgcolor="#FFFFFF">
      <td colspan="5">
        <table width="100%" height="100%"  border="0" align="left" cellpadding="0" cellspacing="1" bgcolor="#999999">
          <tr>
            <td height="200" valign="top" bgcolor="#FFFFFF">
              <table width="100%" height="100%"  border="0" cellpadding="0" cellspacing="0">
                <tr>
                  <td rowspan="2" align="left">&nbsp;</td>
                  <td height="15" align="left">
                                 
                    <!-- Interrupção do modelo geral, início dos dados específicos da tela -->
                    <table width="541" border="0" align="center">
                      <tr>
                        <td colspan="6" align="left" class="NomeCampo">Tipo de Lan&ccedil;amento:
                          &nbsp;<input name="aux_tpcuseve" type="radio" value="1" onClick="document.form.cdcuseve.value = ''; MostraCusto();">
                          Custos por evento
                          <input name="aux_tpcuseve" type="radio" value="2" onClick="document.form.cdcuseve.value = ''; MostraCusto();">
                        Custos diversos</td>
                      </tr>
                      <tr>
                        <td align="right" class="NomeCampo">&nbsp;</td>
                        <td colspan="5" class="NomeCampo">&nbsp;                        </td>
                      </tr>
                      <tr>
                        <td width="99" align="right" class="NomeCampo">Agenda:</td>
                        <td width="89" class="NomeCampo">
                          <input name="aux_dtanoage" type="text" class="Campo" size="8" onChange="mudaAno();">
                        </td>
                        <td width="98" align="right" class="NomeCampo">Cooperativa:</td>
                        <td width="64" align="left">
                          <select name="aux_cdcooper" class="Campo" onChange="document.form.aux_dtanoage.value = ''; document.form.aux_cddopcao.value = ''; document.form.submit();">
                          </select>
                        </td>
                        <td width="66" align="right" class="NomeCampo"><div id="divPAC">PA:</div></td>
                        <td width="99" class="NomeCampo"><select name="aux_cdagenci" class="Campo" onChange="document.form.cdagenci.value = document.form.aux_cdagenci.value;document.form.submit();">
                        </select></td>
                      </tr>
                      <tr>
                        <td align="right" class="NomeCampo"><div id="divEvento">Evento:</div></td>
                        <td colspan="5" class="NomeCampo"><select name="aux_nrseqeve" class="Campo" onChange="document.form.nrseqeve.value = document.form.aux_nrseqeve.value; document.form.aux_cdcuseve.value=''; document.form.vlcusrea.value='';document.form.dtmvtolt.value='';document.form.dsobserv.value=''">
                        </select>                           <span class="NomeCampo">
                          </span>
                        </td>
                      </tr>
                      <tr>
                        <td align="right" class="NomeCampo">                        Custo:</td>
                        <td>
                          <div id="Nome" class="NomeCampo" >
                            <select name="aux_cdcuseve" class="Campo" onChange="document.form.cdcuseve.value = document.form.aux_cdcuseve.value">
                            </select>
                          </div>
                        </td>
                        <td align="right" class="NomeCampo">Valor:</td>
                        <td class="NomeCampo">
                          <input type="text" name="vlcusrea" size="8" class="Campo" style="text-align:right;" maxlength="8" >
                        </td>
                        <td align="right" class="NomeCampo">Data:</td>
                        <td class="NomeCampo">
                          <input type="text" name="dtmvtolt" size="8" class="Campo" onKeyDown="validaInteiro(event)" onkeypress="top.frcod.FormataData(this.name,this.value);" maxlength="10">
                        </td>
                      </tr>
                      <tr>
                        <td align="right" class="NomeCampo">Observa&ccedil;&otilde;es:</td>
                        <td colspan="7"><textarea name="dsobserv" cols=50 rows=5 class="campoListagemAdmin" onKeyUp="ValidaTamanho(this.form.dsobserv,500)" onKeyDown="ValidaTamanho(this.form.dsobserv,500)"> </textarea></td>
                      </tr>
                    </table>
                    <!-- Fim dos dados específicos da tela, reinício do modelo geral -->                  
                  </td>
                </tr>
                <tr>
                  <td height="15" align="center" valign="bottom">
                                  <table border="0" align="center" cellpadding="1" cellspacing="1">
                    <tr>
                      <th align="center"><img style="cursor:hand;" src="/cecred/images/botoes/btn_cadastrar.gif" onClick="return top.frcod.Incluir()"></th>
                      <th align="center"><img style="cursor:hand;" src="/cecred/images/botoes/btn_salvar.gif"  onClick="return top.frcod.Salvar()"></th>
                      <th align="center"><img style="cursor:hand;" src="/cecred/images/botoes/btn_excluir_botao.gif" onClick="return top.frcod.Excluir()"></th>
                      <th align="center"><img style="cursor:hand;" src="/cecred/images/botoes/btn_procurar.gif" onClick="return top.frcod.AbreZoom(parent.mainFrame.NomeDoProgramaDeZoom,parent.mainFrame.NomeDoProgramaPrincipal,'','P',document.form.aux_idevento.value,document.form.aux_dtanoage.value,document.form.aux_cdcooper.options[document.form.aux_cdcooper.options.selectedIndex].value)"></th>
                    </tr>
                  </table></td>
                </tr>
              </table>
            </td>
          </tr>
        </table>
      </td>
    </tr>
  </table>
</div>
<!-- Fim do modelo geral -->
</form>
</body>
</html>
<SCRIPT LANGUAGE="JAVASCRIPT">
   NomeDoProgramaPrincipal  = '/wpgd0022.w';
   NomeDoProgramaDeListagem = '/wpgd0022ls.w';
   NomeDoProgramaDeAjuda    = '/wpgd0022aj.w';
   NomeDoProgramaDeZoom     = '/zoom/zwpgd0022.w';
   
   NomeDoProgramaPrincipal = document.form.aux_dsendurl.value + NomeDoProgramaPrincipal;
   document.form.action = NomeDoProgramaPrincipal;

function Habilita()
{

}

function HabilitaSalvar(){
   document.form.aux_tpcuseve[0].disabled = false;
   document.form.aux_tpcuseve[1].disabled = false;
   document.form.aux_dtanoage.disabled = false;
   document.form.aux_cdagenci.disabled = false;
   document.form.aux_cdcooper.disabled = false;
   document.form.aux_cdcuseve.disabled = false;
   document.form.aux_nrseqeve.disabled = false;  
}

function ValidaDados(form)
    { 
        var msg="";

        /* msg = msg + top.frcod.VE("ca",form.dsobserv,"A descrição da sugestão","nao");*/
            msg = msg + top.frcod.VE("da",form.dtmvtolt,"A data","nao");
        msg = msg + top.frcod.VE("de",form.vlcusrea,"O custo","nao",0, 999999);

        if ((document.form.aux_cdagenci.value == "") &&
                   (document.form.aux_tpcuseve[0].checked))
           msg = msg + "PA inválido. ";
                   
        if (((document.form.aux_nrseqeve.value == "0")||(document.form.aux_nrseqeve.value == "")) &&
                   (document.form.aux_tpcuseve[0].checked)){
           msg = msg + "Evento inválido. ";
                   }

        if ((document.form.aux_cdcuseve.value == "0")||(document.form.aux_cdcuseve.value == ""))
           msg = msg + "Custo inválido. ";

                   
                if (document.form.dsobserv.value.length > 500) {
                   msg = msg + "A quantidade máxima de caracteres na observação deve ser 500.";
                }                
                   
        if (msg == "")
                return true
            else
                {
                    top.frcod.MostraResultado('1',msg);
                    return false
                }
    }

function LimparCampos()
{
   document.form.dtmvtolt.value = '';
   document.form.vlcusrea.value = '';
   document.form.dsobserv.value = '';
   document.form.aux_nrdrowid.value = '?';
   document.form.tpcuseve.value = 0;     
   document.form.aux_tpcuseve[0].disabled = false;
   document.form.aux_tpcuseve[1].disabled = false;
   document.form.aux_dtanoage.disabled = false;
   document.form.aux_cdagenci.disabled = false;
   document.form.aux_cdcooper.disabled = false;
   document.form.aux_cdcuseve.disabled = false;
   document.form.aux_nrseqeve.disabled = false;
}

function CarregaPrincipal()
{  
   /*jan3 = open('wpgd0022a.htm','fraux');*/
}   


// Cria a Combo de PAs, de acordo com a cooperativa selecionada
function MostraPACs()
{
   for (var i=document.all.aux_cdagenci.options.length; i>=0; i--)
      document.all.aux_cdagenci.remove(i); 

   var oOption;

   /* Se for Assembléia, cria uma opção de PAC TODOS */
   /*if (document.form.aux_idevento.value == '2') 
   {
      oOption = document.createElement("OPTION");
      document.all.aux_cdagenci.options.add(oOption);
      oOption.innerText = "--TODOS--";
      oOption.value = 0;
   }
*/
   for(i=0;i<mpac.length;i++)
   {
      if (mpac[i].cdcooper == document.form.aux_cdcooper.value)
      {
         oOption = document.createElement("OPTION");
         document.all.aux_cdagenci.options.add(oOption);
         oOption.innerText = mpac[i].nmresage.substring(0, 15);
         oOption.value = mpac[i].cdagenci;
      }
   }
   document.form.aux_cdagenci.value = '';
}

// Posiciona as Combos nos valores corretos
function PosicionaPAC()
{

   if(document.form.cdagenci.value != "")
   {
      //document.form.aux_cdeixtem.value = document.form.cdeixtem.value;
      MostraPACs();
      document.form.aux_cdagenci.value = document.form.cdagenci.value;
   }
   else
   {
      // posiciona a seleção no primeiro registro de Cooperativas, se só tiver 1
      if(document.all.aux_cdcooper.options.length == 1)
         document.form.aux_cdcooper.value = document.all.aux_cdcooper.options[0].value;

      // posiciona a seleção no primeiro registro de PACs, se só tiver 1
      if(document.all.aux_cdagenci.options.length == 1)
         document.form.aux_cdagenci.value = document.all.aux_cdagenci.options[0].value;
   }
}

function MostraEventos()
{
   for (var i=document.all.aux_nrseqeve.options.length; i>=0; i--)
      document.all.aux_nrseqeve.remove(i); 

   var oOption;
   
   for(i=0;i<mevento.length;i++)
   {
      if ((mevento[i].cdcooper == document.form.aux_cdcooper.value)&&
          ((mevento[i].cdagenci == document.form.aux_cdagenci.value) ||
                   (mevento[i].cdagenci == 0)))
      {
         oOption = document.createElement("OPTION");
         document.all.aux_nrseqeve.options.add(oOption);
         oOption.innerText = mevento[i].nmevento.substring(0, 75);
         oOption.value = mevento[i].nrseqeve;
      }
   }
   if (document.all.aux_nrseqeve.options.length == 0)
   {
      oOption = document.createElement("OPTION");
      document.all.aux_nrseqeve.options.add(oOption);
      oOption.innerText = "--Selecione o PA--";
      oOption.value = "0";
   }

   document.form.aux_nrseqeve.value = '0';
   
}

function PosicionaEventos()
{
   if(document.form.nrseqeve.value != "")
   {
      //document.form.aux_cdeixtem.value = document.form.cdeixtem.value;
      MostraEventos();
      document.form.aux_nrseqeve.value = document.form.nrseqeve.value;
   }
   else
   {
      // posiciona a seleção no primeiro registro de Eventos, se só tiver 1
      if(document.all.aux_nrseqeve.options.length == 1)
         document.form.aux_nrseqeve.value = document.all.aux_nrseqeve.options[0].value;
      else
         document.form.aux_nrseqeve.value = '';

      if (document.form.aux_cdagenci.value == "")
         document.form.aux_nrseqeve.value = '';
   }
}

// Cria a Combo de Custos, de acordo com o tipo de custo selecionado
function MostraCusto()
{

   // desabilita/habilita o PAC e o EVENTO
   if  (document.form.aux_tpcuseve[1].checked){
        document.form.aux_cdagenci.value = 0;
        document.form.aux_nrseqeve.value = 0;                 
        document.form.aux_cdagenci.style.display = 'none';
        document.form.aux_nrseqeve.style.display = 'none';
                document.all.divPAC.style.display = 'none';
                document.all.divEvento.style.display = 'none';                                
   }
   else{
        document.form.aux_cdagenci.style.display = 'block';
        document.form.aux_nrseqeve.style.display = 'block';
                document.all.divPAC.style.display = 'block';
                document.all.divEvento.style.display = 'block';           
   }
        
                
   for (var i=document.all.aux_cdcuseve.options.length; i>=0; i--)
      document.all.aux_cdcuseve.remove(i); 

   var oOption;

   var tpcusto;

   for(i=0;i<document.form.aux_tpcuseve.length;i++)
      if (document.form.aux_tpcuseve[i].checked)
         tpcusto = i + 1;

   for(i=0;i<mcusto.length;i++)
   {
      //alert(parseInt(mcusto[i].tpcuseve));
      if (parseInt(mcusto[i].tpcuseve) == tpcusto)
      {
         oOption = document.createElement("OPTION");
         document.all.aux_cdcuseve.options.add(oOption);
         oOption.innerText = mcusto[i].dscuseve.substring(0, 15);
         oOption.value = mcusto[i].cdcuseve;
      }
   }
   
   PosicionaCusto();         
}

function PosicionaCusto()
{
   if(document.form.cdcuseve.value != ''){
      document.form.aux_cdcuseve.value = document.form.cdcuseve.value;
   }
   else
   {
      // posiciona a seleção no primeiro registro de Custos, se só tiver 1
      if(document.all.aux_cdcuseve.options.length == 1)
         document.form.aux_cdcuseve.value = document.all.aux_cdcuseve.options[0].value;
      else
         document.form.aux_cdcuseve.value = '';
   }    
}

function PosicionaTpCusto()
{
   if (document.form.tpcuseve.value != "0")
      document.form.aux_tpcuseve[parseInt(document.form.tpcuseve.value) - 1].checked = true;
}

function mudaAno()
{
   document.form.method="GET";
   document.form.submit();
}

function RetornoDaPesquisa(campo,valor,valor2,valor3)
{   
}

function TravaTudo(){
   document.form.aux_tpcuseve[0].disabled = true;
   document.form.aux_tpcuseve[1].disabled = true;   
   document.form.aux_dtanoage.disabled = true;
   document.form.aux_cdagenci.disabled = true;
   document.form.aux_cdcooper.disabled = true;
   document.form.aux_cdcuseve.disabled = true;
   document.form.aux_nrseqeve.disabled = true;
}

PosicionaTpCusto();

MostraPACs();
PosicionaPAC();

MostraEventos();
PosicionaEventos();

MostraCusto();
PosicionaCusto();

if (document.form.aux_nrdrowid.value != '?')
    TravaTudo();
        
        ///função para formatar campos com valores decimais///
function FormataValor(campo,tammax,teclapres) {
   
   var tecla = teclapres.keyCode;
   vr = campo.value;
        vr = vr.replace( "/", "" );
        vr = vr.replace( "/", "" );
        vr = vr.replace( ",", "" );
        vr = vr.replace( ".", "" );
        vr = vr.replace( ".", "" );
        vr = vr.replace( ".", "" );
        vr = vr.replace( ".", "" );
   tam = vr.length;

        if (tam < tammax && tecla != 8){ tam = vr.length + 1 ; }

        if (tecla == 8 ){        tam = tam - 1 ; }
                
        if ( tecla == 8 || (tecla >= 48 && tecla <= 57) || (tecla >= 96 && tecla <= 105)){
                if ( tam <= 2 ){ 
                         campo.value = vr ; }
                 if ( (tam > 2) && (tam <= 5) ){
                         campo.value = vr.substr( 0, tam - 2 ) + ',' + vr.substr( tam - 2, tam ) ; }
                 if ( (tam >= 6) && (tam <= 8) ){
                         campo.value = vr.substr( 0, tam - 5 ) + '.' + vr.substr( tam - 5, 3 ) + ',' + vr.substr( tam - 2, tam ) ; }
                 if ( (tam >= 9) && (tam <= 11) ){
                         campo.value = vr.substr( 0, tam - 8 ) + '.' + vr.substr( tam - 8, 3 ) + '.' + vr.substr( tam - 5, 3 ) + ',' + vr.substr( tam - 2, tam ) ; }
                 if ( (tam >= 12) && (tam <= 14) ){
                         campo.value = vr.substr( 0, tam - 11 ) + '.' + vr.substr( tam - 11, 3 ) + '.' + vr.substr( tam - 8, 3 ) + '.' + vr.substr( tam - 5, 3 ) + ',' + vr.substr( tam - 2, tam ) ; }
                 if ( (tam >= 15) && (tam <= 17) ){
                         campo.value = vr.substr( 0, tam - 14 ) + '.' + vr.substr( tam - 14, 3 ) + '.' + vr.substr( tam - 11, 3 ) + '.' + vr.substr( tam - 8, 3 ) + '.' + vr.substr( tam - 5, 3 ) + ',' + vr.substr( tam - 2, tam ) ;}
        }
   else {if (tecla != 9 && tecla != 46 && (tecla < 37 || tecla > 40)) {event.returnValue = false;}}

}

</SCRIPT>
