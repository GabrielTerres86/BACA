--INC0055732 - altera dtrefatu
--Ana Volles - 28/07/2020

--SELECT DISTINCT a.*, b.dtmancad FROM craptfc a, crapcyb b
--WHERE a.cdcooper = b.cdcooper AND a.nrdconta = b.nrdconta 
--AND (TRUNC (a.dtinsori) = '15/07/2020' OR trunc(a.dtrefatu) = '15/07/2020') AND idsittfc = 1  --AND a.nrdconta = 00138436 
--AND a.nrdconta IN (00002356);

BEGIN

  UPDATE craptfc a
  SET a.dtrefatu = TRUNC(SYSDATE)
  WHERE EXISTS (   
      SELECT DISTINCT b.cdcooper, b.nrdconta FROM crapcyb b
      WHERE a.cdcooper = b.cdcooper AND a.nrdconta = b.nrdconta 
      AND (TRUNC (a.dtinsori) = '15/01/2020' OR trunc(a.dtrefatu) = '15/01/2020') AND idsittfc = 1
      AND a.nrdconta IN (00002356
      ,00011550
      ,00015750
      ,00033006
      ,00044067
      ,00050253
      ,00072540
      ,00086851
      ,00092304
      ,00092401
      ,00094803
      ,00105040
      ,00113450
      ,00117897
      ,00118036
      ,00121304
      ,00127566
      ,00128155
      ,00133434
      ,00133884
      ,00138207
      ,00138371
      ,00138436
      ,00139254
      ,00139408
      ,00147044
      ,00147745
      ,00148016
      ,00169625
      ,00179434
      ,00185035
      ,00189375
      ,00190942
      ,00199613
      ,00199621
      ,00209791
      ,00223611
      ,00229776
      ,00259527
      ,00260886
      ,00278939
      ,00288098
      ,00295272
      ,00296996
      ,00300861
      ,00306460
      ,00307165
      ,00323624
      ,00325783
      ,00332577
      ,00333395
      ,00341622
      ,00351695
      ,00352101
      ,00367443
      ,00370410
      ,00376183
      ,00420166
      ,00422304
      ,00422835
      ,00439835
      ,00466182
      ,00499790
      ,00513440
      ,00523836
      ,00547875
      ,00550744
      ,00559873
      ,00563170
      ,00563340
      ,00595497
      ,00600490
      ,00631507
      ,00640859
      ,00676950
      ,00691127
      ,00705381
      ,00721549
      ,00767280
      ,00769975
      ,00873438
      ,00877387
      ,00923591
      ,01526723
      ,01880217
      ,02001373
      ,02028956
      ,02037602
      ,02082322
      ,02094371
      ,02189550
      ,02192284
      ,02292262
      ,02292262
      ,02313847
      ,02348853
      ,02488922
      ,02496534
      ,02536838
      ,02632071
      ,02647850
      ,02774461
      ,02796163
      ,02810867
      ,02940523
      ,03100642
      ,03103412
      ,03191893
      ,03213358
      ,03224821
      ,03501051
      ,03529878
      ,03537668
      ,03569098
      ,03603393
      ,03607488
      ,03637620
      ,03657442
      ,03680770
      ,03705528
      ,03706567
      ,03731650
      ,03770575
      ,03981037
      ,03998185
      ,04005481
      ,04011325
      ,06007848
      ,06022448
      ,06050883
      ,06065724
      ,06194095
      ,06224482
      ,06227686
      ,06253865
      ,06383769
      ,06386962
      ,06395376
      ,06397700
      ,06478581
      ,06480420
      ,06517536
      ,06536379
      ,06537812
      ,06569242
      ,06570321
      ,06580955
      ,06581552
      ,06604889
      ,06693229
      ,06714927
      ,06741126
      ,06757391
      ,06776981
      ,06874681
      ,06879020
      ,06907288
      ,06952089
      ,06981488
      ,06992552
      ,07022735
      ,07050143
      ,07100906
      ,07187599
      ,07190760
      ,07208472
      ,07214014
      ,07221339
      ,07252722
      ,07281811
      ,07300565
      ,07352174
      ,07370709
      ,07427972
      ,07456794
      ,07457065
      ,07462000
      ,07485395
      ,07488041
      ,07508980
      ,07531141
      ,07547188
      ,07594160
      ,07603371
      ,07620861
      ,07625359
      ,07654219
      ,07667370
      ,07668880
      ,07684231
      ,07701233
      ,07737840
      ,07811608
      ,07829094
      ,07868367
      ,07885350
      ,07909730
      ,07934963
      ,07968787
      ,07994397
      ,08000930
      ,08078050
      ,08093636
      ,08093792
      ,08115206
      ,08128960
      ,08141401
      ,08199256
      ,08201161
      ,08233446
      ,08249075
      ,08270643
      ,08314985
      ,08316201
      ,08321930
      ,08345252
      ,08384754
      ,08495122
      ,08549761
      ,08560072
      ,08575215
      ,08577129
      ,08592780
      ,08601119
      ,08639973
      ,08644993
      ,08650497
      ,08667438
      ,08717931
      ,08758557
      ,08786461
      ,08840601
      ,08842256
      ,08852480
      ,08886725
      ,08915245
      ,08922055
      ,08922489
      ,08925968
      ,08953112
      ,08955107
      ,08999775
      ,09009086
      ,09026924
      ,09046623
      ,09048626
      ,09077960
      ,09095462
      ,09105247
      ,09121552
      ,09121560
      ,09126198
      ,09171380
      ,09181784
      ,09183345
      ,09190368
      ,09205071
      ,09222430
      ,09237313
      ,09294961
      ,09310703
      ,09320849
      ,09330208
      ,09405720
      ,09410716
      ,09419276
      ,09451196
      ,09538410
      ,09581456
      ,09604847
      ,09616870
      ,09648992
      ,09649689
      ,09705090
      ,09714235
      ,09738053
      ,09761250
      ,09775790
      ,09776257
      ,09777628
      ,09794484
      ,09817093
      ,09850074
      ,09892842
      ,09940154
      ,09950761
      ,09970240
      ,09997601
      ,10012648
      ,10023500
      ,10038400
      ,10058184
      ,10089225
      ,10096264
      ,10104798
      ,10134816
      ,10180460
      ,10201785
      ,10306552
      ,10370072
      ,10376755
      ,10388141
      ,10395210
      ,10403108
      ,10428100
      ,10468536
      ,10469699
      ,10493638
      ,10505091
      ,10516883
      ,10518606
      ,10545859
      ,10581405
      ,10583211
      ,10594060
      ,10635220
      ,10642501
      ,10676899
      ,10689656
      ,10722475
      ,10737324
      ,10745572
      ,10785256
      ,10801367
      ,10808469
      ,10814116
      ,10824740
      ,10839860
      ,10881808
      ,10883525
      ,10901620
      ,10930434
      ,11024917
      ,11057459
      ,11125071
      ,11212373
      ,11240709
      ,11255498
      ,11348852
      ,11378212
      ,11448415
      ,11499672
      ,80135269
      ,80415482
      ,80476015
      ,02647850));

   dbms_output.put_line('Qtd:'||SQL%ROWCOUNT);
   COMMIT;
     
EXCEPTION
  WHEN OTHERS THEN
    ROLLBACK;
END;
