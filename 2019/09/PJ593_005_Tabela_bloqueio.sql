CREATE TABLE TBCRD_PREAPROV_BLOQUEIO (
    IDHISTASS        NUMBER(10)    NOT NULL,
    IDLIMITE         NUMBER(10)    NOT NULL,
    SKCARGA          NUMBER(10)    NOT NULL,
    CDCOOPER         NUMBER(3)     NOT NULL,
    TPPESSOA         NUMBER(1)     NOT NULL,
    NRCPFCNPJ        NUMBER(14)    NOT NULL, 
    NRDCONTA         NUMBER(10)    NOT NULL,  
    CDOPERAD         NUMBER(10)    NOT NULL,
    INACAO           NUMBER(1)     NOT NULL,
    INBLOQACAO       NUMBER(1)     NULL,
    DTACAO           DATE          NOT NULL,
    DTVIGENTE        DATE          NULL
);

COMMENT ON TABLE TBCRD_PREAPROV_BLOQUEIO IS 
	'Tabela de bloqueio de oferta de limite pre aprovado para o cooperado';

COMMENT ON COLUMN TBCRD_PREAPROV_BLOQUEIO.IDHISTASS IS
    'Chave artificial de identificacao do historico do associado';

COMMENT ON COLUMN TBCRD_PREAPROV_BLOQUEIO.IDLIMITE IS
    'Chave artificial de identificacao do limite';

COMMENT ON COLUMN TBCRD_PREAPROV_BLOQUEIO.SKCARGA IS
    'Chave artificial de identificacao da carga';

COMMENT ON COLUMN TBCRD_PREAPROV_BLOQUEIO.CDCOOPER IS
    'Código da cooperativa';

COMMENT ON COLUMN TBCRD_PREAPROV_BLOQUEIO.TPPESSOA IS
    'Identificacao do tipo de pessoa (1 = PF, 2 = PJ)';

COMMENT ON COLUMN TBCRD_PREAPROV_BLOQUEIO.NRCPFCNPJ IS
    'Numero do CPF ou CNPJ base ao qual o limite potencial pertence';

COMMENT ON COLUMN TBCRD_PREAPROV_BLOQUEIO.NRDCONTA IS
    'Numero da conta do cooperado';

COMMENT ON COLUMN TBCRD_PREAPROV_BLOQUEIO.CDOPERAD IS
    'Codigo do operador';

COMMENT ON COLUMN TBCRD_PREAPROV_BLOQUEIO.INACAO IS
    'Acao que o limite sofreu. 1 = desbloqueio, 2 = bloqueio';

COMMENT ON COLUMN TBCRD_PREAPROV_BLOQUEIO.INBLOQACAO IS
    'Indicador do bloq/desbloq. 1 = definitivo, 2 = ate data vigente';

COMMENT ON COLUMN TBCRD_PREAPROV_BLOQUEIO.DTACAO IS
    'Data que ocorreu a acao';

COMMENT ON COLUMN TBCRD_PREAPROV_BLOQUEIO.DTVIGENTE IS
    'Ate que data o limite esta bloqueado. Se for null, logo o indacao deve ser 1, significando que e por tempo indeterminado';
	
ALTER TABLE TBCRD_PREAPROV_BLOQUEIO ADD CONSTRAINT TBCRD_PREAPROV_BLOQUEIO_PK PRIMARY KEY ( IDHISTASS, CDCOOPER, NRDCONTA );	

ALTER TABLE TBCRD_PREAPROV_BLOQUEIO ADD CONSTRAINT TBCRD_PREAPROV_BLOQUEIO_FK FOREIGN KEY (IDLIMITE, SKCARGA, CDCOOPER, TPPESSOA, NRCPFCNPJ)
  REFERENCES TBCRD_PREAPROV_LIMITE(IDLIMITE, SKCARGA, CDCOOPER, TPPESSOA, NRCPFCNPJ); 