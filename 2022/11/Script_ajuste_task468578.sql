DECLARE 

CURSOR C1 IS
SELECT REGEXP_SUBSTR('1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,9,9','[^,]+', 1, LEVEL) AS PR_CDCOOPER, 
       REGEXP_SUBSTR('9525092,9525092,10351299,6509711,10356282,10508490,10508490,10508490,10508490,10508490,10508490,10356282,9871934,8037060,10750800,9855513,9612270,3983293,9555161,9671374,8552207,9844740,3983293,3983293,6489184,9871934,9855513,9087273,8055815,9087273,90883,90883','[^,]+', 1, LEVEL) AS PR_NRDCONTA,
       REGEXP_SUBSTR('2249551,2249601,2273219,2289807,2290574,2292656,2292663,2292669,2292687,2292697,2292706,2296333,2300664,2329985,2380941,2433190,2464200,2503219,2508706,2664596,2751534,2773820,2795685,2795689,2897489,2900848,2901817,3630642,3823858,3975999,34874,47561','[^,]+', 1, LEVEL) AS PR_NRCTRATO,
       REGEXP_SUBSTR('-3.77,-6.24,-60.52,-61.42,-9.79,-25.34,-10.44,-18.25,-18.22,-25.78,-35.93,-3.78,-391.55,-700.06,-6.25,-30.93,-3.83,-7.89,-7.14,-9.38,-63.91,-13.99,-8.37,-15.52,-158.06,-234.31,-218.72,-214.64,-1524,-100.85,-980.2,-99.91','[^,]+', 1, LEVEL) AS PR_DIFERENCA
  FROM DUAL 
CONNECT BY REGEXP_SUBSTR('1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,9,9','[^,]+', 1, LEVEL) IS NOT NULL;

BEGIN   
    FOR R1 IN C1 LOOP           
      UPDATE CECRED.CRAPEPR
         SET VLPREJUZ = VLPREJUZ + TO_NUMBER(R1.PR_DIFERENCA,'9999.99'),
             VLSDPREJ = VLSDPREJ + TO_NUMBER(R1.PR_DIFERENCA,'9999.99')
       WHERE CDCOOPER = R1.PR_CDCOOPER
         AND NRDCONTA = R1.PR_NRDCONTA
         AND NRCTREMP = R1.PR_NRCTRATO; 
    END LOOP;
    
    COMMIT;
EXCEPTION
  WHEN OTHERS THEN
    RAISE_application_error(-20500, SQLERRM);
    ROLLBACK;
END;
