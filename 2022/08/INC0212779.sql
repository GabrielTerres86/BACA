begin

declare

ds_exc_erro_v		exception;
ds_dados_rollback_v	clob			:= null;
ds_texto_rollback_v	varchar2(32600);

cd_cooperativa_v	cecred.crapcop.cdcooper%type	:= 3;
ds_nome_arquivo_bkp_v	varchar2(100);
ds_nome_diretorio_v	cecred.crapprm.dsvlrprm%type;
ds_critica_v		cecred.crapcri.dscritic%type;

qt_registro	number(10)	:= 0;
nr_arquivo	number(10)	:= 1;
qt_reg_arquivo	number(10)	:= 50000;

vr_dscritic	VARCHAR2(1000);

vr_proxutil	date;
ds_rowidlct	rowid;

cursor	c01 is
select	b.rowid as id_linha,
	b.dtfimvig,
	b.dtcancel,
	b.cdsitseg,
	b.cdopeexc,
	b.cdageexc,
	b.dtinsexc,
	b.cdopecnl,
	c.rowid as nr_linha_tbseg,
	c.nrproposta,
	c.tpregist,
	c.tprecusa,
	c.cdmotrec,
	c.dtrecusa,
	c.situacao,
	c.tpcustei,
	c.cdcooper,
	c.nrdconta
from	cecred.crapcop d,
	cecred.tbseg_prestamista c,
	cecred.crapseg b
where	c.cdcooper	= d.cdcooper
and	b.tpseguro	= 4
and	(b.cdsitseg not in (2,5) or (c.dtrecusa is null and c.tpregist <> 0))
and	c.cdcooper	= b.cdcooper
and	c.nrdconta	= b.nrdconta
and	c.nrctrseg	= b.nrctrseg
and	c.nrproposta	in
	('770356974646',
'770357352525',
'770612941955',
'770613579788',
'770613668233',
'770357378427',
'770573018052',
'770351621184',
'770657673463',
'770351345446',
'770350924248',
'770658419994',
'770573038797',
'770359689675',
'770357040809',
'770613487387',
'770657191353',
'770658186329',
'770657859702',
'770658187350',
'770658237020',
'770572951456',
'770658167545',
'770657964620',
'770657969427',
'770658285238',
'770658106805',
'770572919722',
'770572919730',
'770572919790',
'770572919803',
'770572919811',
'770352807508',
'770352746363',
'770657292818',
'770658611356',
'770359794703',
'770359794215',
'770572919749',
'770572919757',
'770572919773',
'770572919781',
'770350347933',
'770353067664',
'770352424692',
'770352424684',
'770353928201',
'770355213552',
'770355264530',
'770353549030',
'770353538756',
'770355825450',
'770355825469',
'770355825477',
'770355130045',
'770355825485',
'770573595920',
'770658612824',
'770350394427',
'770350394435',
'770353877151',
'770357148804',
'770658438131',
'770658438140',
'770658438158',
'770658438166',
'770350395458',
'770350395466',
'770350395474',
'770350395482',
'770350465774',
'770657292982',
'770657292990',
'770658611313',
'770352158615',
'770353110284',
'770353110438',
'770353110446',
'770359780575',
'770359988796',
'770352083151',
'770352083160',
'770352083178',
'770352083186',
'770352083194',
'770352304298',
'770355953998',
'770658388509',
'770658031392',
'770356324820',
'770613457976',
'770613457984',
'770355797910',
'770354540150',
'770657797502',
'770657796115',
'770657293059',
'770658467018',
'770613751602',
'770613751114',
'770658080245',
'770658647415',
'770658515829',
'770613326588',
'770658181815',
'770349989417',
'770352390470',
'770353899279',
'770353897802',
'770353896490',
'770658498240',
'770356388798',
'770356388810',
'770356388771',
'770356430166',
'770356834097',
'770573234626',
'770573234553',
'770658430793',
'770354030934',
'770658279459',
'770658279475',
'770658279483',
'770658279440',
'770658279491',
'770658279505',
'770358991912',
'770357458021',
'770357458030',
'770357458048',
'770357458056',
'770357458064',
'770357714621',
'770357714630',
'770357401380',
'770355244750',
'770355244776',
'770356564049',
'770356005414',
'770349021129',
'770349021137',
'770349021145',
'770357244404',
'770658025791',
'770358826768',
'770358826776',
'770358826784',
'770358826792',
'770572881245',
'770572920160',
'770572920186',
'770358401643',
'770358368859',
'770358368832',
'770358368891',
'770658387952',
'770658387960',
'770658387979',
'770355299058',
'770658360485',
'770658283146',
'770358929257',
'770354337681',
'770354329301',
'770658387936',
'770658387987',
'770658387995',
'770658388010',
'770352539627',
'770355922278',
'770657346780',
'770657293407',
'770358361099',
'770358361129',
'770358361137',
'770358361153',
'770658355309',
'770658355244',
'770658233297',
'770356485327',
'770356485319',
'770359763565',
'770658039415',
'770658039423',
'770350614508',
'770613391592',
'770613391606',
'770613391584',
'770353075179',
'770352311944',
'770358066917',
'770358500030',
'770356612175',
'770356612167',
'770356612183',
'770355125270',
'770613039678',
'770658165330',
'770658165348',
'770354541165',
'770354541173',
'770354541181',
'770354541190',
'770354541203',
'770354541211',
'770354541220',
'770351523298',
'770355314944',
'770355640477',
'770355314928',
'770355314936',
'770357251001',
'770357627079',
'770357627087',
'770357413354',
'770356352998',
'770357356342',
'770356296621',
'770356296613',
'770354845490',
'770354845504',
'770353750496',
'770354997940',
'770354997959',
'770354997967',
'770354997975',
'770354997983',
'770354997991',
'770354998009',
'770354998017',
'770354998025',
'770354997932',
'770573725018',
'770657293822',
'770657293830',
'770658612212',
'770657293849',
'770658327399',
'770658188119',
'770658188127',
'770355477231',
'770356804635',
'770356582764',
'770358934455',
'770353545167',
'770351088567',
'770353416286',
'770357926998',
'770357926971',
'770658515195',
'770357710170',
'770657451940',
'770657451959',
'770657451967',
'770657451975',
'770657363995',
'770351402636',
'770658007904',
'770658007912',
'770350857168',
'770658582410',
'770658582372',
'770658387588',
'770658387596',
'770613592180',
'770613592210',
'770613592245',
'770613286560',
'770359188374',
'770359188366',
'770658356097',
'770357580110',
'770357580129',
'770358937624',
'770357580137',
'770573426398',
'770573426401',
'770573426380',
'770350323376',
'770350323384',
'770658610520',
'770357968399',
'770357393302',
'770357968380',
'770357006660',
'770357006686',
'770357006694',
'770357006708',
'770357006716',
'770357006724',
'770573671503',
'770613492330',
'770613492348',
'770613492356',
'770613492011',
'770658007823',
'770658007831',
'770357670829',
'770357746850',
'770354596857',
'770573541359',
'770573541367',
'770573541375',
'770573541383',
'770573541391',
'770657294179',
'770657294144',
'770657294152',
'770657294160',
'770356038096',
'770355479811',
'770613488758',
'770613464492',
'770613464484',
'770349849844',
'770349849860',
'770358628184',
'770358628192',
'770358627048',
'770353074067',
'770353431110',
'770657756741',
'770658465511',
'770352317659',
'770351800437',
'770356303342',
'770356303369',
'770356303377',
'770356303326',
'770356857674',
'770657294411',
'770658466763',
'770657294420',
'770354299755',
'770354276852',
'770658078720',
'770353534700',
'770353964607',
'770359104359',
'770350951610',
'770350951504',
'770658390830',
'770658187457',
'770359136005',
'770358028802',
'770359136021',
'770352199907',
'770352199915',
'770352199923',
'770352207950',
'770352360155',
'770353406485',
'770357696402',
'770357696399',
'770658485920',
'770658485938',
'770658485989',
'770658485997',
'770658485911',
'770658374044',
'770356854977',
'770356399773',
'770351913320',
'770657731978',
'770358734570',
'770658416790',
'770355929175',
'770355929183',
'770355929205',
'770355929213',
'770357877300',
'770658613502',
'770357403146',
'770657755265',
'770657794333',
'770353889583',
'770350190058',
'770350190066',
'770350190082',
'770359294476',
'770359377037',
'770359294468',
'770354697947',
'770573542010',
'770573542029',
'770573542037',
'770658323792',
'770657294802',
'770658612646',
'770355766730',
'770355766748',
'770355766497',
'770658169548',
'770349066238',
'770349052512',
'770349058219',
'770350596658',
'770349937441',
'770351790423',
'770354587939',
'770658354396',
'770351793872',
'770573798317',
'770573798325',
'770573798090',
'770573497945',
'770573272463',
'770612776849',
'770355651240',
'770658465236',
'770359313969',
'770359313977',
'770359313985',
'770359313942',
'770658419439',
'770657754056',
'770613320792',
'770613320806',
'770613194673',
'770359731515',
'770354421151',
'770354421160',
'770354421178',
'770354419750',
'770357523320',
'770352656798',
'770352656801',
'770352653900',
'770658213970',
'770658213997',
'770658214004',
'770658214012',
'770658214020',
'770658214039',
'770658214047',
'770658214055',
'770657338656',
'770358234321',
'770358234240',
'770350287906',
'770351272090',
'770351154039',
'770358932754',
'770573231465',
'770573231481',
'770573542258',
'770351061499',
'770351061480',
'770351080205',
'770352165859',
'770351457201',
'770351457180',
'770351457171',
'770356600517',
'770356600525',
'770356600533',
'770356600541',
'770658351621',
'770658221973',
'770658221981',
'770658221957',
'770355027384',
'770357330068',
'770357330076',
'770357330084',
'770357330050',
'770358094945',
'770358208878',
'770358208916',
'770358208924',
'770657295051',
'770657295060',
'770657295086',
'770657295094',
'770657904619',
'770657904627',
'770657904635',
'770657979350',
'770353072692',
'770355286215',
'770355931935',
'770355931951',
'770355704246',
'770357305934',
'770359753160',
'770352503169',
'770657617180',
'770657617156',
'770658611895',
'770353639846',
'770353619365',
'770353618458',
'770359116373',
'770573648528',
'770573648536',
'770354453606',
'770573648544',
'770358956785',
'770358956793',
'770658509640',
'770573746627',
'770573131649',
'770357866782',
'770357866766',
'770357194555',
'770359088329',
'770359088310',
'770356656814',
'770356656806',
'770356656822',
'770356656830',
'770356656849',
'770356656857',
'770359853998',
'770657758701',
'770657758671',
'770356328973',
'770359625693',
'770359625707',
'770359625715',
'770359525290',
'770355966674',
'770658122169',
'770658122045',
'770356328981',
'770356328990',
'770356328906',
'770353174622',
'770353868012',
'770358834272',
'770358834515',
'770358834523',
'770358834531',
'770358834540',
'770358834558',
'770358834566',
'770358834574',
'770357915619',
'770357915600',
'770657449326',
'770657449318',
'770573321529',
'770613141634',
'770612891010',
'770612891028',
'770573683420',
'770573683447',
'770353899317',
'770353894536',
'770572914917',
'770573543076',
'770612891150',
'770573614895',
'770356988477',
'770356988493',
'770658299646',
'770357935580',
'770358264913',
'770612823545',
'770612891141',
'770351320389',
'770350826602',
'770350826599',
'770353381342',
'770658050532',
'770658050540',
'770658050559',
'770658050567',
'770658050524',
'770658050575',
'770358618316',
'770612920826',
'770355360350',
'770355360369',
'770355359492',
'770353413333',
'770353406981',
'770353406990',
'770353404350',
'770657295868',
'770658332546',
'770573776712',
'770573776666',
'770349672421',
'770349672464',
'770573829298',
'770658477943',
'770658477951',
'770658477960',
'770658477978',
'770613449663',
'770658279025',
'770657303526',
'770657303534',
'770657303550',
'770657783730',
'770658465813',
'770658465805',
'770658465821',
'770572961516',
'770658465147',
'770350409238',
'770350409246',
'770350409254',
'770657345563',
'770573322320',
'770573322355',
'770573322363',
'770573322371',
'770573322380',
'770573322312',
'770356894995',
'770356895010',
'770356894987',
'770658389335',
'770572888363',
'770573769775',
'770573078578',
'770573783620',
'770573783387',
'770354132583',
'770354130408',
'770354130424',
'770354130432',
'770359552998',
'770658183060',
'770658183095',
'770613669612',
'770613454942',
'770612891540',
'770612891559',
'770612891567',
'770612891575',
'770613110348',
'770359353057',
'770359353065',
'770359353049',
'770353432001',
'770353430610',
'770355535061',
'770355926370',
'770658003976',
'770658629476',
'770573043960',
'770573043979',
'770573043987',
'770573043995',
'770573044002',
'770573043952',
'770354889994',
'770353859536',
'770573055640',
'770573055659',
'770573055667',
'770573055632',
'770352627631',
'770359338333',
'770359338341',
'770356499620',
'770356499611',
'770658646150',
'770658358308',
'770359869134',
'770357930979',
'770357930960',
'770353526855',
'770658604090',
'770658604104',
'770351966394',
'770658436325',
'770355783758',
'770573270010',
'770356130863',
'770356130871',
'770356130880',
'770356130898',
'770356130901',
'770658353799',
'770657389927',
'770658645803',
'770358019501',
'770358271839',
'770358271847',
'770358271855',
'770354702673',
'770657751715',
'770657751723',
'770359135610',
'770351623896',
'770657978728',
'770657978736',
'770657978744',
'770657978752',
'770657978760',
'770657978779',
'770657978787',
'770657978680',
'770356502426',
'770657324612',
'770657324620',
'770657324604',
'770355527000',
'770355196216',
'770355196224',
'770355196232',
'770350584676',
'770350584684',
'770350584692',
'770359291302',
'770359291299',
'770573013506',
'770573013514',
'770573013522',
'770573013530',
'770573013549',
'770573013492',
'770573013557',
'770658388754',
'770657390321',
'770657390330',
'770658612409',
'770658078895',
'770573453271',
'770572898881',
'770657806897',
'770657664502',
'770355718948',
'770355718956',
'770355677087',
'770359645945',
'770359645953',
'770359794983',
'770353522094',
'770353566148',
'770657962899',
'770658146823',
'770658146831',
'770658146840',
'770657754420',
'770657990000',
'770657967696',
'770573462602',
'770573462610',
'770658520024',
'770658432460',
'770658432478',
'770349094037',
'770350092188',
'770613653961',
'770613653970',
'770613653988',
'770356461509',
'770355275949',
'770355275957',
'770355275930',
'770658181475',
'770353747274',
'770353882929',
'770658599755',
'770613043780',
'770358567576',
'770358567541',
'770658325558',
'770351056878',
'770658516345',
'770658516396',
'770359416792',
'770359675445',
'770658300326',
'770658300334',
'770658300342',
'770349886405',
'770353570773',
'770354073650',
'770658599267',
'770658327690',
'770354131668',
'770359899661',
'770359899670',
'770359899653',
'770358289843',
'770358210139',
'770358210147',
'770358210155',
'770349025248',
'770349025256',
'770349025299',
'770349025302',
'770353108107',
'770355575020',
'770573513410',
'770573513428',
'770573513436',
'770573513444',
'770573510852',
'770352793310',
'770352792730',
'770352792640',
'770352792667',
'770573546520',
'770573497449',
'770658039873',
'770658003690',
'770354780160',
'770354780151',
'770357535484',
'770573142527',
'770573142535',
'770354821770',
'770354821761',
'770355221202',
'770356511247',
'770356511239',
'770356511255',
'770354984725',
'770354984733',
'770354984741',
'770354984750',
'770354595885',
'770657390895',
'770355218422',
'770354688824',
'770354688832',
'770354688840',
'770354688859',
'770354688867',
'770355036243',
'770354688875',
'770354688883',
'770354688891',
'770354688905',
'770359313144',
'770359313152',
'770359313160',
'770359313179',
'770359313187',
'770359313195',
'770359313209',
'770359313217',
'770359313225',
'770359313233',
'770359313136',
'770657799769',
'770352648485',
'770573037251',
'770573037260',
'770354178974',
'770658408178',
'770657932647',
'770358593712',
'770358593720',
'770358685595',
'770359835400',
'770658077287',
'770658077260',
'770658147595',
'770658147609',
'770658147617',
'770658350544',
'770657390976',
'770658611178',
'770349765810',
'770349765829',
'770355585859',
'770355585697',
'770573037278',
'770573037286',
'770573037294',
'770573037308',
'770573037316',
'770573037324',
'770573646568',
'770657390984',
'770359857098',
'770359857055',
'770358285554',
'770358285562',
'770349039788',
'770350328246',
'770352323772',
'770351673915',
'770358285570',
'770358285589',
'770358285597',
'770358285600',
'770358285619',
'770358114997',
'770658646710',
'770349028611',
'770349028620',
'770349028638',
'770349028646',
'770349028662',
'770349028670',
'770350460586',
'770351764775',
'770349039796',
'770350241310',
'770658327348',
'770658327356',
'770612947732',
'770612892520',
'770352107174',
'770658478613',
'770356486714',
'770658469410',
'770357161037',
'770357161045',
'770357161029',
'770358285937',
'770358285945',
'770358285953',
'770358285929',
'770573021517',
'770573021525',
'770573021533',
'770573021509',
'770351188375',
'770353809040',
'770658559150',
'770357518849',
'770657516880',
'770657516899',
'770657516902',
'770657516686',
'770355306828',
'770355306836',
'770355306780',
'770658297589',
'770357387396',
'770357387400',
'770356857933',
'770355254321',
'770355254330',
'770355254348',
'770355254313',
'770356672143',
'770572935086',
'770573346351',
'770573344731',
'770351028815',
'770658357565',
'770658357581',
'770658357549',
'770657391190',
'770657391204',
'770658553356',
'770613191917',
'770612892610')
union
select	b.rowid as id_linha,
	b.dtfimvig,
	b.dtcancel,
	b.cdsitseg,
	b.cdopeexc,
	b.cdageexc,
	b.dtinsexc,
	b.cdopecnl,
	c.rowid as nr_linha_tbseg,
	c.nrproposta,
	c.tpregist,
	c.tprecusa,
	c.cdmotrec,
	c.dtrecusa,
	c.situacao,
	c.tpcustei,
	c.cdcooper,
	c.nrdconta
from	cecred.crapcop d,
	cecred.tbseg_prestamista c,
	cecred.crapseg b
where	c.cdcooper	= d.cdcooper
and	b.tpseguro	= 4
and	(b.cdsitseg not in (2,5) or (c.dtrecusa is null and c.tpregist <> 0))
and	c.cdcooper	= b.cdcooper
and	c.nrdconta	= b.nrdconta
and	c.nrctrseg	= b.nrctrseg
and	c.nrproposta	in
	('770612892628',
'770612892636',
'770612892644',
'770612892652',
'770612892660',
'770359908229',
'770657469068',
'770657469017',
'770355924521',
'770658188143',
'770658188160',
'770358076823',
'770657753084',
'770351514329',
'770351514337',
'770351514310',
'770353546368',
'770658187902',
'770658508482',
'770351168838',
'770351168846',
'770351168854',
'770350586067',
'770350215352',
'770350241906',
'770354144433',
'770356589556',
'770356162285',
'770359631677',
'770359711174',
'770350427279',
'770350427287',
'770350427309',
'770350417516',
'770351331976',
'770351438053',
'770356998731',
'770354189143',
'770352775916',
'770350468412',
'770355261557',
'770354720302',
'770354720310',
'770354720329',
'770354720337',
'770356998740',
'770356998758',
'770356998766',
'770356998774',
'770356998782',
'770356892445',
'770351335009',
'770351229195',
'770351229209',
'770351229217',
'770351229187',
'770352526266',
'770350507906',
'770350507914',
'770350507922',
'770355639223',
'770657968552',
'770359315465',
'770356739760',
'770356739779',
'770358185479',
'770358380794',
'770358380808',
'770358380816',
'770358380824',
'770613018930',
'770354596318',
'770354596326',
'770354980061',
'770354868644',
'770354720361',
'770658631640',
'770356857569',
'770356857577',
'770356857585',
'770356122925',
'770351673761',
'770354863693',
'770354863707',
'770354863715',
'770354863685',
'770613002359',
'770613002340',
'770657789410',
'770657391816',
'770657391824',
'770657391832',
'770354407701',
'770359731086',
'770354407477',
'770358034918',
'770349792176',
'770350139001',
'770351823143',
'770358560067',
'770358560059',
'770657391913',
'770658610589',
'770358069258',
'770573399960',
'770354299887',
'770354299895',
'770354299879',
'770354299917',
'770354299941',
'770354299950',
'770355412261',
'770354720752',
'770354720760',
'770354720779',
'770613026428',
'770613026436',
'770613026444',
'770613138412',
'770350604421',
'770350604430',
'770658177508',
'770350895361',
'770350832920',
'770350833099',
'770357822009',
'770349943727',
'770349943735',
'770349943743',
'770349941856',
'770355837262',
'770355197565',
'770355197573',
'770349790106',
'770349790114',
'770349790122',
'770349790130',
'770349790149',
'770349067633',
'770657798967',
'770657392030',
'770358887767',
'770355032108',
'770658513400',
'770573293401',
'770573160754',
'770349075873',
'770357221994',
'770357222001',
'770357222010',
'770357222028',
'770357222036',
'770357221986',
'770355067173',
'770355067165',
'770355067181',
'770657193887',
'770657288446',
'770657288454',
'770657288462',
'770657288039',
'770354900831',
'770354900840',
'770354958643',
'770358969690',
'770359616317',
'770349812673',
'770349812681',
'770658015117',
'770658330233',
'770658177761',
'770658177770',
'770658177788',
'770658177796',
'770658177800',
'770353512579',
'770353828770',
'770350412190',
'770350412204',
'770350080856',
'770350096213',
'770658595849',
'770657636894',
'770658279300',
'770358554075',
'770358554091',
'770358554105',
'770358554067',
'770357230373',
'770353759540',
'770658557653',
'770658557661',
'770658557670',
'770658557637',
'770657189847',
'770657456101',
'770357592046',
'770658356429',
'770354276909',
'770354276895',
'770357799112',
'770359731434',
'770354426030',
'770359781130',
'770356328167',
'770356328175',
'770356328183',
'770356090055',
'770354371740',
'770354192578',
'770354195054',
'770658107682',
'770357392004',
'770357392012',
'770356457617',
'770355713571',
'770613687750',
'770613687742',
'770658416286',
'770658416294',
'770658416308',
'770658416316',
'770658416324',
'770658416278',
'770658416332',
'770359949820',
'770349703254',
'770349703262',
'770349703270',
'770658042203',
'770351563567',
'770351563575',
'770350638679',
'770350638687',
'770350638695',
'770350638709',
'770350644563',
'770350449345',
'770613073086',
'770613073094',
'770613073108',
'770613073116',
'770613072721',
'770356134508',
'770356227808',
'770573275888',
'770572898180',
'770613244883',
'770613244891',
'770349722097',
'770355334317',
'770355334236',
'770354721589',
'770354721597',
'770354721600',
'770354721619',
'770354721627',
'770354721635',
'770354721643',
'770356012658',
'770356012666',
'770356133579',
'770355325300',
'770356659295',
'770356659309',
'770356659317',
'770613653082',
'770613653090',
'770613653104',
'770613653112',
'770613653120',
'770613653139',
'770613653074',
'770357139066',
'770358607691',
'770657542539',
'770657542555',
'770657379506',
'770657456500',
'770658554093',
'770357579430',
'770357200750',
'770357200768',
'770357200776',
'770357200784',
'770356720628',
'770657795321',
'770354440334',
'770354440342',
'770354440300',
'770658003437',
'770357356180',
'770357356164',
'770357623430',
'770357623456',
'770357622956',
'770357379601',
'770357379610',
'770357899796',
'770350478698',
'770350482148',
'770350476741',
'770573422155',
'770573422163',
'770573422171',
'770573421531',
'770357081041',
'770357536103',
'770357200857',
'770357200865',
'770357200873',
'770357200881',
'770358561268',
'770358561292',
'770573768752',
'770357360560',
'770357360579',
'770357360552',
'770353997858',
'770353967177',
'770658418980',
'770658418998',
'770658552082',
'770657969133',
'770657666726',
'770657666718',
'770359108729',
'770358337376',
'770658647920',
'770353826506',
'770353804626',
'770354666057',
'770354666073',
'770354666090',
'770354666103',
'770354666111',
'770354666120',
'770354666049',
'770355413993',
'770355414043',
'770356401077',
'770356401069',
'770657891584',
'770658554611',
'770612988650',
'770613283102',
'770658598910',
'770658598937',
'770658598953',
'770613491309',
'770613491317',
'770613491325',
'770573051157',
'770357383056',
'770357866340',
'770358917640',
'770354863332',
'770355034437',
'770355034445',
'770355034453',
'770355034461',
'770658024272',
'770353447025',
'770353431528',
'770359096771',
'770359096780',
'770359096283',
'770356359224',
'770356359240',
'770356359259',
'770356359208',
'770356359267',
'770357223776',
'770357200954',
'770357200962',
'770357200970',
'770658330152',
'770357966434',
'770357966442',
'770357072441',
'770355016013',
'770355016056',
'770355016064',
'770355484211',
'770573716663',
'770658328565',
'770657546453',
'770657419249',
'770657891690',
'770357186617',
'770357186625',
'770357186633',
'770357166926',
'770357186668',
'770657675768',
'770657891665',
'770657891673',
'770657891681',
'770354676028',
'770354676036',
'770354676052',
'770354676060',
'770354676079',
'770354675501',
'770657966657',
'770657966665',
'770358736408',
'770358736416',
'770358736424',
'770358736394',
'770358343716',
'770358343724',
'770358343732',
'770358343708',
'770613721738',
'770612990832',
'770357962323',
'770358405860',
'770657813400',
'770657891843',
'770658467247',
'770352551171',
'770350337393',
'770657798126',
'770657798134',
'770657798142',
'770613061070',
'770613061088',
'770613061096',
'770613388117',
'770613283323',
'770657797316',
'770357179882',
'770357179726',
'770350338861',
'770352580619',
'770350338870',
'770658269216',
'770350338942',
'770350338950',
'770350338969',
'770350074651',
'770350074660',
'770350074678',
'770353827731',
'770358584926',
'770658602527',
'770350076018',
'770350076026',
'770350076034',
'770350076042',
'770350076050',
'770350076069',
'770658357999',
'770359292562',
'770358909795',
'770613599312',
'770658610406',
'770355878856',
'770354631750',
'770354863448',
'770354863456',
'770358216846',
'770357485843',
'770357485860',
'770357485827',
'770354521091',
'770355227987',
'770354977028',
'770354977044',
'770354977052',
'770354977060',
'770354977079',
'770354977087',
'770354977095',
'770354977109',
'770354977117',
'770354977125',
'770354977133',
'770354977141',
'770354977150',
'770354977168',
'770352119776',
'770352119806',
'770352119814',
'770352120014',
'770354862840',
'770354862832',
'770356902181',
'770356902190',
'770356011058',
'770357843405',
'770356093984',
'770350048065',
'770359359098',
'770358218482',
'770658603310',
'770658603256',
'770658502387',
'770358193773',
'770612966974',
'770658631861',
'770356548574',
'770658029983',
'770352321478',
'770351986026',
'770351986042',
'770658031082',
'770613737278',
'770613737260',
'770573408942',
'770573408950',
'770573408969',
'770573030354',
'770350935444',
'770353118692',
'770353118706',
'770359059876',
'770359059841',
'770356683625',
'770356919661',
'770356919670',
'770356919688',
'770356919696',
'770356919726',
'770356919734',
'770356919742',
'770658268929',
'770356654870',
'770356654889',
'770613009043',
'770613283552',
'770613283560',
'770350028609',
'770350028617',
'770350028625',
'770350028633',
'770350028641',
'770350028650',
'770350228845',
'770354952513',
'770354951940',
'770613613382',
'770613613390',
'770613613374',
'770658186370',
'770352613070',
'770657892440',
'770657892459',
'770351750286',
'770351750294',
'770351750308',
'770351750243',
'770351323345',
'770351282681',
'770573322851',
'770573273931',
'770573273940',
'770573273958',
'770573273966',
'770573273974',
'770359741456',
'770355219518',
'770355219534',
'770355219062',
'770658515950',
'770354921090',
'770354921103',
'770354921111',
'770354921120',
'770658237756',
'770355507203',
'770355507211',
'770355507220',
'770613624996',
'770351104848',
'770657892505',
'770658278630',
'770349966085',
'770349966115',
'770349966204',
'770658352245',
'770658352253',
'770350812296',
'770350812300',
'770350812261',
'770350824952',
'770351985380',
'770354456060',
'770355782867',
'770355782875',
'770355782883',
'770355782891',
'770355782824',
'770658183222',
'770613667393',
'770357260779',
'770357260752',
'770358554520',
'770358554679',
'770573262468',
'770573245091',
'770356189833',
'770356189850',
'770573811640',
'770658352369',
'770657892513',
'770658467166',
'770349966549',
'770359330790',
'770354021668',
'770355826090',
'770612981779',
'770612981760',
'770356271904',
'770356271890',
'770573811615',
'770573264584',
'770657383171',
'770657223670',
'770354145200',
'770356725883',
'770356725875',
'770573260058',
'770356448499',
'770356448502',
'770359225385',
'770358282679',
'770354573296',
'770354573300',
'770354573318',
'770354573326',
'770355227081',
'770658603787',
'770359979274',
'770359979282',
'770357515785',
'770356906349',
'770613733140',
'770353103954',
'770350387404',
'770354426986',
'770358066860',
'770359902352',
'770351940174',
'770613725997',
'770355715680',
'770354806177',
'770354806185',
'770354806169',
'770613698574',
'770658630407',
'770573065301',
'770355698220',
'770355698238',
'770355680398',
'770351841044',
'770573551826',
'770658120115',
'770658073451',
'770658073427',
'770352539040',
'770658197436',
'770359985592',
'770354563487',
'770354563460',
'770354969599',
'770658195352',
'770658080881',
'770350064125',
'770355036049',
'770354969602',
'770354969610',
'770354292807',
'770354062445',
'770354060728',
'770354060736',
'770354060744',
'770354060710',
'770359060742',
'770357709806',
'770658122967',
'770658122975',
'770658122983',
'770658122959',
'770356481674',
'770573725603',
'770355424103',
'770355424090',
'770613119337',
'770354133148',
'770356446526',
'770357204208',
'770658256564',
'770658256572',
'770658256580',
'770658120328',
'770354707764',
'770572943798',
'770658479121',
'770573409604',
'770613344497',
'770658293508',
'770356643534',
'770573549996',
'770573549848',
'770355227839',
'770355227820',
'770573572734',
'770355134962',
'770355134970',
'770355134989',
'770355134997',
'770356933559',
'770355219887',
'770355219895',
'770355219909',
'770355219917',
'770355219925',
'770355219933',
'770355219941',
'770355219950',
'770355219968',
'770355219860',
'770658411292',
'770613341684',
'770573583671',
'770657973432',
'770355269418',
'770355052567',
'770359834802',
'770359834810',
'770359020724',
'770351717696',
'770359304676',
'770356632346',
'770356593782',
'770352534552',
'770613305777',
'770353064789',
'770352763020',
'770657798444',
'770657798460',
'770356110072',
'770355443671',
'770354796902',
'770350537937',
'770357366380',
'770357366399',
'770357366372',
'770359639252',
'770359985851',
'770358419135',
'770349111080',
'770658354230',
'770658354248',
'770354916592',
'770354916576',
'770358460410',
'770572941639',
'770572941647',
'770572941655',
'770572941663',
'770572941671',
'770572941680',
'770572941698',
'770658213261',
'770657976407',
'770350241710',
'770354771853',
'770354771861',
'770354771870',
'770354771888',
'770354771896',
'770354771900',
'770354771918',
'770354771926',
'770354771934',
'770354771845',
'770572941990',
'770356126190',
'770658169750',
'770359701713',
'770658514822',
'770658514830',
'770355998134',
'770573178696',
'770359116497',
'770573482379',
'770573482387',
'770573482360',
'770356034163',
'770355438546',
'770355938212',
'770355438554',
'770355722473',
'770355722457',
'770613759743',
'770353958640',
'770357875447',
'770357875455',
'770357875463',
'770357875439',
'770353065599',
'770352837083',
'770573519566',
'770573519582',
'770573519590',
'770573519558',
'770359327838',
'770573061888',
'770573062850',
'770355065146',
'770355065138',
'770573645812',
'770573019598',
'770354963582',
'770358468209',
'770357382696',
'770356931670',
'770355706710',
'770353104853',
'770357228905',
'770357900913',
'770354984873',
'770658514407',
'770613296620',
'770658510983',
'770352321206',
'770352035254',
'770356810481',
'770356810490',
'770356810503',
'770356810511',
'770356204484',
'770357092876',
'770357092884',
'770357987458',
'770613169652',
'770351814403',
'770657976784',
'770657976792',
'770355045676',
'770573730453',
'770355573028',
'770354435950',
'770356980352',
'770613381228',
'770613548505',
'770355516792',
'770354804115',
'770573732979',
'770354313014',
'770353969765',
'770353970976',
'770613047131',
'770658477641',
'770358237762',
'770657789658',
'770657789640',
'770573466381',
'770352404110',
'770357955831',
'770357955823',
'770658185977',
'770658355635',
'770657635413',
'770657635421',
'770657635405',
'770354513668',
'770354513676',
'770354513684',
'770354914360',
'770356509625',
'770613587110',
'770354937190',
'770356004019',
'770356996682',
'770573564065',
'770355103676',
'770355103684',
'770355103650',
'770355103692',
'770357900875',
'770658228234',
'770658209655',
'770657974439',
'770355098044',
'770355098052',
'770658598260',
'770658025929',
'770354767864',
'770354807122',
'770350498915',
'770351380233',
'770350935720',
'770355149781',
'770350903798',
'770349097818',
'770573259920',
'770573259939',
'770573259947',
'770573259831',
'770355149803',
'770355149811',
'770350462066',
'770573801121',
'770355541215',
'770358013236',
'770355312127',
'770352298786',
'770352298778',
'770613769668',
'770613769676',
'770613769650',
'770350102760',
'770350102779',
'770658469720',
'770613733590',
'770352412457',
'770355223353',
'770572933881',
'770349104768',
'770349104776',
'770349104784',
'770658614134',
'770629374566',
'770629220046',
'770628950121',
'770629223800',
'770629699236',
'770629694536',
'770629219641',
'770629381708',
'770629700994',
'770629215433',
'770629081011',
'770629702920',
'770629383360',
'770629694250',
'770629698272');

procedure valida_diretorio_p(	ds_nome_diretorio_p	in	varchar2,
				ds_critica_p		out	cecred.crapcri.dscritic%TYPE) is

ds_critica_v	cecred.crapcri.dscritic%type;
ie_tipo_saida_v	varchar2(3);
ds_saida_v	varchar2(1000);
   
begin

	if	(cecred.gene0001.fn_exis_diretorio(ds_nome_diretorio_p)) then

		ds_critica_p	:= null;

	else

		cecred.gene0001.pc_OSCommand_Shell(	pr_des_comando	=> 'mkdir ' || ds_nome_diretorio_p || ' 1> /dev/null',
						pr_typ_saida	=> ie_tipo_saida_v,
						pr_des_saida	=> ds_saida_v);

		if	(ie_tipo_saida_v	= 'ERR') then

			ds_critica_v	:= 'CRIAR DIRETORIO ARQUIVO -> Nao foi possivel criar o diretorio para gerar os arquivos. ' || ds_saida_v;
			raise		ds_exc_erro_v;

		end if;

		cecred.gene0001.pc_OSCommand_Shell(	pr_des_comando	=> 'chmod 777 ' || ds_nome_diretorio_p || ' 1> /dev/null',
						pr_typ_saida	=> ie_tipo_saida_v,
						pr_des_saida	=> ds_saida_v);

		if	(ie_tipo_saida_v	= 'ERR') then

			ds_critica_v	:= 'PERMISSAO NO DIRETORIO -> Nao foi possivel adicionar permissao no diretorio dos arquivos. ' || ds_saida_v;
			raise		ds_exc_erro_v;

		end if;

	end if;

exception
when	ds_exc_erro_v then

        ds_critica_p	:= ds_critica_v;

end valida_diretorio_p;

PROCEDURE pc_efetuar_estorno(	pr_cdcooper	in	cecred.craplau.cdcooper%TYPE,
				pr_nrdconta	in	cecred.craplau.nrdconta%TYPE,
				pr_nrproposta	in	cecred.tbseg_prestamista.nrproposta%TYPE,
				pr_dtmvtolt	in	cecred.crapdat.dtmvtolt%TYPE,
				pr_rowidlct	out	rowid) IS

vr_tab_retorno	cecred.LANC0001.typ_reg_retorno;
vr_incrineg	INTEGER DEFAULT 0 ;
vr_cdcritic	PLS_INTEGER;
vr_dscritic	VARCHAR2(4000);
vr_exc_erro	EXCEPTION;

cursor	cr_craplcm(	pr_cdcooper	cecred.craplau.cdcooper%TYPE,
			pr_nrdconta	cecred.craplau.nrdconta%TYPE,
			pr_nrproposta	cecred.tbseg_prestamista.nrproposta%TYPE) IS

SELECT	m.cdagenci,
	m.cdbccxlt,
	m.nrdolote,
	m.nrdconta,
	m.nrdocmto,
	m.cdhistor,
	m.nrseqdig,
	m.vllanmto,
	m.nrdctabb,
	m.cdcooper,
	m.nrdctitg
FROM	cecred.craplau u,
	cecred.craplcm m
WHERE	u.cdcooper	= pr_cdcooper
AND	u.nrdconta	= pr_nrdconta
AND	u.cdhistor	= 3651
AND	u.cdseqtel	= pr_nrproposta
AND	u.insitlau	= 2
AND	m.cdcooper	= u.cdcooper
AND	m.nrdconta	= u.nrdconta
AND	m.cdhistor	= u.cdhistor
AND	m.dtmvtolt	= u.dtmvtopg
AND	m.nrdocmto	= u.nrdocmto
AND	m.vllanmto	= u.vllanaut
AND	NOT EXISTS
	(SELECT	1
	FROM	cecred.craplcm b
	WHERE	b.cdcooper	= m.cdcooper
	AND	b.nrdconta	= m.nrdconta
	AND	b.nrdocmto || '001'	= m.nrdocmto
	AND	b.cdhistor	= 3852
	AND	b.dtmvtolt	>= m.dtmvtolt
	AND	b.vllanmto	= m.vllanmto);

rw_craplcm	cr_craplcm%ROWTYPE;

begin

	OPEN	cr_craplcm(	pr_cdcooper	=> pr_cdcooper,
				pr_nrdconta	=> pr_nrdconta,
				pr_nrproposta	=> pr_nrproposta);
	FETCH	cr_craplcm INTO rw_craplcm;

		IF	(cr_craplcm%FOUND) THEN

			lanc0001.pc_gerar_lancamento_conta(	pr_dtmvtolt	=> pr_dtmvtolt,
								pr_cdagenci	=> rw_craplcm.cdagenci,
								pr_cdbccxlt	=> rw_craplcm.cdbccxlt,
								pr_nrdolote	=> rw_craplcm.nrdolote,
								pr_nrdconta	=> rw_craplcm.nrdconta,
								pr_nrdocmto	=> rw_craplcm.nrdocmto || '001',
								pr_cdhistor	=> 3852,
								pr_nrseqdig	=> rw_craplcm.nrseqdig + 1,
								pr_vllanmto	=> rw_craplcm.vllanmto,
								pr_nrdctabb	=> rw_craplcm.nrdctabb,
								pr_dtrefere	=> pr_dtmvtolt,
								pr_hrtransa	=> to_char(SYSDATE,'SSSSS'),
								pr_cdcooper	=> rw_craplcm.cdcooper,
								pr_nrdctitg	=> rw_craplcm.nrdctitg,
								pr_tab_retorno	=> vr_tab_retorno,
								pr_incrineg	=> vr_incrineg,
								pr_cdcritic	=> vr_cdcritic,
								pr_dscritic	=> vr_dscritic);

			pr_rowidlct	:= vr_tab_retorno.rowidlct;

			IF	(NVL(vr_cdcritic,0) <> 0 AND TRIM(vr_dscritic) IS NOT NULL) THEN

				RAISE vr_exc_erro;

		        END IF;

		END IF;

	CLOSE cr_craplcm;

EXCEPTION
WHEN	vr_exc_erro THEN

	ds_critica_v	:= vr_dscritic || SQLERRM;

WHEN	OTHERS THEN

	vr_dscritic	:= 'Erro ao alterar craplau SEGU0001.pc_efetiva_pgto_prest_contrib';
	ds_critica_v	:= vr_dscritic||SQLERRM;

END	pc_efetuar_estorno;

begin

if	(upper(cecred.gene0001.fn_database_name) like '%AYLLOSP%' or upper(cecred.gene0001.fn_database_name) like '%AILOSTS%') then

	select	max(a.dsvlrprm)
	into	ds_nome_diretorio_v
	from	cecred.crapprm a
	where	a.nmsistem	= 'CRED'
	and	a.cdcooper	= cd_cooperativa_v
	and	a.cdacesso	= 'ROOT_MICROS';

	if	(ds_nome_diretorio_v	is null) then

		select	max(a.dsvlrprm)
		into	ds_nome_diretorio_v
		from	cecred.crapprm a
		where	a.nmsistem	= 'CRED'
		and	a.cdcooper	= 0
		and	a.cdacesso	= 'ROOT_MICROS';

	end if;

	ds_nome_diretorio_v	:= ds_nome_diretorio_v || 'cpd/bacas/INC0212779';

else

	ds_nome_diretorio_v	:= cecred.gene0001.fn_diretorio(	pr_tpdireto => 'C',
								pr_cdcooper => 3);

	ds_nome_diretorio_v	:= ds_nome_diretorio_v || '/INC0212779';

end if;
 
valida_diretorio_p(	ds_nome_diretorio_p	=> ds_nome_diretorio_v,
			ds_critica_p		=> ds_critica_v);

if	(trim(ds_critica_v) is not null) then

	raise ds_exc_erro_v;

end if;

for	r01 in c01 loop

	begin

	if	(qt_reg_arquivo	>= 50000) then

		qt_reg_arquivo	:= 0;

		dbms_lob.createtemporary(ds_dados_rollback_v, true, dbms_lob.CALL);
		dbms_lob.open(ds_dados_rollback_v, dbms_lob.lob_readwrite);
		cecred.gene0002.pc_escreve_xml(ds_dados_rollback_v, ds_texto_rollback_v, 'begin '||chr(13), false);  
		ds_nome_arquivo_bkp_v	:= 'ROLLBACK_INC0212779_'||nr_arquivo||'.sql';

		nr_arquivo	:= nr_arquivo + 1;

	end if;

	qt_registro	:= qt_registro + 1;
	qt_reg_arquivo	:= qt_reg_arquivo + 1;

	update	cecred.tbseg_prestamista a
	set	a.tpregist	= 0,
		a.tprecusa	= '01072022',
		a.cdmotrec	= 1062,
		a.dtrecusa	= sysdate,
		a.situacao	= 0
	where	a.dtrecusa	is null
	and	a.rowid		= r01.nr_linha_tbseg;

	cecred.gene0002.pc_escreve_xml(	ds_dados_rollback_v,
					ds_texto_rollback_v,
					'update	cecred.tbseg_prestamista a ' || chr(13) ||
					'set	a.tpregist	= ' || nvl(trim(to_char(r01.tpregist)),'null') || ', ' || chr(13) ||
					'	a.tprecusa	= ' || chr(39) || r01.tprecusa || chr(39) || ', ' || chr(13) ||
					'	a.cdmotrec	= ' || nvl(trim(to_char(r01.cdmotrec)),'null') || ', ' || chr(13) ||
					'	a.dtrecusa	= ' || 'to_date(' || chr(39) || trim(to_char(r01.dtrecusa,'dd/mm/yyyy hh24:mi:ss')) || chr(39) || ',' || chr(39) || 'dd/mm/yyyy hh24:mi:ss' || chr(39) || '), ' || chr(13) ||
					'	a.situacao	= ' || nvl(trim(to_char(r01.situacao)),'null') || chr(13) ||
					'where	a.rowid		= ' || chr(39) || r01.nr_linha_tbseg || chr(39) || ';' || chr(13) || chr(13), false);

	update	cecred.crapseg a
	set	a.dtfimvig	= trunc(sysdate),
		a.dtcancel	= trunc(sysdate),
		a.cdsitseg	= 5,
		a.cdopeexc	= '1',
		a.cdageexc	= 1,
		a.dtinsexc	= trunc(sysdate),
		a.cdopecnl	= '1'
	where	a.rowid		= r01.id_linha;

	cecred.gene0002.pc_escreve_xml(	ds_dados_rollback_v,
					ds_texto_rollback_v,
					'update	cecred.crapseg a ' || chr(13) ||
					'set	a.dtfimvig	= ' || 'to_date(' || chr(39) || trim(to_char(r01.dtfimvig,'dd/mm/yyyy')) || chr(39) || ',' || chr(39) || 'dd/mm/yyyy' || chr(39) || '), ' || chr(13) ||
					'	a.dtcancel	= ' || 'to_date(' || chr(39) || trim(to_char(r01.dtcancel,'dd/mm/yyyy')) || chr(39) || ',' || chr(39) || 'dd/mm/yyyy' || chr(39) || '), ' || chr(13) ||
					'	a.cdsitseg	= ' || replace(nvl(trim(to_char(r01.cdsitseg)),'null'),',','.') || ', ' || chr(13) ||
					'	a.cdopeexc	= ' || chr(39) || r01.cdopeexc || chr(39) || ', ' || chr(13) ||
					'	a.cdageexc	= ' || replace(nvl(trim(to_char(r01.cdageexc)),'null'),',','.') || ', ' || chr(13) ||
					'	a.dtinsexc	= ' || 'to_date(' || chr(39) || trim(to_char(r01.dtinsexc,'dd/mm/yyyy')) || chr(39) || ',' || chr(39) || 'dd/mm/yyyy' || chr(39) || '), ' || chr(13) ||
					'	a.cdopecnl	= ' || chr(39) || r01.cdopecnl || chr(39) || chr(13) ||
					'where	a.rowid		= ' || chr(39) || r01.id_linha || chr(39) || ';' || chr(13) || chr(13), false);

	if	(r01.tpcustei	= 0) then

		vr_proxutil	:= GENE0005.fn_valida_dia_util(	pr_cdcooper	=> r01.cdcooper,
								pr_dtmvtolt	=> TRUNC(SYSDATE),
								pr_tipo		=> 'P');

		pc_efetuar_estorno(	pr_cdcooper	=> r01.cdcooper,
					pr_nrdconta	=> r01.nrdconta,
					pr_nrproposta	=> r01.nrproposta,
					pr_dtmvtolt	=> vr_proxutil,
					pr_rowidlct	=> ds_rowidlct);

		cecred.gene0002.pc_escreve_xml(	ds_dados_rollback_v,
						ds_texto_rollback_v,
						'delete	from cecred.craplcm a ' || chr(13) ||
						'where	a.rowid	= ' || chr(39) || ds_rowidlct || chr(39) || ';' || chr(13) || chr(13), false);

	end if;

	if	(qt_registro	>= 1000) then

		cecred.gene0002.pc_escreve_xml(ds_dados_rollback_v, ds_texto_rollback_v, 'commit;' || chr(13) || chr(13), FALSE);

		commit;

		qt_registro	:= 0;

	end if;

	if	(qt_reg_arquivo	>= 50000) then

		cecred.gene0002.pc_escreve_xml(ds_dados_rollback_v, ds_texto_rollback_v, 'commit;' || chr(13) || chr(13), FALSE);
		cecred.gene0002.pc_escreve_xml(ds_dados_rollback_v, ds_texto_rollback_v, 'end;'||chr(13), FALSE);
		cecred.gene0002.pc_escreve_xml(ds_dados_rollback_v, ds_texto_rollback_v, chr(13), TRUE);

		cecred.gene0002.pc_solicita_relato_arquivo(	pr_cdcooper	=> cd_cooperativa_v,
							pr_cdprogra	=> 'ATENDA',
							pr_dtmvtolt	=> trunc(sysdate),
							pr_dsxml	=> ds_dados_rollback_v,
							pr_dsarqsaid	=> ds_nome_diretorio_v || '/' || ds_nome_arquivo_bkp_v,
							pr_flg_impri	=> 'N',
							pr_flg_gerar	=> 'S',
							pr_flgremarq	=> 'N',
							pr_nrcopias	=> 1,
							pr_des_erro	=> ds_critica_v);

		if	(trim(ds_critica_v) is not null) then

			rollback;
			raise	ds_exc_erro_v;

		end if;

		dbms_lob.close(ds_dados_rollback_v);
		dbms_lob.freetemporary(ds_dados_rollback_v);

	end if;

	exception
	when others then
		vr_dscritic	:= 'Falha ao atualizar crapseg';
		rollback;
		exit;
	end;

end loop;

if	(qt_reg_arquivo	<> 50000) then

	cecred.gene0002.pc_escreve_xml(ds_dados_rollback_v, ds_texto_rollback_v, 'commit;' || chr(13) || chr(13), FALSE);
	cecred.gene0002.pc_escreve_xml(ds_dados_rollback_v, ds_texto_rollback_v, 'end;' || chr(13), FALSE);
	cecred.gene0002.pc_escreve_xml(ds_dados_rollback_v, ds_texto_rollback_v, chr(13), TRUE);

	cecred.gene0002.pc_solicita_relato_arquivo(	pr_cdcooper	=> cd_cooperativa_v,
						pr_cdprogra	=> 'ATENDA',
						pr_dtmvtolt	=> trunc(sysdate),
						pr_dsxml	=> ds_dados_rollback_v,
						pr_dsarqsaid	=> ds_nome_diretorio_v || '/' || ds_nome_arquivo_bkp_v,
						pr_flg_impri	=> 'N',
						pr_flg_gerar	=> 'S',
						pr_flgremarq	=> 'N',
						pr_nrcopias	=> 1,
						pr_des_erro	=> ds_critica_v);

	if	(trim(ds_critica_v) is not null) then

		raise	ds_exc_erro_v;

	end if;

	dbms_lob.close(ds_dados_rollback_v);
	dbms_lob.freetemporary(ds_dados_rollback_v);

end if;

if	(trim(vr_dscritic) is not null) then

	ds_critica_v	:= vr_dscritic;
	raise	ds_exc_erro_v;

end if;

commit;

exception
when	ds_exc_erro_v then

	raise_application_error(-20111, ds_critica_v);

end;

end;