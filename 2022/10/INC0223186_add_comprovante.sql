DECLARE
  TYPE tchaveconsulta IS RECORD(
    cdcooper NUMBER,
    nrdconta NUMBER,
    vllanaut NUMBER(20, 2),
    cdempres NUMBER,
    cdrefere NUMBER,
    dtmvtolt VARCHAR2(20),
    nmextcon VARCHAR2(200),
    dshisext VARCHAR2(200),
    nrdocmto NUMBER);

  TYPE ttableconsulta IS TABLE OF tchaveconsulta INDEX BY PLS_INTEGER;

  vlistaconsulta ttableconsulta;
  i              NUMBER := 0;
  vr_dsinfor3    VARCHAR2(2000);
  vr_dsprotoc    VARCHAR2(70);
  vr_dscritic    VARCHAR2(4000);
  vr_des_erro    VARCHAR2(4000);
  vr_idprglog    NUMBER;
BEGIN
  i := i + 1;
  vlistaconsulta(i).cdcooper := 14;
  vlistaconsulta(i).nrdconta := 138401;
  vlistaconsulta(i).vllanaut := 95.09;
  vlistaconsulta(i).dtmvtolt := '19/08/2022';
  vlistaconsulta(i).cdempres := 8360111;
  vlistaconsulta(i).cdrefere := 105505935;
  vlistaconsulta(i).nrdocmto := 10;
  vlistaconsulta(i).dshisext := '105505935';
  vlistaconsulta(i).nmextcon := 'COPEL - PR';
  i := i + 1;
  vlistaconsulta(i).cdcooper := 14;
  vlistaconsulta(i).nrdconta := 61280;
  vlistaconsulta(i).vllanaut := 95.09;
  vlistaconsulta(i).dtmvtolt := '19/08/2022';
  vlistaconsulta(i).cdempres := 8360111;
  vlistaconsulta(i).cdrefere := 10587918;
  vlistaconsulta(i).nrdocmto := 10;
  vlistaconsulta(i).dshisext := ' ';
  vlistaconsulta(i).nmextcon := 'COPEL - PR';
  i := i + 1;
  vlistaconsulta(i).cdcooper := 14;
  vlistaconsulta(i).nrdconta := 20230;
  vlistaconsulta(i).vllanaut := 67.92;
  vlistaconsulta(i).dtmvtolt := '19/08/2022';
  vlistaconsulta(i).cdempres := 8360111;
  vlistaconsulta(i).cdrefere := 72058560;
  vlistaconsulta(i).nrdocmto := 1;
  vlistaconsulta(i).dshisext := ' ';
  vlistaconsulta(i).nmextcon := 'COPEL - PR';
  i := i + 1;
  vlistaconsulta(i).cdcooper := 14;
  vlistaconsulta(i).nrdconta := 276162;
  vlistaconsulta(i).vllanaut := 156;
  vlistaconsulta(i).dtmvtolt := '19/08/2022';
  vlistaconsulta(i).cdempres := 8460082;
  vlistaconsulta(i).cdrefere := 8999307660680;
  vlistaconsulta(i).nrdocmto := 19;
  vlistaconsulta(i).dshisext := 'DEBITO VIVO FIXO';
  vlistaconsulta(i).nmextcon := 'VIVO-TELEFONICA';
  i := i + 1;
  vlistaconsulta(i).cdcooper := 9;
  vlistaconsulta(i).nrdconta := 410225;
  vlistaconsulta(i).vllanaut := 157.69;
  vlistaconsulta(i).dtmvtolt := '19/08/2022';
  vlistaconsulta(i).cdempres := 8360006;
  vlistaconsulta(i).cdrefere := 997395010;
  vlistaconsulta(i).nrdocmto := 2;
  vlistaconsulta(i).dshisext := '997395010';
  vlistaconsulta(i).nmextcon := 'CEEE - RS';
  i := i + 1;
  vlistaconsulta(i).cdcooper := 16;
  vlistaconsulta(i).nrdconta := 113646;
  vlistaconsulta(i).vllanaut := 157.69;
  vlistaconsulta(i).dtmvtolt := '19/08/2022';
  vlistaconsulta(i).cdempres := 8460313;
  vlistaconsulta(i).cdrefere := 402079875911;
  vlistaconsulta(i).nrdocmto := 2;
  vlistaconsulta(i).dshisext := ' ';
  vlistaconsulta(i).nmextcon := 'OI BRTEL CELULAR 14';
  i := i + 1;
  vlistaconsulta(i).cdcooper := 14;
  vlistaconsulta(i).nrdconta := 259136;
  vlistaconsulta(i).vllanaut := 270.01;
  vlistaconsulta(i).dtmvtolt := '19/08/2022';
  vlistaconsulta(i).cdempres := 8360001;
  vlistaconsulta(i).cdrefere := 25560855;
  vlistaconsulta(i).nrdocmto := 17;
  vlistaconsulta(i).dshisext := 'ENERGISA TIRADENTES';
  vlistaconsulta(i).nmextcon := 'ENERGISA SUL SUDESTE';
  i := i + 1;
  vlistaconsulta(i).cdcooper := 14;
  vlistaconsulta(i).nrdconta := 119911;
  vlistaconsulta(i).vllanaut := 218.13;
  vlistaconsulta(i).dtmvtolt := '19/08/2022';
  vlistaconsulta(i).cdempres := 8460430;
  vlistaconsulta(i).cdrefere := 14803498;
  vlistaconsulta(i).nrdocmto := 8;
  vlistaconsulta(i).dshisext := 'internet';
  vlistaconsulta(i).nmextcon := 'HUGHES BRASIL LTDA';
  i := i + 1;
  vlistaconsulta(i).cdcooper := 14;
  vlistaconsulta(i).nrdconta := 264016;
  vlistaconsulta(i).vllanaut := 54.48;
  vlistaconsulta(i).dtmvtolt := '19/08/2022';
  vlistaconsulta(i).cdempres := 8360111;
  vlistaconsulta(i).cdrefere := 106369350;
  vlistaconsulta(i).nrdocmto := 18;
  vlistaconsulta(i).dshisext := ' ';
  vlistaconsulta(i).nmextcon := 'COPEL - PR';
  i := i + 1;
  vlistaconsulta(i).cdcooper := 14;
  vlistaconsulta(i).nrdconta := 208701;
  vlistaconsulta(i).vllanaut := 386.98;
  vlistaconsulta(i).dtmvtolt := '19/08/2022';
  vlistaconsulta(i).cdempres := 8360111;
  vlistaconsulta(i).cdrefere := 48522449;
  vlistaconsulta(i).nrdocmto := 16;
  vlistaconsulta(i).dshisext := ' ';
  vlistaconsulta(i).nmextcon := 'COPEL - PR';
  i := i + 1;
  vlistaconsulta(i).cdcooper := 14;
  vlistaconsulta(i).nrdconta := 204870;
  vlistaconsulta(i).vllanaut := 52.79;
  vlistaconsulta(i).dtmvtolt := '19/08/2022';
  vlistaconsulta(i).cdempres := 8360111;
  vlistaconsulta(i).cdrefere := 90245490;
  vlistaconsulta(i).nrdocmto := 15;
  vlistaconsulta(i).dshisext := ' ';
  vlistaconsulta(i).nmextcon := 'COPEL - PR';
  i := i + 1;
  vlistaconsulta(i).cdcooper := 14;
  vlistaconsulta(i).nrdconta := 191710;
  vlistaconsulta(i).vllanaut := 154.17;
  vlistaconsulta(i).dtmvtolt := '19/08/2022';
  vlistaconsulta(i).cdempres := 8360111;
  vlistaconsulta(i).cdrefere := 96401796;
  vlistaconsulta(i).nrdocmto := 14;
  vlistaconsulta(i).dshisext := ' ';
  vlistaconsulta(i).nmextcon := 'COPEL - PR';
  i := i + 1;
  vlistaconsulta(i).cdcooper := 14;
  vlistaconsulta(i).nrdconta := 153117;
  vlistaconsulta(i).vllanaut := 114.17;
  vlistaconsulta(i).dtmvtolt := '19/08/2022';
  vlistaconsulta(i).cdempres := 8360111;
  vlistaconsulta(i).cdrefere := 62886371;
  vlistaconsulta(i).nrdocmto := 13;
  vlistaconsulta(i).dshisext := 'Luz casa';
  vlistaconsulta(i).nmextcon := 'COPEL - PR';
  i := i + 1;
  vlistaconsulta(i).cdcooper := 14;
  vlistaconsulta(i).nrdconta := 145319;
  vlistaconsulta(i).vllanaut := 70.5;
  vlistaconsulta(i).dtmvtolt := '19/08/2022';
  vlistaconsulta(i).cdempres := 8360111;
  vlistaconsulta(i).cdrefere := 89605543;
  vlistaconsulta(i).nrdocmto := 12;
  vlistaconsulta(i).dshisext := ' ';
  vlistaconsulta(i).nmextcon := 'COPEL - PR';
  i := i + 1;
  vlistaconsulta(i).cdcooper := 14;
  vlistaconsulta(i).nrdconta := 140635;
  vlistaconsulta(i).vllanaut := 29.81;
  vlistaconsulta(i).dtmvtolt := '19/08/2022';
  vlistaconsulta(i).cdempres := 8360111;
  vlistaconsulta(i).cdrefere := 104827483;
  vlistaconsulta(i).nrdocmto := 11;
  vlistaconsulta(i).dshisext := ' ';
  vlistaconsulta(i).nmextcon := 'COPEL - PR';
  i := i + 1;
  vlistaconsulta(i).cdcooper := 14;
  vlistaconsulta(i).nrdconta := 121924;
  vlistaconsulta(i).vllanaut := 138.66;
  vlistaconsulta(i).dtmvtolt := '19/08/2022';
  vlistaconsulta(i).cdempres := 8360111;
  vlistaconsulta(i).cdrefere := 101523815;
  vlistaconsulta(i).nrdocmto := 9;
  vlistaconsulta(i).dshisext := 'copel';
  vlistaconsulta(i).nmextcon := 'COPEL - PR';
  i := i + 1;
  vlistaconsulta(i).cdcooper := 14;
  vlistaconsulta(i).nrdconta := 109487;
  vlistaconsulta(i).vllanaut := 109.71;
  vlistaconsulta(i).dtmvtolt := '19/08/2022';
  vlistaconsulta(i).cdempres := 8360111;
  vlistaconsulta(i).cdrefere := 72305436;
  vlistaconsulta(i).nrdocmto := 7;
  vlistaconsulta(i).dshisext := 'Energia';
  vlistaconsulta(i).nmextcon := 'COPEL - PR';
  i := i + 1;
  vlistaconsulta(i).cdcooper := 14;
  vlistaconsulta(i).nrdconta := 92690;
  vlistaconsulta(i).vllanaut := 156.66;
  vlistaconsulta(i).dtmvtolt := '19/08/2022';
  vlistaconsulta(i).cdempres := 8360111;
  vlistaconsulta(i).cdrefere := 107281635;
  vlistaconsulta(i).nrdocmto := 6;
  vlistaconsulta(i).dshisext := ' ';
  vlistaconsulta(i).nmextcon := 'COPEL - PR';
  i := i + 1;
  vlistaconsulta(i).cdcooper := 14;
  vlistaconsulta(i).nrdconta := 87858;
  vlistaconsulta(i).vllanaut := 238.63;
  vlistaconsulta(i).dtmvtolt := '19/08/2022';
  vlistaconsulta(i).cdempres := 8360111;
  vlistaconsulta(i).cdrefere := 88391540;
  vlistaconsulta(i).nrdocmto := 5;
  vlistaconsulta(i).dshisext := ' ';
  vlistaconsulta(i).nmextcon := 'COPEL - PR';
  i := i + 1;
  vlistaconsulta(i).cdcooper := 14;
  vlistaconsulta(i).nrdconta := 61603;
  vlistaconsulta(i).vllanaut := 192.6;
  vlistaconsulta(i).dtmvtolt := '19/08/2022';
  vlistaconsulta(i).cdempres := 8360111;
  vlistaconsulta(i).cdrefere := 89739949;
  vlistaconsulta(i).nrdocmto := 4;
  vlistaconsulta(i).dshisext := ' ';
  vlistaconsulta(i).nmextcon := 'COPEL - PR';
  i := i + 1;
  vlistaconsulta(i).cdcooper := 14;
  vlistaconsulta(i).nrdconta := 30856;
  vlistaconsulta(i).vllanaut := 141.18;
  vlistaconsulta(i).dtmvtolt := '19/08/2022';
  vlistaconsulta(i).cdempres := 8360111;
  vlistaconsulta(i).cdrefere := 102098760;
  vlistaconsulta(i).nrdocmto := 2;
  vlistaconsulta(i).dshisext := ' ';
  vlistaconsulta(i).nmextcon := 'COPEL - PR';
  i := i + 1;
  vlistaconsulta(i).cdcooper := 9;
  vlistaconsulta(i).nrdconta := 371939;
  vlistaconsulta(i).vllanaut := 125.38;
  vlistaconsulta(i).dtmvtolt := '19/08/2022';
  vlistaconsulta(i).cdempres := 8360111;
  vlistaconsulta(i).cdrefere := 99527340;
  vlistaconsulta(i).nrdocmto := 1;
  vlistaconsulta(i).dshisext := ' ';
  vlistaconsulta(i).nmextcon := 'COPEL - PR';
  i := i + 1;
  vlistaconsulta(i).cdcooper := 10;
  vlistaconsulta(i).nrdconta := 85820;
  vlistaconsulta(i).vllanaut := 107.12;
  vlistaconsulta(i).dtmvtolt := '19/08/2022';
  vlistaconsulta(i).cdempres := 8460082;
  vlistaconsulta(i).cdrefere := 8999974609218;
  vlistaconsulta(i).nrdocmto := 1;
  vlistaconsulta(i).dshisext := ' ';
  vlistaconsulta(i).nmextcon := 'VIVO-TELEFONICA';
  i := i + 1;
  vlistaconsulta(i).cdcooper := 13;
  vlistaconsulta(i).nrdconta := 529516;
  vlistaconsulta(i).vllanaut := 45.07;
  vlistaconsulta(i).dtmvtolt := '19/08/2022';
  vlistaconsulta(i).cdempres := 8360111;
  vlistaconsulta(i).cdrefere := 106849530;
  vlistaconsulta(i).nrdocmto := 14;
  vlistaconsulta(i).dshisext := ' ';
  vlistaconsulta(i).nmextcon := 'COPEL - PR';
  i := i + 1;
  vlistaconsulta(i).cdcooper := 13;
  vlistaconsulta(i).nrdconta := 116254;
  vlistaconsulta(i).vllanaut := 852.02;
  vlistaconsulta(i).dtmvtolt := '19/08/2022';
  vlistaconsulta(i).cdempres := 8360111;
  vlistaconsulta(i).cdrefere := 22720553;
  vlistaconsulta(i).nrdocmto := 13;
  vlistaconsulta(i).dshisext := ' ';
  vlistaconsulta(i).nmextcon := 'COPEL - PR';
  i := i + 1;
  vlistaconsulta(i).cdcooper := 10;
  vlistaconsulta(i).nrdconta := 202924;
  vlistaconsulta(i).vllanaut := 132.5;
  vlistaconsulta(i).dtmvtolt := '19/08/2022';
  vlistaconsulta(i).cdempres := 8460313;
  vlistaconsulta(i).cdrefere := 402293251607;
  vlistaconsulta(i).nrdocmto := 3;
  vlistaconsulta(i).dshisext := '402293251607';
  vlistaconsulta(i).nmextcon := 'OI BRTEL CELULAR 14';
  i := i + 1;
  vlistaconsulta(i).cdcooper := 10;
  vlistaconsulta(i).nrdconta := 126497;
  vlistaconsulta(i).vllanaut := 119.82;
  vlistaconsulta(i).dtmvtolt := '19/08/2022';
  vlistaconsulta(i).cdempres := 8460313;
  vlistaconsulta(i).cdrefere := 402110638621;
  vlistaconsulta(i).nrdocmto := 2;
  vlistaconsulta(i).dshisext := ' ';
  vlistaconsulta(i).nmextcon := 'OI BRTEL CELULAR 14';
  i := i + 1;
  vlistaconsulta(i).cdcooper := 5;
  vlistaconsulta(i).nrdconta := 71293;
  vlistaconsulta(i).vllanaut := 185.33;
  vlistaconsulta(i).dtmvtolt := '15/09/2022';
  vlistaconsulta(i).cdempres := 8460313;
  vlistaconsulta(i).cdrefere := 401750710942;
  vlistaconsulta(i).nrdocmto := 2;
  vlistaconsulta(i).dshisext := ' ';
  vlistaconsulta(i).nmextcon := 'OI BRTEL CELULAR 14';
  i := i + 1;
  vlistaconsulta(i).cdcooper := 7;
  vlistaconsulta(i).nrdconta := 14289393;
  vlistaconsulta(i).vllanaut := 152.85;
  vlistaconsulta(i).dtmvtolt := '19/08/2022';
  vlistaconsulta(i).cdempres := 8460313;
  vlistaconsulta(i).cdrefere := 402102250592;
  vlistaconsulta(i).nrdocmto := 2;
  vlistaconsulta(i).dshisext := ' ';
  vlistaconsulta(i).nmextcon := 'OI BRTEL CELULAR 14';
  i := i + 1;
  vlistaconsulta(i).cdcooper := 7;
  vlistaconsulta(i).nrdconta := 348635;
  vlistaconsulta(i).vllanaut := 106.29;
  vlistaconsulta(i).dtmvtolt := '19/08/2022';
  vlistaconsulta(i).cdempres := 8460313;
  vlistaconsulta(i).cdrefere := 402140900401;
  vlistaconsulta(i).nrdocmto := 1;
  vlistaconsulta(i).dshisext := '402140900401';
  vlistaconsulta(i).nmextcon := 'OI BRTEL CELULAR 14';
  i := i + 1;
  vlistaconsulta(i).cdcooper := 2;
  vlistaconsulta(i).nrdconta := 965030;
  vlistaconsulta(i).vllanaut := 198;
  vlistaconsulta(i).dtmvtolt := '19/08/2022';
  vlistaconsulta(i).cdempres := 8460313;
  vlistaconsulta(i).cdrefere := 401461743689;
  vlistaconsulta(i).nrdocmto := 5;
  vlistaconsulta(i).dshisext := ' ';
  vlistaconsulta(i).nmextcon := 'OI BRTEL CELULAR 14';
  i := i + 1;
  vlistaconsulta(i).cdcooper := 2;
  vlistaconsulta(i).nrdconta := 935255;
  vlistaconsulta(i).vllanaut := 121.83;
  vlistaconsulta(i).dtmvtolt := '19/08/2022';
  vlistaconsulta(i).cdempres := 8460313;
  vlistaconsulta(i).cdrefere := 402049772468;
  vlistaconsulta(i).nrdocmto := 4;
  vlistaconsulta(i).dshisext := ' ';
  vlistaconsulta(i).nmextcon := 'OI BRTEL CELULAR 14';
  i := i + 1;
  vlistaconsulta(i).cdcooper := 2;
  vlistaconsulta(i).nrdconta := 673536;
  vlistaconsulta(i).vllanaut := 3.69;
  vlistaconsulta(i).dtmvtolt := '19/08/2022';
  vlistaconsulta(i).cdempres := 8460313;
  vlistaconsulta(i).cdrefere := 402121915287;
  vlistaconsulta(i).nrdocmto := 3;
  vlistaconsulta(i).dshisext := ' ';
  vlistaconsulta(i).nmextcon := 'OI BRTEL CELULAR 14';
  i := i + 1;
  vlistaconsulta(i).cdcooper := 2;
  vlistaconsulta(i).nrdconta := 493201;
  vlistaconsulta(i).vllanaut := .64;
  vlistaconsulta(i).dtmvtolt := '19/08/2022';
  vlistaconsulta(i).cdempres := 8460313;
  vlistaconsulta(i).cdrefere := 402022013530;
  vlistaconsulta(i).nrdocmto := 2;
  vlistaconsulta(i).dshisext := ' ';
  vlistaconsulta(i).nmextcon := 'OI BRTEL CELULAR 14';
  i := i + 1;
  vlistaconsulta(i).cdcooper := 2;
  vlistaconsulta(i).nrdconta := 208698;
  vlistaconsulta(i).vllanaut := 119.82;
  vlistaconsulta(i).dtmvtolt := '19/08/2022';
  vlistaconsulta(i).cdempres := 8460313;
  vlistaconsulta(i).cdrefere := 402042198987;
  vlistaconsulta(i).nrdocmto := 1;
  vlistaconsulta(i).dshisext := ' ';
  vlistaconsulta(i).nmextcon := 'OI BRTEL CELULAR 14';
  i := i + 1;
  vlistaconsulta(i).cdcooper := 11;
  vlistaconsulta(i).nrdconta := 815233;
  vlistaconsulta(i).vllanaut := 122.26;
  vlistaconsulta(i).dtmvtolt := '23/09/2022';
  vlistaconsulta(i).cdempres := 8460313;
  vlistaconsulta(i).cdrefere := 402073616949;
  vlistaconsulta(i).nrdocmto := 486;
  vlistaconsulta(i).dshisext := ' ';
  vlistaconsulta(i).nmextcon := 'OI BRTEL CELULAR 14';
  i := i + 1;
  vlistaconsulta(i).cdcooper := 11;
  vlistaconsulta(i).nrdconta := 522651;
  vlistaconsulta(i).vllanaut := 71.29;
  vlistaconsulta(i).dtmvtolt := '23/08/2022';
  vlistaconsulta(i).cdempres := 8460313;
  vlistaconsulta(i).cdrefere := 401863285253;
  vlistaconsulta(i).nrdocmto := 2;
  vlistaconsulta(i).dshisext := ' ';
  vlistaconsulta(i).nmextcon := 'OI BRTEL CELULAR 14';
  i := i + 1;
  vlistaconsulta(i).cdcooper := 11;
  vlistaconsulta(i).nrdconta := 134201;
  vlistaconsulta(i).vllanaut := 161.37;
  vlistaconsulta(i).dtmvtolt := '23/08/2022';
  vlistaconsulta(i).cdempres := 8460313;
  vlistaconsulta(i).cdrefere := 401904682920;
  vlistaconsulta(i).nrdocmto := 1;
  vlistaconsulta(i).dshisext := ' ';
  vlistaconsulta(i).nmextcon := 'OI BRTEL CELULAR 14';
  i := i + 1;
  vlistaconsulta(i).cdcooper := 16;
  vlistaconsulta(i).nrdconta := 3970256;
  vlistaconsulta(i).vllanaut := 54.2;
  vlistaconsulta(i).dtmvtolt := '24/08/2022';
  vlistaconsulta(i).cdempres := 8460313;
  vlistaconsulta(i).cdrefere := 401731390473;
  vlistaconsulta(i).nrdocmto := 2;
  vlistaconsulta(i).dshisext := ' ';
  vlistaconsulta(i).nmextcon := 'OI BRTEL CELULAR 14';
  i := i + 1;
  vlistaconsulta(i).cdcooper := 16;
  vlistaconsulta(i).nrdconta := 421707;
  vlistaconsulta(i).vllanaut := 81.67;
  vlistaconsulta(i).dtmvtolt := '24/08/2022';
  vlistaconsulta(i).cdempres := 8460313;
  vlistaconsulta(i).cdrefere := 401088851735;
  vlistaconsulta(i).nrdocmto := 1;
  vlistaconsulta(i).dshisext := ' ';
  vlistaconsulta(i).nmextcon := 'OI BRTEL CELULAR 14';

  FOR i IN vlistaconsulta.first .. vlistaconsulta.last LOOP
    vr_dsinfor3 := 'Convênio: ' || vlistaconsulta(i).nmextcon ||
                   '#Número Identificador:' || vlistaconsulta(i).cdrefere || 
                   '#' || vlistaconsulta(i).dshisext;
  
    cecred.gene0006.pc_gera_protocolo(pr_cdcooper => vlistaconsulta(i).cdcooper,
                                      pr_dtmvtolt => to_date(vlistaconsulta(i).dtmvtolt, 'DD/MM/YYYY'),
                                      pr_hrtransa => gene0002.fn_busca_time,
                                      pr_nrdconta => vlistaconsulta(i).nrdconta,
                                      pr_nrdocmto => vlistaconsulta(i).nrdocmto,
                                      pr_nrseqaut => 0,
                                      pr_vllanmto => vlistaconsulta(i).vllanaut,
                                      pr_nrdcaixa => 900,
                                      pr_gravapro => TRUE,
                                      pr_cdtippro => 15,
                                      pr_dsinfor1 => 'Pagamento',
                                      pr_dsinfor2 => ' ',
                                      pr_dsinfor3 => vr_dsinfor3,
                                      pr_dscedent => vlistaconsulta(i).nmextcon,
                                      pr_flgagend => FALSE,
                                      pr_nrcpfope => 0,
                                      pr_nrcpfpre => 0,
                                      pr_nmprepos => ' ',
                                      pr_dsprotoc => vr_dsprotoc,
                                      pr_dscritic => vr_dscritic,
                                      pr_des_erro => vr_des_erro);
  
    IF TRIM(vr_dscritic) IS NOT NULL OR TRIM(vr_des_erro) IS NOT NULL THEN
      cecred.pc_log_programa(pr_dstiplog   => 'O',
                             pr_cdprograma => 'INC0223186',
                             pr_cdcooper   => 0,
                             pr_dsmensagem => 'cdcooper: ' || vlistaconsulta(i).cdcooper ||
                                              ' nrdconta: ' || vlistaconsulta(i).nrdconta ||
                                              ' cdempres: ' || vlistaconsulta(i).cdempres ||
                                              ' nrdocmto: ' || vlistaconsulta(i).nrdocmto ||
                                              ' Critica: ' || vr_dscritic ||
                                              ' Erro: ' || vr_des_erro,
                             pr_idprglog   => vr_idprglog);
    END IF;
    COMMIT;
  END LOOP;
END;
