DECLARE
  vr_ind_arq        utl_file.file_type;
  vr_linha          VARCHAR2(32767);
  vr_dscritic       VARCHAR2(2000);
  vr_nmdir          VARCHAR2(4000) := CECRED.gene0001.fn_param_sistema('CRED',3,'ROOT_MICROS')||'cpd/bacas/PRB0047683';
  vr_nmarq          VARCHAR2(100)  := 'ROLLBACK_PRB0047683_2.sql';
  vr_exc_saida      EXCEPTION;
  vcount            NUMBER;
  vr_tpregist       NUMBER;
  
  CURSOR cr_prestamista(pr_idseqtra IN tbseg_prestamista.idseqtra%TYPE) IS
    SELECT *
      FROM CECRED.tbseg_prestamista s
     WHERE s.idseqtra = pr_idseqtra;
       
  CURSOR cr_crapseg(pr_progress_recid crapseg.progress_recid%TYPE) IS
    SELECT *
      FROM CECRED.crapseg s
     WHERE s.progress_recid  = pr_progress_recid;
     
  CURSOR cr_crawseg(pr_progress_recid crawseg.progress_recid%TYPE) IS
    SELECT *
      FROM CECRED.crawseg s
     WHERE s.progress_recid = pr_progress_recid;

  CURSOR cr_principal(pr_cdcooper CECRED.crapseg.cdcooper%TYPE) IS
    SELECT p.nrproposta
          ,p.cdcooper
          ,p.nrdconta
          ,p.nrctrseg
          ,p.nrctremp
          ,p.tpregist
          ,p.dtinivig
          ,p.dtfimvig
          ,p.idseqtra
          ,s.cdsitseg
          ,s.dtcancel
          ,s.cdmotcan
          ,s.dtfimvig dtfimvig_crapseg
          ,s.progress_recid
          ,w.progress_recid progress_recid_crawseg
          ,w.nrproposta nrproposta_crawseg
      FROM CECRED.crawseg w,
           CECRED.crapseg s,
           CECRED.tbseg_prestamista p
     WHERE p.cdcooper = pr_cdcooper
       AND p.cdcooper = s.cdcooper
       AND p.nrdconta = s.nrdconta
       AND p.nrctrseg = s.nrctrseg
       AND p.cdcooper = w.cdcooper
       AND p.nrdconta = w.nrdconta
       AND p.nrctrseg = w.nrctrseg
       AND p.tpcustei = 0
       AND w.nrproposta IN ('770629338985',
                            '770655956999',
                            '770629022724',
                            '770655956921',
                            '770629335480',
                            '770655956905',
                            '770629033688',
                            '770655718435',
                            '770628858535',
                            '770655771972',
                            '770629456228',
                            '770655718230',
                            '770628947880',
                            '770655718265',
                            '770629702482',
                            '770655718338',
                            '770629341340',
                            '770655718362',
                            '770629216901',
                            '770655718451',
                            '770629703489',
                            '770655718753',
                            '770629437215',
                            '770655718800',
                            '770629693971',
                            '770655718877',
                            '770629375996',
                            '770655719857',
                            '770628952027',
                            '770655719890',
                            '770629644687',
                            '770655719946',
                            '770628802491',
                            '770655719962',
                            '770629269339',
                            '770655720103',
                            '770629269126',
                            '770655720146',
                            '770629152920',
                            '770655720200',
                            '770628807582',
                            '770655720251',
                            '770628951683',
                            '770655720308',
                            '770628999325',
                            '770655720405',
                            '770628805750',
                            '770655771565',
                            '770629694099',
                            '770655771620',
                            '770629529349',
                            '770655771689',
                            '770629270680',
                            '770655771867',
                            '770629641920',
                            '770655771875',
                            '770629214380',
                            '770655772111',
                            '770628806969',
                            '770655718460',
                            '770628858861',
                            '770655957057',
                            '770628758581',
                            '770655957073',
                            '770629456791',
                            '770655957090',
                            '770629337113',
                            '770655957138',
                            '770629151788',
                            '770655957189',
                            '770629024433',
                            '770655721940',
                            '770629673458',
                            '770655720480',
                            '770629231668',
                            '770655720502',
                            '770629447911',
                            '770655720529',
                            '770629003126',
                            '770655720782',
                            '770629222200',
                            '770655720812',
                            '770628958793',
                            '770655720898',
                            '770629087923',
                            '770655720910',
                            '770629021396',
                            '770655720979',
                            '770629375007',
                            '770655721274',
                            '770629333568',
                            '770655721304',
                            '770629445439',
                            '770655721401',
                            '770629665668',
                            '770655721541',
                            '770629697926',
                            '770655721797',
                            '770629665501',
                            '770655721916',
                            '770629446184',
                            '770655722220',
                            '770629228551',
                            '770655722270',
                            '770628958262',
                            '770655722378',
                            '770629665676',
                            '770655722416',
                            '770629217819',
                            '770655722521',
                            '770629374256',
                            '770655722580',
                            '770629537961',
                            '770655957197',
                            '770629451501',
                            '770655828184',
                            '770629674403',
                            '770655826874',
                            '770629231293',
                            '770655826904',
                            '770629333533',
                            '770655826912',
                            '770629026444',
                            '770655826963',
                            '770628998108',
                            '770655827862',
                            '770629445099',
                            '770655828150',
                            '770629671030',
                            '770655828192',
                            '770629148981',
                            '770655880372',
                            '770629537031',
                            '770655880461',
                            '770629680691',
                            '770655880585',
                            '770629543880',
                            '770655880607',
                            '770628950547',
                            '770655827161',
                            '770629343954',
                            '770655827250',
                            '770628954046',
                            '770655827340',
                            '770628945942',
                            '770655827420',
                            '770628858853',
                            '770655827480',
                            '770629670327',
                            '770655827498',
                            '770629219854',
                            '770655827528',
                            '770629454691',
                            '770655827625',
                            '770629382992',
                            '770655827641',
                            '770629702075',
                            '770655826521',
                            '770629034587',
                            '770655826653',
                            '770629445609',
                            '770655826688',
                            '770628945365',
                            '770655826700',
                            '770629144722',
                            '770655957324',
                            '770629147764',
                            '770655964797',
                            '770629084401',
                            '770655880976',
                            '770629086587',
                            '770655881417',
                            '770629680888',
                            '770655880640',
                            '770628806772',
                            '770655880879',
                            '770628804257',
                            '770655881026',
                            '770629643451',
                            '770655881107',
                            '770628806675',
                            '770655881190',
                            '770629085386',
                            '770655881280',
                            '770629543325',
                            '770655881441',
                            '770628807590',
                            '770655964827',
                            '770629085203',
                            '770655964835',
                            '770628956405',
                            '770655964886',
                            '770629341790',
                            '770655965041',
                            '770628945500',
                            '770655965190',
                            '770629218653',
                            '770655965289',
                            '770629701753',
                            '770655965300',
                            '770629222324',
                            '770655965327',
                            '770629679855',
                            '770655965505',
                            '770629342370',
                            '770655965610',
                            '770629340734',
                            '770655965653',
                            '770629449213',
                            '770655965980',
                            '770628950741',
                            '770655966005',
                            '770629229183',
                            '770655966080',
                            '770629436316',
                            '770655966099',
                            '770629152091',
                            '770655966137',
                            '770629377409',
                            '770655966234',
                            '770629084487',
                            '770655942220',
                            '770628755795',
                            '770655941940',
                            '770629455213',
                            '770655942416',
                            '770628759570',
                            '770655967206',
                            '770628806640',
                            '770655967427',
                            '770629537600',
                            '770655967435',
                            '770629337709',
                            '770655967567',
                            '770629677690',
                            '770655941908',
                            '770629268030',
                            '770655941967',
                            '770628753431',
                            '770655942203',
                            '770629151842',
                            '770655966277',
                            '770629542124',
                            '770655966269',
                            '770629380426',
                            '770655966471',
                            '770629226680',
                            '770655966480',
                            '770629001077',
                            '770655966609',
                            '770629269690',
                            '770655966641',
                            '770629146768',
                            '770655966676',
                            '770629344462',
                            '770655966757',
                            '770629271996',
                            '770655966811',
                            '770629002448',
                            '770655967036',
                            '770629643346',
                            '770655967125',
                            '770628803412',
                            '770655967133',
                            '770629457348',
                            '770655957529',
                            '770629702121',
                            '770655957553',
                            '770629083740',
                            '770655944419',
                            '770629080813',
                            '770655942696',
                            '770629018646',
                            '770655944370',
                            '770629438556',
                            '770655944664',
                            '770629694021',
                            '770655942505',
                            '770629271872',
                            '770655942874',
                            '770629540296',
                            '770655942963',
                            '770628945306',
                            '770655943099',
                            '770629083618',
                            '770655943170',
                            '770628957142',
                            '770655943242',
                            '770629673814',
                            '770655943293',
                            '770628999937',
                            '770655943307',
                            '770628807779',
                            '770655943315',
                            '770629644466',
                            '770655943501',
                            '770629644113',
                            '770655943552',
                            '770629642820',
                            '770655943650',
                            '770629225412',
                            '770655943803',
                            '770629376160',
                            '770655943838',
                            '770629447342',
                            '770655944192',
                            '770629221069',
                            '770655944249',
                            '770629435557',
                            '770655944281',
                            '770629269479',
                            '770655944486',
                            '770629701036',
                            '770655944516',
                            '770629084908',
                            '770656007389',
                            '770629539646',
                            '770655944796',
                            '770629018786',
                            '770656007249',
                            '770629224742',
                            '770656007133',
                            '770629032770',
                            '770656007214',
                            '770629374841',
                            '770656007265',
                            '770629269304',
                            '770656007273',
                            '770629147837',
                            '770656007281',
                            '770629676694',
                            '770656007338',
                            '770629447563',
                            '770656007575',
                            '770629469311',
                            '770656007648',
                            '770628947236',
                            '770656007672',
                            '770629436880',
                            '770656007710',
                            '770629031898',
                            '770656007737',
                            '770629697888',
                            '770656007770',
                            '770629084959',
                            '770656007800',
                            '770629087060',
                            '770656007869',
                            '770628957070',
                            '770656007885',
                            '770629539352',
                            '770656007893',
                            '770629224963',
                            '770656007974',
                            '770629376046',
                            '770656007982',
                            '770628753806',
                            '770656008040',
                            '770629444955',
                            '770656008105',
                            '770629002260',
                            '770656008172',
                            '770629697306',
                            '770656008288',
                            '770629541195',
                            '770656008369',
                            '770629540350',
                            '770656008458',
                            '770629435816',
                            '770656008504',
                            '770629643699',
                            '770656008610',
                            '770628954550',
                            '770656008768',
                            '770629213880',
                            '770655957740',
                            '770629219390',
                            '770656063530',
                            '770629079963',
                            '770655956557',
                            '770629189629',
                            '770655955984',
                            '770628859981',
                            '770656009365',
                            '770629444254',
                            '770655955860',
                            '770629375660',
                            '770655955879',
                            '770628808538',
                            '770655955925',
                            '770629447032',
                            '770655956212',
                            '770629448888',
                            '770655956484',
                            '770629223967',
                            '770655956530',
                            '770629440526',
                            '770655956611',
                            '770629333690',
                            '770656008857',
                            '770629670718',
                            '770656009004',
                            '770629470000',
                            '770656009136',
                            '770629471138',
                            '770656009250',
                            '770628998710',
                            '770656009306',
                            '770629697454',
                            '770656009381',
                            '770629270400',
                            '770656009454',
                            '770629667784',
                            '770655955160',
                            '770629450246',
                            '770655955240',
                            '770629436405',
                            '770655955364',
                            '770628803048',
                            '770655955372',
                            '770629675752',
                            '770655955518',
                            '770629644105',
                            '770655955585',
                            '770629340700',
                            '770655955682',
                            '770629150714',
                            '770655955739');

  CURSOR cr_crapcop IS
    SELECT c.cdcooper
          ,d.dtmvtolt
      FROM CECRED.crapcop c,
           CECRED.crapdat d
     WHERE c.flgativo = 1
       AND c.cdcooper <> 3
       AND c.cdcooper = d.cdcooper;

  BEGIN
      CECRED.GENE0001.pc_abre_arquivo(pr_nmdireto => vr_nmdir
                                     ,pr_nmarquiv => vr_nmarq
                                     ,pr_tipabert => 'W'
                                     ,pr_utlfileh => vr_ind_arq
                                     ,pr_des_erro => vr_dscritic);

      IF vr_dscritic IS NOT NULL THEN
         vr_dscritic := vr_dscritic ||'  Não pode abrir arquivo '|| vr_nmdir || vr_nmarq;
         RAISE vr_exc_saida;
      END IF;

      CECRED.GENE0001.pc_escr_linha_arquivo(vr_ind_arq,'BEGIN');

      FOR rw_crapcop IN cr_crapcop LOOP
        vcount := 0;
        vr_linha := '';

        FOR rw_principal IN cr_principal(pr_cdcooper => rw_crapcop.cdcooper) LOOP

         IF rw_principal.nrproposta IN ('770629022724',
                                        '770629033688',
                                        '770628858535',
                                        '770629456228',
                                        '770628947880',
                                        '770629702482',
                                        '770629216901',
                                        '770629703489',
                                        '770629437215',
                                        '770629693971',
                                        '770629375996',
                                        '770628952027',
                                        '770629644687',
                                        '770628802491',
                                        '770629269339',
                                        '770629269126',
                                        '770628807582',
                                        '770628951683',
                                        '770628999325',
                                        '770628805750',
                                        '770629694099',
                                        '770629529349',
                                        '770629270680',
                                        '770629641920',
                                        '770629214380',
                                        '770628806969',
                                        '770628858861',
                                        '770628758581',
                                        '770629456791',
                                        '770629024433',
                                        '770629673458',
                                        '770629231668',
                                        '770629003126',
                                        '770629222200',
                                        '770628958793',
                                        '770629087923',
                                        '770629021396',
                                        '770629375007',
                                        '770629333568',
                                        '770629445439',
                                        '770629665668',
                                        '770629697926',
                                        '770629665501',
                                        '770629446184',
                                        '770629228551',
                                        '770629665676',
                                        '770629217819',
                                        '770629374256',
                                        '770629451501',
                                        '770629674403',
                                        '770629231293',
                                        '770629333533',
                                        '770629026444',
                                        '770628998108',
                                        '770629445099',
                                        '770629671030',
                                        '770629537031',
                                        '770629680691',
                                        '770628950547',
                                        '770628954046',
                                        '770628945942',
                                        '770628858853',
                                        '770629670327',
                                        '770629219854',
                                        '770629454691',
                                        '770629382992',
                                        '770629702075',
                                        '770629034587',
                                        '770629445609',
                                        '770628945365',
                                        '770629144722',
                                        '770629084401',
                                        '770629086587',
                                        '770629680888',
                                        '770628806772',
                                        '770628804257',
                                        '770629643451',
                                        '770628806675',
                                        '770629085386',
                                        '770628807590',
                                        '770629085203',
                                        '770628945500',
                                        '770629218653',
                                        '770629701753',
                                        '770629222324',
                                        '770629679855',
                                        '770629449213',
                                        '770628950741',
                                        '770629229183',
                                        '770629436316',
                                        '770629377409',
                                        '770629084487',
                                        '770628755795',
                                        '770629455213',
                                        '770628806640',
                                        '770629677690',
                                        '770629268030',
                                        '770628753431',
                                        '770629380426',
                                        '770629226680',
                                        '770629001077',
                                        '770629269690',
                                        '770629271996',
                                        '770629002448',
                                        '770629643346',
                                        '770628803412',
                                        '770629457348',
                                        '770629702121',
                                        '770629083740',
                                        '770629080813',
                                        '770629018646',
                                        '770629438556',
                                        '770629694021',
                                        '770629271872',
                                        '770628945306',
                                        '770629083618',
                                        '770629673814',
                                        '770628999937',
                                        '770628807779',
                                        '770629644466',
                                        '770629644113',
                                        '770629642820',
                                        '770629225412',
                                        '770629376160',
                                        '770629447342',
                                        '770629221069',
                                        '770629435557',
                                        '770629269479',
                                        '770629701036',
                                        '770629084908',
                                        '770629018786',
                                        '770629224742',
                                        '770629032770',
                                        '770629374841',
                                        '770629269304',
                                        '770629676694',
                                        '770628947236',
                                        '770629436880',
                                        '770629031898',
                                        '770629697888',
                                        '770629084959',
                                        '770629087060',
                                        '770629224963',
                                        '770629376046',
                                        '770628753806',
                                        '770629444955',
                                        '770629002260',
                                        '770629697306',
                                        '770629435816',
                                        '770629643699',
                                        '770628954550',
                                        '770629213880',
                                        '770629219390',
                                        '770629079963',
                                        '770629189629',
                                        '770628859981',
                                        '770629444254',
                                        '770629375660',
                                        '770628808538',
                                        '770629447032',
                                        '770629448888',
                                        '770629223967',
                                        '770629440526',
                                        '770629333690',
                                        '770629670718',
                                        '770628998710',
                                        '770629697454',
                                        '770629270400',
                                        '770629667784',
                                        '770629450246',
                                        '770629436405',
                                        '770628803048',
                                        '770629675752',
                                        '770629644105') THEN
             vr_tpregist := 3;
             
             vr_linha :=    ' UPDATE CECRED.tbseg_prestamista p   '
                         || '    SET p.tpregist = ''' || rw_principal.tpregist || ''''
                         || '  WHERE p.idseqtra = ' || rw_principal.idseqtra || ';';
      
             CECRED.GENE0001.pc_escr_linha_arquivo(vr_ind_arq,vr_linha);
      
             UPDATE CECRED.tbseg_prestamista p
               SET p.tpregist = vr_tpregist
             WHERE p.idseqtra = rw_principal.idseqtra;
      
             vr_linha :=    ' UPDATE CECRED.crapseg p   '
                         || '    SET p.cdsitseg = ''' || rw_principal.cdsitseg || ''''
                         || '       ,p.cdmotcan = ''' || rw_principal.cdmotcan || ''''
                         || '       ,p.dtcancel = TO_DATE(''' || rw_principal.dtcancel || ''',''DD/MM/RRRR'')'
                         || '       ,p.dtfimvig = TO_DATE(''' || rw_principal.dtfimvig_crapseg || ''',''DD/MM/RRRR'')'
                         || '  WHERE p.progress_recid = ' || rw_principal.progress_recid || ';';
      
             CECRED.GENE0001.pc_escr_linha_arquivo(vr_ind_arq,vr_linha);
      
             UPDATE CECRED.crapseg p
               SET p.cdsitseg = 1
                  ,p.cdmotcan = NULL
                  ,p.dtcancel = NULL
                  ,p.dtfimvig = rw_principal.dtfimvig
             WHERE p.progress_recid = rw_principal.progress_recid;
             
           ELSIF rw_principal.nrproposta IN ('770629338985',
                                             '770629335480',
                                             '770629341340',
                                             '770629152920',
                                             '770629337113',
                                             '770629151788',
                                             '770629447911',
                                             '770628958262',
                                             '770629537961',
                                             '770629148981',
                                             '770629543880',
                                             '770629343954',
                                             '770629147764',
                                             '770629543325',
                                             '770628956405',
                                             '770629341790',
                                             '770629342370',
                                             '770629340734',
                                             '770629152091',
                                             '770628759570',
                                             '770629537600',
                                             '770629337709',
                                             '770629151842',
                                             '770629542124',
                                             '770629146768',
                                             '770629344462',
                                             '770629540296',
                                             '770628957142',
                                             '770629539646',
                                             '770629147837',
                                             '770629447563',
                                             '770629469311',
                                             '770628957070',
                                             '770629539352',
                                             '770629541195',
                                             '770629540350',
                                             '770629470000',
                                             '770629471138',
                                             '770629340700',
                                             '770629150714') THEN
             vr_tpregist := 1;
             
             vr_linha :=    ' UPDATE CECRED.tbseg_prestamista p   '
                         || '    SET p.tpregist = ''' || rw_principal.tpregist || ''''
                         || '  WHERE p.idseqtra = ' || rw_principal.idseqtra || ';';
      
             CECRED.GENE0001.pc_escr_linha_arquivo(vr_ind_arq,vr_linha);
      
             UPDATE CECRED.tbseg_prestamista p
               SET p.tpregist = vr_tpregist
             WHERE p.idseqtra = rw_principal.idseqtra;
      
             vr_linha :=    ' UPDATE CECRED.crapseg p   '
                         || '    SET p.cdsitseg = ''' || rw_principal.cdsitseg || ''''
                         || '       ,p.cdmotcan = ''' || rw_principal.cdmotcan || ''''
                         || '       ,p.dtcancel = TO_DATE(''' || rw_principal.dtcancel || ''',''DD/MM/RRRR'')'
                         || '       ,p.dtfimvig = TO_DATE(''' || rw_principal.dtfimvig_crapseg || ''',''DD/MM/RRRR'')'
                         || '  WHERE p.progress_recid = ' || rw_principal.progress_recid || ';';
      
             CECRED.GENE0001.pc_escr_linha_arquivo(vr_ind_arq,vr_linha);
      
             UPDATE CECRED.crapseg p
               SET p.cdsitseg = 1
                  ,p.cdmotcan = NULL
                  ,p.dtcancel = NULL
                  ,p.dtfimvig = rw_principal.dtfimvig
             WHERE p.progress_recid = rw_principal.progress_recid;

         ELSIF rw_principal.nrproposta IN ('770655956999',
                                           '770655956921',
                                           '770655956905',
                                           '770655718435',
                                           '770655771972',
                                           '770655718230',
                                           '770655718265',
                                           '770655718338',
                                           '770655718362',
                                           '770655718451',
                                           '770655718753',
                                           '770655718800',
                                           '770655718877',
                                           '770655719857',
                                           '770655719890',
                                           '770655719946',
                                           '770655719962',
                                           '770655720103',
                                           '770655720146',
                                           '770655720200',
                                           '770655720251',
                                           '770655720308',
                                           '770655720405',
                                           '770655771565',
                                           '770655771620',
                                           '770655771689',
                                           '770655771867',
                                           '770655771875',
                                           '770655772111',
                                           '770655718460',
                                           '770655957057',
                                           '770655957073',
                                           '770655957090',
                                           '770655957138',
                                           '770655957189',
                                           '770655721940',
                                           '770655720480',
                                           '770655720502',
                                           '770655720529',
                                           '770655720782',
                                           '770655720812',
                                           '770655720898',
                                           '770655720910',
                                           '770655720979',
                                           '770655721274',
                                           '770655721304',
                                           '770655721401',
                                           '770655721541',
                                           '770655721797',
                                           '770655721916',
                                           '770655722220',
                                           '770655722270',
                                           '770655722378',
                                           '770655722416',
                                           '770655722521',
                                           '770655722580',
                                           '770655957197',
                                           '770655828184',
                                           '770655826874',
                                           '770655826904',
                                           '770655826912',
                                           '770655826963',
                                           '770655827862',
                                           '770655828150',
                                           '770655828192',
                                           '770655880372',
                                           '770655880461',
                                           '770655880585',
                                           '770655880607',
                                           '770655827161',
                                           '770655827250',
                                           '770655827340',
                                           '770655827420',
                                           '770655827480',
                                           '770655827498',
                                           '770655827528',
                                           '770655827625',
                                           '770655827641',
                                           '770655826521',
                                           '770655826653',
                                           '770655826688',
                                           '770655826700',
                                           '770655957324',
                                           '770655964797',
                                           '770655880976',
                                           '770655881417',
                                           '770655880640',
                                           '770655880879',
                                           '770655881026',
                                           '770655881107',
                                           '770655881190',
                                           '770655881280',
                                           '770655881441',
                                           '770655964827',
                                           '770655964835',
                                           '770655964886',
                                           '770655965041',
                                           '770655965190',
                                           '770655965289',
                                           '770655965300',
                                           '770655965327',
                                           '770655965505',
                                           '770655965610',
                                           '770655965653',
                                           '770655965980',
                                           '770655966005',
                                           '770655966080',
                                           '770655966099',
                                           '770655966137',
                                           '770655966234',
                                           '770655942220',
                                           '770655941940',
                                           '770655942416',
                                           '770655967206',
                                           '770655967427',
                                           '770655967435',
                                           '770655967567',
                                           '770655941908',
                                           '770655941967',
                                           '770655942203',
                                           '770655966277',
                                           '770655966269',
                                           '770655966471',
                                           '770655966480',
                                           '770655966609',
                                           '770655966641',
                                           '770655966676',
                                           '770655966757',
                                           '770655966811',
                                           '770655967036',
                                           '770655967125',
                                           '770655967133',
                                           '770655957529',
                                           '770655957553',
                                           '770655944419',
                                           '770655942696',
                                           '770655944370',
                                           '770655944664',
                                           '770655942505',
                                           '770655942874',
                                           '770655942963',
                                           '770655943099',
                                           '770655943170',
                                           '770655943242',
                                           '770655943293',
                                           '770655943307',
                                           '770655943315',
                                           '770655943501',
                                           '770655943552',
                                           '770655943650',
                                           '770655943803',
                                           '770655943838',
                                           '770655944192',
                                           '770655944249',
                                           '770655944281',
                                           '770655944486',
                                           '770655944516',
                                           '770656007389',
                                           '770655944796',
                                           '770656007249',
                                           '770656007133',
                                           '770656007214',
                                           '770656007265',
                                           '770656007273',
                                           '770656007281',
                                           '770656007338',
                                           '770656007575',
                                           '770656007648',
                                           '770656007672',
                                           '770656007710',
                                           '770656007737',
                                           '770656007770',
                                           '770656007800',
                                           '770656007869',
                                           '770656007885',
                                           '770656007893',
                                           '770656007974',
                                           '770656007982',
                                           '770656008040',
                                           '770656008105',
                                           '770656008172',
                                           '770656008288',
                                           '770656008369',
                                           '770656008458',
                                           '770656008504',
                                           '770656008610',
                                           '770656008768',
                                           '770655957740',
                                           '770656063530',
                                           '770655956557',
                                           '770655955984',
                                           '770656009365',
                                           '770655955860',
                                           '770655955879',
                                           '770655955925',
                                           '770655956212',
                                           '770655956484',
                                           '770655956530',
                                           '770655956611',
                                           '770656008857',
                                           '770656009004',
                                           '770656009136',
                                           '770656009250',
                                           '770656009306',
                                           '770656009381',
                                           '770656009454',
                                           '770655955160',
                                           '770655955240',
                                           '770655955364',
                                           '770655955372',
                                           '770655955518',
                                           '770655955585',
                                           '770655955682',
                                           '770655955739') THEN
                                           
          FOR rw_prestamista IN cr_prestamista(pr_idseqtra => rw_principal.idseqtra) LOOP
            vr_linha := 'INSERT INTO CECRED.tbseg_prestamista(idseqtra,
                                                              cdcooper,
                                                              nrdconta,
                                                              nrctrseg,
                                                              nrctremp,
                                                              tpregist,
                                                              cdapolic,
                                                              nrcpfcgc,
                                                              nmprimtl,
                                                              dtnasctl,
                                                              cdsexotl,
                                                              dsendres,
                                                              dsdemail,
                                                              nmbairro,
                                                              nmcidade,
                                                              cdufresd,
                                                              nrcepend,
                                                              nrtelefo,
                                                              dtdevend,
                                                              dtinivig,
                                                              cdcobran,
                                                              cdadmcob,
                                                              tpfrecob,
                                                              tpsegura,
                                                              cdprodut,
                                                              cdplapro,
                                                              vlprodut,
                                                              tpcobran,
                                                              vlsdeved,
                                                              vldevatu,
                                                              dtrefcob,
                                                              dtfimvig,
                                                              dtdenvio,
                                                              nrproposta,
                                                              tprecusa,
                                                              cdmotrec,
                                                              dtrecusa,
                                                              situacao,
                                                              tpcustei,
                                                              pemorte,
                                                              peinvalidez,
                                                              peiftttaxa,
                                                              qtifttdias,
                                                              nrapolice,
                                                              qtparcel,
                                                              vlpielimit,
                                                              vlifttlimi,
                                                              dsprotocolo,
                                                              flfinanciasegprestamista,
                                                              flcancelado_mobile)
                        VALUES( '''|| rw_prestamista.idseqtra                                   ||''',' ||
                               ''''|| rw_prestamista.cdcooper                                   ||''',' ||
                               ''''|| rw_prestamista.nrdconta                                   ||''',' ||
                               ''''|| rw_prestamista.nrctrseg                                   ||''',' ||
                               ''''|| rw_prestamista.nrctremp                                   ||''',' ||
                               ''''|| rw_prestamista.tpregist                                   ||''',' ||
                               ''''|| rw_prestamista.cdapolic                                   ||''',' ||
                               ''''|| rw_prestamista.nrcpfcgc                                   ||''',' ||
                               ''''|| rw_prestamista.nmprimtl                                   ||''',' ||
                               'TO_DATE(''' || rw_prestamista.dtnasctl || ''',''DD/MM/RRRR''),' ||
                               ''''|| rw_prestamista.cdsexotl                                   ||''',' ||
                               ''''|| rw_prestamista.dsendres                                   ||''',' ||
                               ''''|| rw_prestamista.dsdemail                                   ||''',' ||
                               ''''|| rw_prestamista.nmbairro                                   ||''',' ||
                               ''''|| rw_prestamista.nmcidade                                   ||''',' ||
                               ''''|| rw_prestamista.cdufresd                                   ||''',' ||
                               ''''|| rw_prestamista.nrcepend                                   ||''',' ||
                               ''''|| rw_prestamista.nrtelefo                                   ||''',' ||
                               'TO_DATE(''' || rw_prestamista.dtdevend || ''',''DD/MM/RRRR''),' ||
                               'TO_DATE(''' || rw_prestamista.dtinivig || ''',''DD/MM/RRRR''),' ||
                               ''''|| rw_prestamista.cdcobran                                   ||''',' || 
                               ''''|| rw_prestamista.cdadmcob                                   ||''',' || 
                               ''''|| rw_prestamista.tpfrecob                                   ||''',' || 
                               ''''|| rw_prestamista.tpsegura                                   ||''',' || 
                               ''''|| rw_prestamista.cdprodut                                   ||''',' || 
                               ''''|| rw_prestamista.cdplapro                                   ||''',' || 
                               ''''|| rw_prestamista.vlprodut                                   ||''',' || 
                               ''''|| rw_prestamista.tpcobran                                   ||''',' || 
                               ''''|| rw_prestamista.vlsdeved                                   ||''',' || 
                               ''''|| rw_prestamista.vldevatu                                   ||''',' ||
                               'TO_DATE(''' || rw_prestamista.dtrefcob || ''',''DD/MM/RRRR''),' ||
                               'TO_DATE(''' || rw_prestamista.dtfimvig || ''',''DD/MM/RRRR''),' ||
                               'TO_DATE(''' || rw_prestamista.dtdenvio || ''',''DD/MM/RRRR''),' ||
                               ''''|| rw_prestamista.nrproposta                                 ||''',' ||
                               ''''|| rw_prestamista.tprecusa                                   ||''',' ||
                               ''''|| rw_prestamista.cdmotrec                                   ||''',' ||
                               'TO_DATE(''' || rw_prestamista.dtrecusa || ''',''DD/MM/RRRR''),' ||
                               ''''|| rw_prestamista.situacao                                   ||''',' ||
                               ''''|| rw_prestamista.tpcustei                                   ||''',' ||
                               ''''|| rw_prestamista.pemorte                                    ||''',' ||
                               ''''|| rw_prestamista.peinvalidez                                ||''',' ||
                               ''''|| rw_prestamista.peiftttaxa                                 ||''',' ||
                               ''''|| rw_prestamista.qtifttdias                                 ||''',' ||
                               ''''|| rw_prestamista.nrapolice                                  ||''',' ||
                               ''''|| rw_prestamista.qtparcel                                   ||''',' ||
                               ''''|| rw_prestamista.vlpielimit                                 ||''',' ||
                               ''''|| rw_prestamista.vlifttlimi                                 ||''',' ||
                               ''''|| rw_prestamista.dsprotocolo                                ||''',' ||
                               ''''|| rw_prestamista.flfinanciasegprestamista                   ||''',' ||
                               ''''|| rw_prestamista.flcancelado_mobile                         ||''');';
                               
            CECRED.GENE0001.pc_escr_linha_arquivo(vr_ind_arq,vr_linha);
            
            DELETE CECRED.tbseg_prestamista p
             WHERE p.idseqtra = rw_prestamista.idseqtra;
          END LOOP;

          FOR rw_crapseg IN cr_crapseg(pr_progress_recid => rw_principal.progress_recid) LOOP
            vr_linha := 'INSERT INTO CECRED.crapseg(nrdconta,
                                                    nrctrseg,
                                                    dtinivig,
                                                    dtfimvig,
                                                    dtmvtolt,
                                                    cdagenci,
                                                    cdbccxlt,
                                                    cdsitseg,
                                                    dtaltseg,
                                                    dtcancel,
                                                    dtdebito,
                                                    dtiniseg,
                                                    indebito,
                                                    nrdolote,
                                                    nrseqdig,
                                                    qtprepag,
                                                    vlprepag,
                                                    vlpreseg,
                                                    dtultpag,
                                                    tpseguro,
                                                    tpplaseg,
                                                    qtprevig,
                                                    cdsegura,
                                                    lsctrant,
                                                    nrctratu,
                                                    flgunica,
                                                    dtprideb,
                                                    vldifseg,
                                                    nmbenvid##1,
                                                    nmbenvid##2,
                                                    nmbenvid##3,
                                                    nmbenvid##4,
                                                    nmbenvid##5,
                                                    dsgraupr##1,
                                                    dsgraupr##2,
                                                    dsgraupr##3,
                                                    dsgraupr##4,
                                                    dsgraupr##5,
                                                    txpartic##1,
                                                    txpartic##2,
                                                    txpartic##3,
                                                    txpartic##4,
                                                    txpartic##5,
                                                    dtultalt,
                                                    cdoperad,
                                                    vlpremio,
                                                    qtparcel,
                                                    tpdpagto,
                                                    cdcooper,
                                                    flgconve,
                                                    flgclabe,
                                                    cdmotcan,
                                                    tpendcor,
                                                    progress_recid,
                                                    cdopecnl,
                                                    dtrenova,
                                                    cdopeori,
                                                    cdageori,
                                                    dtinsori,
                                                    cdopeexc,
                                                    cdageexc,
                                                    dtinsexc,
                                                    vlslddev,
                                                    idimpdps)
              VALUES( ''' || rw_crapseg.nrdconta                                  ||''',' ||
                     '''' || rw_crapseg.nrctrseg                                  ||''',' ||
                     'TO_DATE(''' || rw_crapseg.dtinivig || ''',''DD/MM/RRRR''),' ||
                     'TO_DATE(''' || rw_crapseg.dtfimvig || ''',''DD/MM/RRRR''),' ||
                     'TO_DATE(''' || rw_crapseg.dtmvtolt || ''',''DD/MM/RRRR''),' ||
                     '''' || rw_crapseg.cdagenci                                  ||''',' ||
                     '''' || rw_crapseg.cdbccxlt                                  ||''',' ||
                     '''' || rw_crapseg.cdsitseg                                  ||''',' ||
                     'TO_DATE(''' || rw_crapseg.dtaltseg || ''',''DD/MM/RRRR''),' ||
                     'TO_DATE(''' || rw_crapseg.dtcancel || ''',''DD/MM/RRRR''),' ||
                     'TO_DATE(''' || rw_crapseg.dtdebito || ''',''DD/MM/RRRR''),' ||
                     'TO_DATE(''' || rw_crapseg.dtiniseg || ''',''DD/MM/RRRR''),' ||
                     '''' || rw_crapseg.indebito                                  ||''',' ||
                     '''' || rw_crapseg.nrdolote                                  ||''',' ||
                     '''' || rw_crapseg.nrseqdig                                  ||''',' ||
                     '''' || rw_crapseg.qtprepag                                  ||''',' ||
                     '''' || rw_crapseg.vlprepag                                  ||''',' ||
                     '''' || rw_crapseg.vlpreseg                                  ||''',' ||
                     'TO_DATE(''' || rw_crapseg.dtultpag || ''',''DD/MM/RRRR''),' ||
                     '''' || rw_crapseg.tpseguro                                  ||''',' ||
                     '''' || rw_crapseg.tpplaseg                                  ||''',' ||
                     '''' || rw_crapseg.qtprevig                                  ||''',' ||
                     '''' || rw_crapseg.cdsegura                                  ||''',' ||
                     '''' || rw_crapseg.lsctrant                                  ||''',' ||
                     '''' || rw_crapseg.nrctratu                                  ||''',' ||
                     '''' || rw_crapseg.flgunica                                  ||''',' ||
                     'TO_DATE(''' || rw_crapseg.dtprideb || ''',''DD/MM/RRRR''),' ||
                     '''' || rw_crapseg.vldifseg                                  ||''',' ||
                     '''' || rw_crapseg.nmbenvid##1                               ||''',' ||
                     '''' || rw_crapseg.nmbenvid##2                               ||''',' ||
                     '''' || rw_crapseg.nmbenvid##3                               ||''',' ||
                     '''' || rw_crapseg.nmbenvid##4                               ||''',' ||
                     '''' || rw_crapseg.nmbenvid##5                               ||''',' ||
                     '''' || rw_crapseg.dsgraupr##1                               ||''',' ||
                     '''' || rw_crapseg.dsgraupr##2                               ||''',' ||
                     '''' || rw_crapseg.dsgraupr##3                               ||''',' ||
                     '''' || rw_crapseg.dsgraupr##4                               ||''',' ||
                     '''' || rw_crapseg.dsgraupr##5                               ||''',' ||
                     '''' || rw_crapseg.txpartic##1                               ||''',' ||
                     '''' || rw_crapseg.txpartic##2                               ||''',' ||
                     '''' || rw_crapseg.txpartic##3                               ||''',' ||
                     '''' || rw_crapseg.txpartic##4                               ||''',' ||
                     '''' || rw_crapseg.txpartic##5                               ||''',' ||
                     'TO_DATE(''' || rw_crapseg.dtultalt || ''',''DD/MM/RRRR''),' ||
                     '''' || rw_crapseg.cdoperad                                  ||''',' || 
                     '''' || rw_crapseg.vlpremio                                  ||''',' || 
                     '''' || rw_crapseg.qtparcel                                  ||''',' || 
                     '''' || rw_crapseg.tpdpagto                                  ||''',' || 
                     '''' || rw_crapseg.cdcooper                                  ||''',' || 
                     '''' || rw_crapseg.flgconve                                  ||''',' || 
                     '''' || rw_crapseg.flgclabe                                  ||''',' || 
                     '''' || rw_crapseg.cdmotcan                                  ||''',' || 
                     '''' || rw_crapseg.tpendcor                                  ||''',' ||
                     '''' || rw_crapseg.progress_recid                            ||''',' ||
                     '''' || rw_crapseg.cdopecnl                                  ||''',' ||
                     'TO_DATE(''' || rw_crapseg.dtrenova || ''',''DD/MM/RRRR''),' ||
                     '''' || rw_crapseg.cdopeori                                  ||''',' ||
                     '''' || rw_crapseg.cdageori                                  ||''',' ||
                     'TO_DATE(''' || rw_crapseg.dtinsori || ''',''DD/MM/RRRR''),' ||
                     '''' || rw_crapseg.cdopeexc                                  ||''',' ||
                     '''' || rw_crapseg.cdageexc                                  ||''',' ||
                     'TO_DATE(''' || rw_crapseg.dtinsexc || ''',''DD/MM/RRRR''),' ||
                     '''' || rw_crapseg.vlslddev                                  ||''',' ||
                     '''' || rw_crapseg.idimpdps                                  ||''');';
            
            CECRED.GENE0001.pc_escr_linha_arquivo(vr_ind_arq,vr_linha);
                     
            DELETE CECRED.crapseg p
             WHERE p.progress_recid = rw_crapseg.progress_recid;
          END LOOP;
          
          FOR rw_crawseg IN cr_crawseg(pr_progress_recid => rw_principal.progress_recid_crawseg) LOOP
            vr_linha := 'INSERT INTO CECRED.crawseg(dtmvtolt,
                                                    nrdconta,
                                                    nrctrseg,
                                                    tpseguro,
                                                    nmdsegur,
                                                    tpplaseg,
                                                    nmbenefi,
                                                    nrcadast,
                                                    nmdsecao,
                                                    dsendres,
                                                    nrendres,
                                                    nmbairro,
                                                    nmcidade,
                                                    cdufresd,
                                                    nrcepend,
                                                    dtinivig,
                                                    dtfimvig,
                                                    dsmarvei,
                                                    dstipvei,
                                                    nranovei,
                                                    nrmodvei,
                                                    qtpasvei,
                                                    ppdbonus,
                                                    flgdnovo,
                                                    nrapoant,
                                                    nmsegant,
                                                    flgdutil,
                                                    flgnotaf,
                                                    flgapant,
                                                    vlpreseg,
                                                    vlseguro,
                                                    vldfranq,
                                                    vldcasco,
                                                    vlverbae,
                                                    flgassis,
                                                    vldanmat,
                                                    vldanpes,
                                                    vldanmor,
                                                    vlappmor,
                                                    vlappinv,
                                                    cdsegura,
                                                    nmempres,
                                                    dschassi,
                                                    flgrenov,
                                                    dtdebito,
                                                    vlbenefi,
                                                    cdcalcul,
                                                    flgcurso,
                                                    dtiniseg,
                                                    nrdplaca,
                                                    lsctrant,
                                                    nrcpfcgc,
                                                    nrctratu,
                                                    nmcpveic,
                                                    flgunica,
                                                    nrctrato,
                                                    flgvisto,
                                                    cdapoant,
                                                    dtprideb,
                                                    vldifseg,
                                                    dscobext##1,
                                                    dscobext##2,
                                                    dscobext##3,
                                                    dscobext##4,
                                                    dscobext##5,
                                                    vlcobext##1,
                                                    vlcobext##2,
                                                    vlcobext##3,
                                                    vlcobext##4,
                                                    vlcobext##5,
                                                    flgrepgr,
                                                    vlfrqobr,
                                                    tpsegvid,
                                                    dtnascsg,
                                                    cdsexosg,
                                                    vlpremio,
                                                    qtparcel,
                                                    nrfonemp,
                                                    nrfonres,
                                                    dsoutgar,
                                                    vloutgar,
                                                    tpdpagto,
                                                    cdcooper,
                                                    flgconve,
                                                    complend,
                                                    progress_recid,
                                                    nrproposta,
                                                    flggarad,
                                                    flgassum,
                                                    tpcustei,
                                                    tpmodali,
                                                    flfinanciasegprestamista,
                                                    flgsegma)
              VALUES ( TO_DATE(''' || rw_crawseg.dtmvtolt || ''',''DD/MM/RRRR''),' ||
                      '''' || rw_crawseg.nrdconta                         || ''',' ||
                      '''' || rw_crawseg.nrctrseg                         || ''',' ||
                      '''' || rw_crawseg.tpseguro                         || ''',' ||
                      '''' || rw_crawseg.nmdsegur                         || ''',' ||
                      '''' || rw_crawseg.tpplaseg                         || ''',' ||
                      '''' || rw_crawseg.nmbenefi                         || ''',' ||
                      '''' || rw_crawseg.nrcadast                         || ''',' ||
                      '''' || rw_crawseg.nmdsecao                         || ''',' ||
                      '''' || rw_crawseg.dsendres                         || ''',' ||
                      '''' || rw_crawseg.nrendres                         || ''',' ||
                      '''' || rw_crawseg.nmbairro                         || ''',' ||
                      '''' || rw_crawseg.nmcidade                         || ''',' ||
                      '''' || rw_crawseg.cdufresd                         || ''',' ||
                      '''' || rw_crawseg.nrcepend                         || ''',' ||
                      'TO_DATE(''' || rw_crawseg.dtinivig || ''',''DD/MM/RRRR''),' ||
                      'TO_DATE(''' || rw_crawseg.dtfimvig || ''',''DD/MM/RRRR''),' ||
                      '''' || rw_crawseg.dsmarvei                         || ''',' ||
                      '''' || rw_crawseg.dstipvei                         || ''',' ||
                      '''' || rw_crawseg.nranovei                         || ''',' ||
                      '''' || rw_crawseg.nrmodvei                         || ''',' ||
                      '''' || rw_crawseg.qtpasvei                         || ''',' ||
                      '''' || rw_crawseg.ppdbonus                         || ''',' ||
                      '''' || rw_crawseg.flgdnovo                         || ''',' ||
                      '''' || rw_crawseg.nrapoant                         || ''',' ||
                      '''' || rw_crawseg.nmsegant                         || ''',' ||
                      '''' || rw_crawseg.flgdutil                         || ''',' ||
                      '''' || rw_crawseg.flgnotaf                         || ''',' ||
                      '''' || rw_crawseg.flgapant                         || ''',' ||
                      '''' || rw_crawseg.vlpreseg                         || ''',' ||
                      '''' || rw_crawseg.vlseguro                         || ''',' ||
                      '''' || rw_crawseg.vldfranq                         || ''',' ||
                      '''' || rw_crawseg.vldcasco                         || ''',' ||
                      '''' || rw_crawseg.vlverbae                         || ''',' ||
                      '''' || rw_crawseg.flgassis                         || ''',' ||
                      '''' || rw_crawseg.vldanmat                         || ''',' ||
                      '''' || rw_crawseg.vldanpes                         || ''',' ||
                      '''' || rw_crawseg.vldanmor                         || ''',' ||
                      '''' || rw_crawseg.vlappmor                         || ''',' ||
                      '''' || rw_crawseg.vlappinv                         || ''',' ||
                      '''' || rw_crawseg.cdsegura                         || ''',' ||
                      '''' || rw_crawseg.nmempres                         || ''',' ||
                      '''' || rw_crawseg.dschassi                         || ''',' ||
                      '''' || rw_crawseg.flgrenov                         || ''',' ||
                      'TO_DATE(''' || rw_crawseg.dtdebito || ''',''DD/MM/RRRR''),' ||
                      '''' || rw_crawseg.vlbenefi                         || ''',' ||
                      '''' || rw_crawseg.cdcalcul                         || ''',' ||
                      '''' || rw_crawseg.flgcurso                         || ''',' ||
                      'TO_DATE(''' || rw_crawseg.dtiniseg || ''',''DD/MM/RRRR''),' ||
                      '''' || rw_crawseg.nrdplaca                         || ''',' ||
                      '''' || rw_crawseg.lsctrant                         || ''',' ||
                      '''' || rw_crawseg.nrcpfcgc                         || ''',' ||
                      '''' || rw_crawseg.nrctratu                         || ''',' ||
                      '''' || rw_crawseg.nmcpveic                         || ''',' ||
                      '''' || rw_crawseg.flgunica                         || ''',' ||
                      '''' || rw_crawseg.nrctrato                         || ''',' ||
                      '''' || rw_crawseg.flgvisto                         || ''',' ||
                      '''' || rw_crawseg.cdapoant                         || ''',' ||
                      'TO_DATE(''' || rw_crawseg.dtprideb || ''',''DD/MM/RRRR''),' ||
                      '''' || rw_crawseg.vldifseg                         || ''',' ||
                      '''' || rw_crawseg.dscobext##1                      || ''',' ||
                      '''' || rw_crawseg.dscobext##2                      || ''',' ||
                      '''' || rw_crawseg.dscobext##3                      || ''',' ||
                      '''' || rw_crawseg.dscobext##4                      || ''',' ||
                      '''' || rw_crawseg.dscobext##5                      || ''',' ||
                      '''' || rw_crawseg.vlcobext##1                      || ''',' ||
                      '''' || rw_crawseg.vlcobext##2                      || ''',' ||
                      '''' || rw_crawseg.vlcobext##3                      || ''',' ||
                      '''' || rw_crawseg.vlcobext##4                      || ''',' ||
                      '''' || rw_crawseg.vlcobext##5                      || ''',' ||
                      '''' || rw_crawseg.flgrepgr                         || ''',' ||
                      '''' || rw_crawseg.vlfrqobr                         || ''',' ||
                      '''' || rw_crawseg.tpsegvid                         || ''',' ||
                      'TO_DATE(''' || rw_crawseg.dtnascsg || ''',''DD/MM/RRRR''),' ||
                      '''' || rw_crawseg.cdsexosg                         || ''',' ||
                      '''' || rw_crawseg.vlpremio                         || ''',' ||
                      '''' || rw_crawseg.qtparcel                         || ''',' ||
                      '''' || rw_crawseg.nrfonemp                         || ''',' ||
                      '''' || rw_crawseg.nrfonres                         || ''',' ||
                      '''' || rw_crawseg.dsoutgar                         || ''',' ||
                      '''' || rw_crawseg.vloutgar                         || ''',' ||
                      '''' || rw_crawseg.tpdpagto                         || ''',' ||
                      '''' || rw_crawseg.cdcooper                         || ''',' ||
                      '''' || rw_crawseg.flgconve                         || ''',' ||
                      '''' || rw_crawseg.complend                         || ''',' ||
                      '''' || rw_crawseg.progress_recid                   || ''',' ||
                      '''' || rw_crawseg.nrproposta                       || ''',' ||
                      '''' || rw_crawseg.flggarad                         || ''',' ||
                      '''' || rw_crawseg.flgassum                         || ''',' ||
                      '''' || rw_crawseg.tpcustei                         || ''',' ||
                      '''' || rw_crawseg.tpmodali                         || ''',' ||
                      '''' || rw_crawseg.flfinanciasegprestamista         || ''',' ||
                      '''' || rw_crawseg.flgsegma                         ||''');';

            CECRED.GENE0001.pc_escr_linha_arquivo(vr_ind_arq,vr_linha);
            
            vr_linha := 'UPDATE CECRED.crawseg SET nrproposta = ''' || rw_crawseg.nrproposta || ''' WHERE progress_recid = ' || rw_crawseg.progress_recid || ';';

            CECRED.GENE0001.pc_escr_linha_arquivo(vr_ind_arq,vr_linha); 

            DELETE CECRED.crawseg w
             WHERE w.progress_recid = rw_crawseg.progress_recid; 
                                  
          END LOOP;

         END IF;

          IF vcount = 1000 THEN
            COMMIT;
          ELSE
            vcount := vcount + 1;
          END IF;
        END LOOP;

        COMMIT;
      END LOOP;

      CECRED.GENE0001.pc_escr_linha_arquivo(vr_ind_arq,' COMMIT;');
      CECRED.GENE0001.pc_escr_linha_arquivo(vr_ind_arq,' END; ');
      CECRED.GENE0001.pc_escr_linha_arquivo(vr_ind_arq,'/ ');
      CECRED.GENE0001.pc_fecha_arquivo(pr_utlfileh => vr_ind_arq );
    EXCEPTION
       WHEN vr_exc_saida THEN
            vr_dscritic := vr_dscritic || SQLERRM || DBMS_UTILITY.FORMAT_ERROR_BACKTRACE;
            dbms_output.put_line(vr_dscritic);
            ROLLBACK;
       WHEN OTHERS THEN
            vr_dscritic := vr_dscritic || SQLERRM || DBMS_UTILITY.FORMAT_ERROR_BACKTRACE;
            dbms_output.put_line(vr_dscritic);
            ROLLBACK;
    END;
/
