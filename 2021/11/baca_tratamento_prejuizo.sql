DECLARE
  CURSOR cr_crapcop IS
    SELECT cdcooper
      FROM crapcop c
     WHERE c.flgativo = 1;
  rw_crapcop cr_crapcop%ROWTYPE;
  
  vr_dstratar VARCHAR2(4000) := '502049;10014825;04/08/2021|511307;10007981;04/08/2021|520500;10008257;04/08/2021|518948;10008329;04/08/2021|508209;10008736;04/08/2021|508209;10009334;04/08/2021|517844;10012285;04/08/2021|521469;10012451;04/08/2021|508870;10012786;04/08/2021|509779;10013890;04/08/2021|514624;10014213;04/08/2021|528617;10014229;04/08/2021|524069;10014256;04/08/2021|528374;10014732;04/08/2021|528617;10015020;04/08/2021|528617;10015201;04/08/2021|529249;13000007;04/08/2021|529230;13000417;04/08/2021|510041;13001003;04/08/2021|512346;13001008;04/08/2021|522244;13001098;04/08/2021|521272;14000366;04/08/2021|524930;14000505;04/08/2021|518468;14001210;04/08/2021|517186;14001392;04/08/2021|528544;14001433;04/08/2021|532207;14100030;04/08/2021|513644;15000120;04/08/2021|528765;15000192;04/08/2021|530107;15000256;04/08/2021|529044;15000273;04/08/2021|521132;15000295;04/08/2021|531316;15000479;04/08/2021|527041;15000488;04/08/2021|520012;15000569;04/08/2021|527548;15000670;04/08/2021|527432;15000824;04/08/2021|523127;15000881;04/08/2021|524131;15000882;04/08/2021|522252;15000980;04/08/2021|527769;15001025;04/08/2021|507610;15001042;04/08/2021|512753;15001049;04/08/2021|525065;15001084;04/08/2021|520497;15001121;04/08/2021|532266;15100015;04/08/2021|531979;15100050;04/08/2021|531472;16000013;04/08/2021|522120;16000164;04/08/2021|503339;16000275;04/08/2021|526711;16000303;04/08/2021|522120;16000453;04/08/2021|523747;16000466;04/08/2021|525367;16000471;04/08/2021|503380;16000580;04/08/2021|502499;16000582;04/08/2021|510815;16000589;04/08/2021|530590;16000608;04/08/2021|503312;16000651;04/08/2021|528439;16000696;04/08/2021|521256;16000755;04/08/2021|513466;16000762;04/08/2021|520543;16000785;04/08/2021|520241;16000859;04/08/2021|500976;16001095;04/08/2021|531790;16100010;04/08/2021|532010;16100013;04/08/2021|503487;16100019;04/08/2021|525111;16100027;04/08/2021|532363;16100030;04/08/2021|531790;16100039;04/08/2021|532355;16100042;04/08/2021|500526;16200004;04/08/2021|527190;16200011;04/08/2021|'; 
  -- Adicionar tratamento para a conta  | separador 1 e ; separador 2
BEGIN

  -- PRM
  FOR rw_crapcop IN cr_crapcop LOOP
    
    INSERT INTO crapprm
      (nmsistem,
       cdcooper,
       cdacesso,
       dstexprm,
       dsvlrprm)
    VALUES
      ('CRED',
       rw_crapcop.cdcooper,
       'PREJUIZO_EXCECAO',
       'Contas com excecoes exclusivas a serem tratadas em fontes especificos EMPR0001 e EXTR0002',
       CASE rw_crapcop.cdcooper WHEN 9 THEN vr_dstratar ELSE '' END);
       
  END LOOP;
  
  COMMIT;
END;

